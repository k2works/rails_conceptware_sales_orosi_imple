<?xml version="1.0" encoding="UTF-8"?>
<System AppServerName="" AutoConnectToEdit="T" CalendarTable="ZT070" CurrencyDetailTable="" CurrencyTable="" DBCP="" DatabaseName="jdbc:mysql://127.0.0.1/rails_conceptware_sales_orosi_imple_development" DatabasePassword="password" DatabaseUser="root" DateFormat="jp11" DriverVMOptions="-Xms256m -Xmx256m" EditorUser="00000" EditorUserPassword="0000000000" ExchangeRateAnnualTable="ZT080" ExchangeRateMonthlyTable="ZT081" FormatVersion="1.2" HashFormat="" ImageFileFolder="&lt;CURRENT>\db\image" LoginScript="////////////////////////////#EOL#// セッション開始時の処理 //#EOL#////////////////////////////#EOL#if (session.status == 'ACT') {#EOL##EOL#&#x9;/////////////////////////////////////#EOL#&#x9;// 前後日付算出（検索条件初期値用）//#EOL#&#x9;/////////////////////////////////////#EOL#&#x9;var today = session.getToday() + '';#EOL#&#x9;var todayWithSlash = today.substring(0, 4) + '/' + today.substring(5, 7) + '/' + today.substring(8, 10);#EOL#&#x9;var dateLastWeek = session.getOffsetDate(today, -7, 0);#EOL#&#x9;var dateNextWeek = session.getOffsetDate(today, 7, 0);#EOL#&#x9;var date3MonthsAgo = session.getOffsetDate(today, -91, 0);#EOL#&#x9;var date2MonthsAgo = session.getOffsetDate(today, -61, 0);#EOL#&#x9;var dateLastMonth = session.getOffsetDate(today, -30, 0);#EOL#&#x9;var dateNextMonth = session.getOffsetDate(today, 30, 0);#EOL#&#x9;var dateLastYear = session.getOffsetDate(today, -365, 0);#EOL#&#x9;var currentFYear = session.getFYearOfDate(today);#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// セッション属性の登録 //#EOL#&#x9;//////////////////////////#EOL#&#x9;session.setAttribute('Today', today);                            // 当日日付(-区切) //#EOL#&#x9;session.setAttribute('TodayWithSlash', todayWithSlash);          // 当日日付(/区切) //#EOL#&#x9;session.setAttribute('DateLastWeek', dateLastWeek);              // １週間前日付 //#EOL#&#x9;session.setAttribute('DateNextWeek', dateNextWeek);              // １週間後日付 //#EOL#&#x9;session.setAttribute('Date3MonthsAgo', date3MonthsAgo);          // ３ヶ月前日付 //#EOL#&#x9;session.setAttribute('Date2MonthsAgo', date2MonthsAgo);          // ２ヶ月前日付 //#EOL#&#x9;session.setAttribute('DateLastMonth', dateLastMonth);            // １ヶ月前日付 //#EOL#&#x9;session.setAttribute('DateNextMonth', dateNextMonth);            // １ヶ月後日付 //#EOL#&#x9;session.setAttribute('DateLastYear', dateLastYear);              // １年前日付 //#EOL#&#x9;session.setAttribute('CurrentFYear', currentFYear);              // 当年度 //#EOL#&#x9;session.setAttribute('EmployeeNo', session.userEmployeeNo + ''); // ユーザの従業員№（ブランクの場合あり）//#EOL##EOL#}#EOL#" Name="卸売業向け販売管理システム" NumberingTable="ZT030" OutputFolder="&lt;CURRENT>\db\output" ProxyIP="" ProxyPort="" Remarks="◆システムの概要#EOL#DBC社提供の基本設計ライブラリー「CONCEPTWARE／販売管理(4.0.0)」にもとづいて作成された専門卸売業向け販売管理システムの詳細設計です。発注･仕入･支払管理、見積･受注･売上･請求･受領管理、在庫管理がなされます。在庫については、倉庫・商品別の現在庫と未来在庫が管理されます。#EOL##EOL#◆システムへのログイン方法#EOL#システム起動のボタン（またはＦ５）を押すと、X-TEA Driverが起動され、詳細設計（このファイルの内容）が解釈されてシステムが立ち上がります。その際、&quot;00000&quot;のユーザＩＤで自動的にログインされます。これは、X-TEA Editorの「その他の設定」のタブの「Editorユーザ」と「パスワード」がそのように設定されているためです。ログインに成功すると１つまたは複数のメニューがタブ形式で示されますが、どのメニューを並べるかはユーザ毎に設定されています。すなわち、ユーザテーブル上の「利用可能メニュー」に&quot;ALL&quot;と指定すればすべてのメニューがタブ表示され、&quot;10,20&quot;のようにメニューＩＤをコンマ区切りで指定すればそれらのみがタブ表示されます（その様子をX-TEA Editor上でユーザテーブル(ZT020)の「データ」のタブで確認できます）。デスクトップのショートカットから起動させることも可能です（Readme参照）。#EOL##EOL#◆基本設計情報について#EOL#データモデル、業務フロー、業務マニュアルを含む基本設計については「CONCEPTWARE／販売管理」を参照してください。このファイルと同じフォルダにSalesOrosi.xeadの名前で置かれています。閲覧・編集するためには別途 X-TEA Modeler をインストールする必要があります。#EOL##EOL#◆利用条件#EOL#・本データの著作権および所有権はDBC社が有します#EOL#・本データを使用したことによって発生したいかなるトラブル、損害にも、著作者は一切の責任を負いません#EOL#・本データを再配布・転載する際には、著作権や利用条件の表示を書き換えないでください#EOL#・以上の点が了承・遵守される限りにおいて、本データを無償にてご利用できます。なお、商業的な再配布・転載等の際には、事前に御相談ください#EOL##EOL#◆最近の大きな変更#EOL#＜２．０．0＞#EOL#・「CONCEPTWARE／販売管理(4.0.0)」にもとづいて大幅修正した#EOL#＜１．０．２７＞#EOL#・セッションテーブル(ZT050)に「処理系バージョン」を組み込み、「IPアドレス」のサイズを２０桁に短縮した#EOL#＜１．０．２６＞#EOL#・休日テーブル(ZT070)にカレンダー区分を組み込んだ#EOL#＜１．０．２５＞#EOL#・Driverの検索条件の配置方式の改善にともなって、一部の機能の検索条件の配置を変更した。#EOL#・一部のスクリプトのコメントミスを修正した#EOL#・支払指示時の仕入実績の書き込みステップのミスを修正した" ScriptFunctions="//////////////////////////#EOL#// メッセージ表示用関数 //#EOL#//////////////////////////#EOL#function showMessage(message) {#EOL#&#x9;javax.swing.JOptionPane.showMessageDialog(null, message);#EOL#}" SessionDetailTable="ZT051" SessionTable="ZT050" SkipModuleCheck="F" SkipPreload="T" SmtpAdminEmail="" SmtpHost="" SmtpPassword="" SmtpPort="" SmtpUser="" SystemFont="Meiryo UI" TaxTable="ZT060" UserFilterValueTable="ZT021" UserTable="ZT020" UserVariantsTable="ZT040" VariantsTable="ZT010" Version="2.0.5" WelcomePageURL="http://homepage2.nifty.com/dbc/xeadFramework/MenuPage.html"><Menu CrossCheckersToBeLoaded="" FunctionsToBeLoaded="" HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=10" ID="10" Name="マスター管理メニュー"><Option FunctionID="AF010" Index="00" OptionName=""/><Option FunctionID="AF020" Index="01" OptionName=""/><Option FunctionID="AF030" Index="02" OptionName=""/><Option FunctionID="BF010" Index="10" OptionName=""/><Option FunctionID="BF020" Index="11" OptionName=""/><Option FunctionID="BF030" Index="12" OptionName=""/></Menu><Menu CrossCheckersToBeLoaded="" FunctionsToBeLoaded="" HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=11" ID="11" Name="在庫管理メニュー"><Option FunctionID="KF010" Index="06" OptionName=""/><Option FunctionID="KF020" Index="12" OptionName=""/><Option FunctionID="KF026" Index="13" OptionName=""/><Option FunctionID="KF016A" Index="07" OptionName="棚卸結果エントリー"/><Option FunctionID="EF210" Index="04" OptionName=""/><Option FunctionID="EF200" Index="03" OptionName=""/><Option FunctionID="EF100" Index="01" OptionName=""/><Option FunctionID="LF010" Index="15" OptionName=""/><Option FunctionID="LF014A" Index="16" OptionName=""/><Option FunctionID="EF010" Index="00" OptionName=""/><Option FunctionID="KF030" Index="10" OptionName=""/></Menu><Menu CrossCheckersToBeLoaded="" FunctionsToBeLoaded="" HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=12" ID="12" Name="受注管理メニュー"><Option FunctionID="DF010" Index="10" OptionName=""/><Option FunctionID="GF010" Index="01" OptionName=""/><Option FunctionID="GF020" Index="03" OptionName=""/><Option FunctionID="GF040" Index="05" OptionName=""/><Option FunctionID="JF010" Index="08" OptionName=""/><Option FunctionID="JF020" Index="07" OptionName=""/><Option FunctionID="GF050" Index="00" OptionName=""/><Option FunctionID="DF100" Index="12" OptionName=""/><Option FunctionID="DF020" Index="11" OptionName=""/><Option FunctionID="DF111" Index="14" OptionName=""/><Option FunctionID="DF110" Index="15" OptionName=""/><Option FunctionID="DF120" Index="16" OptionName=""/><Option FunctionID="GF030" Index="04" OptionName=""/></Menu><Menu CrossCheckersToBeLoaded="" FunctionsToBeLoaded="" HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=13" ID="13" Name="発注管理メニュー"><Option FunctionID="CF010" Index="10" OptionName=""/><Option FunctionID="FF010" Index="00" OptionName=""/><Option FunctionID="FF040" Index="04" OptionName=""/><Option FunctionID="FF020" Index="02" OptionName="入荷指示エントリー"/><Option FunctionID="CF100" Index="11" OptionName=""/><Option FunctionID="CF111A" Index="13" OptionName="支払依頼エントリー"/><Option FunctionID="CF110" Index="14" OptionName=""/><Option FunctionID="HF010" Index="07" OptionName=""/><Option FunctionID="HF020" Index="06" OptionName=""/><Option FunctionID="FF030" Index="03" OptionName=""/><Option FunctionID="FF013" Index="15" OptionName=""/></Menu><Menu CrossCheckersToBeLoaded="" HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=90" ID="90" Name="システム管理メニュー"><Option FunctionID="ZF010" Index="00" OptionName=""/><Option FunctionID="ZF020" Index="01" OptionName=""/><Option FunctionID="ZF030" Index="02" OptionName=""/><Option FunctionID="ZF040" Index="03" OptionName=""/><Option FunctionID="ZF050" Index="05" OptionName=""/><Option FunctionID="ZF060" Index="10" OptionName=""/><Option FunctionID="ZF080" Index="12" OptionName=""/><Option FunctionID="ZF082" Index="13" OptionName=""/><Option FunctionID="ZF900" Index="15" OptionName=""/><Option FunctionID="ZF070" Index="11" OptionName=""/></Menu><Menu HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=14" ID="14" Name="購買部長メニュー"><Option FunctionID="CF010" Index="01" OptionName=""/><Option FunctionID="CF120" Index="00" OptionName=""/></Menu><Menu HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=15" ID="15" Name="経理メニュー"><Option FunctionID="CF131" Index="01" OptionName=""/><Option FunctionID="CF130" Index="02" OptionName=""/><Option FunctionID="CF010" Index="00" OptionName=""/><Option FunctionID="DF010" Index="04" OptionName=""/><Option FunctionID="DF120" Index="05" OptionName=""/><Option FunctionID="ZF100" Index="14" OptionName=""/><Option FunctionID="CF140" Index="10" OptionName=""/><Option FunctionID="DF130" Index="11" OptionName=""/><Option FunctionID="EF110" Index="12" OptionName=""/></Menu><Menu HelpURL="http://homepage2.nifty.com/dbc/tasklist.html?file=sample.xml&amp;id=20" ID="20" Name="統計管理メニュー"><Option FunctionID="YF010" Index="00" OptionName=""/><Option FunctionID="YF020" Index="01" OptionName=""/><Option FunctionID="YF100" Index="10" OptionName=""/><Option FunctionID="YF030" Index="02" OptionName=""/><Option FunctionID="YF040" Index="03" OptionName=""/><Option FunctionID="YF050" Index="04" OptionName=""/><Option FunctionID="YF060" Index="05" OptionName=""/><Option FunctionID="ZF110" Index="11" OptionName=""/></Menu><Subsystem ID="A" Name="組織マスター管理" Remarks="部門、従業員、取引先といった全社的な基本台帳とその管理機能を提供するサブシステム"/><Subsystem ID="B" Name="商品マスター管理" Remarks="商品や倉庫といった商品関連情報を管理するための台帳とそれらの管理機能を提供するサブシステム"/><Subsystem ID="C" Name="買掛残高データ管理" Remarks="仕入先台帳、及び、仕入・支払関連の取引簿とそれらの管理機能を提供するサブシステム。#EOL##EOL#各種仕入取引にともなって仕入実績が追加されると「仕入先」の買掛残高が増額される。何件かの仕入実績がまとまって１件の支払依頼が作られる。支払依頼が管理者によって承認され、さらに経理担当者によって支払指示されると、支払依頼に対して実際の支払がなされたとみなされる。このときに、相当する仕入実績（支払実績）が生成され、買掛残高が減額される。"/><Subsystem ID="D" Name="売掛残高データ管理" Remarks="顧客台帳、及び、売上・請求・受領関連の取引簿とそれらの管理機能を提供するサブシステム。#EOL##EOL#各種売上取引にともなって売上実績が追加されると「顧客」の売掛残高が増額される。何件かの売上実績がまとまって１件の請求見出しが作られる。請求書送付後に経理によって入金が確認されたなら、受領明細が登録されると同時に売上実績（受領実績）が生成され、売掛残高が減額される。通常は月次で請求処理がなされるが、「都度請求」の顧客に対しては売上実績毎に請求処理がなされる。"/><Subsystem ID="E" Name="在庫残高データ管理" Remarks="在庫残高や受払に関する帳簿とその管理機能を提供するサブシステム"/><Subsystem ID="Z" Name="システム制御データ管理" Remarks="システムへのログインや利用履歴、およびシステム変数等の基本的なシステム設定値を管理するためのサブシステム"/><Subsystem ID="F" Name="発注･入荷データ管理" Remarks="発注、入荷といった標準的な仕入活動に関する帳簿とその管理機能を提供するサブシステム"/><Subsystem ID="G" Name="受注･出荷データ管理" Remarks="見積、受注、出荷といった標準的な売上活動に関する帳簿とその管理機能を提供するサブシステム"/><Subsystem ID="Y" Name="統計データ管理" Remarks="商品や顧客等のさまざまな切り口での月次集計値を維持・照会するためのサブシステム"/><Subsystem ID="H" Name="一般仕入取引データ管理" Remarks="仕入返品、直接入荷(発注なしの入荷)、他勘定振替といった通常入荷以外の買掛増減取引の帳簿とその管理機能を提供するサブシステム"/><Subsystem ID="K" Name="一般在庫取引データ管理" Remarks="棚増、棚減等の一般在庫取引や棚卸に関する帳簿とその管理機能を提供するサブシステム"/><Subsystem ID="J" Name="一般売上取引データ管理" Remarks="売上返品、直接出荷(受注なしの出荷)、他勘定振替といった通常出荷以外の売掛増減取引の帳簿とその管理機能を提供するサブシステム"/><Subsystem ID="L" Name="セット指示データ管理" Remarks="セット商品の加工指示に関する帳簿とその管理機能を提供するサブシステム"/><Table ActiveWhere="" ID="AT010" Name="部門" RangeKey="" Remarks="部門定義を保持するためのテーブル" SubsystemID="A"><Field ID="CDBUMON" Name="部門Ｃ" Nullable="F" Order="0" Remarks="" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXBUMON" Name="部門名" Nullable="F" Order="1" Remarks="" Size="30" Type="CHAR" TypeOptions="KANJI"/><Field ID="NRKANRISYA" Name="管理者№" Nullable="F" Order="2" Remarks="" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXTEKIYO" Name="摘要" Nullable="T" Order="3" Remarks="" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Key Fields="CDBUMON" Type="PK"/><Refer Fields="TXKANJI" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT020" WithKeyFields="AT010.NRKANRISYA"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0000" Text="var rAT011 = instance.createTableOperator('Count', 'AT011');#EOL#rAT011.addKeyValue('CDBUMON',&#x9;AT010_CDBUMON.value);#EOL#if (rAT011.execute() > 0) {#EOL#&#x9;AT010_CDBUMON.error = '既存の部門階層によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rAT011 = instance.createTableOperator('Count', 'AT011');#EOL#rAT011.addKeyValue('CDJYOUIBUMON',&#x9;AT010_CDBUMON.value);#EOL#if (rAT011.execute() > 0) {#EOL#&#x9;AT010_CDBUMON.error = '既存の部門階層によって上位部門として参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rAT021 = instance.createTableOperator('Count', 'AT021');#EOL#rAT021.addKeyValue('CDBUMON',&#x9;AT010_CDBUMON.value);#EOL#if (rAT021.execute() > 0) {#EOL#&#x9;AT010_CDBUMON.error = '既存の従業員所属部門によって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="AT011" Name="部門階層" RangeKey="" Remarks="組織階層情報を保持するためのテーブル。部門毎に年月期間別の上位部門が定義される。" SubsystemID="A"><Field ID="CDBUMON" Name="部門Ｃ" Nullable="F" Order="0" Remarks="" Size="5" Type="CHAR" TypeOptions=""/><Field ID="DTHAKKOUNENGETSU" Name="発効年月" Nullable="F" Order="1" Remarks="" Size="6" Type="CHAR" TypeOptions="YMONTH"/><Field ID="CDJYOUIBUMON" Name="上位部門Ｃ" Nullable="F" Order="2" Remarks="" Size="5" Type="CHAR" TypeOptions=""/><Field ID="DTSIKKOUNENGETSU" Name="失効年月" Nullable="F" Order="3" Remarks="" Size="6" Type="CHAR" TypeOptions="YMONTH"/><Key Fields="CDBUMON;DTHAKKOUNENGETSU" Type="PK"/><Refer Fields="TXBUMON" Order="0" TableAlias="AT010_1" ToKeyFields="" ToTable="AT010" WithKeyFields="AT011.CDBUMON"/><Refer Fields="TXBUMON" Order="1" TableAlias="AT010_2" ToKeyFields="" ToTable="AT010" WithKeyFields="AT011.CDJYOUIBUMON"/><Script EventP="BC;BU" EventR="BR()" Name="失効年月のエラー検査" Order="0" Text="if (AT011_DTSIKKOUNENGETSU.value != '' &amp;&amp; AT011_DTSIKKOUNENGETSU.value &lt;=  AT011_DTHAKKOUNENGETSU.value) {#EOL#&#x9;AT011_DTSIKKOUNENGETSU.error = '発効年月より未来に設定してください。'#EOL#}"/><Script EventP="BC;BU" EventR="AR()" Function="" Name="上位部門のエラー検査" Order="0010" Text="//////////////////////////////////////////////#EOL#// Javaパッケージの導入 for Class ArrayList //#EOL#//////////////////////////////////////////////#EOL#var importedPackage = new JavaImporter(java.util);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数定義 //#EOL#&#x9;//////////////#EOL#&#x9;var rAT011;#EOL#&#x9;var tougaibumon = ''; //当該部門CD//#EOL#&#x9;var jyouibumon = '';  //上位部門CD//#EOL#&#x9;var dthakkounengetsu = ''; //発効年月//#EOL#&#x9;var dtsikkounengetsu = ''; //失効年月//#EOL#&#x9;var jyouibumonList = new ArrayList(); //上位部門CDリスト//#EOL#&#x9;var dthakkounengetsuList = new ArrayList(); //発効年月リスト//#EOL#&#x9;var dtsikkounengetsuList = new ArrayList(); //失効年月リスト//#EOL##EOL#&#x9;if (AT011_CDJYOUIBUMON.value != '') {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;// '00001'のような値が数値の1として比較されないために明示的に //#EOL#&#x9;&#x9;// 両辺を文字列化したうえで、部門Ｃと上位部門Ｃとを比較する   //#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;tougaibumon = AT011_CDBUMON.value + '';#EOL#&#x9;&#x9;jyouibumon = AT011_CDJYOUIBUMON.value + '';#EOL#&#x9;&#x9;if (tougaibumon == jyouibumon) {#EOL#&#x9;&#x9;&#x9;AT011_CDJYOUIBUMON.error = '自分自身を上位部門としては指定できません。';#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;&#x9;// 階層ループチェック //#EOL#&#x9;&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;&#x9;jyouibumonList.add(jyouibumon);#EOL#&#x9;&#x9;&#x9;dthakkounengetsuList.add(AT011_DTHAKKOUNENGETSU.value);#EOL#&#x9;&#x9;&#x9;dtsikkounengetsuList.add(AT011_DTSIKKOUNENGETSU.value);#EOL#&#x9;&#x9;&#x9;for (var i = 0; i &lt; jyouibumonList.size(); i++) {#EOL#&#x9;&#x9;&#x9;&#x9;rAT011 = instance.createTableOperator('Select', 'AT011');#EOL#&#x9;&#x9;&#x9;&#x9;rAT011.addKeyValue('CDBUMON',&#x9;&#x9;&#x9;&#x9;jyouibumonList.get(i));#EOL#&#x9;&#x9;&#x9;&#x9;rAT011.addKeyValue('DTHAKKOUNENGETSU &lt;',&#x9;dtsikkounengetsuList.get(i));#EOL#&#x9;&#x9;&#x9;&#x9;rAT011.addKeyValue('DTSIKKOUNENGETSU >',&#x9;dthakkounengetsuList.get(i));#EOL#&#x9;&#x9;&#x9;&#x9;while(rAT011.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;jyouibumon = rAT011.getValueOf('CDJYOUIBUMON') + '';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dthakkounengetsu = rAT011.getValueOf('DTHAKKOUNENGETSU');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dtsikkounengetsu = rAT011.getValueOf('DTSIKKOUNENGETSU');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (jyouibumon == tougaibumon) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AT011_CDJYOUIBUMON.error = '指定の部門が階層上でループします。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;i = jyouibumonList.size();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;jyouibumonList.add(jyouibumon);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dthakkounengetsuList.add(dthakkounengetsu);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dtsikkounengetsuList.add(dtsikkounengetsu);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}"/><Key Fields="CDJYOUIBUMON" Type="XK"/><Key Fields="CDBUMON" Type="XK"/><Script EventP="BC" EventR="BR()" Function="" Name="追加時設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#AT011_CDBUMON.editable = false;#EOL##EOL#////////////////#EOL#// 初期値設定 //#EOL#////////////////#EOL#if (AT011_DTHAKKOUNENGETSU.value == '') {#EOL#&#x9;AT011_DTHAKKOUNENGETSU.value = session.getThisMonth() + '';#EOL#}#EOL#if (AT011_DTSIKKOUNENGETSU.value == '') {#EOL#&#x9;AT011_DTSIKKOUNENGETSU.value = '999912';#EOL#}"/></Table><Table ActiveWhere="" ID="AT020" Name="従業員" RangeKey="" Remarks="従業員情報を保持するためのテーブル" SubsystemID="A"><Field ID="NRJYUGYOIN" Name="従業員№" Nullable="F" Order="0" Remarks="" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXKANA" Name="カナ名" Nullable="F" Order="1" Remarks="" Size="20" Type="CHAR" TypeOptions="KATAKANA"/><Field ID="TXKANJI" Name="漢字名" Nullable="F" Order="2" Remarks="" Size="20" Type="CHAR" TypeOptions="KANJI"/><Field ID="KBKOYOU" Name="雇用区分" Nullable="F" Order="3" Remarks="" Size="5" Type="CHAR" TypeOptions="KUBUN(KBKOYOU)"/><Field ID="DTNYUSYA" Name="入社日" Nullable="F" Order="4" Remarks="" Size="10" Type="DATE" TypeOptions=""/><Field ID="DTTAISYA" Name="退社日" Nullable="T" Order="5" Remarks="" Size="10" Type="DATE" TypeOptions=""/><Key Fields="NRJYUGYOIN" Type="PK"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0000" Text="var rAT010 = instance.createTableOperator('Count', 'AT010');#EOL#rAT010.addKeyValue('NRKANRISYA',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rAT010.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の部門によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rAT021 = instance.createTableOperator('Count', 'AT021');#EOL#rAT021.addKeyValue('NRJYUGYOIN',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rAT021.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の従業員所属部門によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT010 = instance.createTableOperator('Count', 'CT010');#EOL#rCT010.addKeyValue('NRTANTOUJYUGYOIN',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rCT010.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の仕入先によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT010 = instance.createTableOperator('Count', 'DT010');#EOL#rDT010.addKeyValue('NRTANTOUJYUGYOIN',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rDT010.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の顧客によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT100 = instance.createTableOperator('Count', 'DT100');#EOL#rDT100.addKeyValue('NRJYUGYOIN',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rDT100.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の売掛増減履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT010 = instance.createTableOperator('Count', 'FT010');#EOL#rFT010.addKeyValue('NRJYUGYOIN',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rFT010.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の発注見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT020 = instance.createTableOperator('Count', 'GT020');#EOL#rGT020.addKeyValue('DT010NRTANTOUJYUGYOIN',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rGT020.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の出荷見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT060 = instance.createTableOperator('Count', 'YT060');#EOL#rYT060.addKeyValue('NRTANTOUJYUGYOIN',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rYT060.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存の営業担当別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rZT020 = instance.createTableOperator('Count', 'ZT020');#EOL#rZT020.addKeyValue('NREMPLOYEE',&#x9;AT020_NRJYUGYOIN.value);#EOL#if (rZT020.execute() > 0) {#EOL#&#x9;AT020_NRJYUGYOIN.error = '既存のユーザ定義によって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="AT021" Name="従業員所属部門" RangeKey="" Remarks="従業員の所属部門を保持するためのテーブル。従業員毎に年月期間別の所属部門が定義される。" SubsystemID="A"><Field ID="NRJYUGYOIN" Name="従業員№" Nullable="F" Order="0010" Remarks="" Size="5" Type="CHAR" TypeOptions=""/><Field ID="DTSYOZOKUNENGETSU" Name="所属発効年月" Nullable="F" Order="0020" Remarks="" Size="6" Type="CHAR" TypeOptions="YMONTH"/><Field ID="CDBUMON" Name="部門Ｃ" Nullable="F" Order="0030" Remarks="" Size="5" Type="CHAR" TypeOptions=""/><Key Fields="NRJYUGYOIN;DTSYOZOKUNENGETSU" Type="PK"/><Refer Fields="TXKANJI;TXKANA;DTTAISYA" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT020" WithKeyFields="AT021.NRJYUGYOIN"/><Refer Fields="TXBUMON" Order="1" TableAlias="" ToKeyFields="" ToTable="AT010" WithKeyFields="AT021.CDBUMON"/><Key Fields="NRJYUGYOIN" Type="XK"/><Key Fields="CDBUMON" Type="XK"/><Field ID="DTLASTNENGETSU" Name="所属最終年月" Nullable="T" Order="0050" Remarks="" Size="6" Type="CHAR" TypeOptions="VIRTUAL,YMONTH"/><Field ColumnName="現行メンバー" ID="KBPRESENT" Name="現行メンバー区分" NoUpdate="F" Nullable="F" Order="0060" Size="1" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBFLAG1)"/><Script EventP="BC;BU;BD;AR" EventR="BR()" Function="" Name="仮想フィールドの設定" Order="0000" Text="//////////////////#EOL#// 所属最終年月 //#EOL#//////////////////#EOL#var lastYearMonth = '999912';#EOL#if (AT021_DTSYOZOKUNENGETSU.value != '') {#EOL#&#x9;var rAT021 = instance.createTableOperator('Select', 'AT021');#EOL#&#x9;rAT021.addKeyValue('NRJYUGYOIN',&#x9;AT021_NRJYUGYOIN.value);#EOL#&#x9;rAT021.setOrderBy('NRJYUGYOIN, DTSYOZOKUNENGETSU');#EOL#&#x9;while (rAT021.next()) {#EOL#&#x9;&#x9;if (rAT021.getValueOf('DTSYOZOKUNENGETSU') > AT021_DTSYOZOKUNENGETSU.value) {#EOL#&#x9;&#x9;&#x9;var workString = rAT021.getValueOf('DTSYOZOKUNENGETSU') + '';#EOL#&#x9;&#x9;&#x9;var workIntYear = workString.substring(0,4);#EOL#&#x9;&#x9;&#x9;var workIntMonth = workString.substring(4,6);#EOL##EOL#&#x9;&#x9;&#x9;workIntMonth = workIntMonth - 1;#EOL#&#x9;&#x9;&#x9;if (workIntMonth == 0) {#EOL#&#x9;&#x9;&#x9;&#x9;workIntMonth = 12;#EOL#&#x9;&#x9;&#x9;&#x9;workIntYear = workIntYear - 1;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (workIntMonth >= 10) {#EOL#&#x9;&#x9;&#x9;&#x9;lastYearMonth = workIntYear + workIntMonth + '';#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;lastYearMonth = workIntYear + '0' + workIntMonth + '';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL#if (AT020_DTTAISYA.value != '') {#EOL#&#x9;var nyusyaDate = AT020_DTTAISYA.value;#EOL#&#x9;var nyusyaYearMonth = nyusyaDate.replace('-','').substring(0,6);#EOL#&#x9;if (lastYearMonth > nyusyaYearMonth) {#EOL#&#x9;&#x9;lastYearMonth = nyusyaYearMonth;#EOL#&#x9;}#EOL#}#EOL#AT021_DTLASTNENGETSU.value = lastYearMonth;#EOL#AT021_DTLASTNENGETSU.editable = false;#EOL##EOL#////////////////////////#EOL#// 現行メンバーフラグ //#EOL#////////////////////////#EOL#var today = session.getToday() + '';#EOL#var currentYearMonth = today.replace('-','').substring(0,6);#EOL#if (currentYearMonth >= AT021_DTSYOZOKUNENGETSU.value &amp;&amp; currentYearMonth &lt;= AT021_DTLASTNENGETSU.value) {#EOL#&#x9;AT021_KBPRESENT.value = 'T';#EOL#} else {#EOL#&#x9;AT021_KBPRESENT.value = 'F';#EOL#}"/></Table><Table ActiveWhere="" ID="AT030" Name="取引先" RangeKey="" Remarks="仕入先や顧客とみなされる取引先の情報を保持するためのテーブル" SubsystemID="A"><Field ID="NRTORIHIKISAKI" Name="取引先№" Nullable="F" Order="0010" Remarks="" Size="8" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKISAKI)"/><Field ID="TXKANA" Name="カナ名" Nullable="F" Order="0020" Remarks="" Size="40" Type="CHAR" TypeOptions="KATAKANA"/><Field ID="TXKANJI" Name="漢字名" Nullable="F" Order="0030" Remarks="" Size="40" Type="CHAR" TypeOptions="KANJI"/><Field ID="NRYUBIN" Name="郵便番号" Nullable="F" Order="0060" Remarks="" Size="8" Type="CHAR" TypeOptions="ZIPNO"/><Field ID="TXJYUSYO1" Name="住所１" Nullable="F" Order="0070" Remarks="" Size="30" Type="CHAR" TypeOptions="ZIPADRS"/><Field ID="TXJYUSYO2" Name="住所２" Nullable="T" Order="0080" Remarks="" Size="30" Type="CHAR" TypeOptions="KANJI"/><Field ID="NRDENWA" Name="電話番号" Nullable="F" Order="0090" Remarks="" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="NRFAX" Name="FAX番号" Nullable="F" Order="0100" Remarks="" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="TXURL" Name="サイトＵＲＬ" Nullable="T" Order="0110" Remarks="" Size="40" Type="CHAR" TypeOptions="URL"/><Field ID="FGKOKYAKU" Name="顧客対象" Nullable="T" Order="0120" Remarks="" Size="1" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBFLAG1)"/><Field ID="FGSIIRESAKI" Name="仕入先対象" Nullable="T" Order="0130" Remarks="" Size="1" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBFLAG1)"/><Key Fields="NRTORIHIKISAKI" Type="PK"/><Refer Fields="AMKISYUKAIKAKE;AMGENKAIKAKE;AMKEIJYOU;AMSIHARAI" Optional="T" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="CT010" WithKeyFields="AT030.NRTORIHIKISAKI"/><Refer Fields="AMKISYUURIKAKE;AMKAISYU;AMGENURIKAKE;AMKEIJYOU" Optional="T" Order="1" TableAlias="" ToKeyFields="" ToTable="DT010" WithKeyFields="AT030.NRTORIHIKISAKI"/><Script EventP="BR" EventR="" Name="顧客・仕入先対象区分の初期化" Order="0010" Text="AT030_FGKOKYAKU.value = 'F';#EOL#AT030_FGKOKYAKU.editable = false;#EOL##EOL#AT030_FGSIIRESAKI.value = 'F';#EOL#AT030_FGSIIRESAKI.editable = false;#EOL##EOL#AT030_KBNAIKA.value = '';#EOL#AT030_KBNAIKA.editable = false;#EOL##EOL#AT030_KBGAIKA.value = '';#EOL#AT030_KBGAIKA.editable = false;#EOL##EOL#CT010_AMGENKAIKAKE.value = '';#EOL#DT010_AMGENURIKAKE.value = '';#EOL#"/><Script EventP="BC;BU;BD;AR" EventR="AR(CT010)" Name="買掛残高と対象区分の設定" Order="0040" Text="CT010_AMGENKAIKAKE.value = Number(CT010_AMKISYUKAIKAKE.value) + Number(CT010_AMKEIJYOU.value) - CT010_AMSIHARAI.value;#EOL#AT030_FGSIIRESAKI.value = 'T';#EOL#AT030_KBGAIKA.value = AT030_KBCURRENCY.value;#EOL#"/><Script EventP="BC;BU;BD;AR" EventR="AR(DT010)" Name="売掛残高と対象区分の設定" Order="0050" Text="DT010_AMGENURIKAKE.value = Number(DT010_AMKISYUURIKAKE.value) + Number(DT010_AMKEIJYOU.value) - DT010_AMKAISYU.value;#EOL#AT030_FGKOKYAKU.value = 'T';#EOL#AT030_KBNAIKA.value = session.getSystemVariantString('SYSTEM_CURRENCY');"/><Key Fields="TXKANJI" Type="SK"/><Field ID="KBCOUNTRY" Name="国名" Nullable="F" Order="0050" Remarks="ＩＳＯの３桁コード(ISO 3166-1 alpha-3)。一旦設置したら変更不可" Size="3" Type="CHAR" TypeOptions="KUBUN(KBCOUNTRY)"/><Field ID="KBCURRENCY" Name="取引通貨" Nullable="F" Order="0051" Remarks="輸入取引用通貨。国内取引先であれば円。一旦設置したら変更不可" Size="3" Type="CHAR" TypeOptions="KUBUN(KBCURRENCY)"/><Field ID="KBNAIKA" Name="売掛取引通貨" Nullable="F" Order="0132" Remarks="当面は輸出取引は内貨の固定" Size="3" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBCURRENCY)"/><Field ID="KBGAIKA" Name="買掛取引通貨" Nullable="F" Order="0133" Remarks="" Size="3" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBCURRENCY)"/><Script EventP="BC;BU" EventR="BR()" Function="" Name="国と通貨区分の制約" Order="0020" Text="if (AT030_KBCOUNTRY.value == (session.getSystemVariantString('SYSTEM_COUNTRY') + '')) {#EOL#&#x9;AT030_KBCURRENCY.value = session.getSystemVariantString('SYSTEM_CURRENCY');#EOL#}"/><Script EventP="BU" EventR="BR()" Function="" Name="更新不可設定" Order="0030" Text="AT030_KBCOUNTRY.editable = false;#EOL#AT030_KBCURRENCY.editable = false;"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0060" Text="var rCT010 = instance.createTableOperator('Count', 'CT010');#EOL#rCT010.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rCT010.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の仕入先によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT011 = instance.createTableOperator('Count', 'CT011');#EOL#rCT011.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rCT011.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の仕入先別商品明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT100 = instance.createTableOperator('Count', 'CT100');#EOL#rCT100.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rCT100.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の買掛増減履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT110 = instance.createTableOperator('Count', 'CT110');#EOL#rCT110.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rCT110.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の支払依頼によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT010 = instance.createTableOperator('Count', 'DT010');#EOL#rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rDT010.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の顧客によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT011 = instance.createTableOperator('Count', 'DT011');#EOL#rDT011.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rDT011.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の出荷先によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT100 = instance.createTableOperator('Count', 'DT100');#EOL#rDT100.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rDT100.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の売掛増減履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT110 = instance.createTableOperator('Count', 'DT110');#EOL#rDT110.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rDT110.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の請求指示によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT120 = instance.createTableOperator('Count', 'DT120');#EOL#rDT120.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rDT120.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の受領明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET100 = instance.createTableOperator('Count', 'ET100');#EOL#rET100.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rET100.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の受払履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET200 = instance.createTableOperator('Count', 'ET200');#EOL#rET200.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rET200.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の受払予定によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT010 = instance.createTableOperator('Count', 'FT010');#EOL#rFT010.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rFT010.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の発注見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT020 = instance.createTableOperator('Count', 'FT020');#EOL#rFT020.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rFT020.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の入荷見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT010 = instance.createTableOperator('Count', 'GT010');#EOL#rGT010.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rGT010.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の受注見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT020 = instance.createTableOperator('Count', 'GT020');#EOL#rGT020.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rGT020.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の出荷見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT030 = instance.createTableOperator('Count', 'GT030');#EOL#rGT030.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rGT030.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の見積見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rHT010 = instance.createTableOperator('Count', 'HT010');#EOL#rHT010.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rHT010.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の仕入振替によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rHT020 = instance.createTableOperator('Count', 'HT020');#EOL#rHT020.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rHT020.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の特殊仕入によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rJT010 = instance.createTableOperator('Count', 'JT010');#EOL#rJT010.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rJT010.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の売上振替によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#rJT020.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rJT020.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の特殊売上によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT040 = instance.createTableOperator('Count', 'YT040');#EOL#rYT040.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rYT040.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の仕入先別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT041 = instance.createTableOperator('Count', 'YT041');#EOL#rYT041.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rYT041.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の仕入商品別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT050 = instance.createTableOperator('Count', 'YT050');#EOL#rYT050.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rYT050.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の顧客別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT051 = instance.createTableOperator('Count', 'YT051');#EOL#rYT051.addKeyValue('NRTORIHIKISAKI',&#x9;AT030_NRTORIHIKISAKI.value);#EOL#if (rYT051.execute() > 0) {#EOL#&#x9;AT030_NRTORIHIKISAKI.error = '既存の顧客商品別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="ZT070" Name="休日テーブル" RangeKey="" Remarks="公休日や会社の特別休日の情報を保持するためのテーブル。日付選択用カレンダーの休日表示設定や日程計算のために利用される。" SubsystemID="Z"><Field ID="DTOFF" Name="休日日付" Nullable="F" Order="0020" Size="10" Type="DATE" TypeOptions=""/><Field ID="TXOFF" Name="摘要" Nullable="T" Order="0030" Size="20" Type="CHAR" TypeOptions="KANJI"/><Key Fields="KBCALENDAR;DTOFF" Type="PK"/><Field ID="KBCALENDAR" Name="カレンダー区分" Nullable="F" Order="0010" Size="2" Type="CHAR" TypeOptions="KUBUN(KBCALENDAR)"/></Table><Table ActiveWhere="" ID="BT031" Name="倉庫ロケ" RangeKey="" Remarks="倉庫別のロケ一覧を保持するためのテーブル" SubsystemID="B"><Field ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0" Size="5" Type="CHAR" TypeOptions=""/><Field ID="NRLOCATION" Name="ロケ№" Nullable="F" Order="1" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXTEKIYO" Name="摘要" Nullable="T" Order="2" Size="20" Type="CHAR" TypeOptions="KANJI"/><Key Fields="NRSOUKO;NRLOCATION" Type="PK"/><Refer Fields="TXSOUKO" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="BT030" WithKeyFields="BT031.NRSOUKO"/><Key Fields="NRSOUKO" Type="XK"/><Script EventP="BC" EventR="BR()" Function="" Name="登録時設定" Order="0000" Text="BT031_NRSOUKO.editable = false;"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0010" Text="var rET010 = instance.createTableOperator('Count', 'ET010');#EOL#rET010.addKeyValue('NRSOUKO',&#x9;BT031_NRSOUKO.value);#EOL#rET010.addKeyValue('NRLOCATION',&#x9;BT031_NRLOCATION.value);#EOL#if (rET010.execute() > 0) {#EOL#&#x9;BT031_NRSOUKO.error = '既存の倉庫在庫によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT010 = instance.createTableOperator('Select', 'KT010');#EOL#rKT010.addKeyValue('NRSOUKO',&#x9;BT031_NRSOUKO.value);#EOL#while (rKT010.next()) {#EOL#&#x9;var rKT011 = instance.createTableOperator('Count', 'KT011');#EOL#&#x9;rKT011.addKeyValue('NRTANAOROSHI',&#x9;rKT010.getValueOf('NRTANAOROSHI'));#EOL#&#x9;rKT011.addKeyValue('NRLOCATION',&#x9;BT031_NRLOCATION.value);#EOL#&#x9;if (rKT011.execute() > 0) {#EOL#&#x9;&#x9;BT031_NRSOUKO.error = '既存の棚卸指示明細によって参照されているため、このレコードは削除できません。';#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL##EOL#var rKT020 = instance.createTableOperator('Select', 'KT020');#EOL#rKT020.addKeyValue('NRSOUKOTO',&#x9;BT031_NRSOUKO.value);#EOL#while (rKT020.next()) {#EOL#&#x9;var rKT021 = instance.createTableOperator('Count', 'KT021');#EOL#&#x9;rKT021.addKeyValue('NRZAIKOIDOU',&#x9;rKT010.getValueOf('NRZAIKOIDOU'));#EOL#&#x9;rKT021.addKeyValue('NRLOCATIONTO',&#x9;BT031_NRLOCATION.value);#EOL#&#x9;if (rKT021.execute() > 0) {#EOL#&#x9;&#x9;BT031_NRSOUKO.error = '既存の在庫移動指示明細によって参照されているため、このレコードは削除できません。';#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL##EOL#var rKT030 = instance.createTableOperator('Count', 'KT030');#EOL#rKT030.addKeyValue('NRSOUKO',&#x9;BT031_NRSOUKO.value);#EOL#rKT030.addKeyValue('NRLOCATION',&#x9;BT031_NRLOCATION.value);#EOL#if (rKT030.execute() > 0) {#EOL#&#x9;BT031_NRSOUKO.error = '既存の在庫振替によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rLT010 = instance.createTableOperator('Count', 'LT010');#EOL#rLT010.addKeyValue('NRSOUKO',&#x9;BT031_NRSOUKO.value);#EOL#rLT010.addKeyValue('NRLOCATION',&#x9;BT031_NRLOCATION.value);#EOL#if (rLT010.execute() > 0) {#EOL#&#x9;BT031_NRSOUKO.error = '既存のセット指示によって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="ZT040" Name="ユーザ定義区分" RangeKey="" Remarks="キー値と摘要の組み合わせで定義できる区分情報を保持するためのテーブル" SubsystemID="Z"><Field ID="IDUSERKUBUN" Name="区分ＩＤ" Nullable="F" Order="0" Size="20" Type="CHAR" TypeOptions=""/><Field ID="KBUSERKUBUN" Name="区分値" Nullable="F" Order="1" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXUSERKUBUN" Name="区分値摘要" Nullable="F" Order="2" Size="20" Type="CHAR" TypeOptions="KANJI"/><Field ID="SQLIST" Name="一覧順序" Nullable="F" Order="3" Size="2" Type="CHAR" TypeOptions=""/><Key Fields="IDUSERKUBUN;KBUSERKUBUN" Type="PK"/></Table><Table ActiveWhere="" ID="CT011" Name="仕入先別商品明細" RangeKey="" Remarks="仕入先毎の扱い商品情報を保持するためのテーブル" SubsystemID="C"><Field ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0020" Size="8" Type="CHAR" TypeOptions=""/><Field ID="DTHAKKOU" Name="発効日" Nullable="F" Order="0030" Size="10" Type="DATE" TypeOptions=""/><Field ID="DTSIKKOU" Name="失効日" Nullable="F" Order="0040" Size="10" Type="DATE" TypeOptions=""/><Field ID="QTSIIRETANNI" Name="仕入単位数" Nullable="F" Order="0060" Remarks="仕入先の出荷単位数のこと" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="2" ID="PRSIIRETANKA" Name="契約仕入単価" Nullable="F" Order="0080" Size="10" Type="DECIMAL" TypeOptions=""/><Field ID="VLKANZANKEISU" Name="単位換算係数" Nullable="F" Order="0070" Remarks="仕入数×単位換算係数＝「在庫単位」での仕入数" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="VLLEADTIME" Name="標準発注ＬＴ" Nullable="T" Order="0090" Size="4" Type="SMALLINT" TypeOptions=""/><Key Fields="NRSYOHIN;NRTORIHIKISAKI;DTHAKKOU" Type="PK"/><Refer Fields="TXKANJI;TXKANA;KBCURRENCY" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="CT011.NRTORIHIKISAKI"/><Refer Fields="NRTORIHIKISAKI" Order="1" TableAlias="" ToKeyFields="" ToTable="CT010" WithKeyFields="CT011.NRTORIHIKISAKI"/><Refer Fields="TXHINBAN;TXSYOHIN;KBZAIKOUM;TXIMAGEFILENAME" Order="2" TableAlias="" ToKeyFields="" ToTable="BT020" WithKeyFields="CT011.NRSYOHIN"/><Key Fields="NRTORIHIKISAKI" Type="XK"/><Key Fields="NRSYOHIN" Type="XK"/><Field ID="KBSIIREUM" Name="仕入単位区分" Nullable="F" Order="0051" Size="5" Type="CHAR" TypeOptions="KUBUN(KBZAIKOUM)"/><Script EventP="BC" EventR="BR()" Function="" Name="追加時初期設定" Order="0000" Text="if (instance.parmMap.get('NRTORIHIKISAKI') != null) {#EOL#&#x9;CT011_NRTORIHIKISAKI.editable = false;#EOL#}#EOL#if (CT011_VLKANZANKEISU.value == 0) {#EOL#&#x9;CT011_VLKANZANKEISU.value = 1;#EOL#}#EOL#if (CT011_QTSIIRETANNI.value == 0) {#EOL#&#x9;CT011_QTSIIRETANNI.value = 1;#EOL#}"/></Table><Table ActiveWhere="" ID="DT020" Name="掛率ランク" RangeKey="" Remarks="顧客毎に指定される掛率（値引率）のランク情報を保持するためのテーブル" SubsystemID="D"><Field ID="CDKAKERITSURANK" Name="掛率ランクＣ" Nullable="F" Order="00" Size="2" Type="CHAR" TypeOptions=""/><Field ID="TXKAKERITSURANK" Name="ランク記述" Nullable="F" Order="01" Size="20" Type="CHAR" TypeOptions="KANJI"/><Field Decimal="2" ID="VLKAKERITSU" Name="掛率" Nullable="F" Order="02" Size="3" Type="NUMERIC" TypeOptions=""/><Key Fields="CDKAKERITSURANK" Type="PK"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0000" Text="var rDT010 = instance.createTableOperator('Count', 'DT010');#EOL#rDT010.addKeyValue('CDKAKERITSURANK',&#x9;DT020_CDKAKERITSURANK.value);#EOL#if (rDT010.execute() > 0) {#EOL#&#x9;DT020_CDKAKERITSURANK.error = '既存の顧客によって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="ZT020" Name="ユーザ定義" RangeKey="" Remarks="ユーザ定義を保持するためのテーブル。ユーザは必ずしも従業員と関連されている必要はない。" SubsystemID="Z"><Field ID="IDUSER" Name="ユーザＩＤ" Nullable="F" Order="0010" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXPASSWORD" Name="パスワード" Nullable="F" Order="0030" Remarks="ユーザの指定値が、システム定義の「ハッシュ方式」にもとづいて異化されたうえで保管される" Size="50" Type="CHAR" TypeOptions=""/><Field ID="DTVALID" Name="発効日" Nullable="F" Order="0040" Size="10" Type="DATE" TypeOptions=""/><Field ID="DTEXPIRE" Name="失効日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Field ID="TXMENUS" Name="利用可能メニュー" Nullable="F" Order="0070" Size="30" Type="CHAR" TypeOptions=""/><Key Fields="IDUSER" Type="PK"/><Script EventP="BC;BU" EventR="BR()" Name="追加更新時の妥当性検査" Order="0" Text="if (ZT020_DTEXPIRE.value != '' &amp;&amp; ZT020_DTEXPIRE.value &lt;=  ZT020_DTVALID.value) {#EOL#&#x9;ZT020_DTEXPIRE.error = '発効日より未来に設定してください。'#EOL#}#EOL#if (ZT020_IDUSER.value.match(/[^A-Za-z0-9]+/)) {#EOL#&#x9;ZT020_IDUSER.error = '半角英数字のみを入力してください。'#EOL#}#EOL#"/><Field ID="NREMPLOYEE" Name="従業員№" Nullable="T" Order="0080" Size="5" Type="CHAR" TypeOptions=""/><Refer Fields="" Order="0010" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="ZT020.NREMPLOYEE"/><Field ID="TXNAME" Name="ユーザ名" Nullable="F" Order="0020" Size="30" Type="CHAR" TypeOptions="KANJI"/><Script EventP="BC;BU" EventR="BR()" Function="" Name="パスワードの初期化" Order="0010" Text="if (ZT020_TXPASSWORD.value == '') {#EOL#&#x9;ZT020_TXPASSWORD.value = 'f1b708bba17f1ce948dc979f4d7092bc' //&quot;0000000000&quot;のハッシュコード値//#EOL#}"/><Field ID="TXEMAIL" Name="メールアドレス" Nullable="T" Order="0060" Size="40" Type="CHAR" TypeOptions=""/></Table><Table ActiveWhere="" ID="ZT051" Name="セッション明細" RangeKey="" Remarks="セッション毎の機能の利用履歴を保持するためのテーブル" SubsystemID="Z"><Field ID="NRSESSION" Name="セッション№" Nullable="F" Order="0" Size="7" Type="CHAR" TypeOptions=""/><Field ID="SQPROGRAM" Name="行番" Nullable="F" Order="1" Size="4" Type="SMALLINT" TypeOptions=""/><Field ID="IDMENU" Name="メニューID" Nullable="F" Order="2" Size="2" Type="CHAR" TypeOptions=""/><Field ID="IDPROGRAM" Name="プログラムID" Nullable="F" Order="3" Size="10" Type="CHAR" TypeOptions=""/><Field ID="TXPROGRAM" Name="プログラム名" Nullable="F" Order="4" Size="30" Type="CHAR" TypeOptions=""/><Field ID="DTSTART" Name="利用開始日時" Nullable="F" Order="5" Size="23" Type="DATETIME" TypeOptions=""/><Field ID="DTEND" Name="利用終了日時" Nullable="T" Order="6" Remarks="" Size="23" Type="DATETIME" TypeOptions=""/><Field ID="KBPROGRAMSTATUS" Name="終了状態" Nullable="T" Order="7" Size="2" Type="CHAR" TypeOptions=""/><Field ID="TXERRORLOG" Name="処理ログ" Nullable="T" Order="8" Size="0" Type="LONG VARCHAR" TypeOptions=""/><Key Fields="NRSESSION;SQPROGRAM" Type="PK"/><Refer Fields="IDUSER" Order="0" TableAlias="" ToKeyFields="" ToTable="ZT050" WithKeyFields="ZT051.NRSESSION"/><Refer Fields="TXNAME" Order="1" TableAlias="" ToKeyFields="" ToTable="ZT020" WithKeyFields="ZT050.IDUSER"/><Script EventP="BC;BU;BD;AR" EventR="AR()" Name="終了状態にもとづく配色設定" Order="0" Text="if (ZT051_KBPROGRAMSTATUS.value == '99') {#EOL#&#x9;ZT051_KBPROGRAMSTATUS.color = 'red';#EOL#}"/></Table><Table ActiveWhere="" ID="ET100" Name="受払履歴" RangeKey="" Remarks="受払実績情報を保持するためのテーブル。在庫残高が増減するたびにテーブルスクリプトによって追加される。いずれのフィールド値についても、ユーザがパネルから直接編集することはない。" SubsystemID="E"><Field ID="NRUKEBARAI" Name="受払№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRUKEBARAI)"/><Field ID="KBAKADEN" Name="赤黒" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBAKADEN)"/><Field ID="KBUKEBARAI" Name="受払区分" Nullable="F" Order="0040" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBUKEBARAI)"/><Field ID="DTUKEBARAI" Name="受払日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Field ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0060" Size="5" Type="CHAR" TypeOptions=""/><Field ID="NRLOCATION" Name="入庫ロケ№" Nullable="F" Order="0070" Remarks="入庫時のロケ。出庫時はブランク" Size="5" Type="CHAR" TypeOptions=""/><Field ID="NRIDOUSOUKO" Name="移動倉庫№" Nullable="T" Order="0080" Size="5" Type="CHAR" TypeOptions=""/><Field ID="NRTORIHIKISAKI" Name="取引先№" Nullable="T" Order="0090" Size="8" Type="CHAR" TypeOptions=""/><Field ID="SQSYUKKASAKI" Name="出荷先行番" Nullable="T" Order="0100" Size="3" Type="SMALLINT" TypeOptions=""/><Field ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0110" Size="7" Type="CHAR" TypeOptions=""/><Field ID="QTUKEBARAI" Name="受払数量" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0180" Size="7" Type="CHAR" TypeOptions=""/><Field ID="DTCREATE" Name="実績追加日時" Nullable="F" Order="0190" Size="26" Type="TIMESTAMP" TypeOptions=""/><Field ID="TXAITESAKI" Name="相手先名" Nullable="T" Order="0220" Size="40" Type="CHAR" TypeOptions="VIRTUAL,KANJI"/><Key Fields="NRUKEBARAI" Type="PK"/><Refer Fields="TXSOUKO" Order="0010" OrderBy="" TableAlias="BT030A" ToKeyFields="" ToTable="BT030" WithKeyFields="ET100.NRSOUKO"/><Refer Fields="TXHINBAN;TXSYOHIN;KBZAIKOUM" Order="0020" TableAlias="" ToKeyFields="" ToTable="BT020" WithKeyFields="ET100.NRSYOHIN"/><Refer Fields="TXSOUKO" Order="0030" TableAlias="BT030B" ToKeyFields="" ToTable="BT030" WithKeyFields="ET100.NRIDOUSOUKO"/><Refer Fields="TXKANJI" Order="0040" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="ET100.NRTORIHIKISAKI"/><Script EventP="AR" EventR="AR()" Name="「相手先名」の設定" Order="0010" Text="if (AT030_TXKANJI.value != '') {#EOL#&#x9;ET100_TXAITESAKI.value = AT030_TXKANJI.value;#EOL#}#EOL#if (BT030B_TXSOUKO.value != '') {#EOL#&#x9;ET100_TXAITESAKI.value = BT030B_TXSOUKO.value;#EOL#}"/><Field ID="DTNEND" Name="年度" Nullable="F" Order="0200" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0210" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field ID="FGVALID" Name="効区" Nullable="F" Order="0030" Remarks="有効区分。赤黒処理分は無効化される。" Size="1" Type="CHAR" TypeOptions="KUBUN(FGVALID)"/><Field ID="AMUKEBARAI" Name="受払金額" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMSAGAKU" Name="取引差額" Nullable="T" Order="0141" Remarks="受払区分毎に以下のように設定される（これらの区分以外ではゼロに設定される）。#EOL#10（発注入荷）：関税と諸掛の合算。これと税抜仕入額の合算が入庫額となる#EOL#11（直入荷）：関税と諸掛の合算。これと税抜仕入額の合算が入庫額となる#EOL#12（仕入返品）：出庫額から税抜返品額を差し引いた値#EOL#20（受注出荷）：税抜売上額から出庫額を差し引いた値。粗利#EOL#21（直出荷）：税抜売上額から出庫額を差し引いた値。粗利#EOL#22（売上返品）：入庫額から税抜返品額を差し引いた値。ふつうはマイナス値" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="NRTORIHIKIKANRI;NRUKEBARAI" Type="XK"/><Key Fields="DTCREATE" Type="XK"/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="F" Order="0121" Remarks="" Size="40" Type="CHAR" TypeOptions=""/></Table><Table ActiveWhere="" ID="CT100" Name="買掛増減履歴" RangeKey="" Remarks="仕入実績情報を保持するためのテーブル。買掛残高が増減するたびにテーブルスクリプトによって追加される。いずれのフィールド値についても、ユーザがパネルから直接編集することはない。" SubsystemID="C"><Field ID="NRSIIRE" Name="買掛増減№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSIIRE)"/><Field ID="KBAKADEN" Name="赤黒" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBAKADEN)"/><Field ID="KBSIIRE" Name="仕入区分" Nullable="F" Order="0040" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBSIIRE)"/><Field ID="DTSIIRE" Name="仕入日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Field ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0060" Size="8" Type="CHAR" TypeOptions=""/><Field ID="NRSYOHIN" Name="仕入商品№" Nullable="T" Order="0070" Size="7" Type="CHAR" TypeOptions=""/><Field ID="QTSIIRE" Name="仕入数量" Nullable="T" Order="0110" Size="9" Type="INTEGER" TypeOptions="ACCEPT_MINUS"/><Field ID="AMTAX" Name="消費税額" Nullable="T" Order="0140" Remarks="国内仕入の場合に設定される" Size="9" Type="INTEGER" TypeOptions="ACCEPT_MINUS"/><Field ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0150" Size="7" Type="CHAR" TypeOptions=""/><Field ID="DTCREATE" Name="実績追加日時" Nullable="F" Order="0170" Size="23" Type="TIMESTAMP" TypeOptions=""/><Key Fields="NRSIIRE" Type="PK"/><Refer Fields="TXKANJI;KBCOUNTRY" Order="0010" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="CT100.NRTORIHIKISAKI"/><Refer Fields="TXHINBAN" Order="0020" TableAlias="" ToKeyFields="" ToTable="BT020" WithKeyFields="CT100.NRSYOHIN"/><Key Fields="NRTORIHIKISAKI" Type="XK"/><Field ID="DTNEND" Name="年度" Nullable="F" Order="0180" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0190" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field Decimal="" ID="NRSIHARAIIRAI" Name="支払依頼№" Nullable="T" Order="0160" Size="7" Type="CHAR" TypeOptions=""/><Key Fields="NRSIHARAIIRAI" Type="XK"/><Refer Fields="FGSYOUNIN;NRSIHARAIIRAI;NRSIHARAI" Order="0040" OrderBy="" TableAlias="" ToKeyFields="NRSIHARAIIRAI" ToTable="CT110" WithKeyFields="CT100.NRSIHARAIIRAI"/><Script EventP="BU" EventR="AR()" Function="" Name="支払依頼額合算(CF111B)" Order="0040" Text="if (instance.functionID == 'CF111B') {#EOL#&#x9;CT110_AMSIIREWORK.value = Number(CT110_AMSIIREWORK.value) + Number(CT100_AMSIIRE.value);#EOL#&#x9;CT110_AMTAXWORK.value = Number(CT110_AMTAXWORK.value) + Number(CT100_AMTAX.value);#EOL#}"/><Field ID="FGVALID" Name="効区" Nullable="F" Order="0030" Remarks="有効区分。赤黒処理分は無効化される。支払締め処理の対象となることも示す。" Size="1" Type="CHAR" TypeOptions="KUBUN(FGVALID)"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="支払依頼取消設定(CF113)" Order="0010" Text="if (instance.functionID == 'CF113') {#EOL#&#x9;if (CT100_NRSIHARAIIRAI.value != '') {#EOL#&#x9;&#x9;CT100_NRSIHARAIIRAIWORK.value = CT100_NRSIHARAIIRAI.value;#EOL#&#x9;}#EOL#&#x9;if (CT100_NRSIHARAIIRAI.oldValue == '') {#EOL#&#x9;&#x9;CT100_NRSIHARAIIRAI.error = '支払依頼されていないので、支払依頼を取り消すことができません。';#EOL#&#x9;} else {#EOL#&#x9;&#x9;if (CT110_NRSIHARAI.value == '') {#EOL#&#x9;&#x9;&#x9;CT100_NRSIHARAIIRAI.value = '';#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;CT100_NRSIHARAIIRAI.error = 'すでに経理処理にまわっているため、支払依頼を取り消すことができません。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}"/><Field ID="KBSIIREUM" Name="仕入単位区分" Nullable="F" Order="0120" Size="5" Type="CHAR" TypeOptions="KUBUN(KBZAIKOUM)"/><Field Decimal="2" ID="AMSIIRE" Name="税抜仕入額" Nullable="F" Order="0130" Remarks="取引通貨建の仕入額" Size="11" Type="DECIMAL" TypeOptions="ACCEPT_MINUS"/><Field Decimal="2" ID="PRSIIRE" Name="仕入単価" Nullable="T" Order="0090" Size="10" Type="DECIMAL" TypeOptions="ACCEPT_MINUS"/><Key Fields="NRTORIHIKIKANRI;NRSIIRE" Type="XK"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="変更不可設定" Order="0020" Text="CT100_NRSIIRE.editable = false;#EOL#CT100_KBAKADEN.editable = false;#EOL#CT100_FGVALID.editable = false;#EOL#CT100_KBSIIRE.editable = false;#EOL#CT100_DTSIIRE.editable = false;#EOL#CT100_NRTORIHIKISAKI.editable = false;#EOL#CT100_NRSYOHIN.editable = false;#EOL#CT100_TXSYOHIN.editable = false;#EOL#CT100_PRSIIRE.editable = false;#EOL#CT100_KBCURRENCY.editable = false; #EOL#CT100_QTSIIRE.editable = false;#EOL#CT100_KBSIIREUM.editable = false;#EOL#CT100_AMSIIRE.editable = false;#EOL#CT100_AMTAX.editable = false;#EOL#CT100_NRTORIHIKIKANRI.editable = false;#EOL#CT100_NRSIHARAIIRAI.editable = false;#EOL#CT100_NRSIHARAIIRAIWORK.editable = false;#EOL#CT100_DTCREATE.editable = false;#EOL#CT100_DTNEND.editable = false;#EOL#CT100_DTMSEQ.editable = false;#EOL#CT100_AMSIIRENAIKA.editable = false;#EOL#"/><Field Decimal="" ID="NRSIHARAIIRAIWORK" Name="支払依頼№表示用ワーク" Nullable="T" Order="0200" Size="7" Type="CHAR" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMSIIRENAIKA" Name="内貨税抜仕入額" Nullable="F" Order="0210" Remarks="内貨仕入単価に仕入数量を掛け合わせた値。内貨仕入単価が、計上時における年次ＴＴＳレートにもとづく不正確な値である点に注意。" Size="9" Type="INTEGER" TypeOptions="VIRTUAL,ACCEPT_MINUS"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="仮想フィールドの設定" Order="0030" Text="//////////////////////#EOL#// 内貨仕入額の設定 //#EOL#//////////////////////#EOL#var rtRate = session.getMonthlyExchangeRate(CT100_KBCURRENCY.value, CT100_DTSIIRE.value, 'TTS');#EOL#CT100_AMSIIRENAIKA.value = Math.round(CT100_AMSIIRE.value * rtRate);#EOL#"/><Field ID="KBCURRENCY" Name="通貨" Nullable="F" Order="0100" Size="3" Type="CHAR" TypeOptions="KUBUN(KBCURRENCY)"/><Key Fields="DTCREATE" Type="XK"/><Field ID="TXSYOHIN" Name="商品名／摘要" Nullable="T" Order="0080" Remarks="振替取引では振替摘要が設定される" Size="30" Type="CHAR" TypeOptions="KANJI"/></Table><Table ActiveWhere="" ID="ZT060" Name="消費税率" RangeKey="" Remarks="開始日別の消費税率を保持するためのテーブル" SubsystemID="Z"><Script EventP="BC;BU" EventR="BR()" Name="消費税率のエラー検査" Order="0" Text="if (ZT060_VLTAXRATE.value >= 1.00) {#EOL#&#x9;ZT060_VLTAXRATE.error = '1.00より小さい値を設定してください。'#EOL#}"/><Field ID="DTSTART" Name="開始日" Nullable="F" Order="0" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="2" ID="VLTAXRATE" Name="税率" Nullable="F" Order="1" Size="3" Type="NUMERIC" TypeOptions=""/><Key Fields="DTSTART" Type="PK"/></Table><Table ActiveWhere="" ID="BT030" Name="倉庫" RangeKey="" Remarks="倉庫情報を保持するためのテーブル" SubsystemID="B"><Field ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0010" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXSOUKO" Name="倉庫名" Nullable="F" Order="0020" Size="20" Type="CHAR" TypeOptions="KANJI"/><Field ID="NRYUBIN" Name="郵便番号" Nullable="F" Order="0040" Size="8" Type="CHAR" TypeOptions="ZIPNO"/><Field ID="TXJYUSYO" Name="住所" Nullable="F" Order="0050" Size="40" Type="CHAR" TypeOptions="ZIPADRS"/><Field ID="NRDENWA" Name="電話番号" Nullable="F" Order="0060" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="NRFAX" Name="FAX番号" Nullable="F" Order="0070" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="NRDEFAULTLOCATION" Name="ロケ初期値" Nullable="T" Order="0080" Size="5" Type="CHAR" TypeOptions=""/><Key Fields="NRSOUKO" Type="PK"/><Field ID="TXSOUKOENG" Name="倉庫名(英文)" Nullable="T" Order="0030" Size="30" Type="CHAR" TypeOptions=""/><Field ID="TXJYUSYOENG" Name="住所(英文)" Nullable="T" Order="0051" Size="40" Type="CHAR" TypeOptions=""/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0000" Text="var rBT031 = instance.createTableOperator('Count', 'BT031');#EOL#rBT031.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rBT031.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の倉庫ロケによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET010 = instance.createTableOperator('Count', 'ET010');#EOL#rET010.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rET010.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の倉庫在庫によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET100 = instance.createTableOperator('Count', 'ET100');#EOL#rET100.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rET100.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の受払履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET100 = instance.createTableOperator('Count', 'ET100');#EOL#rET100.addKeyValue('NRIDOUSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rET100.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の受払履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET200 = instance.createTableOperator('Count', 'ET200');#EOL#rET200.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rET200.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の受払予定によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET200 = instance.createTableOperator('Count', 'ET200');#EOL#rET200.addKeyValue('NRIDOUSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rET200.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の受払予定によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT010 = instance.createTableOperator('Count', 'FT010');#EOL#rFT010.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rFT010.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の発注見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT020 = instance.createTableOperator('Count', 'FT020');#EOL#rFT020.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rFT020.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の入荷見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT010 = instance.createTableOperator('Count', 'GT010');#EOL#rGT010.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rGT010.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の受注見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT012 = instance.createTableOperator('Count', 'GT012');#EOL#rGT012.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rGT012.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の出荷明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT020 = instance.createTableOperator('Count', 'GT020');#EOL#rGT020.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rGT020.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の出荷見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rHT020 = instance.createTableOperator('Count', 'HT020');#EOL#rHT020.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rHT020.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の特殊仕入によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#rJT020.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rJT020.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の特殊売上によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT010 = instance.createTableOperator('Count', 'KT010');#EOL#rKT010.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rKT010.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の棚卸指示によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT020 = instance.createTableOperator('Count', 'KT020');#EOL#rKT020.addKeyValue('NRSOUKOFROM',&#x9;BT030_NRSOUKO.value);#EOL#if (rKT020.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の在庫移動指示によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT020 = instance.createTableOperator('Count', 'KT020');#EOL#rKT020.addKeyValue('NRSOUKOTO',&#x9;BT030_NRSOUKO.value);#EOL#if (rKT020.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の在庫移動指示によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT030 = instance.createTableOperator('Count', 'KT030');#EOL#rKT030.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rKT030.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の在庫振替によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rLT010 = instance.createTableOperator('Count', 'LT010');#EOL#rLT010.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rLT010.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存のセット指示によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT031 = instance.createTableOperator('Count', 'YT031');#EOL#rYT031.addKeyValue('NRSOUKO',&#x9;BT030_NRSOUKO.value);#EOL#if (rYT031.execute() > 0) {#EOL#&#x9;BT030_NRSOUKO.error = '既存の商品倉庫別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="DT100" Name="売掛増減履歴" RangeKey="" Remarks="売上実績情報を保持するためのテーブル。売掛残高が増減するたびにテーブルスクリプトによって追加される。いずれのフィールド値についても、ユーザがパネルから直接編集することはない。" SubsystemID="D"><Field ID="NRURIAGE" Name="売掛増減№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRURIAGE)"/><Field ID="KBAKADEN" Name="赤黒" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBAKADEN)"/><Field ID="KBURIAGE" Name="売上区分" Nullable="F" Order="0040" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBURIAGE)"/><Field ID="DTURIAGE" Name="売上日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Field ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0060" Size="8" Type="CHAR" TypeOptions=""/><Field ID="NRSYOHIN" Name="売上商品№" Nullable="T" Order="0070" Size="7" Type="CHAR" TypeOptions=""/><Field ID="PRURIAGE" Name="売上単価" Nullable="T" Order="0100" Remarks="標準単価との差にもとづく金額が値引額とみなされる。" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="QTURIAGE" Name="売上数量" Nullable="T" Order="0110" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMURIAGE" Name="税抜売上額" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMTAX" Name="税額" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="NRSEIKYU" Name="請求№" Nullable="T" Order="0160" Size="7" Type="CHAR" TypeOptions=""/><Field ID="NRJYUGYOIN" Name="担当営業№" Nullable="T" Order="0170" Size="5" Type="CHAR" TypeOptions=""/><Field ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0180" Size="7" Type="CHAR" TypeOptions=""/><Field ID="DTCREATE" Name="実績追加日時" Nullable="F" Order="0190" Size="26" Type="TIMESTAMP" TypeOptions=""/><Key Fields="NRURIAGE" Keys="" Type="PK"/><Refer Fields="TXKANJI" Order="0010" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="DT100.NRTORIHIKISAKI"/><Refer Fields="TXHINBAN" Order="0030" TableAlias="" ToKeyFields="" ToTable="BT020" WithKeyFields="DT100.NRSYOHIN"/><Refer Fields="TXKANJI" Order="0050" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT020" WithKeyFields="DT100.NRJYUGYOIN"/><Key Fields="NRTORIHIKISAKI" Type="XK"/><Field ID="DTNEND" Name="年度" Nullable="F" Order="0200" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0210" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field ID="FGVALID" Name="効区" Nullable="F" Order="0030" Remarks="有効区分。赤黒処理分は無効化される。請求締め処理の対象となることも示す。" Size="1" Type="CHAR" TypeOptions="KUBUN(FGVALID)"/><Field ID="KBURIAGEUM" Name="売上単位区分" Nullable="F" Order="0120" Size="5" Type="CHAR" TypeOptions="KUBUN(KBZAIKOUM)"/><Refer Fields="DTSEIKYU;NRSEIKYU;AMSEIKYU" Order="0060" TableAlias="DT100DT110" ToKeyFields="NRSEIKYU" ToTable="DT110" WithKeyFields="DT100.NRSEIKYU"/><Field ID="PRHANBAI" Name="標準販売価格" Nullable="T" Order="0090" Remarks="売上計上時に商品マスターからコピーされる。これと売上単価との差にもとづく金額が値引額とみなされる。" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMNEBIKI" Name="値引額" Nullable="F" Order="0220" Remarks="(標準販売価格－売上単価) × 売上数量" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールドの設定" Order="0010" Text="//////////////////#EOL#// 値引額の設定 //#EOL#//////////////////#EOL#if (DT100_KBURIAGE.value == '00' || DT100_KBURIAGE.value == '01') {#EOL#&#x9;if (DT100_FGVALID.value == 'T') {#EOL#&#x9;&#x9;DT100_AMNEBIKI.value = (DT100_PRHANBAI.value - DT100_PRURIAGE.value) * DT100_QTURIAGE.value;#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////#EOL#// 粗利額の設定 //#EOL#//////////////////#EOL#DT100_AMARARI.value = (DT100_PRURIAGE.value * DT100_QTURIAGE.value) - DT100_AMGENKA.value;#EOL#"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="請求取消前設定(DF113)" Order="0030" Text="if (instance.functionID == 'DF113') {#EOL#&#x9;if (DT100_NRSEIKYU.value != '') {#EOL#&#x9;&#x9;DT100_NRSEIKYUWORK.value = DT100_NRSEIKYU.value;#EOL#&#x9;}#EOL#&#x9;if (DT100_NRSEIKYU.oldValue == '') {#EOL#&#x9;&#x9;DT100_NRSEIKYU.error = '請求指示されていないので、請求指示を取り消すことができません。';#EOL#&#x9;} else {#EOL#&#x9;&#x9;DT100_NRSEIKYU.value = '';#EOL#&#x9;}#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="請求取消後処理(DF113)" Order="0040" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT110; var uDT110;#EOL#var amSeikyuUpdated = 0; var errorMessage = ''; var count = 0;#EOL##EOL#/////////////////////////////////////////////////////////#EOL#// 請求取消にともなう請求見出し(DT110)上の請求額の更新 //#EOL#/////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'DF113' &amp;&amp; DT100_KBURIAGE.value != '90') {#EOL#&#x9;rDT110 = instance.createTableOperator('Select', 'DT110');#EOL#&#x9;rDT110.setSelectFields('AMSEIKYU, UPDCOUNTER');#EOL#&#x9;rDT110.addKeyValue('NRSEIKYU',&#x9;DT100_NRSEIKYU.oldValue);#EOL#&#x9;if (rDT110.next()) {#EOL#&#x9;&#x9;amSeikyuUpdated = rDT110.getValueOf('AMSEIKYU') - DT100_AMURIAGE.value - DT100_AMTAX.value;#EOL#&#x9;&#x9;uDT110 = instance.createTableOperator('Update', 'DT110');#EOL#&#x9;&#x9;uDT110.addValue('AMSEIKYU',&#x9;&#x9;amSeikyuUpdated);#EOL#&#x9;&#x9;uDT110.addValue('UPDCOUNTER',&#x9;Number(rDT110.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT110.addKeyValue('NRSEIKYU',&#x9;&#x9;DT100_NRSEIKYU.oldValue);#EOL#&#x9;&#x9;uDT110.addKeyValue('UPDCOUNTER',&#x9;rDT110.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT110.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '請求見出し(DT110)の更新に失敗しました。';#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '対応する請求見出し(DT110)が見つかりません。更新に失敗しました。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Key Fields="NRTORIHIKIKANRI;NRURIAGE" Type="XK"/><Field ID="AMGENKA" Name="売上原価" Nullable="T" Order="0150" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMARARI" Name="粗利額" Nullable="F" Order="0230" Remarks="(売上単価 × 売上数量) － 売上原価" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="変更不可設定" Order="0020" Text="DT100_NRURIAGE.editable = false;#EOL#DT100_KBAKADEN.editable = false;#EOL#DT100_FGVALID.editable = false;#EOL#DT100_KBURIAGE.editable = false;#EOL#DT100_DTURIAGE.editable = false;#EOL#DT100_NRTORIHIKISAKI.editable = false;#EOL#DT100_NRSYOHIN.editable = false;#EOL#DT100_TXSYOHIN.editable = false;#EOL#DT100_PRHANBAI.editable = false;#EOL#DT100_PRURIAGE.editable = false;#EOL#DT100_QTURIAGE.editable = false;#EOL#DT100_KBURIAGEUM.editable = false;#EOL#DT100_AMURIAGE.editable = false;#EOL#DT100_AMTAX.editable = false;#EOL#DT100_AMGENKA.editable = false;#EOL#DT100_NRSEIKYU.editable = false;#EOL#DT100_NRSEIKYUWORK.editable = false;#EOL#DT100_NRJYUGYOIN.editable = false;#EOL#DT100_NRTORIHIKIKANRI.editable = false;#EOL#DT100_DTCREATE.editable = false;#EOL#DT100_DTNEND.editable = false;#EOL#DT100_DTMSEQ.editable = false;#EOL#DT100_AMNEBIKI.editable = false;#EOL#DT100_AMARARI.editable = false;#EOL#"/><Field ID="NRSEIKYUWORK" Name="請求№表示用ワーク" Nullable="T" Order="0240" Size="7" Type="CHAR" TypeOptions="VIRTUAL"/><Refer Fields="TXSIMEBI" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="DT100.NRTORIHIKISAKI"/><Key Fields="DTCREATE" Type="XK"/><Field ID="TXSYOHIN" Name="商品名／摘要" Nullable="T" Order="0080" Remarks="振替取引では振替摘要が設定される" Size="30" Type="CHAR" TypeOptions="KANJI"/></Table><Table ActiveWhere="" ID="ZT030" Name="採番テーブル" RangeKey="" Remarks="レコード識別用フィールドの自動採番を管理するためのテーブル" SubsystemID="Z"><Field ID="IDNUMBER" Name="番号ＩＤ" Nullable="F" Order="0" Size="20" Type="CHAR" TypeOptions=""/><Field ID="TXPREFIX" Name="冒頭文字" Nullable="T" Order="1" Size="4" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRNUMDIGIT" Name="数字部桁" Nullable="F" Order="2" Size="2" Type="SMALLINT" TypeOptions=""/><Field ID="NRCURRENT" Name="現在番号値" Nullable="F" Order="3" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="FGWITHCD" Name="チェックデジット" Nullable="F" Order="4" Remarks="値がT(真)であれば、採番値の末尾にチェックデジット（モジュラス１０）を付加する。したがって冒頭文字を１文字指定して、チェックデジットを指定すれば、採番値は数字部桁に２を足した長さになる。" Size="1" Type="CHAR" TypeOptions="KUBUN(KBFLAG1)"/><Key Fields="IDNUMBER" Type="PK"/></Table><Table ActiveWhere="" ID="ET010" Name="倉庫在庫" RangeKey="" Remarks="商品と倉庫の組み合わせ毎に管理される属性情報を保持するためのテーブル。安全在庫数、(年次)期首在庫高、期間入出庫高を含む。" SubsystemID="E"><Field ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0020" Size="5" Type="CHAR" TypeOptions=""/><Field ID="QTANZENZAIKO" Name="安全在庫数" Nullable="T" Order="0040" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="QTJYOUGENZAIKO" Name="上限在庫数" Nullable="T" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="QTKISYUZAIKO" Name="期首在庫数" Nullable="T" Order="0060" Remarks="システム変数「入力認可過去月度(ALLOWED_FISCAL_MONTH)」の上４桁で表される会計年度における繰越在庫数" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="QTNYUKO" Name="当期入庫数" Nullable="T" Order="0070" Remarks="" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="QTSYUKKO" Name="当期出庫数" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMKISYUZAIKO" Name="期首在庫額" Nullable="T" Order="0090" Remarks="システム変数「入力認可過去月度(ALLOWED_FISCAL_MONTH)」の上４桁で表される会計年度における繰越在庫額" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMNYUKO" Name="当期入庫額" Nullable="T" Order="0100" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMSYUKKO" Name="当期出庫額" Nullable="T" Order="0110" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="QTGENZAIKO" Name="現在庫数" Nullable="T" Order="0120" Remarks="期首在庫数＋当期入庫数－当期出庫数" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="AMGENZAIKO" Name="現在庫額" Nullable="T" Order="0130" Remarks="期首在庫額＋当期入庫額－当期出庫額" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="PRIDOUHEIKIN" Name="移動平均単価" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="DTSUMMARY" Name="検査範囲日" Nullable="T" Order="0210" Remarks="EF050のみで利用される。過不足検査をどの未来日まで行うかを示す。検索条件としてユーザによってパネルから入力される。" Size="10" Type="DATE" TypeOptions="VIRTUAL"/><Field ID="DTSHORT" Name="最早不足日" Nullable="T" Order="0150" Size="10" Type="DATE" TypeOptions="VIRTUAL"/><Field ID="QTSUMMARY" Name="在庫推移計算用ワーク" Nullable="T" Order="0200" Remarks="" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="QTEXCESSSUMMARY" Name="期間過剰数" Nullable="T" Order="0160" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="AMEXCESSSUMMARY" Name="期間過剰額" Nullable="T" Order="0170" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="FGSHORT" Name="不足検査対象" Nullable="T" Order="0180" Remarks="" Size="1" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBFLAG1)"/><Field ID="FGEXCESS" Name="過剰検査対象" Nullable="T" Order="0190" Remarks="" Size="1" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBFLAG1)"/><Key Fields="NRSYOHIN;NRSOUKO" Type="PK"/><Refer Fields="TXSYOHIN;KBSYOHIN;TXHINBAN;KBZAIKOUM;TXIMAGEFILENAME;QTHANBAIUNIT;PRHANBAI;TXSIYOU;CDMAKER" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="BT020" WithKeyFields="ET010.NRSYOHIN"/><Refer Fields="TXSOUKO" Order="1" OrderBy="" TableAlias="" ToKeyFields="" ToTable="BT030" WithKeyFields="ET010.NRSOUKO"/><Refer Fields="TXMAKERABR" Order="2" TableAlias="" ToKeyFields="" ToTable="BT010" WithKeyFields="BT020.CDMAKER"/><Script EventP="BC;BU" EventR="BR()" Function="" Name="入力不可項目設定" Order="0010" Text="ET010_QTGENZAIKO.editable = false;#EOL#ET010_QTKISYUZAIKO.editable = false;#EOL#ET010_QTNYUKO.editable = false;#EOL#ET010_QTSYUKKO.editable = false;#EOL#ET010_AMGENZAIKO.editable = false;#EOL#ET010_AMKISYUZAIKO.editable = false;#EOL#ET010_AMNYUKO.editable = false;#EOL#ET010_AMSYUKKO.editable = false;"/><Script EventP="BC;BU;BD;AR" EventR="BR()" Function="" Name="仮想フィールドの設定" Order="0020" Text="ET010_QTGENZAIKO.value = Number(ET010_QTKISYUZAIKO.value) + Number(ET010_QTNYUKO.value) - ET010_QTSYUKKO.value;#EOL#ET010_AMGENZAIKO.value = Number(ET010_AMKISYUZAIKO.value) + Number(ET010_AMNYUKO.value) -  ET010_AMSYUKKO.value;#EOL#if (ET010_QTGENZAIKO.value != 0) {#EOL#&#x9;ET010_PRIDOUHEIKIN.value = Math.round(ET010_AMGENZAIKO.value / ET010_QTGENZAIKO.value);#EOL#}"/><Script EventP="BC;BU" EventR="AR()" Function="" Name="安全在庫数の妥当性検査" Order="0100" Text="if (ET010_QTANZENZAIKO.value >  ET010_QTJYOUGENZAIKO.value) {#EOL#&#x9;ET010_QTANZENZAIKO.error = '上限在庫数以下に設定してください。'#EOL#}"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0110" Text="if (ET010_QTGENZAIKO.value != 0 || ET010_AMGENZAIKO.value != 0) {#EOL#&#x9;ET010_NRSYOHIN.error = '現在庫数か現在庫額がゼロでないので、削除できません。'#EOL#}#EOL#"/><Key Fields="NRSOUKO" Type="XK"/><Script EventP="AR" EventR="AR()" Function="" Name="受払予定にもとづく過不足検査(EF210)" Order="0050" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET200;#EOL#var today = session.getToday() + '';#EOL#var dtlastchange = today;#EOL#var qtexcesswork = 0;#EOL##EOL#///////////////////////////////////////////////////////////////////#EOL#// 在庫推移異状の一覧(EF210)で読み込まれた場合に以下の検査を実行 //#EOL#///////////////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'EF210') {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 検査結果の初期化 //#EOL#&#x9;//////////////////////#EOL#&#x9;ET010_FGSHORT.value = 'F';#EOL#&#x9;ET010_FGEXCESS.value = 'F';#EOL#&#x9;ET010_QTEXCESSSUMMARY.value = 0;#EOL#&#x9;ET010_QTSUMMARY.value = ET010_QTGENZAIKO.value;#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 現在庫の過剰検査 //#EOL#&#x9;//////////////////////#EOL#&#x9;if (ET010_QTGENZAIKO.value > ET010_QTJYOUGENZAIKO.value) {#EOL#&#x9;&#x9;qtexcesswork = ET010_QTGENZAIKO.value - ET010_QTJYOUGENZAIKO.value;#EOL#&#x9;&#x9;ET010_FGEXCESS.value = 'T';#EOL#&#x9;} else {#EOL#&#x9;&#x9;qtexcesswork = 0;#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// マイナス在庫の評価 //#EOL#&#x9;////////////////////////#EOL#&#x9;if (ET010_QTGENZAIKO.value &lt; 0) {#EOL#&#x9;&#x9;ET010_DTSHORT.value = today;#EOL#&#x9;&#x9;ET010_FGSHORT.value = 'T';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////#EOL#&#x9;// 受払予定(ET200)毎に過不足検査 //#EOL#&#x9;///////////////////////////////////#EOL#&#x9;rET200 = instance.createTableOperator('Select', 'ET200');#EOL#&#x9;rET200.setSelectFields('KBYOTEI, DTYOTEI, QTYOTEI');#EOL#&#x9;rET200.addKeyValue('NRSYOHIN',&#x9;ET010_NRSYOHIN.value);#EOL#&#x9;rET200.addKeyValue('NRSOUKO',&#x9;ET010_NRSOUKO.value);#EOL#&#x9;rET200.setOrderBy('DTYOTEI, KBYOTEI');#EOL#&#x9;while (rET200.next()) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 受払予定日と受払予定数の取得（受払予定日が過去日であれば現在日に設定） //#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;var qtyotei = rET200.getValueOf('QTYOTEI');#EOL#&#x9;&#x9;var dtyotei = rET200.getValueOf('DTYOTEI');#EOL#&#x9;&#x9;if (session.getDaysBetweenDates(today, dtyotei, 0) &lt; 0) {#EOL#&#x9;&#x9;&#x9;dtyotei = today;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 受払予定日が検査範囲であれば欠品/過剰の検査をする //#EOL#&#x9;&#x9;///////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (session.getDaysBetweenDates(dtyotei, ET010_DTSUMMARY.value, 0) >= 0) {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 受払区分に従って、受払予定数を推移在庫数に加減する     //#EOL#&#x9;&#x9;&#x9;// 10：仕入入庫  20：売上出庫  30：移動出庫  31：移動入庫 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rET200.getValueOf('KBYOTEI') == '10' || rET200.getValueOf('KBYOTEI') == '31') {#EOL#&#x9;&#x9;&#x9;&#x9;ET010_QTSUMMARY.value = Number(ET010_QTSUMMARY.value) + Number(qtyotei);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rET200.getValueOf('KBYOTEI') == '20' || rET200.getValueOf('KBYOTEI') == '30') {#EOL#&#x9;&#x9;&#x9;&#x9;ET010_QTSUMMARY.value = Number(ET010_QTSUMMARY.value) - Number(qtyotei);#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 推移数が安全在庫を切れば、その日を最早欠品日とする //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (ET010_FGSHORT.value == 'F' &amp;&amp; ET010_QTSUMMARY.value &lt; ET010_QTANZENZAIKO.value) {#EOL#&#x9;&#x9;&#x9;&#x9;ET010_DTSHORT.value = dtyotei;#EOL#&#x9;&#x9;&#x9;&#x9;ET010_FGSHORT.value = 'T';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;// 累積過剰数の計算 //#EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;ET010_QTEXCESSSUMMARY.value = Number(ET010_QTEXCESSSUMMARY.value) + Number(qtexcesswork * session.getDaysBetweenDates(dtlastchange, dtyotei, 0));#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 推移数(qtsummary)が上限在庫を超えれば、過剰設定する //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (ET010_QTSUMMARY.value > ET010_QTJYOUGENZAIKO.value) {#EOL#&#x9;&#x9;&#x9;&#x9;qtexcesswork = ET010_QTSUMMARY.value - ET010_QTJYOUGENZAIKO.value;#EOL#&#x9;&#x9;&#x9;&#x9;ET010_FGEXCESS.value = 'T';#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;qtexcesswork = 0;#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 次の受払予定の検査のために現レコードの予定日を保存 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;dtlastchange = dtyotei;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 期間過剰額を計算 //#EOL#&#x9;//////////////////////#EOL#&#x9;ET010_QTEXCESSSUMMARY.value = Number(ET010_QTEXCESSSUMMARY.value) + Number(qtexcesswork * session.getDaysBetweenDates(dtlastchange, ET010_DTSUMMARY.value, 0));#EOL#&#x9;ET010_AMEXCESSSUMMARY.value = ET010_QTEXCESSSUMMARY.value * BT020_PRHANBAI.value;#EOL#}#EOL#"/><Script EventP="AR" EventR="BR()" Function="" Name="推移在庫数の初期化(EF011)" Order="0060" Text="///////////////////////////////////////////////////////////////////#EOL#// 倉庫在庫と関連情報の確認(EF011)で読み込まれた場合に以下を実行 //#EOL#///////////////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'EF011') {#EOL#&#x9;ET010_QTSUMMARY.value = ET010_QTGENZAIKO.value;#EOL#}"/><Field ID="NRLOCATION" Name="標準ロケ№" Nullable="T" Order="0031" Remarks="入庫登録において設定されるまではブランク" Size="5" Type="CHAR" TypeOptions=""/><Refer Fields="TXTEKIYO" Order="0012" OrderBy="" TableAlias="" ToKeyFields="NRSOUKO;NRLOCATION" ToTable="BT031" WithKeyFields="ET010.NRSOUKO;ET010.NRLOCATION"/></Table><Table ActiveWhere="" ID="CT010" Name="仕入先" RangeKey="" Remarks="取引先の仕入先用拡張属性を保持するためのテーブル。(年次)期首買掛残高、期間仕入計上額、期間支払額を含む。" SubsystemID="C"><Field ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0010" Size="8" Type="CHAR" TypeOptions=""/><Field ID="TXTANTOUBUSYO" Name="仕入先担当部署" Nullable="F" Order="0020" Size="30" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXTANTOUSYA" Name="仕入先担当者名" Nullable="T" Order="0030" Size="40" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXTANTOUSYASYOKUI" Name="仕入先担当者職位" Nullable="T" Order="0040" Size="10" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXTANTOUSYAEMAIL" Name="仕入先担当者メアド" Nullable="T" Order="0050" Size="40" Type="CHAR" TypeOptions="URL"/><Field ID="TXTANTOUSYADENWA" Name="仕入先担当者電話番号" Nullable="T" Order="0060" Size="20" Type="CHAR" TypeOptions="DIAL"/><Field ID="KBSIHARAIHOUHOU" Name="支払方法区分" Nullable="F" Order="0070" Size="2" Type="CHAR" TypeOptions="KUBUN(KBSIHARAIHOUHOU)"/><Field ID="VLNYUKINSAITO" Name="支払入金サイト" Nullable="F" Order="0090" Size="4" Type="SMALLINT" TypeOptions=""/><Field ID="NRTANTOUJYUGYOIN" Name="仕入担当者№" Nullable="F" Order="0110" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0120" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Field Decimal="2" ID="AMKISYUKAIKAKE" Name="期首買掛残高" Nullable="T" Order="0130" Remarks="システム変数「入力認可過去月度(ALLOWED_FISCAL_MONTH)」の上４桁で表される会計年度における繰越買掛残高" Size="11" Type="DECIMAL" TypeOptions=""/><Field Decimal="2" ID="AMSIHARAI" Name="当期支払額" Nullable="T" Order="0150" Size="11" Type="DECIMAL" TypeOptions=""/><Field Decimal="2" ID="AMGENKAIKAKE" Name="現買掛残高" Nullable="T" Order="0270" Size="11" Type="DECIMAL" TypeOptions="VIRTUAL"/><Key Fields="NRTORIHIKISAKI" Type="PK"/><Refer Fields="TXKANJI;TXKANA;TXJYUSYO1;TXJYUSYO2;KBCURRENCY" Options="" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="CT010.NRTORIHIKISAKI"/><Refer Fields="TXKANJI" Order="2" TableAlias="" ToKeyFields="" ToTable="AT020" WithKeyFields="CT010.NRTANTOUJYUGYOIN"/><Script EventP="BC" EventR="BR()" Name="追加時入力不可項目の設定" Order="0010" Text="CT010_AMGENKAIKAKE.editable = false;"/><Script EventP="BC;BU;BD;AR" EventR="BR()" Name="現買掛残高の設定" Order="0020" Text="CT010_AMGENKAIKAKE.value = Number(CT010_AMKISYUKAIKAKE.value) + Number(CT010_AMKEIJYOU.value) - CT010_AMSIHARAI.value;#EOL#"/><Script EventP="BD" EventR="BR()" Function="" Name="現買掛残高≠０ ならば削除不可" Order="0040" Text="if (CT010_AMGENKAIKAKE.value != 0) {#EOL#&#x9;CT010_AMGENKAIKAKE.error = '現買掛残高がゼロでないので、削除できません。'#EOL#}"/><Script EventP="BU" EventR="BR()" Name="更新時入力不可項目の設定" Order="0030" Text="CT010_AMGENKAIKAKE.editable = false;#EOL#CT010_AMKEIJYOU.editable = false;#EOL#CT010_AMSIHARAI.editable = false;#EOL#"/><Field ID="TXHURIKOMISAKI" Name="振込先銀行口座" Nullable="T" Order="0080" Size="50" Type="CHAR" TypeOptions=""/><Field Decimal="2" ID="AMKEIJYOU" Name="当期計上額" Nullable="T" Order="0140" Size="11" Type="DECIMAL" TypeOptions=""/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0050" Text="var rAT030 = instance.createTableOperator('Count', 'AT030');#EOL#rAT030.addKeyValue('NRTORIHIKISAKI',&#x9;CT010_NRTORIHIKISAKI.value);#EOL#if (rAT030.execute() > 0) {#EOL#&#x9;CT010_NRTORIHIKISAKI.error = '既存の取引先によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT011 = instance.createTableOperator('Count', 'CT011');#EOL#rCT011.addKeyValue('NRTORIHIKISAKI',&#x9;CT010_NRTORIHIKISAKI.value);#EOL#if (rCT011.execute() > 0) {#EOL#&#x9;CT010_NRTORIHIKISAKI.error = '既存の仕入先別商品明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT110 = instance.createTableOperator('Count', 'CT110');#EOL#rCT110.addKeyValue('NRTORIHIKISAKI',&#x9;CT010_NRTORIHIKISAKI.value);#EOL#if (rCT110.execute() > 0) {#EOL#&#x9;CT010_NRTORIHIKISAKI.error = '既存の支払依頼によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET200 = instance.createTableOperator('Count', 'ET200');#EOL#rET200.addKeyValue('NRTORIHIKISAKI',&#x9;CT010_NRTORIHIKISAKI.value);#EOL#if (rET200.execute() > 0) {#EOL#&#x9;CT010_NRTORIHIKISAKI.error = '既存の受払予定によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT010 = instance.createTableOperator('Count', 'FT010');#EOL#rFT010.addKeyValue('NRTORIHIKISAKI',&#x9;CT010_NRTORIHIKISAKI.value);#EOL#if (rFT010.execute() > 0) {#EOL#&#x9;CT010_NRTORIHIKISAKI.error = '既存の発注見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rHT010 = instance.createTableOperator('Count', 'HT010');#EOL#rHT010.addKeyValue('NRTORIHIKISAKI',&#x9;CT010_NRTORIHIKISAKI.value);#EOL#if (rHT010.execute() > 0) {#EOL#&#x9;CT010_NRTORIHIKISAKI.error = '既存の仕入振替によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rHT020 = instance.createTableOperator('Count', 'HT020');#EOL#rHT020.addKeyValue('NRTORIHIKISAKI',&#x9;CT010_NRTORIHIKISAKI.value);#EOL#if (rHT020.execute() > 0) {#EOL#&#x9;CT010_NRTORIHIKISAKI.error = '既存の特殊仕入によって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="ZT050" Name="セッション" RangeKey="" Remarks="ユーザがシステムにログインすることで開始されるセッションの履歴を保持するためのテーブル" SubsystemID="Z"><Field ID="NRSESSION" Name="セッション№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field ID="DTLOGIN" Name="ログイン日時" Nullable="F" Order="0020" Size="23" Type="DATETIME" TypeOptions=""/><Field ID="DTLOGOUT" Name="ログアウト日時" Nullable="T" Order="0030" Remarks="" Size="23" Type="DATETIME" TypeOptions=""/><Field ID="IDUSER" Name="ユーザＩＤ" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXIPADDRESS" Name="ＩＰアドレス" Nullable="F" Order="0050" Size="20" Type="CHAR" TypeOptions=""/><Field ID="KBSESSIONSTATUS" Name="状態" Nullable="F" Order="0070" Size="3" Type="CHAR" TypeOptions="VALUES(ACT;ERR;END)"/><Key Fields="NRSESSION" Type="PK"/><Refer Fields="TXNAME" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="ZT020" WithKeyFields="ZT050.IDUSER"/><Script EventP="BC;BU;BD;AR" EventR="AR()" Name="セッション状態にもとづく配色設定" Order="0" Text="if (ZT050_KBSESSIONSTATUS.value == 'ERR') {#EOL#&#x9;ZT050_KBSESSIONSTATUS.color = 'red';#EOL#}#EOL#if (ZT050_KBSESSIONSTATUS.value == 'ACT') {#EOL#&#x9;ZT050_KBSESSIONSTATUS.color = 'green';#EOL#}"/><Key Fields="IDUSER" Type="XK"/><Field ID="VLVERSION" Name="処理系バージョン" Nullable="F" Order="0060" Size="10" Type="CHAR" TypeOptions=""/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="DT011" Name="出荷先" RangeKey="" Remarks="顧客毎の出荷先情報を保持するためのテーブル" SubsystemID="D"><Field ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="00" Size="8" Type="CHAR" TypeOptions=""/><Field ID="SQSYUKKASAKI" Name="出荷先行" Nullable="F" Order="01" Size="3" Type="SMALLINT" TypeOptions=""/><Field ID="TXKANJI" Name="出荷先名" Nullable="F" Order="02" Size="40" Type="CHAR" TypeOptions="KANJI"/><Field ID="NRYUBIN" Name="郵便番号" Nullable="F" Order="03" Size="8" Type="CHAR" TypeOptions="ZIPNO"/><Field ID="TXJYUSYO" Name="住所" Nullable="F" Order="04" Size="40" Type="CHAR" TypeOptions="KANJI"/><Field ID="NRDENWA" Name="電話番号" Nullable="F" Order="05" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="NRFAX" Name="FAX番号" Nullable="T" Order="06" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="VLUNSOULT" Name="運送ＬＴ" Nullable="F" Order="07" Size="4" Type="SMALLINT" TypeOptions=""/><Key Fields="NRTORIHIKISAKI;SQSYUKKASAKI" Type="PK"/><Refer Fields="TXKANJI" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="DT011.NRTORIHIKISAKI"/><Script EventP="BC" EventR="BR()" Function="" Name="追加前設定" Order="0000" Text="DT011_NRTORIHIKISAKI.editable = false;"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0010" Text="var rGT010 = instance.createTableOperator('Count', 'GT010');#EOL#rGT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT011_NRTORIHIKISAKI.value);#EOL#rGT010.addKeyValue('SQSYUKKASAKI',&#x9;&#x9;DT011_SQSYUKKASAKI.value);#EOL#if (rGT010.execute() > 0) {#EOL#&#x9;DT011_NRTORIHIKISAKI.error = '既存の受注見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT020 = instance.createTableOperator('Count', 'GT020');#EOL#rGT020.addKeyValue('NRTORIHIKISAKI',&#x9;DT011_NRTORIHIKISAKI.value);#EOL#rGT020.addKeyValue('SQSYUKKASAKI',&#x9;&#x9;DT011_SQSYUKKASAKI.value);#EOL#if (rGT020.execute() > 0) {#EOL#&#x9;DT011_NRTORIHIKISAKI.error = '既存の出荷見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT030 = instance.createTableOperator('Count', 'GT030');#EOL#rGT030.addKeyValue('NRTORIHIKISAKI',&#x9;DT011_NRTORIHIKISAKI.value);#EOL#rGT030.addKeyValue('SQSYUKKASAKI',&#x9;&#x9;DT011_SQSYUKKASAKI.value);#EOL#if (rGT030.execute() > 0) {#EOL#&#x9;DT011_NRTORIHIKISAKI.error = '既存の見積見出しによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#rJT020.addKeyValue('NRTORIHIKISAKI',&#x9;DT011_NRTORIHIKISAKI.value);#EOL#rJT020.addKeyValue('SQSYUKKASAKI',&#x9;&#x9;DT011_SQSYUKKASAKI.value);#EOL#if (rJT020.execute() > 0) {#EOL#&#x9;DT011_NRTORIHIKISAKI.error = '既存の特殊売上によって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="ZT010" Name="システム変数" RangeKey="" Remarks="企業名や年度開始月といったシステム変数を保持するためのテーブル" SubsystemID="Z"><Field ID="IDVARIANT" Name="変数ＩＤ" Nullable="F" Order="0010" Size="20" Type="CHAR" TypeOptions=""/><Field ID="TXTYPE" Name="変数タイプ" Nullable="F" Order="0030" Size="10" Type="CHAR" TypeOptions="VALUES(STRING;NUMBER)"/><Field ID="TXVALUE" Name="変数値" Nullable="F" Order="0040" Size="100" Type="CHAR" TypeOptions=""/><Key Fields="IDVARIANT" Type="PK"/><Field ID="TXNAME" Name="変数名" Nullable="F" Order="0020" Size="10" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXREMARKS" Name="摘要" Nullable="T" Order="0042" Size="500" Type="VARCHAR" TypeOptions=""/></Table><Table ActiveWhere="" ID="BT010" Name="メーカー" RangeKey="" Remarks="扱い商品のメーカー（仕入先とは限らない）に関する情報を保持するためのテーブル" SubsystemID="B"><Field ID="CDMAKER" Name="メーカーＣ" Nullable="F" Order="0010" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXMAKER" Name="メーカー名" Nullable="F" Order="0020" Size="40" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXMAKERABR" Name="メーカー略称" Nullable="F" Order="0030" Size="10" Type="CHAR" TypeOptions=""/><Field ID="NRYUBIN" Name="郵便番号" Nullable="F" Order="0060" Size="8" Type="CHAR" TypeOptions="ZIPNO"/><Field ID="TXJYUSYO" Name="住所" Nullable="F" Order="0070" Size="40" Type="CHAR" TypeOptions="ZIPADRS"/><Field ID="NRDENWA" Name="電話番号" Nullable="F" Order="0080" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="NRFAX" Name="FAX番号" Nullable="F" Order="0090" Size="14" Type="CHAR" TypeOptions="DIAL"/><Field ID="TXURL" Name="サイトＵＲＬ" Nullable="T" Order="0100" Size="40" Type="CHAR" TypeOptions="URL"/><Field ID="TXEMAIL" Name="担当者EMail" Nullable="T" Order="0110" Size="40" Type="CHAR" TypeOptions="URL"/><Key Fields="CDMAKER" Type="PK"/><Field ID="KBCOUNTRY" Name="国名" Nullable="F" Order="0050" Remarks="ＩＳＯの３桁コード(ISO 3166-1 alpha-3)" Size="3" Type="CHAR" TypeOptions="KUBUN(KBCOUNTRY)"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0000" Text="var rBT020 = instance.createTableOperator('Count', 'BT020');#EOL#rBT020.addKeyValue('CDMAKER',&#x9;BT010_CDMAKER.value);#EOL#if (rBT020.execute() > 0) {#EOL#&#x9;BT010_CDMAKER.error = '既存の商品によって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="FT010" Name="発注見出し" RangeKey="" Remarks="仕入先への発注情報を保持するためのテーブル。１件の発注において複数の品目を扱える。" SubsystemID="F"><Field ID="NRHATTYU" Name="発注№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRHATTYU)"/><Field ID="DTHATTYU" Name="発注日" Nullable="F" Order="0020" Size="10" Type="DATE" TypeOptions=""/><Field ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0030" Size="8" Type="CHAR" TypeOptions=""/><Field ID="NRSOUKO" Name="入荷予定倉庫№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0060" Size="300" Type="VARCHAR" TypeOptions=""/><Key Fields="NRHATTYU" Type="PK"/><Refer Fields="TXTANTOUBUSYO;TXTANTOUSYA;TXTANTOUSYASYOKUI;TXTANTOUSYAEMAIL;TXTANTOUSYADENWA" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="CT010" WithKeyFields="FT010.NRTORIHIKISAKI"/><Refer Fields="TXKANJI;TXKANA;KBCURRENCY" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="FT010.NRTORIHIKISAKI"/><Refer Fields="TXSOUKO;NRYUBIN;TXJYUSYO;TXSOUKOENG;TXJYUSYOENG" Order="0030" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="FT010.NRSOUKO"/><Field ID="STHATTYU" Name="発注状況" Nullable="F" Order="0100" Remarks="" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STHATTYU)"/><Script EventP="BU" EventR="BR()" Function="" Name="更新前設定" Order="0030" Text="FT010_NRTORIHIKISAKI.editable = false;#EOL#FT010_STHATTYU.editable = false;#EOL##EOL#/////////////////////////////////////////////////////////////////#EOL#// FF012Bでの行追加設定のWhere条件に組み込まれるセッション変数 //#EOL#/////////////////////////////////////////////////////////////////#EOL#session.setAttribute('DateHattyu', FT010_DTHATTYU.value);"/><Script EventP="BC" EventR="BR()" Function="" Name="追加前設定" Order="0020" Text="if (FT010_DTHATTYU.value == '') {#EOL#&#x9;FT010_DTHATTYU.value = session.getToday() + '';#EOL#}#EOL#if (FT010_NRJYUGYOIN.value == '') {#EOL#&#x9;FT010_NRJYUGYOIN.value = session.userEmployeeNo + '';#EOL#}#EOL#FT010_STHATTYU.value = '10';#EOL#FT010_STHATTYU.editable = false;"/><Field ID="FGKAKUNIN" Name="納期確認" Nullable="F" Order="0050" Size="1" Type="CHAR" TypeOptions="KUBUN(KBFLAG2)"/><Script EventP="AR" EventR="BR()" Function="" Name="発注状況設定" Order="0010" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rFT011; var rFT012;#EOL#var sqhattyu = 0; var countOfNyukameisai = 0; var countOfMikaitou = 0; var countOfNyukazumi = 0;#EOL##EOL#//////////////////////////////////////////#EOL#// 取消日が設定されていれば取消済とする //#EOL#//////////////////////////////////////////#EOL#if (FT010_DTTORIKESHI.value != '') {#EOL#&#x9;FT010_STHATTYU.value = '99'; //取消済//#EOL#} else {#EOL##EOL#&#x9;/////////////////////////////////////#EOL#&#x9;// 関連レコード(FT011,FT012)の集計 //#EOL#&#x9;/////////////////////////////////////#EOL#&#x9;rFT011 = instance.createTableOperator('Select', 'FT011');#EOL#&#x9;rFT011.setSelectFields('SQHATTYU');#EOL#&#x9;rFT011.addKeyValue('NRHATTYU',&#x9;FT010_NRHATTYU.value);#EOL#&#x9;while (rFT011.next()) {#EOL#&#x9;&#x9;rFT012 = instance.createTableOperator('Select', 'FT012');#EOL#&#x9;&#x9;rFT012.setSelectFields('FGKAKUNIN, NRNYUKA');#EOL#&#x9;&#x9;rFT012.addKeyValue('NRHATTYU',&#x9;&#x9;FT010_NRHATTYU.value);#EOL#&#x9;&#x9;rFT012.addKeyValue('SQHATTYU',&#x9;&#x9;rFT011.getValueOf('SQHATTYU'));#EOL#&#x9;&#x9;while (rFT012.next()) {#EOL#&#x9;&#x9;&#x9;countOfNyukameisai++;#EOL#&#x9;&#x9;&#x9;if (rFT012.getValueOf('FGKAKUNIN') == 'F' &amp;&amp; rFT012.getValueOf('NRNYUKA').trim() == '') {#EOL#&#x9;&#x9;&#x9;&#x9;countOfMikaitou++;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rFT012.getValueOf('NRNYUKA').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;countOfNyukazumi++;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////////#EOL#&#x9;// 集計結果にもとづく発注状況の設定 //#EOL#&#x9;//////////////////////////////////////#EOL#&#x9;if (countOfNyukameisai == countOfNyukazumi &amp;&amp; countOfNyukameisai > 0) {#EOL#&#x9;&#x9;&#x9;FT010_STHATTYU.value = '50'; //入荷完了//#EOL#&#x9;} else {#EOL#&#x9;&#x9;if (countOfMikaitou > 0 || countOfNyukameisai == 0) {#EOL#&#x9;&#x9;&#x9;if (FT010_DTHAKKOU.value == '') {#EOL#&#x9;&#x9;&#x9;&#x9;FT010_STHATTYU.value = '10'; //未発行//#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;FT010_STHATTYU.value = '20'; //納期未確定//#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;if (countOfNyukazumi > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;FT010_STHATTYU.value = '40'; //一部入荷済//#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;FT010_STHATTYU.value = '30'; //入荷待ち//#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}"/><Field ID="DTTORIKESHI" Name="取消日" Nullable="T" Order="0090" Size="10" Type="DATE" TypeOptions=""/><Field ID="DTHAKKOU" Name="発注書発行日" Nullable="T" Order="0081" Size="10" Type="DATE" TypeOptions=""/><Field ID="NRJYUGYOIN" Name="発注担当№" Nullable="F" Order="0032" Size="5" Type="CHAR" TypeOptions=""/><Refer Fields="TXKANJI" Order="0040" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="FT010.NRJYUGYOIN"/><Field ID="DTKIBOUNOUKI" Name="希望納期初期値" Nullable="T" Order="0061" Size="10" Type="DATE" TypeOptions=""/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0040" Text="var rFT011 = instance.createTableOperator('Count', 'FT011');#EOL#rFT011.addKeyValue('NRHATTYU',&#x9;FT010_NRHATTYU.value);#EOL#if (rFT011.execute() > 0) {#EOL#&#x9;FT010_NRHATTYU.error = '発注明細をともなうため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="FT012" Name="入荷明細" RangeKey="" Remarks="仕入先からの納期回答情報を保持するためのテーブル。通常は発注明細１件につき入荷明細１件（入荷行＝001）だが、分納される場合には２件以上（入荷行＝002～）が対応する。" SubsystemID="F"><Field Decimal="" ID="NRHATTYU" Name="発注№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQHATTYU" Name="発注行" Nullable="F" Order="0020" Size="3" Type="SMALLINT" TypeOptions="NO_EDIT"/><Field Decimal="" ID="SQNYUKA" Name="入荷行" Nullable="F" Order="0030" Remarks="" Size="3" Type="SMALLINT" TypeOptions="NO_EDIT"/><Field Decimal="" ID="DTYOTEINYUKA" Name="予定入荷日" Nullable="F" Order="0040" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="FGKAKUNIN" Name="納期確認" Nullable="F" Order="0050" Size="1" Type="CHAR" TypeOptions="KUBUN(KBFLAG2)"/><Field Decimal="" ID="NRNYUKA" Name="入荷№" Nullable="T" Order="0130" Size="7" Type="CHAR" TypeOptions=""/><Key Fields="NRHATTYU;SQHATTYU;SQNYUKA" Type="PK"/><Refer Fields="PRHATTYU;NRSYOHIN" Order="0030" TableAlias="" ToKeyFields="NRHATTYU;SQHATTYU" ToTable="FT011" WithKeyFields="FT012.NRHATTYU;FT012.SQHATTYU"/><Refer Fields="NRTORIHIKISAKI;NRSOUKO;DTHATTYU" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRHATTYU" ToTable="FT010" WithKeyFields="FT012.NRHATTYU"/><Refer Fields="NRSOUKO;DTNYUKA" Order="0040" TableAlias="" ToKeyFields="NRNYUKA" ToTable="FT020" WithKeyFields="FT012.NRNYUKA"/><Refer Fields="TXKANJI;KBCURRENCY;KBCOUNTRY" Order="0050" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="FT010.NRTORIHIKISAKI"/><Script EventP="BC;BU;AR" EventR="AR()" Function="" Name="仮想フィールド設定" Order="0010" Text="////////////////////////////#EOL#// 仕入先別商品明細の読取 //#EOL#////////////////////////////#EOL#var rCT011 = instance.createTableOperator('Select', 'CT011');#EOL#rCT011.addKeyValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#rCT011.addKeyValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#rCT011.addKeyValue('DTHAKKOU &lt;=',&#x9;&#x9;FT010_DTHATTYU.value);#EOL#rCT011.addKeyValue('DTSIKKOU >=',&#x9;&#x9;FT010_DTHATTYU.value);#EOL#if (rCT011.next()) {#EOL#&#x9;FT012_KBSIIREUM1.value = rCT011.getValueOf('KBSIIREUM');#EOL#&#x9;FT012_KBSIIREUM2.value = rCT011.getValueOf('KBSIIREUM');#EOL#&#x9;FT012_KBSIIREUM3.value = rCT011.getValueOf('KBSIIREUM');#EOL#&#x9;FT012_VLKANZANKEISU.value = rCT011.getValueOf('VLKANZANKEISU');#EOL#}#EOL##EOL#////////////////////////////////////////#EOL#// 入庫予定・実際数を在庫単位数に換算 //#EOL#////////////////////////////////////////#EOL#FT012_QTYOTEINYUKO.value = FT012_QTYOTEISIIRE.value * FT012_VLKANZANKEISU.value;#EOL#FT012_QTJITSUNYUKO.value = FT012_QTJITSUSIIRE.value * FT012_VLKANZANKEISU.value;#EOL##EOL#////////////////////////////#EOL#// 仕入額・消費税額の設定 //#EOL#////////////////////////////#EOL#if (FT012_NRNYUKA.value != '') {#EOL#&#x9;FT012_AMSIIREGAIKA.value = FT012_PRSIIRE.value * FT012_QTJITSUSIIRE.value;#EOL##EOL#&#x9;var rtRate = session.getMonthlyExchangeRate(AT030_KBCURRENCY.value, FT020_DTNYUKA.value, 'TTS');#EOL#&#x9;FT012_AMSIIRENAIKA.value = Math.round(FT012_AMSIIREGAIKA.value * rtRate);#EOL##EOL#&#x9;var rtRateOld = session.getMonthlyExchangeRate(AT030_KBCURRENCY.value, FT020_DTNYUKA.oldValue, 'TTS');#EOL#&#x9;FT012_AMSIIRENAIKA.oldValue = Math.round(FT012_AMSIIREGAIKA.oldValue * rtRateOld);#EOL##EOL#&#x9;if (AT030_KBCOUNTRY.value == (session.getSystemVariantString('SYSTEM_COUNTRY') + '')) {#EOL#&#x9;&#x9;FT012_AMTAX.value = session.getTaxAmount(FT020_DTNYUKA.value, FT012_AMSIIRENAIKA.value);#EOL#&#x9;&#x9;FT012_AMTAX.oldValue = session.getTaxAmount(FT020_DTNYUKA.oldValue, FT012_AMSIIRENAIKA.oldValue);#EOL#&#x9;} else {#EOL#&#x9;&#x9;FT012_AMTAX.value = 0;#EOL#&#x9;&#x9;FT012_AMTAX.oldValue = 0;#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="QTDEFECT" Name="不合格数" Nullable="T" Order="0090" Remarks="「仕入単位」での数量" Size="9" Type="INTEGER" TypeOptions=""/><Refer Fields="TXSOUKO" Order="0100" TableAlias="BT030B" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="FT020.NRSOUKO"/><Field ID="NRSYOHIN" Name="入荷商品№" Nullable="F" Order="0060" Size="7" Type="CHAR" TypeOptions=""/><Script EventP="BC" EventR="BR()" Function="" Name="追加前初期値設定" Order="0020" Text="FT012_NRSYOHIN.value = FT011_NRSYOHIN.value;#EOL#FT012_PRSIIRE.value = FT011_PRHATTYU.value;#EOL#FT012_FGKAKUNIN.value = 'F';#EOL#"/><Refer Fields="TXSOUKO" Order="0090" TableAlias="BT030A" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="FT010.NRSOUKO"/><Script EventP="BC;BU" EventR="AR()" Function="" Name="変更不可設定" Order="0030" Text="FT012_KBSIIREUM1.editable = false;#EOL#FT012_KBSIIREUM2.editable = false;#EOL#FT012_KBSIIREUM3.editable = false;#EOL#FT012_VLKANZANKEISU.editable = false;#EOL#FT012_NRNYUKA.editable = false;#EOL#FT012_QTYOTEINYUKO.editable = false;#EOL##EOL#if (instance.functionID == 'FF021' || instance.functionID == 'FF030') {#EOL#&#x9;FT012_NRSYOHIN.editable = false;#EOL#&#x9;FT012_QTYOTEISIIRE.editable = false;#EOL#&#x9;FT012_DTYOTEINYUKA.editable = false;#EOL#}#EOL#"/><Script EventP="BU" EventR="BR()" Function="" Name="入荷切り離しのための設定(FF043)" Order="0080" Text="if (instance.functionID == 'FF043') {#EOL#&#x9;FT012_QTJITSUSIIRE.editable = false;#EOL#&#x9;FT012_QTDEFECT.editable = false;#EOL##EOL#&#x9;if (FT012_QTJITSUSIIRE.value > 0) {#EOL#&#x9;&#x9;FT012_QTJITSUSIIRE.error = '入荷指示から切り離すためには、登録されている仕入実績数をクリアする必要があります。';#EOL#&#x9;} else {#EOL#&#x9;&#x9;FT012_NRNYUKA.value = '';#EOL#&#x9;&#x9;FT012_QTDEFECT.value = 0;#EOL#&#x9;}#EOL#}"/><Script EventP="AC" EventR="" Function="" Name="追加後の受払予定設定" Order="0090" Text="//////////////#EOL#// 変数設定 //#EOL#//////////////#EOL#var cET200; var rET010; var cET010;#EOL#var errorMessage = ''; var count = 0; var qtnyuka = 0;#EOL##EOL#///////////////////////////////////////////#EOL#// 関連レコードの処理（納期確認済の場合）//#EOL#///////////////////////////////////////////#EOL#if (FT012_FGKAKUNIN.value == 'T') {#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 在庫単位での入荷予定数の計算 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;qtnyuka = FT012_QTYOTEISIIRE.value * FT012_VLKANZANKEISU.value;#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払予定(ET200)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'10');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;FT012_DTYOTEINYUKA.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT010_NRSOUKO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;qtnyuka);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;FT012_NRHATTYU.value + '-' + FT012_SQHATTYU.value + '-' + FT012_SQNYUKA.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;// 倉庫在庫(ET010)初期レコードの追加（存在していなければ）//#EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;FT010_NRSOUKO.value);#EOL#&#x9;&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020A_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020A_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="削除後の受払予定設定" Order="0110" Text="/////////////////////////////////////////////////////////////////////////#EOL#// 関連する受払予定レコードの削除（レコードが存在していない可能性あり）//#EOL#/////////////////////////////////////////////////////////////////////////#EOL#var dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#dET200.execute();"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM;FGLOTKANRI;QTANZENZAIKO;QTJYOUGENZAIKO;TXIMAGEFILENAME" Order="0060" OrderBy="" TableAlias="BT020A" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="FT012.NRSYOHIN"/><Script EventP="AU" EventR="" Function="" Name="更新後の受払予定設定" Order="0100" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var dET200; var cET200; var rET010; var cET010;#EOL#var dtYotei = ''; var qtYotei = 0; var count = 0; var errorMessage = '';#EOL##EOL#////////////////////////////////////////////////////////////////////////#EOL#// 関連する受払予定(ET200)の削除（レコードが存在していない可能性あり）//#EOL#////////////////////////////////////////////////////////////////////////#EOL#dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#dET200.execute();#EOL##EOL#////////////////////////////#EOL#// 納期確認済の場合の処理 //#EOL#////////////////////////////#EOL#if (FT012_FGKAKUNIN.value == 'T') {#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 入荷予定日と入荷予定数の設定 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;if (FT012_NRNYUKA.value == '') {#EOL#&#x9;&#x9;dtYotei = FT012_DTYOTEINYUKA.value;#EOL#&#x9;&#x9;qtYotei = FT012_QTYOTEISIIRE.value * FT012_VLKANZANKEISU.value;#EOL#&#x9;} else {#EOL#&#x9;&#x9;if (FT012_QTJITSUSIIRE.value == 0 &amp;&amp; FT012_QTDEFECT.value == 0) {#EOL#&#x9;&#x9;&#x9;dtYotei = FT020_DTNYUKA.value;#EOL#&#x9;&#x9;&#x9;qtYotei = FT012_QTYOTEISIIRE.value * FT012_VLKANZANKEISU.value;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// 入荷予定数＞０ならば //#EOL#&#x9;//////////////////////////#EOL#&#x9;if (qtYotei > 0) {#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 受払予定(ET200)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'10');#EOL#&#x9;&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;dtYotei);#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT010_NRSOUKO.value);#EOL#&#x9;&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;qtYotei);#EOL#&#x9;&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;FT012_NRHATTYU.value + '-' + FT012_SQHATTYU.value + '-' + FT012_SQNYUKA.value);#EOL#&#x9;&#x9;count = cET200.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 倉庫在庫(ET010)初期レコードの追加（存在していなければ）//#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;FT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020A_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020A_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL#"/><Refer Fields="NRLOCATION" Optional="T" Order="0110" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="FT012.NRSYOHIN;FT020.NRSOUKO"/><Script EventP="BU" EventR="AR()" Function="" Name="妥当性検査と各種設定(FF030)" Order="0060" Text="if (instance.functionID == 'FF030') {#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 更新不可設定 //#EOL#&#x9;//////////////////#EOL#&#x9;FT012_NRSYOHIN.editable = false;#EOL#&#x9;FT012_QTYOTEISIIRE.editable = false;#EOL#&#x9;FT012_QTJITSUNYUKO.editable = false;#EOL##EOL#&#x9;////////////////#EOL#&#x9;// 妥当性検査 //#EOL#&#x9;////////////////#EOL#&#x9;if (BT020A_FGLOTKANRI.value == 'T' &amp;&amp; FT012_TXLOTNUMBER.value == '' &amp;&amp; FT012_QTJITSUNYUKO.value > 0) {#EOL#&#x9;&#x9;FT012_TXLOTNUMBER.error = 'ロット管理品です。ロット№を入力してください。';#EOL#&#x9;}#EOL#&#x9;if (FT012_NRLOCATION.value == '') {#EOL#&#x9;&#x9;FT012_NRLOCATION.value = ET010_NRLOCATION.value;#EOL#&#x9;}#EOL#&#x9;if (FT012_NRLOCATION.value == '' &amp;&amp; FT012_QTJITSUNYUKO.value > 0) {#EOL#&#x9;&#x9;FT012_NRLOCATION.error = '入庫ロケ№を入力してください。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 実際仕入数の初期値設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;if (FT012_QTJITSUSIIRE.value == 0 &amp;&amp; FT012_QTDEFECT.value == 0 &amp;&amp; FT012_FGWORK.value == '') {#EOL#&#x9;&#x9;FT012_QTJITSUSIIRE.value = FT012_QTYOTEISIIRE.value;#EOL#&#x9;}#EOL#&#x9;FT012_FGWORK.value = 'T';#EOL#}"/><Refer Fields="NRTANTOUJYUGYOIN" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="CT010" WithKeyFields="FT010.NRTORIHIKISAKI"/><Script EventP="BU" EventR="AR()" Function="" Name="入荷指示の実際入荷倉庫の初期設定(FF021)" Order="0040" Text="if (instance.functionID == 'FF021') {#EOL#&#x9;if (FT020_NRSOUKO.value == '') {#EOL#&#x9;&#x9;FT020_NRSOUKO.value = FT010_NRSOUKO.value;#EOL#&#x9;}#EOL#}"/><Field ID="NRLOCATION" Name="入庫ロケ№" Nullable="T" Order="0120" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="2" ID="PRSIIRE" Name="仕入単価" Nullable="F" Order="0100" Remarks="取引通貨建ての発注単価を引き継いだものだが、変更可能。仕入実際数に掛け合わせることで仕入額が得られる" Size="10" Type="DECIMAL" TypeOptions=""/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0110" Remarks="ロット管理品の場合、入力必須" Size="40" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0140" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field Decimal="" ID="QTYOTEISIIRE" Name="仕入予定数" Nullable="F" Order="0070" Remarks="「仕入単位」での数量" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTYOTEINYUKO" Name="入庫予定数" Nullable="T" Order="0190" Remarks="「在庫単位」での仕入予定数" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="QTJITSUSIIRE" Name="実際仕入数" Nullable="T" Order="0080" Remarks="「仕入単位」での数量" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTJITSUNYUKO" Name="実際入庫数" Nullable="T" Order="0180" Remarks="「在庫単位」での数量。実際仕入数に換算係数を掛け合わせた値" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="ロット№の設定" Order="0050" Text="if (BT020A_FGLOTKANRI.value == 'F') {#EOL#&#x9;FT012_TXLOTNUMBER.editable = false;#EOL#&#x9;FT012_TXLOTNUMBER.value = '記載不要';#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="買掛・在庫計上処理(FF030)" Order="0120" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var uCT010; var rCT100; var uCT100; var cCT100;#EOL#var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;  #EOL#var dtNendNew = 0; var dtMSeqNew = 0; var dtNendOld = 0; var dtMSeqOld = 0;#EOL#var amNyukoNew = 0; var amSyukkoNew = 0; var amNyukoOld = 0; var amSyukkoOld = 0;#EOL#var qtNyukoNew = 0; var qtSyukkoNew = 0; var qtNyukoOld = 0; var qtSyukkoOld = 0;#EOL#var qtNyukoUpdated = 0; var amNyukoUpdated = 0; var qtSyukkoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var amKeijyouUpdated = 0; var errorMessage = ''; var count = 0;#EOL##EOL#///////////////////////////////////////////#EOL#// 入荷実績エントリー(FF030)において実行 //#EOL#///////////////////////////////////////////#EOL#if (instance.functionID == 'FF030') {#EOL##EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;// 関連フィールド値が変更された場合に実行 //#EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;if (FT012_PRSIIRE.valueChanged#EOL#&#x9;&#x9;|| FT012_QTJITSUSIIRE.valueChanged#EOL#&#x9;&#x9;|| FT012_NRLOCATION.valueChanged#EOL#&#x9;&#x9;|| FT012_TXLOTNUMBER.valueChanged#EOL#&#x9;&#x9;|| FT020_DTNYUKA.valueChanged) {#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;// 関連する仕入先マスター(CT010)の検索 //#EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#&#x9;&#x9;rCT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#&#x9;&#x9;rCT010.addKeyValue('NRTORIHIKISAKI', FT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;if (rCT010.next()) {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;//////////////////////////// 赤伝処理 //////////////////////////////////#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (FT012_QTJITSUSIIRE.oldValue > 0) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;dtNendOld = session.getFYearOfDate(FT020_DTNYUKA.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;dtMSeqOld = session.getMSeqOfDate(FT020_DTNYUKA.oldValue);#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 関連する仕入実績(CT100)の失効処理 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rCT100.setSelectFields('NRSIIRE, NRSIHARAIIRAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rCT100.addKeyValue('NRTORIHIKIKANRI', FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (rCT100.getValueOf('NRSIHARAIIRAI').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する仕入実績が支払依頼処理されているため、変更処理はキャンセルされます。関連する支払依頼('#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+ rCT100.getValueOf('NRSIHARAIIRAI') + ')から当該の仕入実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uCT100 = instance.createTableOperator('Update', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('UPDCOUNTER',&#x9;Number(rCT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('NRSIIRE',&#x9;&#x9;rCT100.getValueOf('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('UPDCOUNTER',&#x9;rCT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = uCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 仕入実績(CT100)の追加（赤伝）//#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;'00');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;FT020_DTNYUKA.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT012_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020A_TXSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;FT012_PRSIIRE.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;FT012_QTJITSUSIIRE.oldValue * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;FT012_KBSIIREUM1.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;FT012_PRSIIRE.oldValue * FT012_QTJITSUSIIRE.oldValue * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;FT012_AMTAX.oldValue * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 各種受払額の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoOld = FT012_AMSIIRENAIKA.oldValue * -1;#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoOld = 0;#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoOld = FT012_QTJITSUNYUKO.oldValue * -1;#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoOld = 0;#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'10');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;FT020_DTNYUKA.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;FT012_NRLOCATION.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT012_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;FT012_TXLOTNUMBER.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;//////////////////////////// 黒伝処理 //////////////////////////////////#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (FT012_QTJITSUSIIRE.value > 0) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;dtNendNew = session.getFYearOfDate(FT020_DTNYUKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;dtMSeqNew = session.getMSeqOfDate(FT020_DTNYUKA.value);#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 仕入実績(CT100)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;'00');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;FT020_DTNYUKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT012_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020A_TXSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;FT012_PRSIIRE.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;FT012_QTJITSUSIIRE.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;FT012_KBSIIREUM1.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;FT012_PRSIIRE.value * FT012_QTJITSUSIIRE.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;FT012_AMTAX.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 各種受払額の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoNew = FT012_AMSIIRENAIKA.value;#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoNew = 0;#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoNew = FT012_QTJITSUNYUKO.value;#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoNew = 0;#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'10');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;FT020_DTNYUKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;FT012_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT012_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;FT012_TXLOTNUMBER.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;FT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;//////////////////////////// 残高更新 //////////////////////////////////#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;FT012_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;FT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) - Number(qtNyukoOld) + Number(qtNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) - Number(amNyukoOld) + Number(amNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) - Number(qtSyukkoOld) + Number(qtSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) - Number(amSyukkoOld) + Number(amSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('NRLOCATION',&#x9;FT012_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;FT012_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;FT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT012_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;FT012_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyukoNew - amNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukkoNew - amSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyukoNew - qtNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukkoNew - qtSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020A_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020A_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 仕入先マスター(CT010)の買掛残高更新 //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;amKeijyouUpdated = Number(rCT010.getValueOf('AMKEIJYOU'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; - Number(FT012_AMSIIREGAIKA.oldValue) - Number(FT012_AMTAX.oldValue)#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(FT012_AMSIIREGAIKA.value) + Number(FT012_AMTAX.value);#EOL#&#x9;&#x9;&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}"/><Script EventP="BD" EventR="BR()" Function="" Name="削除妥当性チェック" Order="0070" Text="if (FT012_NRNYUKA.value != '') {#EOL#&#x9;FT012_NRHATTYU.error = '削除するには、関連する入荷指示から切り離す必要があります。';#EOL#}"/><Field Decimal="2" ID="AMSIIREGAIKA" Name="外貨仕入額" Nullable="T" Order="0200" Remarks="実際仕入数×仕入単価（取引通貨建）" Size="11" Type="DECIMAL" TypeOptions="VIRTUAL"/><Field ID="AMSIIRENAIKA" Name="内貨仕入額" Nullable="T" Order="0210" Remarks="実際仕入数×仕入単価（取引通貨建）×為替レート" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="AMTAX" Name="消費税額" Nullable="T" Order="0220" Remarks="内貨仕入額×入荷日基準の消費税率。国内取引先の場合に設定される。" Size="7" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="FGWORK" Name="実際仕入数の初期化用ワーク" Nullable="T" Order="0230" Size="1" Type="CHAR" TypeOptions="VIRTUAL"/><Field ID="VLKANZANKEISU" Name="単位換算係数" NoUpdate="T" Nullable="F" Order="0170" Remarks="範囲検索されたCT011から設定される" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ColumnName="U/M" ID="KBSIIREUM1" Name="仕入単位区分" NoUpdate="T" Nullable="F" Order="0160" Remarks="範囲検索されたCT011から設定される" Size="5" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBZAIKOUM)"/><Field ColumnName="U/M" ID="KBSIIREUM2" Name="仕入単位区分" NoUpdate="T" Nullable="F" Order="0161" Remarks="範囲検索されたCT011から設定される" Size="5" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBZAIKOUM)"/><Field ColumnName="U/M" ID="KBSIIREUM3" Name="仕入単位区分" NoUpdate="T" Nullable="F" Order="0162" Remarks="範囲検索されたCT011から設定される" Size="5" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBZAIKOUM)"/></Table><Table ActiveWhere="" ID="GT010" Name="受注見出し" RangeKey="" Remarks="顧客からの受注情報を保持するためのテーブル。１件の受注において複数の品目を扱える。" SubsystemID="G"><Field Decimal="" ID="NRJYUTYU" Name="受注№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRJYUTYU)"/><Field Decimal="" ID="DTJYUTYU" Name="受注日" Nullable="F" Order="0020" Remarks="" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0030" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQSYUKKASAKI" Name="出荷先行番" Nullable="F" Order="0040" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0070" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Key Fields="NRJYUTYU" Type="PK"/><Refer Fields="TXKANJI" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="GT010.NRTORIHIKISAKI"/><Refer Fields="CDKAKERITSURANK;TXTANTOUBUSYO;TXTANTOUSYA;NRTANTOUJYUGYOIN" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="GT010.NRTORIHIKISAKI"/><Refer Fields="TXKANJI;VLUNSOULT;NRYUBIN;TXJYUSYO" Order="0050" TableAlias="" ToKeyFields="NRTORIHIKISAKI;SQSYUKKASAKI" ToTable="DT011" WithKeyFields="GT010.NRTORIHIKISAKI;GT010.SQSYUKKASAKI"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="更新前設定" Order="0030" Text="GT010_NRTORIHIKISAKI.editable = false;#EOL#GT010_STJYUTYU.editable = false;#EOL#GT010_NRMITSUMORI.editable = false;#EOL#GT010_SQVERSION.editable = false;#EOL##EOL#if (GT010_CTSYUKKAMEISAI.value > 0 &amp;&amp; GT010_DTTORIKESHI.value != '') {#EOL#&#x9;GT010_DTTORIKESHI.error = '受注を取り消すためには、出荷予定をすべて削除する必要があります。';#EOL#}"/><Field ID="STJYUTYU" Name="受注状況" Nullable="F" Order="0120" Remarks="" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STJYUTYU)"/><Refer Fields="TXKAKERITSURANK;VLKAKERITSU" Order="0030" TableAlias="" ToKeyFields="CDKAKERITSURANK" ToTable="DT020" WithKeyFields="DT010.CDKAKERITSURANK"/><Script EventP="BC" EventR="BR()" Function="" Name="追加前設定" Order="0020" Text="GT010_DTJYUTYU.value = session.getToday() + '';#EOL#GT010_STJYUTYU.editable = false;#EOL#GT010_DTTORIKESHI.editable = false;#EOL#GT010_NRMITSUMORI.editable = false;#EOL#GT010_SQVERSION.editable = false;#EOL#"/><Field ID="TXTYUBAN" Name="顧客注文番号" Nullable="T" Order="0050" Size="15" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="DTKIBOUNOUKI" Name="希望納期省略値" Nullable="T" Order="0110" Remarks="受注明細に対する希望納期省略値。追加時にのみパネル上で入力される" Size="10" Type="DATE" TypeOptions="VIRTUAL"/><Field ID="NRSOUKO" Name="出荷予定倉庫№" Nullable="F" Order="0060" Remarks="出荷明細上の出荷倉庫の初期値となる" Size="5" Type="CHAR" TypeOptions=""/><Refer Fields="TXSOUKO" Order="0060" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="GT010.NRSOUKO"/><Refer Fields="TXKANJI" Order="0040" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Script EventP="AR" EventR="BR()" Function="" Name="読取時設定(GF016)" Order="0040" Text="if (instance.functionID == 'GF016' &amp;&amp; GT010_TXTYUBAN.value == '') {#EOL#&#x9;GT010_TXTYUBAN.value = GT010_NRJYUTYU.value;#EOL#}"/><Script EventP="AR" EventR="BR()" Function="" Name="受注状況設定" Order="0010" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rGT011; var rGT012;#EOL#var qtYotei = 0; var qtKanryo = 0;#EOL##EOL#//////////////////////////////////////////#EOL#// 受注状況と出荷明細の初期値を設定する //#EOL#//////////////////////////////////////////#EOL#GT010_STJYUTYU.value = '10'; //未出荷//#EOL#GT010_CTSYUKKAMEISAI.value = 0;#EOL##EOL#//////////////////////////////////////////#EOL#// 取消日が設定されていれば取消済とする //#EOL#//////////////////////////////////////////#EOL#if (GT010_DTTORIKESHI.value != '') {#EOL#&#x9;GT010_STJYUTYU.value = '99'; //取消済//#EOL#} else {#EOL##EOL#&#x9;/////////////////////////////////////////////////////#EOL#&#x9;// 関連レコード(GT011,GT012)の集計と受注状況の設定 //#EOL#&#x9;/////////////////////////////////////////////////////#EOL#&#x9;rGT011 = instance.createTableOperator('Select', 'GT011');#EOL#&#x9;rGT011.setSelectFields('SQJYUTYU');#EOL#&#x9;rGT011.addKeyValue('NRJYUTYU',&#x9;GT010_NRJYUTYU.value);#EOL#&#x9;while (rGT011.next()) {#EOL#&#x9;&#x9;rGT012 = instance.createTableOperator('Select', 'GT012');#EOL#&#x9;&#x9;rGT012.setSelectFields('NRSYUKKA, QTYOTEISYUKKA, QTJITSUSYUKKA, QTTORIKESHI');#EOL#&#x9;&#x9;rGT012.addKeyValue('NRJYUTYU',&#x9;GT010_NRJYUTYU.value);#EOL#&#x9;&#x9;rGT012.addKeyValue('SQJYUTYU',&#x9;rGT011.getValueOf('SQJYUTYU'));#EOL#&#x9;&#x9;while (rGT012.next()) {#EOL#&#x9;&#x9;&#x9;if (rGT012.getValueOf('NRSYUKKA').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;GT010_STJYUTYU.value = '20'; //出荷残あり//#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;qtYotei = Number(qtYotei) + Number(rGT012.getValueOf('QTYOTEISYUKKA'));#EOL#&#x9;&#x9;&#x9;qtKanryo = Number(qtKanryo) + Number(rGT012.getValueOf('QTJITSUSYUKKA')) + Number(rGT012.getValueOf('QTTORIKESHI'));#EOL#&#x9;&#x9;&#x9;GT010_CTSYUKKAMEISAI.value++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;if (qtKanryo >= qtYotei &amp;&amp; qtYotei > 0) {#EOL#&#x9;&#x9;GT010_STJYUTYU.value = '30'; //出荷完了//#EOL#&#x9;}#EOL#}"/><Field ID="DTTORIKESHI" Name="取消日" Nullable="T" Order="0080" Size="10" Type="DATE" TypeOptions=""/><Field ID="CTSYUKKAMEISAI" Name="出荷明細件数" Nullable="F" Order="0130" Size="3" Type="SMALLINT" TypeOptions="VIRTUAL"/><Field Decimal="" ID="NRMITSUMORI" Name="見積№" Nullable="T" Order="0090" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQVERSION" Name="見積版№" Nullable="T" Order="0100" Size="2" Type="SMALLINT" TypeOptions=""/><Script EventP="AC" EventR="" Function="" Name="追加時の見積明細複写処理" Order="0050" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rGT031; var cGT011; var cGT012; var cET200; var rET010; var cET010; var rBT020;#EOL#var count; var nrTorihikikanri; var errorMessage = '';#EOL##EOL#//////////////////////////////////////////////////////////////////////#EOL#// 見積№がブランクでなければ見積明細を検索して関連データを追加する //#EOL#//////////////////////////////////////////////////////////////////////#EOL#if (GT010_NRMITSUMORI != '') {#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 見積明細(GT031)の検索 //#EOL#&#x9;///////////////////////////#EOL#&#x9;rGT031 = instance.createTableOperator('Select', 'GT031');#EOL#&#x9;rGT031.addKeyValue('NRMITSUMORI',&#x9;GT010_NRMITSUMORI.value);#EOL#&#x9;rGT031.addKeyValue('SQVERSION',&#x9;&#x9;GT010_SQVERSION.value);#EOL#&#x9;while (rGT031.next()) {#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 受注明細(GT011)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;cGT011 = instance.createTableOperator('Insert', 'GT011');#EOL#&#x9;&#x9;cGT011.addValue('NRJYUTYU',&#x9;&#x9;&#x9;GT010_NRJYUTYU.value);#EOL#&#x9;&#x9;cGT011.addValue('SQJYUTYU',&#x9;&#x9;&#x9;rGT031.getValueOf('SQMITSUMORI'));#EOL#&#x9;&#x9;cGT011.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rGT031.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;cGT011.addValue('PRJYUTYU',&#x9;&#x9;&#x9;rGT031.getValueOf('PRJYUTYU'));#EOL#&#x9;&#x9;cGT011.addValue('QTJYUTYU',&#x9;&#x9;&#x9;rGT031.getValueOf('QTJYUTYU'));#EOL#&#x9;&#x9;cGT011.addValue('DTKIBOUNOUKI',&#x9;&#x9;rGT031.getValueOf('DTKIBOUNOUKI'));#EOL#&#x9;&#x9;cGT011.addValue('TXTEKIYO',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cGT011.addValue('NRTORIHIKISAKI',&#x9;GT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;count = cGT011.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受注明細(GT011)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////////#EOL#&#x9;&#x9;// 出荷明細(GT012)のデフォルトレコードの追加 //#EOL#&#x9;&#x9;///////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;nrTorihikikanri = session.getNextNumber('NRTORIHIKIKANRI');#EOL#&#x9;&#x9;&#x9;cGT012 = instance.createTableOperator('Insert', 'GT012');#EOL#&#x9;&#x9;&#x9;cGT012.addValue('NRJYUTYU',&#x9;&#x9;&#x9;GT010_NRJYUTYU.value);#EOL#&#x9;&#x9;&#x9;cGT012.addValue('SQJYUTYU',&#x9;&#x9;&#x9;rGT031.getValueOf('SQMITSUMORI'));#EOL#&#x9;&#x9;&#x9;cGT012.addValue('SQSYUKKA',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;cGT012.addValue('DTYOTEISYUKKA',&#x9;rGT031.getValueOf('DTKIBOUNOUKI'));#EOL#&#x9;&#x9;&#x9;cGT012.addValue('QTYOTEISYUKKA',&#x9;rGT031.getValueOf('QTJYUTYU'));#EOL#&#x9;&#x9;&#x9;cGT012.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cGT012.addValue('NRSYUKKA',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cGT012.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#&#x9;&#x9;&#x9;count = cGT012.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '出荷明細(GT012)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////////#EOL#&#x9;&#x9;// 出荷明細に対応する受払予定(ET200)の追加 //#EOL#&#x9;&#x9;/////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;&#x9;&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#&#x9;&#x9;&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'20');#EOL#&#x9;&#x9;&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;rGT031.getValueOf('DTKIBOUNOUKI'));#EOL#&#x9;&#x9;&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;GT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rGT031.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;rGT031.getValueOf('QTJYUTYU'));#EOL#&#x9;&#x9;&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;GT010_NRJYUTYU.value + '-' + rGT031.getValueOf('SQMITSUMORI') + '-1');#EOL#&#x9;&#x9;&#x9;count = cET200.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 倉庫在庫(ET010)初期レコードの追加（存在していなければ）//#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;rGT031.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;GT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;&#x9;rBT020 = instance.createTableOperator('Select', 'BT020');#EOL#&#x9;&#x9;&#x9;&#x9;rBT020.setSelectFields('QTANZENZAIKO, QTJYOUGENZAIKO');#EOL#&#x9;&#x9;&#x9;&#x9;rBT020.addKeyValue('NRSYOHIN',&#x9;rGT031.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;if (rBT020.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rGT031.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;rBT020.getValueOf('QTANZENZAIKO'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;rBT020.getValueOf('QTJYOUGENZAIKO'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Key Fields="NRMITSUMORI;SQVERSION" Type="XK"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0060" Text="var rGT011 = instance.createTableOperator('Count', 'GT011');#EOL#rGT011.addKeyValue('NRJYUTYU',&#x9;GT010_NRJYUTYU.value);#EOL#if (rGT011.execute() > 0) {#EOL#&#x9;GT010_NRJYUTYU.error = '受注明細をともなうため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="GT012" Name="出荷明細" RangeKey="" Remarks="顧客への納期回答情報を保持するためのテーブル。１件の受注明細レコードに、複数の出荷明細レコードが対応する。" SubsystemID="G"><Field Decimal="" ID="NRJYUTYU" Name="受注№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQJYUTYU" Name="受注行" Nullable="F" Order="0020" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="SQSYUKKA" Name="出荷行" Nullable="F" Order="0030" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="NRSOUKO" Name="出荷倉庫№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="DTYOTEISYUKKA" Name="予定出荷日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="QTYOTEISYUKKA" Name="出荷指示数" Nullable="F" Order="0060" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="NRSYUKKA" Name="出荷№" Nullable="T" Order="0100" Size="7" Type="CHAR" TypeOptions=""/><Key Fields="NRJYUTYU;SQJYUTYU;SQSYUKKA" Type="PK"/><Refer Fields="NRTORIHIKISAKI;SQSYUKKASAKI;TXTYUBAN" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRJYUTYU" ToTable="GT010" WithKeyFields="GT012.NRJYUTYU"/><Refer Fields="NRSYOHIN;PRJYUTYU;QTJYUTYU;DTKIBOUNOUKI;NRTORIHIKISAKI" Order="0020" TableAlias="" ToKeyFields="NRJYUTYU;SQJYUTYU" ToTable="GT011" WithKeyFields="GT012.NRJYUTYU;GT012.SQJYUTYU"/><Refer Fields="TXKANJI;TXKANA" Order="0030" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="GT010.NRTORIHIKISAKI"/><Refer Fields="TXSOUKO" Order="0060" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="GT012.NRSOUKO"/><Script EventP="AD" EventR="" Function="" Name="削除後の受払予定設定" Order="0080" Text="///////////////////////////#EOL#// 受払予定(ET200)の削除 //#EOL#///////////////////////////#EOL#var dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#dET200.execute();"/><Script EventP="AC" EventR="" Function="" Name="追加後の受払予定設定" Order="0060" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var cET200; var rET010; var cET010;#EOL#var count; var errorMessage = '';#EOL##EOL#///////////////////////////#EOL#// 受払予定(ET200)の追加 //#EOL#///////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'20');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;GT012_DTYOTEISYUKKA.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;GT010_NRTORIHIKISAKI.value);#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT012_NRSOUKO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;GT012_QTYOTEISYUKKA.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;GT012_NRJYUTYU.value + '-' + GT012_SQJYUTYU.value + '-' + GT012_SQSYUKKA.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////////////////////////////////#EOL#// 倉庫在庫(ET010)初期レコードの追加（存在していなければ）//#EOL#////////////////////////////////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;rET010.addKeyValue('NRSOUKO',&#x9;GT012_NRSOUKO.value);#EOL#&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT012_NRSOUKO.value);#EOL#&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL#"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM;FGLOTKANRI;QTANZENZAIKO;QTJYOUGENZAIKO;TXIMAGEFILENAME;PRHANBAI" Order="0070" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="GT011.NRSYOHIN"/><Refer Fields="DTSYUKKA;TMKANRYO" Order="0080" TableAlias="" ToKeyFields="NRSYUKKA" ToTable="GT020" WithKeyFields="GT012.NRSYUKKA"/><Refer Fields="TXKANJI" Order="0050" TableAlias="" ToKeyFields="NRTORIHIKISAKI;SQSYUKKASAKI" ToTable="DT011" WithKeyFields="GT010.NRTORIHIKISAKI;GT010.SQSYUKKASAKI"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="出荷明細切り離しのための設定(GF043)" Order="0040" Text="if (instance.functionID == 'GF043') {#EOL#&#x9;GT012_NRTORIHIKIKANRI.editable = false;#EOL#&#x9;GT012_NRSYUKKA.editable = false;#EOL#&#x9;GT012_NRSOUKO.editable = false;#EOL#&#x9;GT012_QTYOTEISYUKKA.editable = false;#EOL#&#x9;GT012_DTYOTEISYUKKA.editable = false;#EOL#&#x9;GT012_QTJITSUSYUKKA.editable = false;#EOL##EOL#&#x9;if (GT012_QTJITSUSYUKKA.value > 0) {#EOL#&#x9;&#x9;GT012_QTJITSUSYUKKA.error = '登録されている実際出荷数をクリアしたうえで再試行してください。';#EOL#&#x9;} else {#EOL#&#x9;&#x9;GT012_NRSYUKKA.value = '';#EOL#&#x9;}#EOL#}"/><Key Fields="NRSYUKKA" Type="XK"/><Refer Fields="NRLOCATION;QTKISYUZAIKO;QTNYUKO;QTSYUKKO;AMKISYUZAIKO;AMNYUKO;AMSYUKKO" Optional="T" Order="0090" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="GT011.NRSYOHIN;GT012.NRSOUKO"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="更新前設定" Order="0030" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#GT012_QTJITSUSYUKKA.editable = false;#EOL#GT012_QTTORIKESHI.editable = false;#EOL#GT012_NRSYUKKA.editable = false;#EOL#if ((instance.functionID == 'GF015' &amp;&amp; GT012_NRSYUKKA.value != '') || instance.functionID == 'GF020') {#EOL#&#x9;GT012_NRSOUKO.editable = false;#EOL#&#x9;GT012_DTYOTEISYUKKA.editable = false;#EOL#&#x9;GT012_QTYOTEISYUKKA.editable = false;#EOL#&#x9;GT012_TXZAIKOCHECK.editable = false;#EOL#}#EOL##EOL#////////////////#EOL#// 妥当性検査 //#EOL#////////////////#EOL#if (instance.functionID == 'GF030') {#EOL#&#x9;GT012_QTYOTEISYUKKA.editable = false;#EOL#&#x9;GT012_QTJITSUSYUKKA.editable = true;#EOL#&#x9;GT012_QTTORIKESHI.editable = true;#EOL#&#x9;var goukei = Number(GT012_QTJITSUSYUKKA.value) + Number(GT012_QTTORIKESHI.value);#EOL#&#x9;if (goukei != GT012_QTYOTEISYUKKA.value &amp;&amp; goukei > 0) {#EOL#&#x9;&#x9;GT012_QTJITSUSYUKKA.error = '出荷実際数と取消数の合計(' + goukei + ')が、指示数(' + GT012_QTYOTEISYUKKA.value + ')と一致しません。';#EOL#&#x9;}#EOL##EOL#&#x9;if (BT020_FGLOTKANRI.value == 'T') {#EOL#&#x9;&#x9;GT012_TXLOTNUMBER.editable = true;#EOL#&#x9;&#x9;if (GT012_TXLOTNUMBER.value == '' &amp;&amp; GT012_QTJITSUSYUKKA.value > 0) {#EOL#&#x9;&#x9;&#x9;GT012_TXLOTNUMBER.error = 'ロット管理品です。ロット№を入力してください。';#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;GT012_TXLOTNUMBER.editable = false;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////#EOL#// 実際出庫数と出庫単価の設定 //#EOL#////////////////////////////////#EOL#if (instance.functionID == 'GF030') {#EOL#&#x9;if (GT012_QTJITSUSYUKKA.value == 0 &amp;&amp; GT012_QTTORIKESHI.value == 0 &amp;&amp; GT012_FGWORK.value == '') {#EOL#&#x9;&#x9;GT012_QTJITSUSYUKKA.value = GT012_QTYOTEISYUKKA.value;#EOL#&#x9;}#EOL#&#x9;GT012_FGWORK.value = 'T';#EOL##EOL#&#x9;var qtGenzaiko = Number(ET010_QTKISYUZAIKO.value) + Number(ET010_QTNYUKO.value) - Number(ET010_QTSYUKKO.value);#EOL#&#x9;var amGenzaiko = Number(ET010_AMKISYUZAIKO.value) + Number(ET010_AMNYUKO.value) - Number(ET010_AMSYUKKO.value);#EOL#&#x9;if (qtGenzaiko != 0) {#EOL#&#x9;&#x9;GT012_PRSYUKKO.value = Math.round(amGenzaiko / qtGenzaiko);#EOL#&#x9;}#EOL#}#EOL#"/><Field Decimal="" ID="QTTORIKESHI" Name="出荷取消数" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Script EventP="AU" EventR="" Function="" Name="更新後の受払予定設定" Order="0070" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var dET200; var cET200; var rET010; var cET010;#EOL#var dtSyukka; var errorMessage = '';#EOL##EOL#///////////////////////////#EOL#// 受払予定(ET200)の削除 //#EOL#///////////////////////////#EOL#dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#dET200.execute();#EOL##EOL#//////////////////////////////#EOL#// 出荷実績が未登録であれば //#EOL#//////////////////////////////#EOL#if (GT012_QTYOTEISYUKKA.value != Number(GT012_QTJITSUSYUKKA.value) + Number(GT012_QTTORIKESHI.value)) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 出荷予定日と出荷残数の設定 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;dtSyukka = GT012_DTYOTEISYUKKA.value; //出荷明細上の出荷予定日//#EOL#&#x9;if (GT020_DTSYUKKA.value != '') {#EOL#&#x9;&#x9;dtSyukka = GT020_DTSYUKKA.value; //出荷指示上の出荷指示日//#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払予定(ET200)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'20');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;dtSyukka);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;GT010_NRTORIHIKISAKI.value);#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT012_NRSOUKO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;GT012_QTYOTEISYUKKA.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;GT012_NRJYUTYU.value + '-' + GT012_SQJYUTYU.value + '-' + GT012_SQSYUKKA.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;// 倉庫在庫(ET010)初期レコードの追加（存在していなければ）//#EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;GT012_NRSOUKO.value);#EOL#&#x9;&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT012_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="TXZAIKOCHECK" Name="在庫状況" Nullable="T" Order="0140" Remarks="'Click to check'の固定値が設定される仮想フィールド。在庫状況一覧を起動するボタンを表示するためのもの" Size="14" Type="CHAR" TypeOptions="VIRTUAL"/><Script EventP="BC;BU;AR" EventR="AR()" Function="" Name="仮想フィールドの設定" Order="0020" Text="//////////////////////////////////#EOL#// 在庫チェック用ボタンの固定値 //#EOL#//////////////////////////////////#EOL#GT012_TXZAIKOCHECK.value = 'Click to Check';#EOL##EOL#//////////////////////////#EOL#// 売上額と消費税の設定 //#EOL#//////////////////////////#EOL#if (GT012_NRSYUKKA.value != '') {#EOL#&#x9;GT012_AMURIAGE.value = GT011_PRJYUTYU.value * GT012_QTJITSUSYUKKA.value;#EOL#&#x9;GT012_AMTAX.value = session.getTaxAmount(GT020_DTSYUKKA.value, GT012_AMURIAGE.value);#EOL#&#x9;GT012_AMURIAGE.oldValue = GT011_PRJYUTYU.value * GT012_QTJITSUSYUKKA.oldValue;#EOL#&#x9;GT012_AMTAX.oldValue = session.getTaxAmount(GT020_DTSYUKKA.oldValue, GT012_AMURIAGE.oldValue);#EOL#}#EOL##EOL#////////////////////#EOL#// ロット№の設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'GF021A') {#EOL#&#x9;if (BT020_FGLOTKANRI.value == 'F') {#EOL#&#x9;&#x9;GT012_TXLOTNUMBER.value = '記載不要';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////////#EOL#// 顧客注文番号と分納マークの設定 //#EOL#////////////////////////////////////#EOL#if (instance.functionID == 'GF032A') {#EOL#&#x9;if (GT010_TXTYUBAN.value == '') {#EOL#&#x9;&#x9;GT010_TXTYUBAN.value = GT012_NRJYUTYU.value;#EOL#&#x9;}#EOL##EOL#&#x9;var order = 0; var count = 0;#EOL#&#x9;var rGT012 = instance.createTableOperator('Select', 'GT012');#EOL#&#x9;rGT012.addKeyValue('NRJYUTYU',&#x9;GT012_NRJYUTYU.value);#EOL#&#x9;rGT012.addKeyValue('SQJYUTYU',&#x9;GT012_SQJYUTYU.value);#EOL#&#x9;rGT012.setOrderBy('DTYOTEISYUKKA');#EOL#&#x9;while (rGT012.next()) {#EOL#&#x9;&#x9;count++;#EOL#&#x9;&#x9;if (rGT012.getValueOf('SQSYUKKA') == GT012_SQSYUKKA.value) {#EOL#&#x9;&#x9;&#x9;order = count;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;GT012_TXBUNNOU.value = order + '/' + count;#EOL#}"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0110" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0090" Remarks="ロット管理品の場合、入力必須" Size="40" Type="CHAR" TypeOptions=""/><Field ID="TXBUNNOU" Name="分納マーク" Nullable="T" Order="0150" Remarks="納品書の明細項目として出力される。関連する受注明細１件あたりに２件の出荷明細が存在してその２件目であれば 2/2 のように設定される。多くの場合は 1/1 で、最大値は 99/99 となる。" Size="5" Type="CHAR" TypeOptions="VIRTUAL"/><Field ID="AMTAX" Name="消費税額" Nullable="T" Order="0130" Remarks="売上額×出荷日基準の消費税率" Size="7" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="QTJITSUSYUKKA" Name="実際出荷数" Nullable="T" Order="0070" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMURIAGE" Name="税抜売上額" Nullable="T" Order="0120" Remarks="受注単価×実際出荷数" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Script EventP="AU" EventR="" Function="" Name="売掛・在庫計上処理(GF030)" Order="0081" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var rDT100; var uDT100; var cDT100;#EOL#var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;  #EOL#var dtNendNew = 0; var dtMSeqNew = 0; var dtNendOld = 0; var dtMSeqOld = 0;#EOL#var amNyukoNew = 0; var amSyukkoNew = 0; var amNyukoOld = 0; var amSyukkoOld = 0;#EOL#var qtNyukoNew = 0; var qtSyukkoNew = 0; var qtNyukoOld = 0; var qtSyukkoOld = 0;#EOL#var qtNyukoUpdated = 0; var amNyukoUpdated = 0; var qtSyukkoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var amKeijyouUpdated = 0; var errorMessage = ''; var count = 0; var amSagaku = 0;#EOL##EOL#///////////////////////////////////////////#EOL#// 出荷実績エントリー(GF030)において実行 //#EOL#///////////////////////////////////////////#EOL#if (instance.functionID == 'GF030') {#EOL##EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;// 関連フィールド値が変更された場合に実行 //#EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;if (GT012_QTJITSUSYUKKA.valueChanged || GT012_TXLOTNUMBER.valueChanged || GT020_DTSYUKKA.valueChanged) {#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する顧客マスター(DT010)の検索 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#&#x9;&#x9;rDT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#&#x9;&#x9;rDT010.addKeyValue('NRTORIHIKISAKI', GT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;if (rDT010.next()) {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;//////////////////////////// 赤伝処理 //////////////////////////////////#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (GT012_QTJITSUSYUKKA.oldValue > 0) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;dtNendOld = session.getFYearOfDate(GT020_DTSYUKKA.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;dtMSeqOld = session.getMSeqOfDate(GT020_DTSYUKKA.oldValue);#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 関連する売上実績(DT100)の失効処理 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;rDT100.setSelectFields('NRURIAGE, NRSEIKYU, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;rDT100.addKeyValue('NRTORIHIKIKANRI', GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (rDT100.getValueOf('NRSEIKYU').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する売上実績が請求処理されているため、取消処理はキャンセルされます。関連する請求指示(' + rDT100.getValueOf('NRSEIKYU') + ')から当該の売上実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addValue('FGVALID','F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addValue('UPDCOUNTER',Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 売上実績(DT100)の追加（赤伝）//#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'00');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;GT020_DTSYUKKA.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;GT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;BT020_PRHANBAI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;GT011_PRJYUTYU.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;GT012_QTJITSUSYUKKA.oldValue * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;BT020_KBZAIKOUM.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;GT012_AMURIAGE.oldValue * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;GT012_AMTAX.oldValue * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;GT012_PRSYUKKO.oldValue * GT012_QTJITSUSYUKKA.oldValue * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;DT010_NRTANTOUJYUGYOIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 各種受払額の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoOld = 0;#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoOld = GT012_PRSYUKKO.oldValue * GT012_QTJITSUSYUKKA.oldValue * -1;#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoOld = 0;#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoOld = GT012_QTJITSUSYUKKA.oldValue * -1;#EOL#&#x9;&#x9;&#x9;&#x9;amSagaku = (Number(GT012_AMURIAGE.oldValue) + Number(amSyukkoOld)) * -1#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'20');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;GT020_DTSYUKKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;GT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;GT020_SQSYUKKASAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;GT012_TXLOTNUMBER.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagaku);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;//////////////////////////// 黒伝処理 //////////////////////////////////#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (GT012_QTJITSUSYUKKA.value > 0) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;dtNendNew = session.getFYearOfDate(GT020_DTSYUKKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;dtMSeqNew = session.getMSeqOfDate(GT020_DTSYUKKA.value);#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 売上実績(DT100)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'00');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;GT020_DTSYUKKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;GT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;BT020_PRHANBAI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;GT011_PRJYUTYU.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;GT012_QTJITSUSYUKKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;BT020_KBZAIKOUM.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;GT012_AMURIAGE.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;GT012_AMTAX.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;GT012_PRSYUKKO.value * GT012_QTJITSUSYUKKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;DT010_NRTANTOUJYUGYOIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 各種受払額の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoNew = 0;#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoNew = GT012_PRSYUKKO.value * GT012_QTJITSUSYUKKA.value;#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoNew = 0;#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoNew = GT012_QTJITSUSYUKKA.value;#EOL#&#x9;&#x9;&#x9;&#x9;amSagaku = GT012_AMURIAGE.value - amSyukkoNew;#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'20');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;GT020_DTSYUKKA.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;GT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;GT020_SQSYUKKASAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;GT012_TXLOTNUMBER.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagaku);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;GT012_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;//////////////////////////// 残高更新 //////////////////////////////////#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;GT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) - Number(qtNyukoOld) + Number(qtNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) - Number(amNyukoOld) + Number(amNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) - Number(qtSyukkoOld) + Number(qtSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) - Number(amSyukkoOld) + Number(amSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;GT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyukoNew - amNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukkoNew - amSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyukoNew - qtNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukkoNew - qtSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 顧客マスター(DT010)の買掛残高更新 //#EOL#&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;amKeijyouUpdated = Number(rDT010.getValueOf('AMKEIJYOU'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; - Number(GT012_AMURIAGE.oldValue) - Number(GT012_AMTAX.oldValue)#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(GT012_AMURIAGE.value) + Number(GT012_AMTAX.value);#EOL#&#x9;&#x9;&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;GT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '顧客マスタ(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客マスタが存在しません。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}"/><Refer Fields="NRTANTOUJYUGYOIN" Order="0040" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="GT010.NRTORIHIKISAKI"/><Field Decimal="" ID="PRSYUKKO" Name="出庫単価" Nullable="T" Order="0081" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="FGWORK" Name="実際出荷数の初期化用ワーク" Nullable="T" Order="0151" Size="1" Type="CHAR" TypeOptions="VIRTUAL"/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="GT011" Name="受注明細" RangeKey="" Remarks="特定商品の受注情報を保持するためのテーブル。１件の受注見出しレコードに、複数の受注明細レコードが対応する。" SubsystemID="G"><Field Decimal="" ID="NRJYUTYU" Name="受注№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQJYUTYU" Name="受注行" Nullable="F" Order="0020" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="受注商品№" Nullable="F" Order="0030" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="PRJYUTYU" Name="受注単価" Nullable="F" Order="0040" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTJYUTYU" Name="受注数量" Nullable="F" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTSYUKKAZUMI" Name="出荷済数量" Nullable="T" Order="0100" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="DTKIBOUNOUKI" Name="希望納期" Nullable="F" Order="0070" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0080" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Key Fields="NRJYUTYU;SQJYUTYU" Type="PK"/><Refer Fields="NRTORIHIKISAKI;DTJYUTYU;NRSOUKO;SQSYUKKASAKI" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRJYUTYU" ToTable="GT010" WithKeyFields="GT011.NRJYUTYU"/><Refer Fields="TXSYOHIN;TXHINBAN;TXSIYOU;KBZAIKOUM;PRHANBAI;QTHANBAIUNIT;QTANZENZAIKO;QTJYOUGENZAIKO;TXIMAGEFILENAME" Order="0060" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="GT011.NRSYOHIN"/><Refer Fields="CDKAKERITSURANK" Order="0030" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="GT010.NRTORIHIKISAKI"/><Refer Fields="VLKAKERITSU;TXKAKERITSURANK" Order="0050" TableAlias="" ToKeyFields="CDKAKERITSURANK" ToTable="DT020" WithKeyFields="DT010.CDKAKERITSURANK"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0090" Remarks="受注見出しからの継承（受注見出しでは変更禁止項目）。インデックスとして利用される" Size="8" Type="CHAR" TypeOptions=""/><Key Fields="NRTORIHIKISAKI" Type="XK"/><Script EventP="BC" EventR="AR()" Function="" Name="追加時設定" Order="0020" Text="////////////////////////////////////////////////////////#EOL#// 受注見出しの仕入先Ｃを受注明細の継承属性に設定する //#EOL#////////////////////////////////////////////////////////#EOL#GT011_NRTORIHIKISAKI.value = GT010_NRTORIHIKISAKI.value;#EOL##EOL#/////////////////////////////////////////////////////////////////////#EOL#// GF012において、見出し部分の希望納期を明細行の希望納期に設定する //#EOL#/////////////////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'GF012B') {#EOL#&#x9;if (GT011_DTKIBOUNOUKI.value == '') {#EOL#&#x9;&#x9;GT011_DTKIBOUNOUKI.value = GT010_DTKIBOUNOUKI.value;#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////#EOL#// 受注単価がゼロならば、標準売価を掛率で乗じて四捨五入した値を設定する //#EOL#//////////////////////////////////////////////////////////////////////////#EOL#if (GT011_PRJYUTYU.value == 0) {#EOL#&#x9;GT011_PRJYUTYU.value = Math.round(BT020_PRHANBAI.value * DT020_VLKAKERITSU.value);#EOL#}"/><Field Decimal="" ID="QTSYUKKAZAN" Name="出荷残数量" Nullable="T" Order="0110" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="AC" EventR="" Function="" Name="追加後の関連レコード追加" Order="0030" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var cGT012; var cET200; var rET010; var cET010;#EOL#var count; var nrTorihikikanri; var errorMessage = '';#EOL##EOL#/////////////////////////////////////////////#EOL#// 出荷明細(GT012)デフォルトレコードの追加 //#EOL#/////////////////////////////////////////////#EOL#nrTorihikikanri = session.getNextNumber('NRTORIHIKIKANRI');#EOL#cGT012 = instance.createTableOperator('Insert', 'GT012');#EOL#cGT012.addValue('NRJYUTYU',&#x9;&#x9;&#x9;GT011_NRJYUTYU.value);#EOL#cGT012.addValue('SQJYUTYU',&#x9;&#x9;&#x9;GT011_SQJYUTYU.value);#EOL#cGT012.addValue('SQSYUKKA',&#x9;&#x9;&#x9;1);#EOL#cGT012.addValue('DTYOTEISYUKKA',&#x9;GT011_DTKIBOUNOUKI.value);#EOL#cGT012.addValue('QTYOTEISYUKKA',&#x9;GT011_QTJYUTYU.value);#EOL#cGT012.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT010_NRSOUKO.value);#EOL#cGT012.addValue('NRSYUKKA',&#x9;&#x9;&#x9;'');#EOL#cGT012.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#count = cGT012.execute();#EOL#if (count != 1) {#EOL#&#x9;errorMessage = '出荷明細(GT012)の登録に失敗しました。処理はキャンセルされます。';#EOL#}#EOL##EOL#///////////////////////////////////////////#EOL#// 出荷明細に対する受払予定(ET200)の追加 //#EOL#///////////////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'20');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;GT011_DTKIBOUNOUKI.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;GT010_NRTORIHIKISAKI.value);#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT010_NRSOUKO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;GT011_QTJYUTYU.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;GT011_NRJYUTYU.value + '-' + GT011_SQJYUTYU.value + '-1');#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////////////////////////////////#EOL#// 倉庫在庫(ET010)初期レコードの追加（存在していなければ）//#EOL#////////////////////////////////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;rET010.addKeyValue('NRSOUKO',&#x9;GT010_NRSOUKO.value);#EOL#&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;GT011_NRSYOHIN.value);#EOL#&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;GT010_NRSOUKO.value);#EOL#&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="BC" EventR="BR()" Function="" Name="追加時変更不可設定" Order="0010" Text="GT011_NRJYUTYU.editable = false;#EOL#GT011_QTSYUKKAZUMI.editable = false;#EOL#GT011_QTSYUKKAZAN.editable = false;"/><Refer Fields="TXKANJI" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="GT010.NRTORIHIKISAKI"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールドの設定" Order="0011" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rGT012;#EOL#var qtKanryo = 0; var qtYotei = 0;#EOL##EOL#/////////////////////////////////#EOL#// 出荷明細(GT012)の読取と集計 //#EOL#/////////////////////////////////#EOL#rGT012 = instance.createTableOperator('Select', 'GT012');#EOL#rGT012.setSelectFields('QTYOTEISYUKKA, QTJITSUSYUKKA, QTTORIKESHI');#EOL#rGT012.addKeyValue('NRJYUTYU',&#x9;GT011_NRJYUTYU.value);#EOL#rGT012.addKeyValue('SQJYUTYU',&#x9;GT011_SQJYUTYU.value);#EOL#while (rGT012.next()) {#EOL#&#x9;qtYotei = Number(qtYotei) + Number(rGT012.getValueOf('QTYOTEISYUKKA'));#EOL#&#x9;qtKanryo = Number(qtKanryo) + Number(rGT012.getValueOf('QTJITSUSYUKKA')) + Number(rGT012.getValueOf('QTTORIKESHI'));#EOL#}#EOL##EOL#//////////////////////////////////#EOL#// 出荷済数量と出荷残数量の設定 //#EOL#//////////////////////////////////#EOL#GT011_QTSYUKKAZUMI.value = qtKanryo;#EOL#GT011_QTSYUKKAZAN.value = qtYotei - qtKanryo;"/><Script EventP="BC;BU" EventR="AR()" Function="" Name="受注数のまるめ検査" Order="0040" Text="var amari = GT011_QTJYUTYU.value % BT020_QTHANBAIUNIT.value;#EOL#if (GT011_QTJYUTYU.valueChanged &amp;&amp; amari != 0) {#EOL#   GT011_QTJYUTYU.error = '販売単位数の倍数を指定してください。';#EOL#}#EOL#"/><Refer Fields="TXKANJI;VLUNSOULT" Order="0040" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI;SQSYUKKASAKI" ToTable="DT011" WithKeyFields="GT010.NRTORIHIKISAKI;GT010.SQSYUKKASAKI"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0050" Text="var rGT012 = instance.createTableOperator('Count', 'GT012');#EOL#rGT012.addKeyValue('NRJYUTYU',&#x9;GT011_NRJYUTYU.value);#EOL#rGT012.addKeyValue('SQJYUTYU',&#x9;GT011_SQJYUTYU.value);#EOL#if (rGT012.execute() > 0) {#EOL#&#x9;GT011_NRJYUTYU.error = '出荷明細をともなうため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="FT020" Name="入荷見出し" RangeKey="" Remarks="仕入先からの入荷のまとまりを管理するためのテーブル。同一仕入先から同一のタイミングで入荷されたものであれば、異なる発注にもとづく商品でも、１件の入荷見出しレコードとしてまとめられる。" SubsystemID="F"><Field Decimal="" ID="NRNYUKA" Name="入荷№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRNYUKA)"/><Field ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0020" Size="8" Type="CHAR" TypeOptions=""/><Field ID="DTNYUKA" Name="入荷日" Nullable="F" Order="0030" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRSOUKO" Name="入荷倉庫№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Key Fields="NRNYUKA" Type="PK"/><Refer Fields="TXKANJI" Order="0020" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="FT020.NRTORIHIKISAKI"/><Script EventP="BU" EventR="BR()" Function="" Name="更新不可設定と妥当性検査" Order="0020" Text="//////////////////#EOL#// 更新不可設定 //#EOL#//////////////////#EOL#FT020_NRTORIHIKISAKI.editable = false;#EOL#FT020_NRSOUKO.editable = false;#EOL#FT020_STNYUKA.editable = false;#EOL##EOL#////////////////#EOL#// 妥当性検査 //#EOL#////////////////#EOL#FT020_DTNYUKA.error = session.getErrorOfAccountDate(FT020_DTNYUKA.value);#EOL#"/><Script EventP="BC" EventR="BR()" Function="" Name="追加レコード初期設定(FF021)" Order="0030" Text="/////////////////////////////////////////////////////#EOL#// 入荷指示エントリー(FF021)で処理される場合の設定 //#EOL#/////////////////////////////////////////////////////#EOL#if (instance.functionID == 'FF021') {#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 変更不可設定 //#EOL#&#x9;//////////////////#EOL#&#x9;FT020_NRTORIHIKISAKI.editable = false;#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// ブランク時のデフォルト値設定 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;if (FT020_DTNYUKA.value == '') {#EOL#&#x9;&#x9;FT020_DTNYUKA.value = session.getToday() + '';#EOL#&#x9;}#EOL#}"/><Refer Fields="TXSOUKO" Order="0030" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="FT020.NRSOUKO"/><Field ID="STNYUKA" Name="入荷状況" Nullable="T" Order="0060" Remarks="" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STNYUKA)"/><Script EventP="AR" EventR="AR()" Function="" Name="入荷状況設定" Order="0010" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rFT012; var qtnyuka = 0;#EOL##EOL#///////////////////////////////////////////////////////#EOL#// 入荷明細(FT012)の検収数にもとづいて入荷状況を設定 //#EOL#///////////////////////////////////////////////////////#EOL#FT020_STNYUKA.value = '20'; //検収済//#EOL#rFT012 = instance.createTableOperator('Select', 'FT012');#EOL#rFT012.setSelectFields('NRSYOHIN, NRHATTYU, SQHATTYU, SQNYUKA, QTJITSUSIIRE, QTDEFECT');#EOL#rFT012.addKeyValue('NRNYUKA',&#x9;FT020_NRNYUKA.value);#EOL#while (rFT012.next()) {#EOL#&#x9;qtnyuka  = Number(rFT012.getValueOf('QTJITSUSIIRE')) + Number(rFT012.getValueOf('QTDEFECT'));#EOL#&#x9;if (qtnyuka == 0) {#EOL#&#x9;&#x9;FT020_STNYUKA.value = '10'; //未検収//#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0040" Text="var rFT012 = instance.createTableOperator('Count', 'FT012');#EOL#rFT012.addKeyValue('NRNYUKA',&#x9;FT020_NRNYUKA.value);#EOL#if (rFT012.execute() > 0) {#EOL#&#x9;FT020_NRNYUKA.error = '入荷明細をともなうため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="BT020" Name="商品" RangeKey="" Remarks="扱い商品に関する情報を保持するためのテーブル。内部ＩＤ（内部商品№）をＰＫとし、変更可能な品番をＳＫとする。" SubsystemID="B"><Field ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSYOHIN)"/><Field ID="TXSYOHIN" Name="商品名" Nullable="F" Order="0020" Size="30" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXHINBAN" Name="品番" Nullable="F" Order="0030" Size="20" Type="CHAR" TypeOptions=""/><Field ID="TXSIYOU" Name="仕様" Nullable="T" Order="0040" Size="50" Type="CHAR" TypeOptions=""/><Field ID="TXIMAGEFILENAME" Name="外観" Nullable="T" Order="0050" Size="30" Type="CHAR" TypeOptions="IMAGE"/><Field ID="KBSYOHIN" Name="商品群" Nullable="F" Order="0060" Size="5" Type="CHAR" TypeOptions="KUBUN(KBSYOHIN)"/><Field ID="CDMAKER" Name="メーカーＣ" Nullable="F" Order="0070" Size="5" Type="CHAR" TypeOptions=""/><Field ID="PRHANBAI" Name="標準売価" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="PRSIIRE" Name="標準仕入価格" Nullable="T" Order="0090" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="PRARARI" Name="標準粗利" Nullable="T" Order="0170" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="KBZAIKOUM" Name="在庫単位区分" Nullable="F" Order="0110" Size="5" Type="CHAR" TypeOptions="KUBUN(KBZAIKOUM)"/><Field ID="QTHANBAIUNIT" Name="販売単位数" Nullable="F" Order="0120" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="FGLOTKANRI" Name="ロット管理対象" Nullable="F" Order="0150" Size="1" Type="CHAR" TypeOptions="BOOLEAN(T;F)"/><Field ID="FGLISTSYOHIN" Name="一覧検索対象" Nullable="F" Order="0160" Size="1" Type="CHAR" TypeOptions="BOOLEAN(T;F)"/><Key Fields="NRSYOHIN" Type="PK"/><Key Fields="TXHINBAN" Type="SK"/><Refer Fields="TXMAKERABR" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="BT010" WithKeyFields="BT020.CDMAKER"/><Script EventP="BC;BU;BD;AR" EventR="AR()" Name="粗利の設定" Order="0010" Text="BT020_PRARARI.value = BT020_PRHANBAI.value - BT020_PRSIIRE.value;#EOL#"/><Script EventP="BU" EventR="BR()" Name="更新時設定" Order="0030" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#BT020_PRARARI.editable = false;#EOL#BT020_KBZAIKOUM.editable = false;"/><Script EventP="BC" EventR="BR()" Function="" Name="追加時設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#BT020_PRARARI.editable = false;#EOL##EOL#//////////////////////#EOL#// デフォルト値設定 //#EOL#//////////////////////#EOL#if (BT020_TXHINBAN.value == '' &amp;&amp; BT020_TXSYOHIN.value == '') {#EOL#&#x9;BT020_QTHANBAIUNIT.value = 1;#EOL#&#x9;BT020_FGLISTSYOHIN.value = 'T';#EOL#&#x9;BT020_FGLOTKANRI.value = 'T';#EOL#}"/><Key Fields="CDMAKER" Type="XK"/><Field ID="QTANZENZAIKO" Name="安全在庫省略値" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="QTJYOUGENZAIKO" Name="上限在庫省略値" Nullable="F" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0040" Text="var rBT021 = instance.createTableOperator('Count', 'BT021');#EOL#rBT021.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rBT021.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存のセット構成によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rBT021 = instance.createTableOperator('Count', 'BT021');#EOL#rBT021.addKeyValue('NRCHILD',&#x9;BT020_NRSYOHIN.value);#EOL#if (rBT021.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存のセット構成によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT011 = instance.createTableOperator('Count', 'CT011');#EOL#rCT011.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rCT011.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の仕入先別商品明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rCT100 = instance.createTableOperator('Count', 'CT100');#EOL#rCT100.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rCT100.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の買掛増減履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rDT100 = instance.createTableOperator('Count', 'DT100');#EOL#rDT100.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rDT100.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の売掛増減履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET010 = instance.createTableOperator('Count', 'ET010');#EOL#rET010.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rET010.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の倉庫在庫によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET100 = instance.createTableOperator('Count', 'ET100');#EOL#rET100.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rET100.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の受払履歴によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rET200 = instance.createTableOperator('Count', 'ET200');#EOL#rET200.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rET200.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の受払予定によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT011 = instance.createTableOperator('Count', 'FT011');#EOL#rFT011.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rFT011.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の発注明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rFT012 = instance.createTableOperator('Count', 'FT012');#EOL#rFT012.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rFT012.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の入荷明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT011 = instance.createTableOperator('Count', 'GT011');#EOL#rGT011.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rGT011.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の受注明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rGT031 = instance.createTableOperator('Count', 'GT031');#EOL#rGT031.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rGT031.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の見積明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rHT020 = instance.createTableOperator('Count', 'HT020');#EOL#rHT020.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rHT020.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の特殊仕入によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#rJT020.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rJT020.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の特殊売上によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT011 = instance.createTableOperator('Count', 'KT011');#EOL#rKT011.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rKT011.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の棚卸指示明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT021 = instance.createTableOperator('Count', 'KT021');#EOL#rKT021.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rKT021.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の在庫移動指示明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rKT030 = instance.createTableOperator('Count', 'KT030');#EOL#rKT030.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rKT030.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の在庫振替によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rLT010 = instance.createTableOperator('Count', 'LT010');#EOL#rLT010.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rLT010.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存のセット指示によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rLT011 = instance.createTableOperator('Count', 'LT011');#EOL#rLT011.addKeyValue('NRCHILD',&#x9;BT020_NRSYOHIN.value);#EOL#if (rLT011.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存のセット指示構成明細によって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT030 = instance.createTableOperator('Count', 'YT030');#EOL#rYT030.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rYT030.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の商品別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT031 = instance.createTableOperator('Count', 'YT031');#EOL#rYT031.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rYT031.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の商品倉庫別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT041 = instance.createTableOperator('Count', 'YT041');#EOL#rYT041.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rYT041.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の仕入商品別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}#EOL##EOL#var rYT051 = instance.createTableOperator('Count', 'YT051');#EOL#rYT051.addKeyValue('NRSYOHIN',&#x9;BT020_NRSYOHIN.value);#EOL#if (rYT051.execute() > 0) {#EOL#&#x9;BT020_NRSYOHIN.error = '既存の顧客商品別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="FT011" Name="発注明細" RangeKey="" Remarks="特定商品の発注情報を保持するためのテーブル。１件の発注見出しレコードに、複数の発注明細レコードが対応する。" SubsystemID="F"><Field ID="NRHATTYU" Name="発注№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQHATTYU" Name="発注行" Nullable="F" Order="0020" Size="3" Type="SMALLINT" TypeOptions="NO_EDIT"/><Field ID="NRSYOHIN" Name="発注商品№" Nullable="F" Order="0030" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="2" ID="PRHATTYU" Name="発注単価" Nullable="F" Order="0040" Size="10" Type="DECIMAL" TypeOptions=""/><Field Decimal="" ID="QTHATTYU" Name="発注数量" Nullable="F" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTKIBOUNOUKI" Name="希望納期" Nullable="F" Order="0060" Size="10" Type="DATE" TypeOptions=""/><Field ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0070" Size="300" Type="VARCHAR" TypeOptions=""/><Key Fields="NRHATTYU;SQHATTYU" Type="PK"/><Refer Fields="DTHATTYU;NRTORIHIKISAKI;NRSOUKO;FGKAKUNIN" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRHATTYU" ToTable="FT010" WithKeyFields="FT011.NRHATTYU"/><Refer Fields="TXSYOHIN;TXHINBAN;PRSIIRE;KBZAIKOUM;QTANZENZAIKO;QTJYOUGENZAIKO;TXIMAGEFILENAME" Order="0020" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="FT011.NRSYOHIN"/><Refer Fields="" Order="0050" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="CT010" WithKeyFields="FT010.NRTORIHIKISAKI"/><Refer Fields="TXSOUKO" Order="0060" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="FT010.NRSOUKO"/><Script EventP="AC" EventR="" Function="" Name="追加後の関連レコード処理" Order="0050" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var cFT012; var rET010; var cET010; var cET200;#EOL#var errorMessage = ''; var count = 0;#EOL#var nrTorihikikanri = session.getNextNumber('NRTORIHIKIKANRI');#EOL##EOL#///////////////////////////////////////////////////#EOL#// 入荷明細(FT012)のデフォルトレコードを追加する //#EOL#///////////////////////////////////////////////////#EOL#cFT012 = instance.createTableOperator('Insert', 'FT012');#EOL#cFT012.addValue('NRHATTYU',&#x9;&#x9;&#x9;FT011_NRHATTYU.value);#EOL#cFT012.addValue('SQHATTYU',&#x9;&#x9;&#x9;FT011_SQHATTYU.value);#EOL#cFT012.addValue('SQNYUKA',&#x9;&#x9;&#x9;1);#EOL#cFT012.addValue('DTYOTEINYUKA',&#x9;&#x9;FT011_DTKIBOUNOUKI.value);#EOL#cFT012.addValue('FGKAKUNIN',&#x9;&#x9;FT010_FGKAKUNIN.value);#EOL#cFT012.addValue('QTYOTEISIIRE',&#x9;&#x9;FT011_QTHATTYU.value);#EOL#cFT012.addValue('PRSIIRE',&#x9;&#x9;&#x9;FT011_PRHATTYU.value);#EOL#cFT012.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#cFT012.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#cFT012.addValue('NRNYUKA',&#x9;&#x9;&#x9;'');#EOL#count = cFT012.execute();#EOL#if (count != 1) {#EOL#&#x9;errorMessage = '入荷明細(FT012)の登録に失敗しました。処理はキャンセルされます。';#EOL#}#EOL##EOL#//////////////////////////////////#EOL#// 発注見出しが納期確認済の処理 //#EOL#//////////////////////////////////#EOL#if (FT010_FGKAKUNIN.value == 'T' &amp;&amp; errorMessage == '') {#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 入荷明細に対応する受払予定(ET200)の追加 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'10');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;FT011_DTKIBOUNOUKI.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT010_NRSOUKO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;FT011_QTHATTYU.value * FT011_VLKANZANKEISU.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;FT011_NRHATTYU.value + '-' + FT011_SQHATTYU.value + '-1');#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;// 倉庫在庫(ET010)初期レコードの追加（存在していなければ）//#EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;FT010_NRSOUKO.value);#EOL#&#x9;&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;FT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#"/><Script EventP="BC;BU;AR" EventR="BR()" Function="" Name="追加時変更不可設定" Order="0010" Text="FT011_KBSIIREUM.editable = false;#EOL#FT011_QTSIIRETANNI.editable = false;#EOL#FT011_VLKANZANKEISU.editable = false;#EOL#FT011_PRSIIRETANKA.editable = false;#EOL#FT011_NRHATTYU.editable = false;#EOL#FT011_QTHATTYUKANZAN.editable = false;"/><Refer Fields="TXKANJI;KBCURRENCY" Order="0070" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="FT010.NRTORIHIKISAKI"/><Field Decimal="" ID="QTHATTYUKANZAN" Name="在庫換算数" NoUpdate="T" Nullable="T" Order="0081" Remarks="単位換算係数によって設定される" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="BC;BU;BD;AR" EventR="AR()" Function="" Name="仮想フィールドの設定" Order="0030" Text="////////////////////////////#EOL#// 仕入先別商品明細の読取 //#EOL#////////////////////////////#EOL#var rCT011 = instance.createTableOperator('Select', 'CT011');#EOL#rCT011.addKeyValue('NRTORIHIKISAKI',&#x9;FT010_NRTORIHIKISAKI.value);#EOL#rCT011.addKeyValue('NRSYOHIN',&#x9;&#x9;&#x9;FT011_NRSYOHIN.value);#EOL#rCT011.addKeyValue('DTHAKKOU &lt;=',&#x9;&#x9;FT010_DTHATTYU.value);#EOL#rCT011.addKeyValue('DTSIKKOU >=',&#x9;&#x9;FT010_DTHATTYU.value);#EOL#if (rCT011.next()) {#EOL#&#x9;FT011_KBSIIREUM.value = rCT011.getValueOf('KBSIIREUM');#EOL#&#x9;FT011_QTSIIRETANNI.value = rCT011.getValueOf('QTSIIRETANNI');#EOL#&#x9;FT011_VLKANZANKEISU.value = rCT011.getValueOf('VLKANZANKEISU');#EOL#&#x9;FT011_PRSIIRETANKA.value = rCT011.getValueOf('PRSIIRETANKA');#EOL#} else {#EOL#&#x9;FT011_NRSYOHIN.error = '発注日('+FT010_DTHATTYU.value+')において有効な商品仕入契約が存在しません。';#EOL#}#EOL##EOL#//////////////////////////////////#EOL#// 発注数を在庫単位数に換算する //#EOL#//////////////////////////////////#EOL#FT011_QTHATTYUKANZAN.value = FT011_QTHATTYU.value * FT011_VLKANZANKEISU.value;#EOL#"/><Script EventP="BC;BU" EventR="AR()" Function="" Name="発注数のまるめ検査と希望納期の初期値設定" Order="0040" Text="////////////////////////#EOL#// 発注数のまるめ検査 //#EOL#////////////////////////#EOL#var amari = FT011_QTHATTYU.value % FT011_QTSIIRETANNI.value;#EOL#if (amari != 0) {#EOL#   FT011_QTHATTYU.error = '仕入単位数の倍数を指定してください。';#EOL#}#EOL##EOL#//////////////////////////////////////////#EOL#// 希望納期がブランクであれば初期値設定 //#EOL#//////////////////////////////////////////#EOL#if (FT011_DTKIBOUNOUKI.value == '') {#EOL#&#x9;FT011_DTKIBOUNOUKI.value = FT010_DTKIBOUNOUKI.value;#EOL#}"/><Field ID="KBSIIREUM" Name="仕入単位区分" NoUpdate="T" Nullable="F" Order="0071" Remarks="範囲検索されたCT011から設定される" Size="5" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBZAIKOUM)"/><Field ID="QTSIIRETANNI" Name="仕入単位数" NoUpdate="T" Nullable="F" Order="0072" Remarks="範囲検索されたCT011から設定される" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="VLKANZANKEISU" Name="単位換算係数" NoUpdate="T" Nullable="F" Order="0073" Remarks="範囲検索されたCT011から設定される" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="2" ID="PRSIIRETANKA" Name="契約仕入単価" NoUpdate="T" Nullable="F" Order="0074" Remarks="範囲検索されたCT011から設定される" Size="10" Type="DECIMAL" TypeOptions="VIRTUAL"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0060" Text="var rFT012 = instance.createTableOperator('Count', 'FT012');#EOL#rFT012.addKeyValue('NRHATTYU',&#x9;FT011_NRHATTYU.value);#EOL#rFT012.addKeyValue('SQHATTYU',&#x9;FT011_SQHATTYU.value);#EOL#if (rFT012.execute() > 0) {#EOL#&#x9;FT011_NRHATTYU.error = '入荷明細をともなうため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="DT010" Name="顧客" RangeKey="" Remarks="取引先の顧客用拡張属性を保持するためのテーブル。(年次)期首売掛残高、期間売上計上額、期間回収額を含む。" SubsystemID="D"><Field ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0010" Size="8" Type="CHAR" TypeOptions=""/><Field ID="CDKAKERITSURANK" Name="掛率ランクＣ" Nullable="F" Order="0020" Size="2" Type="CHAR" TypeOptions=""/><Field ID="TXTANTOUBUSYO" Name="客先担当部署" Nullable="F" Order="0030" Size="30" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXTANTOUSYA" Name="客先担当者名" Nullable="T" Order="0040" Size="40" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXTANTOUSYASYOKUI" Name="客先担当者職位" Nullable="T" Order="0050" Size="10" Type="CHAR" TypeOptions="KANJI"/><Field ID="TXTANTOUSYAEMAIL" Name="客先担当者メアド" Nullable="T" Order="0060" Size="40" Type="CHAR" TypeOptions="URL"/><Field ID="TXTANTOUSYADENWA" Name="客先担当者電話番号" Nullable="T" Order="0070" Size="20" Type="CHAR" TypeOptions="DIAL"/><Field ID="KBSEIKYUHOUSHIKI" Name="請求方式区分" Nullable="F" Order="0080" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBSEIKYUHOUSHIKI)"/><Field ID="CDNOUHINSYOYOSHIKI" Name="納品書様式Ｃ" Nullable="T" Order="0100" Size="4" Type="CHAR" TypeOptions=""/><Field ID="KBNYUKINHOUHOU" Name="標準入金方法区分" Nullable="F" Order="0110" Size="2" Type="CHAR" TypeOptions="KUBUN(KBNYUKINHOUHOU)"/><Field ID="VLNYUKINSAITO" Name="売上入金サイト" Nullable="F" Order="0120" Size="4" Type="SMALLINT" TypeOptions=""/><Field ID="AMYOSHIN" Name="与信限度額" Nullable="F" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="NRTANTOUJYUGYOIN" Name="担当営業№" Nullable="F" Order="0140" Size="5" Type="CHAR" TypeOptions=""/><Field ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0150" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Field ID="AMKISYUURIKAKE" Name="期首売掛残高" Nullable="T" Order="0160" Remarks="システム変数「入力認可過去月度(ALLOWED_FISCAL_MONTH)」の上４桁で表される会計年度における繰越売掛残高" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMKAISYU" Name="当期回収額" Nullable="T" Order="0180" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="AMGENURIKAKE" Name="現売掛残高" Nullable="T" Order="0190" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Key Fields="NRTORIHIKISAKI" Type="PK"/><Refer Fields="TXKANA;TXKANJI;TXJYUSYO1;TXJYUSYO2" Order="0" OrderBy="" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="DT010.NRTORIHIKISAKI"/><Refer Fields="TXKAKERITSURANK" Order="1" TableAlias="" ToKeyFields="" ToTable="DT020" WithKeyFields="DT010.CDKAKERITSURANK"/><Refer Fields="TXKANJI" Order="2" TableAlias="" ToKeyFields="" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Script EventP="BC;BU" EventR="BR()" Name="入力不可項目の設定" Order="0010" Text="DT010_AMGENURIKAKE.editable = false;#EOL#DT010_AMKEIJYOU.editable = false;#EOL#DT010_AMKAISYU.editable = false;#EOL#DT010_KBNAIKA.editable = false;"/><Script EventP="BC;BU;BD;AR" EventR="AR()" Name="現売掛残高の設定" Order="0020" Text="DT010_AMGENURIKAKE.value = Number(DT010_AMKISYUURIKAKE.value) + Number(DT010_AMKEIJYOU.value) - DT010_AMKAISYU.value;#EOL#DT010_KBNAIKA.value = session.getSystemVariantString('SYSTEM_CURRENCY');#EOL#"/><Key Fields="NRTANTOUJYUGYOIN" Type="XK"/><Script EventP="BD" EventR="BR()" Function="" Name="削除チェック" Order="0040" Text="if (DT010_AMGENURIKAKE.value == 0) {#EOL##EOL#&#x9;var rAT030 = instance.createTableOperator('Count', 'AT030');#EOL#&#x9;rAT030.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rAT030.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の取引先によって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rDT100 = instance.createTableOperator('Count', 'DT100');#EOL#&#x9;rDT100.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rDT100.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の売掛増減履歴によって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rDT110 = instance.createTableOperator('Count', 'DT110');#EOL#&#x9;rDT110.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rDT110.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の請求指示によって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rDT120 = instance.createTableOperator('Count', 'DT120');#EOL#&#x9;rDT120.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rDT120.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の受領明細によって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rET200 = instance.createTableOperator('Count', 'ET200');#EOL#&#x9;rET200.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rET200.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の受払予定によって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rGT010 = instance.createTableOperator('Count', 'GT010');#EOL#&#x9;rGT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rGT010.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の受注見出しによって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rGT020 = instance.createTableOperator('Count', 'GT020');#EOL#&#x9;rGT020.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rGT020.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の出荷見出しによって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rGT030 = instance.createTableOperator('Count', 'GT030');#EOL#&#x9;rGT030.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rGT030.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の見積見出しによって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rJT010 = instance.createTableOperator('Count', 'JT010');#EOL#&#x9;rJT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rJT010.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の売上振替によって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#&#x9;rJT020.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rJT020.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の特殊売上によって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rYT050 = instance.createTableOperator('Count', 'YT050');#EOL#&#x9;rYT050.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rYT050.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の顧客別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#&#x9;var rYT051 = instance.createTableOperator('Count', 'YT051');#EOL#&#x9;rYT051.addKeyValue('NRTORIHIKISAKI',&#x9;DT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rYT051.execute() > 0) {#EOL#&#x9;&#x9;DT010_NRTORIHIKISAKI.error = '既存の顧客商品別月次取引SUMによって参照されているため、このレコードは削除できません。';#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;DT010_AMGENURIKAKE.error = '現売掛残高がゼロでないので、削除できません。'#EOL#}#EOL#"/><Field ID="AMKEIJYOU" Name="当期計上額" Nullable="T" Order="0170" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="TXSIMEBI" Name="締め日" Nullable="T" Order="0090" Remarks="規定の締め日が入力される。複数あればコンマで区切る" Size="10" Type="CHAR" TypeOptions="KATAKANA"/><Field ID="KBNAIKA" Name="売掛取引通貨" Nullable="F" Order="0191" Remarks="当面は輸出取引は内貨の固定" Size="3" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBCURRENCY)"/></Table><Table ActiveWhere="" ID="GT020" Name="出荷見出し" RangeKey="" Remarks="顧客（出荷先）への出荷のまとまりを管理するためのテーブル。同一出荷先へ同一のタイミングで出荷されたものであれば、異なる受注にもとづく商品でも、１件の出荷見出しレコードとしてまとめられる。" SubsystemID="G"><Field Decimal="" ID="NRSYUKKA" Name="出荷№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSYUKKA)"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0020" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQSYUKKASAKI" Name="出荷先行番" Nullable="F" Order="0030" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="NRSOUKO" Name="出荷倉庫№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSEIKYU" Name="都度請求№" Nullable="T" Order="0070" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="STSYUKKA" Name="出荷状況" Nullable="F" Order="0100" Remarks="" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STSYUKKA)"/><Key Fields="NRSYUKKA" Type="PK"/><Field Decimal="" ID="DTSYUKKA" Name="出荷日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Field ID="TMKANRYO" Name="完了日時" Nullable="T" Order="0090" Size="23" Type="DATETIME" TypeOptions=""/><Field ID="TMHAKKOU" Name="発行日時" Nullable="T" Order="0080" Size="23" Type="DATETIME" TypeOptions=""/><Script EventP="BC" EventR="BR()" Function="" Name="追加レコード初期設定(GF020)" Order="0040" Text="///////////////////////////////////////////////////////////#EOL#// 出荷指示エントリー(GF020)によって追加された場合の処理 //#EOL#///////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'GF020') {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;//出荷日のデフォルト値設定//#EOL#&#x9;////////////////////////////#EOL#&#x9;if (GT020_DTSYUKKA.value == '') {#EOL#&#x9;&#x9;GT020_DTSYUKKA.value = session.getToday() + '';#EOL#&#x9;}#EOL#}"/><Script EventP="AR" EventR="BR()" Function="" Name="出荷状況設定" Order="0010" Text="if (GT020_TMKANRYO.value == '') {#EOL#&#x9;if (GT020_TMHAKKOU.value == '') {#EOL#&#x9;&#x9;GT020_STSYUKKA.value = '10'; //未発行//#EOL#&#x9;} else {#EOL#&#x9;&#x9;GT020_STSYUKKA.value = '20'; //未出荷//#EOL#&#x9;}#EOL#} else {#EOL#&#x9;GT020_STSYUKKA.value = '30'; //出荷済//#EOL#}"/><Script EventP="BU" EventR="BR()" Function="" Name="更新前設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#GT020_NRTORIHIKISAKI.editable = false;#EOL#GT020_SQSYUKKASAKI.editable = false;#EOL#GT020_NRSOUKO.editable = false;#EOL#GT020_NRSOUKO.editable = false;#EOL#GT020_NRSEIKYU.editable = false;#EOL#GT020_TMHAKKOU.editable = false;#EOL#GT020_TMKANRYO.editable = false;#EOL#GT020_STSYUKKA.editable = false;#EOL#if (GT020_TMKANRYO.value != '') {#EOL#&#x9;GT020_DTSYUKKA.editable = false;#EOL#}#EOL##EOL#//////////////////////#EOL#// 会計期間チェック //#EOL#//////////////////////#EOL#if (instance.functionID == 'GF030') {#EOL#&#x9;GT020_DTSYUKKA.error = session.getErrorOfAccountDate(GT020_DTSYUKKA.value);#EOL#}#EOL##EOL#////////////////////////#EOL#// 出荷完了日時の設定 //#EOL#////////////////////////#EOL#if (instance.functionID == 'GF030') {#EOL#&#x9;GT020_TMKANRYO.value = session.getTimeStamp() + '';#EOL#}#EOL##EOL#//////////////////////////////////////////#EOL#// 都度請求処理対象であれば請求№を採番 //#EOL#//////////////////////////////////////////#EOL#if (instance.functionID == 'GF030') {#EOL#&#x9;if (DT010GT020_KBSEIKYUHOUSHIKI.value == '20') {#EOL#&#x9;&#x9;GT020_NRSEIKYU.value = session.getNextNumber('NRSEIKYU');#EOL#&#x9;} else {#EOL#&#x9;&#x9;GT020_NRSEIKYU.value = '';#EOL#&#x9;}#EOL#}"/><Refer Fields="TXSOUKO" Order="0010" OrderBy="" TableAlias="BT030GT020" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="GT020.NRSOUKO"/><Refer Fields="TXKANJI" Order="0020" TableAlias="AT030GT020" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="GT020.NRTORIHIKISAKI"/><Refer Fields="TXKANJI;NRYUBIN;TXJYUSYO;NRDENWA;NRFAX" Order="0030" TableAlias="DT011GT020" ToKeyFields="NRTORIHIKISAKI;SQSYUKKASAKI" ToTable="DT011" WithKeyFields="GT020.NRTORIHIKISAKI;GT020.SQSYUKKASAKI"/><Refer Fields="NRTANTOUJYUGYOIN;KBSEIKYUHOUSHIKI" Order="0040" TableAlias="DT010GT020" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="GT020.NRTORIHIKISAKI"/><Refer Fields="TXKANJI" Order="0050" TableAlias="AT020GT020" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010GT020.NRTANTOUJYUGYOIN"/><Field ID="TMKANRYOWORK" Name="完了日時ワーク" Nullable="T" Order="0110" Remarks="GF045Bでクリアされる完了日時をパネル表示するためのワークフィールド" Size="23" Type="TIMESTAMP" TypeOptions="VIRTUAL"/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0061" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Script EventP="AU" EventR="" Function="" Name="都度請求書発行" Order="0050" Text="////////////////////////////////////////////#EOL#// 都度請求対象であれば請求指示データ生成 //#EOL#////////////////////////////////////////////#EOL#if (GT020_NRSEIKYU.value != '') {#EOL#&#x9;instance.parmMap.put('NRSEIKYU', &#x9;&#x9;GT020_NRSEIKYU.value);#EOL#&#x9;instance.parmMap.put('NRTORIHIKISAKI', &#x9;GT020_NRTORIHIKISAKI.value);#EOL#&#x9;instance.callFunction('DF112');#EOL#}#EOL#"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0060" Text="var rGT012 = instance.createTableOperator('Count', 'GT012');#EOL#rGT012.addKeyValue('NRSYUKKA',&#x9;GT020_NRSYUKKA.value);#EOL#if (rGT012.execute() > 0) {#EOL#&#x9;GT020_NRSYUKKA.error = '出荷明細をともなうため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="HT010" Name="仕入振替" RangeKey="" Remarks="買掛に関連する勘定科目との振替指示情報を保持するためのテーブル" SubsystemID="H"><Field Decimal="" ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0040" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="DTTORIHIKI" Name="取引日" Nullable="F" Order="0030" Remarks="" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="2" ID="AMTORIHIKI" Name="税抜取引額" Nullable="F" Order="0050" Size="10" Type="DECIMAL" TypeOptions=""/><Field Decimal="" ID="AMTAX" Name="消費税額" Nullable="T" Order="0080" Remarks="内貨での値。国内仕入先の場合に設定される" Size="7" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="TXTEKIYO" Name="振替摘要" Nullable="F" Order="0060" Size="30" Type="CHAR" TypeOptions="KANJI"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0070" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Key Fields="NRSIIREHURIKAE" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Field Decimal="" ID="KBSIIREHURIKAE" Name="振替区分" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBSIIREHURIKAE)"/><Field Decimal="" ID="NRSIIREHURIKAE" Name="仕入振替№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSIIREHURIKAE)"/><Refer Fields="TXKANJI;KBCOUNTRY;KBCURRENCY" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="HT010.NRTORIHIKISAKI"/><Refer Fields="" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="CT010" WithKeyFields="HT010.NRTORIHIKISAKI"/><Script EventP="BU;BD;AR" EventR="AR()" Function="" Name="更新前・削除前・読込後設定" Order="0030" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#HT010_KBSIIREHURIKAE.editable = false;#EOL#HT010_NRTORIHIKISAKI.editable = false;#EOL##EOL#//////////////////////#EOL#// 会計期間チェック //#EOL#//////////////////////#EOL#if (instance.functionID == 'HF011') {#EOL#&#x9;HT010_DTTORIHIKI.error = session.getErrorOfAccountDate(HT010_DTTORIHIKI.value);#EOL#}#EOL#"/><Script EventP="AC" EventR="" Function="" Name="追加後の関連レコード処理" Order="0040" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var cCT100; var uCT010;#EOL#var amSiire = 0; var amTax = 0; var amKeijyouUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var errorMessage = '';#EOL##EOL#/////////////////////////////////////////#EOL#// 関連する仕入先マスター(CT010)の検索 //#EOL#/////////////////////////////////////////#EOL#rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#rCT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#rCT010.addKeyValue('NRTORIHIKISAKI', HT010_NRTORIHIKISAKI.value);#EOL#if (rCT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(HT010_DTTORIHIKI.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(HT010_DTTORIHIKI.value);#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 取引額の符号設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '10') { //１０：雑益振替//#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.value * -1;#EOL#&#x9;}#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '11') { //１１：雑損仕入 //#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.value;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.value;#EOL#&#x9;}#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '20') { //２０：相殺(売掛金振替)//#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.value * -1;#EOL#&#x9;}#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '30') { //３０：売上原価振替//#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.value;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.value;#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 仕入実績(CT100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;HT010_KBSIIREHURIKAE.value);#EOL#&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT010_DTTORIHIKI.value);#EOL#&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT010_NRTORIHIKISAKI.value);#EOL#&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;HT010_TXTEKIYO.value);#EOL#&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT010_AMTORIHIKI.value);#EOL#&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;1);#EOL#&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;'CNT');#EOL#&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiire);#EOL#&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTax);#EOL#&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT010_NRTORIHIKIKANRI.value);#EOL#&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;count = cCT100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 仕入先マスター(CT010)の買掛残高更新 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rCT010.getValueOf('AMKEIJYOU')) + Number(amSiire) + Number(amTax);#EOL#&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;HT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0010" Text="//////////////////////////////////////////#EOL#// 取引日の初期値設定と会計期間チェック //#EOL#//////////////////////////////////////////#EOL#if (HT010_DTTORIHIKI.value == '') {#EOL#&#x9;HT010_DTTORIHIKI.value = session.getToday() + '';#EOL#}#EOL#HT010_DTTORIHIKI.error = session.getErrorOfAccountDate(HT010_DTTORIHIKI.value);#EOL#"/><Script EventP="AU" EventR="" Function="" Name="更新後の関連レコード処理" Order="0050" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var uCT010; var rCT100; var uCT100; var cCT100;#EOL#var amSiireNew = 0; var amSiireOld = 0; var amTaxNew = 0; var amTaxOld = 0;#EOL#var amKeijyouUpdated = 0; var dtNendNew = 0; var dtMSeqNew = 0;var dtNendOld = 0; var dtMSeqOld = 0;#EOL#var errorMessage = ''; var count = 0;#EOL##EOL#//////////////////////////#EOL#// フィールド値変更検査 //#EOL#//////////////////////////#EOL#if (HT010_DTTORIHIKI.valueChanged || HT010_AMTORIHIKI.valueChanged ) {#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 関連する仕入先マスター(CT010)の検索 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#&#x9;rCT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#&#x9;rCT010.addKeyValue('NRTORIHIKISAKI', HT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rCT010.next()) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 赤伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendOld = session.getFYearOfDate(HT010_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;dtMSeqOld = session.getMSeqOfDate(HT010_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 取引額の符号設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '10') { //１０：雑益振替//#EOL#&#x9;&#x9;&#x9;amSiireOld = HT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amTaxOld = HT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '11') { //１１：雑損仕入 //#EOL#&#x9;&#x9;&#x9;amSiireOld = HT010_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;amTaxOld = HT010_AMTAX.oldValue;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '20') { //２０：相殺(売掛金振替)//#EOL#&#x9;&#x9;&#x9;amSiireOld = HT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amTaxOld = HT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '30') { //３０：売上原価振替//#EOL#&#x9;&#x9;&#x9;amSiireOld = HT010_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;amTaxOld = HT010_AMTAX.oldValue;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;amSiireOld = amSiireOld * -1;#EOL#&#x9;&#x9;amTaxOld = amTaxOld * -1;#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する仕入実績(CT100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;&#x9;&#x9;rCT100.setSelectFields('NRSIIRE, NRSIHARAIIRAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rCT100.addKeyValue('NRTORIHIKIKANRI', HT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;if (rCT100.getValueOf('NRSIHARAIIRAI').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する仕入実績が支払依頼処理されているため、変更処理はキャンセルされます。関連する支払依頼(' + rCT100.getValueOf('NRSIHARAIIRAI') + ')から当該の仕入実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100 = instance.createTableOperator('Update', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('UPDCOUNTER',&#x9;Number(rCT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('NRSIIRE',&#x9;&#x9;rCT100.getValueOf('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('UPDCOUNTER',&#x9;rCT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;// 仕入実績(CT100)の赤伝追加 //#EOL#&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;HT010_KBSIIREHURIKAE.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT010_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;HT010_TXTEKIYO.oldValue);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT010_AMTORIHIKI.oldValue);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiireOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTaxOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 黒伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendNew = session.getFYearOfDate(HT010_DTTORIHIKI.value);#EOL#&#x9;&#x9;dtMSeqNew = session.getMSeqOfDate(HT010_DTTORIHIKI.value);#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 取引額の符号設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '10') { //１０：雑益振替//#EOL#&#x9;&#x9;&#x9;amSiireNew = HT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;amTaxNew = HT010_AMTAX.value * -1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '11') { //１１：雑損仕入 //#EOL#&#x9;&#x9;&#x9;amSiireNew = HT010_AMTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;amTaxNew = HT010_AMTAX.value;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '20') { //２０：相殺(売掛金振替)//#EOL#&#x9;&#x9;&#x9;amSiireNew = HT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;amTaxNew = HT010_AMTAX.value * -1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT010_KBSIIREHURIKAE.value == '30') { //３０：売上原価振替//#EOL#&#x9;&#x9;&#x9;amSiireNew = HT010_AMTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;amTaxNew = HT010_AMTAX.value;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;// 仕入実績(CT100)の黒伝追加 //#EOL#&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;HT010_KBSIIREHURIKAE.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT010_DTTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;HT010_TXTEKIYO.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT010_AMTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiireNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTaxNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;/////////////// 仕入先マスター(CT010)の買掛残高更新 ////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;amKeijyouUpdated = Number(rCT010.getValueOf('AMKEIJYOU'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amSiireOld) + Number(amTaxOld)#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amSiireNew) + Number(amTaxNew);#EOL#&#x9;&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;HT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="削除後の関連レコード処理" Order="0060" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var uCT010; var rCT100; var uCT100; var cCT100;#EOL#var amSiire = 0; var amTax = 0; var amKeijyouUpdated = 0;#EOL#var errorMessage = ''; var dtNend = 0; var dtMSeq = 0;#EOL##EOL#/////////////////////////////////////////#EOL#// 関連する仕入先マスター(CT010)の検索 //#EOL#/////////////////////////////////////////#EOL#rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#rCT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#rCT010.addKeyValue('NRTORIHIKISAKI', HT010_NRTORIHIKISAKI.value);#EOL#if (rCT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(HT010_DTTORIHIKI.oldValue);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(HT010_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 取引額の符号設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '10') { //１０：雑益振替//#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.oldValue * -1;#EOL#&#x9;}#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '11') { //１１：雑損仕入 //#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.oldValue;#EOL#&#x9;}#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '20') { //２０：相殺(売掛金振替)//#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.oldValue * -1;#EOL#&#x9;}#EOL#&#x9;if (HT010_KBSIIREHURIKAE.value == '30') { //３０：売上原価振替//#EOL#&#x9;&#x9;amSiire = HT010_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;amTax = HT010_AMTAX.oldValue;#EOL#&#x9;}#EOL#&#x9;amSiire = amSiire * -1;#EOL#&#x9;amTax = amTax * -1;#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する仕入実績(CT100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;&#x9;rCT100.setSelectFields('NRSIIRE, NRSIHARAIIRAI, UPDCOUNTER');#EOL#&#x9;&#x9;rCT100.addKeyValue('NRTORIHIKIKANRI', HT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;&#x9;if (rCT100.getValueOf('NRSIHARAIIRAI').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する仕入実績が支払依頼処理されているため、変更処理はキャンセルされます。関連する支払依頼(' + rCT100.getValueOf('NRSIHARAIIRAI') + ')から当該の仕入実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;uCT100 = instance.createTableOperator('Update', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addValue('UPDCOUNTER',&#x9;Number(rCT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('NRSIIRE',&#x9;&#x9;rCT100.getValueOf('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('UPDCOUNTER',&#x9;rCT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 仕入実績(CT100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;HT010_KBSIIREHURIKAE.value);#EOL#&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT010_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;HT010_TXTEKIYO.oldValue);#EOL#&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT010_AMTORIHIKI.oldValue);#EOL#&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiire);#EOL#&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 仕入先マスター(CT010)の買掛残高更新 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rCT010.getValueOf('AMKEIJYOU')) + Number(amSiire) + Number(amTax);#EOL#&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;HT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Field Decimal="" ID="AMTORIHIKINAIKA" Name="内貨税抜取引額" Nullable="F" Order="0071" Remarks="税抜取引額（取引通貨建）×為替レート" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="BC;BU;BD;AR" EventR="AR()" Function="" Name="仮想フィールドの設定" Order="0020" Text="//////////////////////#EOL#// 内貨取引額の設定 //#EOL#//////////////////////#EOL#HT010_AMTORIHIKINAIKA.editable = false;#EOL#if (AT030_KBCURRENCY.value != '') {#EOL#&#x9;var rtRate = session.getMonthlyExchangeRate(AT030_KBCURRENCY.value, HT010_DTTORIHIKI.value, 'TTS');#EOL#&#x9;HT010_AMTORIHIKINAIKA.value = Math.round(HT010_AMTORIHIKI.value * rtRate);#EOL#&#x9;var rtRateOld = session.getMonthlyExchangeRate(AT030_KBCURRENCY.value, HT010_DTTORIHIKI.oldValue, 'TTS');#EOL#&#x9;HT010_AMTORIHIKINAIKA.oldValue = Math.round(HT010_AMTORIHIKI.oldValue * rtRateOld);#EOL#}#EOL##EOL#////////////////////#EOL#// 消費税額の設定 //#EOL#////////////////////#EOL#HT010_AMTAX.editable = false;#EOL#if (AT030_KBCOUNTRY.value != '') {#EOL#&#x9;if (AT030_KBCOUNTRY.value == (session.getSystemVariantString('SYSTEM_COUNTRY') + '')) {#EOL#&#x9;&#x9;HT010_AMTAX.value = session.getTaxAmount(HT010_DTTORIHIKI.value, HT010_AMTORIHIKINAIKA.value);#EOL#&#x9;&#x9;HT010_AMTAX.oldValue = session.getTaxAmount(HT010_DTTORIHIKI.oldValue, HT010_AMTORIHIKINAIKA.oldValue);#EOL#&#x9;} else {#EOL#&#x9;&#x9;HT010_AMTAX.value = 0;#EOL#&#x9;&#x9;HT010_AMTAX.oldValue = 0;#EOL#&#x9;}#EOL#}"/></Table><Table ActiveWhere="" ID="CT120" Name="支払指示" RangeKey="" Remarks="経理課での仕入に対する支払指示を保持するためのテーブル" SubsystemID="C"><Field Decimal="" ID="NRSIHARAI" Name="支払指示№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSIHARAI)"/><Field Decimal="" ID="DTSIHARAI" Name="支払日" Nullable="F" Order="0020" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="KBSIHARAIHOUHOU" Name="支払方法区分" Nullable="F" Order="0030" Size="2" Type="CHAR" TypeOptions="KUBUN(KBSIHARAIHOUHOU)"/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0060" Size="300" Type="VARCHAR" TypeOptions=""/><Key Fields="NRSIHARAI" Type="PK"/><Field Decimal="2" ID="AMSIHARAI" Name="税込支払指示額" Nullable="T" Order="0070" Remarks="関連する仕入実績から仕入額と消費税を合計した値。取引通貨建て" Size="11" Type="DECIMAL" TypeOptions="VIRTUAL"/><Script EventP="BU;BD;AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0010" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT110; var amSiharai = 0; var amTax = 0; var nrMeisai = 0; #EOL##EOL#///////////////////////////////////#EOL#// 関連する支払依頼(CT110)の検索 //#EOL#///////////////////////////////////#EOL#rCT110 = instance.createTableOperator('Select', 'CT110');#EOL#rCT110.setSelectFields('NRSIHARAIIRAI, NRTORIHIKISAKI');#EOL#rCT110.addKeyValue('NRSIHARAI',&#x9;CT120_NRSIHARAI.value);#EOL#while (rCT110.next()) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 関連する支払依頼の件数集計 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;nrMeisai++;#EOL##EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;// 関連する仕入実績(CT100)の検索と支払額集計 //#EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;rCT100.setSelectFields('AMSIIRE, AMTAX');#EOL#&#x9;rCT100.addKeyValue('NRSIHARAIIRAI',&#x9;rCT110.getValueOf('NRSIHARAIIRAI'));#EOL#&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;amSiharai = Number(amSiharai) + Number(rCT100.getValueOf('AMSIIRE'));#EOL#&#x9;&#x9;amTax = Number(amTax) + Number(rCT100.getValueOf('AMTAX'));#EOL#&#x9;}#EOL#}#EOL#CT120_NRMEISAI.value = nrMeisai;#EOL#CT120_AMSIHARAI.value = Number(amSiharai) + Number(amTax);#EOL#"/><Field ID="AMNAIKASIHARAI" Name="内貨実際支払額" Nullable="T" Order="0050" Remarks="取引通貨建ての支払指示額に対する実際に支払額" Size="9" Type="INTEGER" TypeOptions=""/><Script EventP="BC" EventR="BR()" Function="" Name="追加前設定" Order="0020" Text="//////////////////////////////////////////////////////////////////////////////#EOL#// システム値（支払日）を用いて今月の支払日を計算して、支払日の初期値とする //#EOL#//////////////////////////////////////////////////////////////////////////////#EOL#if (CT120_DTSIHARAI.value == '') {#EOL#&#x9;var workDate = session.getToday() + '';#EOL#&#x9;CT120_DTSIHARAI.value = workDate;#EOL#&#x9;var day = session.getSystemVariantInteger(&quot;SIHARAI_DAY&quot;);#EOL#&#x9;while (day > 0) {#EOL#&#x9;&#x9;if (day > 9) {#EOL#&#x9;&#x9;&#x9;workDate = workDate.substring(0, 8) + day + '';#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;workDate = workDate.substring(0, 8) + '0' + day;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (session.isValidDate(workDate) &amp;&amp; !session.isOffDate(workDate)) {#EOL#&#x9;&#x9;&#x9;CT120_DTSIHARAI.value = workDate;#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;day--;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL#"/><Script EventP="BU" EventR="BR()" Function="" Name="更新前設定" Order="0030" Text="//////////////////#EOL#// 変更不可設定 //#EOL#//////////////////#EOL#CT120_DTSIHARAI.editable = false;#EOL#CT120_KBCURRENCY.editable = false;#EOL#CT120_AMSIHARAI.editable = false;#EOL##EOL#////////////////////////////#EOL#// 実際支払額の初期値設定 //#EOL#////////////////////////////#EOL#if (CT120_KBCURRENCY.value == (session.getSystemVariantString('SYSTEM_CURRENCY') + '') &amp;&amp; CT120_AMNAIKASIHARAI.value == 0) {#EOL#&#x9;CT120_AMNAIKASIHARAI.value = CT120_AMSIHARAI.value;#EOL#}#EOL##EOL##EOL#"/><Field ID="NRMEISAI" Name="明細行数" Nullable="T" Order="0091" Size="4" Type="SMALLINT" TypeOptions="VIRTUAL"/><Script EventP="BD" EventR="BR()" Function="" Name="削除妥当性チェック" Order="0040" Text="if (CT120_NRMEISAI.value > 0) {#EOL#&#x9;CT120_NRSIHARAI.error = '関連する支払依頼を伴うため、削除できません。それらの支払依頼について支払指示を取消したうえで削除してください。';#EOL#}"/><Field ID="AMTESURYO" Name="手数料" Nullable="T" Order="0051" Remarks="" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="KBCURRENCY" Name="通貨" Nullable="F" Order="0041" Size="3" Type="CHAR" TypeOptions="KUBUN(KBCURRENCY)"/></Table><Table ActiveWhere="" ID="CT110" Name="支払依頼" RangeKey="" Remarks="支払対象の仕入実績をまとめたもの。このまとまりに対して購買部長が「承認」し、さらに経理課で支払指示されると、「支払」の仕入実績が追加され、買掛残高が引き落とされる。" SubsystemID="C"><Field Decimal="" ID="NRSIHARAIIRAI" Name="支払依頼№" Nullable="F" Order="0010" Remarks="" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSIHARAIIRAI)"/><Field Decimal="" ID="DTSIHARAIIRAI" Name="依頼日" Nullable="F" Order="0020" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0030" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="2" ID="AMSIHARAI" Name="税抜支払額" Nullable="T" Order="0100" Size="11" Type="DECIMAL" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMTAX" Name="消費税額" Nullable="T" Order="0120" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="TXSEIKYUNO" Name="仕入先請求番号" Nullable="T" Order="0040" Size="20" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0050" Size="300" Type="VARCHAR" TypeOptions=""/><Field Decimal="" ID="FGSYOUNIN" Name="支払承認フラグ" Nullable="F" Order="0060" Size="1" Type="CHAR" TypeOptions="KUBUN(FGSYOUNIN)"/><Field Decimal="" ID="NRSIHARAI" Name="支払指示№" Nullable="T" Order="0070" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0080" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field Decimal="" ID="KBSIHARAIHOUHOU" Name="支払方法区分" Nullable="F" Order="0090" Size="2" Type="CHAR" TypeOptions="KUBUN(KBSIHARAIHOUHOU)"/><Key Fields="NRSIHARAIIRAI" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Refer Fields="KBSIHARAIHOUHOU;TXHURIKOMISAKI" Order="0070" OrderBy="" TableAlias="CT110CT010" ToKeyFields="NRTORIHIKISAKI" ToTable="CT010" WithKeyFields="CT110.NRTORIHIKISAKI"/><Refer Fields="TXKANJI;KBCURRENCY" Order="0080" OrderBy="" TableAlias="CT110AT030" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="CT110.NRTORIHIKISAKI"/><Script EventP="BC" EventR="AR()" Function="" Name="追加レコード初期設定(CF111B)" Order="0010" Text="if (instance.functionID == 'CF111B') {#EOL##EOL#&#x9;//////////////////////////////////////#EOL#&#x9;//支払額集計値の初期化と変更不可設定//#EOL#&#x9;//////////////////////////////////////#EOL#&#x9;CT110_AMSIHARAI.value = CT110_AMSIIREWORK.value;;#EOL#&#x9;CT110_AMTAX.value = CT110_AMTAXWORK.value;;#EOL##EOL#&#x9;CT110_AMTAX.editable = false;#EOL#&#x9;CT110_AMSIHARAI.editable = false;#EOL##EOL#&#x9;CT110_AMSIIREWORK.value = 0;#EOL#&#x9;CT110_AMTAXWORK.value = 0;#EOL##EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;//依頼日と支払方法区分のデフォルト値設定//#EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;if (CT110_DTSIHARAIIRAI.value == '') {#EOL#&#x9;&#x9;CT110_DTSIHARAIIRAI.value = session.getToday() + '';#EOL#&#x9;&#x9;CT110_KBSIHARAIHOUHOU.value = CT110CT010_KBSIHARAIHOUHOU.value;#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////#EOL#&#x9;//承認フラグ設定//#EOL#&#x9;//////////////////#EOL#&#x9;CT110_FGSYOUNIN.value = 'F';#EOL#}"/><Script EventP="BU;BD;AR" EventR="AR()" Function="" Hold="F" Name="仮想フィールド設定" Order="0020" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT100;#EOL#var amsiharai = 0.00; var amtax = 0; var count = 0;#EOL##EOL#/////////////////////////////////////////////////////#EOL#// 仕入実績(CT100)から仕入額を集計して支払額とする //#EOL#/////////////////////////////////////////////////////#EOL#rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#rCT100.setSelectFields('AMSIIRE, AMTAX');#EOL#rCT100.addKeyValue('NRSIHARAIIRAI',&#x9;CT110_NRSIHARAIIRAI.value);#EOL#while (rCT100.next()) {#EOL#&#x9;amsiharai = Number(amsiharai) + Number(rCT100.getValueOf('AMSIIRE'));#EOL#&#x9;amtax = Number(amtax) + Number(rCT100.getValueOf('AMTAX'));#EOL#&#x9;count++;#EOL#}#EOL#CT110_AMSIHARAI.value = amsiharai;#EOL#CT110_AMTAX.value = amtax;#EOL#CT110_AMSIHARAIGOUKEI.value = Number(amsiharai) + Number(amtax);#EOL#CT110_NRMEISAI.value = count;"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="更新時設定" Order="0030" Text="////////////////#EOL#//変更不可設定//#EOL#////////////////#EOL#CT110_NRTORIHIKISAKI.editable = false;#EOL#CT110_FGSYOUNIN.editable = false;#EOL#CT110_NRSIHARAI.editable = false;#EOL#CT110_NRSIHARAIWORK.editable = false;#EOL#CT110_AMSIHARAI.editable = false;#EOL#CT110_AMTAX.editable = false;#EOL#if (instance.functionID != 'CF121') {#EOL#&#x9;CT110_DTSIHARAIIRAI.editable = false;#EOL#&#x9;CT110_KBSIHARAIHOUHOU.editable = false;#EOL#&#x9;CT110_TXSEIKYUNO.editable = false;#EOL#}#EOL##EOL#///////////////////////////////////////////////////////////////////#EOL#// 会計期間チェック（支払指示№がセットされたかクリアされたとき）// #EOL#///////////////////////////////////////////////////////////////////#EOL#if ((CT110_NRSIHARAI.value != '' &amp;&amp; CT110_NRSIHARAI.oldValue == '') ||#EOL#&#x9;(CT110_NRSIHARAI.value == '' &amp;&amp; CT110_NRSIHARAI.oldValue != '')) {#EOL#&#x9;CT110_DTSIHARAIIRAI.error = session.getErrorOfAccountDate(CT110_DTSIHARAIIRAI.value);#EOL#}#EOL#"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="承認／承認取消設定(CF123, CF124)" Order="0040" Text="if (instance.functionID == 'CF123') {#EOL#&#x9;CT110_FGSYOUNIN.value = 'T';#EOL#}#EOL#if (instance.functionID == 'CF124') {#EOL#&#x9;CT110_FGSYOUNIN.value = 'F';#EOL#}"/><Refer Fields="KBSIHARAIHOUHOU;DTSIHARAI" Order="0090" TableAlias="" ToKeyFields="NRSIHARAI" ToTable="CT120" WithKeyFields="CT110.NRSIHARAI"/><Key Fields="NRSIHARAI" Type="XK"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="支払指示取消設定(CF134)" Order="0041" Text="if (instance.functionID == 'CF134') {#EOL#&#x9;if (CT110_NRSIHARAI.value != '') {#EOL#&#x9;&#x9;CT110_NRSIHARAIWORK.value = CT110_NRSIHARAI.value;#EOL#&#x9;}#EOL#&#x9;CT110_NRSIHARAI.value = '';#EOL#}"/><Field ID="NRMEISAI" Name="明細行数" Nullable="T" Order="0160" Size="4" Type="SMALLINT" TypeOptions="VIRTUAL"/><Script EventP="BD" EventR="BR()" Function="" Name="削除妥当性チェック" Order="0051" Text="if (CT110_NRMEISAI.value > 0) {#EOL#&#x9;CT110_NRSIHARAIIRAI.error = '関連する仕入実績を伴うため、削除できません。それらの仕入実績について支払依頼を取消したうえで削除してください。';#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="更新時の関連レコード処理" Order="0061" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var uCT010; var cCT100; var rCT100; var uCT100; var rCT120;#EOL#var amSiharai = 0; var amTax = 0; var amSiharaiUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var errorMessage = '';#EOL##EOL#////////////////////////////////////////////////////////////////#EOL#// 支払№がセットされたかリセットされた場合に、以下を実行する //#EOL#////////////////////////////////////////////////////////////////#EOL#if ((CT110_NRSIHARAI.value != '' &amp;&amp; CT110_NRSIHARAI.oldValue == '') ||#EOL#&#x9;(CT110_NRSIHARAI.value == '' &amp;&amp; CT110_NRSIHARAI.oldValue != '')) {#EOL##EOL#&#x9;/////////////////////////#EOL#&#x9;// 仕入先(CT010)の検索 //#EOL#&#x9;/////////////////////////#EOL#&#x9;rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#&#x9;rCT010.setSelectFields('AMSIHARAI, UPDCOUNTER');#EOL#&#x9;rCT010.addKeyValue('NRTORIHIKISAKI', CT110_NRTORIHIKISAKI.value);#EOL#&#x9;if (rCT010.next()) {#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;// 支払計上時：仕入実績(CT100)の黒伝処理 //#EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;if (CT110_NRSIHARAI.value != '' &amp;&amp; CT110_NRSIHARAI.oldValue == '') {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;dtNend = session.getFYearOfDate(CT120_DTSIHARAI.value);#EOL#&#x9;&#x9;&#x9;dtMSeq = session.getMSeqOfDate(CT120_DTSIHARAI.value);#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 支払額（仕入額の逆数）の設定 //#EOL#&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;amSiharai = CT110_AMSIHARAI.value * -1;#EOL#&#x9;&#x9;&#x9;amTax = CT110_AMTAX.value * -1;#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;// 仕入実績(CT100)の追加 //#EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;'90');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;CT120_DTSIHARAI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;CT110_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;amSiharai);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;CT110AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiharai);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTax);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;CT110_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;// 支払取消時：仕入実績(CT100)の赤伝処理 //#EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;if (CT110_NRSIHARAI.value == '' &amp;&amp; CT110_NRSIHARAI.oldValue != '') {#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 切離元支払指示(CT120)の検索 //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;&#x9;rCT120 = instance.createTableOperator('Select', 'CT120');#EOL#&#x9;&#x9;&#x9;rCT120.setSelectFields('DTSIHARAI');#EOL#&#x9;&#x9;&#x9;rCT120.addKeyValue('NRSIHARAI', CT110_NRSIHARAI.oldValue);#EOL#&#x9;&#x9;&#x9;if (rCT120.next()) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;dtNend = session.getFYearOfDate(rCT120.getValueOf('DTSIHARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;dtMSeq = session.getMSeqOfDate(rCT120.getValueOf('DTSIHARAI'));#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 仕入実績(CT100)の失効処理 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;rCT100.setSelectFields('NRSIIRE, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;rCT100.addKeyValue('NRTORIHIKIKANRI', CT110_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100 = instance.createTableOperator('Update', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('UPDCOUNTER',&#x9;Number(rCT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('NRSIIRE',&#x9;&#x9;rCT100.getValueOf('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('UPDCOUNTER',&#x9;rCT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 支払額の設定 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;&#x9;&#x9;amSiharai = CT110_AMSIHARAI.value;#EOL#&#x9;&#x9;&#x9;&#x9;amTax = CT110_AMTAX.value;#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 仕入実績(CT100)の赤伝追加 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;'90');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;rCT120.getValueOf('DTSIHARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;CT110_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;amSiharai);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;CT110AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiharai);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTax);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;CT110_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '切離元の支払指示(CT120)が存在しません。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;// 仕入先マスター(CT010)の買掛残高更新 //#EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;if (CT110_NRSIHARAI.value != '' &amp;&amp; CT110_NRSIHARAI.oldValue == '') { // 支払計上時 //#EOL#&#x9;&#x9;&#x9;&#x9;amSiharaiUpdated = Number(rCT010.getValueOf('AMSIHARAI')) + Number(CT110_AMSIHARAI.value) + Number(CT110_AMTAX.value);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (CT110_NRSIHARAI.value == '' &amp;&amp; CT110_NRSIHARAI.oldValue != '') { // 支払取消時 //#EOL#&#x9;&#x9;&#x9;&#x9;amSiharaiUpdated = Number(rCT010.getValueOf('AMSIHARAI')) - Number(CT110_AMSIHARAI.value) - Number(CT110_AMTAX.value);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;&#x9;uCT010.addValue('AMSIHARAI',&#x9;amSiharaiUpdated);#EOL#&#x9;&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;CT110_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="NRSIHARAIWORK" Name="支払№表示用ワーク" Nullable="T" Order="0170" Size="7" Type="CHAR" TypeOptions="VIRTUAL"/><Field Decimal="2" ID="AMSIIREWORK" Name="税抜仕入額合計用ワーク" Nullable="T" Order="0140" Size="11" Type="DECIMAL" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMTAXWORK" Name="消費税合計用ワーク" Nullable="T" Order="0150" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="2" ID="AMSIHARAIGOUKEI" Name="税込支払額" Nullable="T" Order="0121" Size="11" Type="DECIMAL" TypeOptions="VIRTUAL"/></Table><Table ActiveWhere="" ID="HT020" Name="特殊仕入" RangeKey="" Remarks="「仕入先返品」および「発注なし入荷」に関する情報を保持するためのテーブル" SubsystemID="H"><Field Decimal="" ID="NRTOKUSYUSIIRE" Name="特殊仕入№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTOKUSYUSIIRE)"/><Field Decimal="" ID="KBTOKUSYUSIIRE" Name="取引区分" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBTOKUSYUSIIRE)"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0030" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="DTTORIHIKI" Name="取引日" Nullable="F" Order="0040" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="商品№" Nullable="F" Order="0050" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSOUKO" Name="取引倉庫№" Nullable="F" Order="0060" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRLOCATION" Name="ロケ№" Nullable="F" Order="0070" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="2" ID="AMTORIHIKI" Name="税抜取引額" Nullable="T" Order="0190" Remarks="取引通貨での値" Size="10" Type="DECIMAL" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMTAX" Name="消費税額" Nullable="T" Order="0210" Remarks="内貨での値。国内仕入先の場合に設定される" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0130" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0140" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Key Fields="NRTOKUSYUSIIRE" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Refer Fields="TXKANJI;KBCOUNTRY;KBCURRENCY" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="HT020.NRTORIHIKISAKI"/><Refer Fields="TXTANTOUBUSYO;TXTANTOUSYA;NRTANTOUJYUGYOIN" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="CT010" WithKeyFields="HT020.NRTORIHIKISAKI"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM;QTANZENZAIKO;QTJYOUGENZAIKO;FGLOTKANRI" Order="0040" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="HT020.NRSYOHIN"/><Refer Fields="TXSOUKO" Order="0060" OrderBy="" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="HT020.NRSOUKO"/><Refer Fields="TXKANJI" Order="0030" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="CT010.NRTANTOUJYUGYOIN"/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#HT020_KBSIIREUM.editable = false;#EOL#HT020_VLKANZANKEISU.editable = false;#EOL#HT020_PRSIIRETANKAeditable = false;#EOL#HT020_KBTOKUSYUSIIRE.editable = false;#EOL#HT020_QTTORIHIKIKANZAN.editable = false;#EOL#HT020_AMTORIHIKI.editable = false;#EOL#HT020_AMTORIHIKINAIKA.editable = false;#EOL#HT020_AMTAX.editable = false;#EOL#HT020_KBTORIHIKIUM.editable = false;#EOL##EOL#//////////////////////////////////////////#EOL#// 取引日の初期値設定と会計期間チェック //#EOL#//////////////////////////////////////////#EOL#if (HT020_DTTORIHIKI.value == '') {#EOL#&#x9;HT020_DTTORIHIKI.value = session.getToday() + '';#EOL#}#EOL#HT020_DTTORIHIKI.error = session.getErrorOfAccountDate(HT020_DTTORIHIKI.value);#EOL##EOL#//////////////////////////////#EOL#// ロケーションの初期値設定 //#EOL#//////////////////////////////#EOL#if (HT020_NRLOCATION.value == '') {#EOL#&#x9;HT020_NRLOCATION.value = ET010_NRLOCATION.value;#EOL#}#EOL##EOL#////////////////////#EOL#// 取引金額の設定 //#EOL#////////////////////#EOL#if (HT020_KBTOKUSYUSIIRE.value == '20') { //20：直接入荷//#EOL#&#x9;if (HT020_PRTORIHIKI.value == 0) {#EOL#&#x9;&#x9;HT020_PRTORIHIKI.value = HT020_PRSIIRETANKA.value;#EOL#&#x9;}#EOL#}#EOL#HT020_AMTORIHIKI.value = HT020_QTTORIHIKI.value * HT020_PRTORIHIKI.value;#EOL##EOL#//////////////////////////////////////////////////#EOL#// 取引単位の設定と取引数の在庫管理単位への換算 //#EOL#//////////////////////////////////////////////////#EOL#if (HT020_KBTOKUSYUSIIRE.value == '10') { //10：仕入返品//#EOL#&#x9;HT020_KBTORIHIKIUM.value = BT020_KBZAIKOUM.value;#EOL#&#x9;HT020_QTTORIHIKIKANZAN.value = HT020_QTTORIHIKI.value;#EOL#}#EOL#if (HT020_KBTOKUSYUSIIRE.value == '20') { //20：直接入荷//#EOL#&#x9;HT020_KBTORIHIKIUM.value = HT020_KBSIIREUM.value;#EOL#&#x9;HT020_QTTORIHIKIKANZAN.value = HT020_QTTORIHIKI.value * HT020_VLKANZANKEISU.value;#EOL#}#EOL##EOL#////////////////////////////////#EOL#// 内貨取引額と消費税額の設定 //#EOL#////////////////////////////////#EOL#if (AT030_KBCURRENCY.value != '') {#EOL#&#x9;var rtRate = session.getMonthlyExchangeRate(AT030_KBCURRENCY.value, HT020_DTTORIHIKI.value, 'TTS');#EOL#&#x9;HT020_AMTORIHIKINAIKA.value = HT020_AMTORIHIKI.value * rtRate;#EOL#}#EOL#if (AT030_KBCOUNTRY.value == (session.getSystemVariantString('SYSTEM_COUNTRY') + '')) {#EOL#&#x9;HT020_AMTAX.value = session.getTaxAmount(HT020_DTTORIHIKI.value, HT020_AMTORIHIKINAIKA.value);#EOL#} else {#EOL#&#x9;HT020_AMTAX.value = 0;#EOL#}#EOL##EOL#////////////////////#EOL#// ロット№の設定 //#EOL#////////////////////#EOL#if (BT020_FGLOTKANRI.value == 'F') {#EOL#&#x9;HT020_TXLOTNUMBER.editable = false;#EOL#&#x9;HT020_TXLOTNUMBER.value = '記載不要';#EOL#} else {#EOL#&#x9;HT020_TXLOTNUMBER.editable = true;#EOL#&#x9;if (HT020_TXLOTNUMBER.value == '') {#EOL#&#x9;&#x9;HT020_TXLOTNUMBER.error = '入荷品のロット№を入力してください。';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 受払単価の設定 //#EOL#////////////////////#EOL#if (HT020_KBTOKUSYUSIIRE.value == '10') { //10：仕入返品//#EOL#&#x9;if (HT020_PRUKEBARAI.value == 0) {#EOL#&#x9;&#x9;var amGenzaiko = Number(ET010_AMKISYUZAIKO.value) + Number(ET010_AMNYUKO.value) - ET010_AMSYUKKO.value;#EOL#&#x9;&#x9;var qtGenzaiko = Number(ET010_QTKISYUZAIKO.value) + Number(ET010_QTNYUKO.value) - ET010_QTSYUKKO.value;#EOL#&#x9;&#x9;if (qtGenzaiko != 0) {#EOL#&#x9;&#x9;&#x9;HT020_PRUKEBARAI.value = Math.round(amGenzaiko / qtGenzaiko);#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL#if (HT020_KBTOKUSYUSIIRE.value == '20') { //20：直接入荷//#EOL#&#x9;HT020_PRUKEBARAI.value = 0;#EOL#&#x9;HT020_PRUKEBARAI.editable = false;#EOL#&#x9;var amUkebarai = Number(HT020_AMTORIHIKI.value) + Number(HT020_AMTAX.value);#EOL#&#x9;if (HT020_QTTORIHIKIKANZAN.value != 0) {#EOL#&#x9;&#x9;HT020_PRUKEBARAI.value = Math.round(amUkebarai / HT020_QTTORIHIKIKANZAN.value);#EOL#&#x9;}#EOL#}"/><Script EventP="BU;BD;AR" EventR="AR()" Function="" Name="更新前・削除前・読込後設定" Order="0030" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#HT020_KBSIIREUM.editable = false;#EOL#HT020_VLKANZANKEISU.editable = false;#EOL#HT020_PRSIIRETANKAeditable = false;#EOL#HT020_KBTOKUSYUSIIRE.editable = false;#EOL#HT020_NRTORIHIKISAKI.editable = false;#EOL#HT020_QTTORIHIKIKANZAN.editable = false;#EOL#HT020_AMTORIHIKI.editable = false;#EOL#HT020_AMTORIHIKINAIKA.editable = false;#EOL#HT020_AMTAX.editable = false;#EOL#HT020_PRUKEBARAI.editable = false;#EOL#HT020_KBTORIHIKIUM.editable = false;#EOL#HT020_NRSYOHIN.editable = false;#EOL##EOL#//////////////////////#EOL#// 会計期間チェック //#EOL#//////////////////////#EOL#if (instance.functionID == 'HF021C' || instance.functionID == 'HF021D') {#EOL#&#x9;HT020_DTTORIHIKI.error = session.getErrorOfAccountDate(HT020_DTTORIHIKI.value);#EOL#}#EOL##EOL#////////////////////#EOL#// 取引金額の設定 //#EOL#////////////////////#EOL#HT020_AMTORIHIKI.value = HT020_QTTORIHIKI.value * HT020_PRTORIHIKI.value;#EOL#HT020_AMTORIHIKI.oldValue = HT020_QTTORIHIKI.oldValue * HT020_PRTORIHIKI.oldValue;#EOL##EOL#//////////////////////////////////////////////////#EOL#// 取引単位の設定と取引数の在庫管理単位への換算 //#EOL#//////////////////////////////////////////////////#EOL#if (HT020_KBTOKUSYUSIIRE.value == '10') { // 10：仕入返品 //#EOL#&#x9;HT020_KBTORIHIKIUM.value = BT020_KBZAIKOUM.value;#EOL#&#x9;HT020_QTTORIHIKIKANZAN.value = HT020_QTTORIHIKI.value;#EOL#&#x9;HT020_KBTORIHIKIUM.oldValue = BT020_KBZAIKOUM.oldValue;#EOL#&#x9;HT020_QTTORIHIKIKANZAN.oldValue = HT020_QTTORIHIKI.oldValue;#EOL#}#EOL#if (HT020_KBTOKUSYUSIIRE.value == '20') { // 20：直接入荷 //#EOL#&#x9;HT020_KBTORIHIKIUM.value = HT020_KBSIIREUM.value;#EOL#&#x9;HT020_QTTORIHIKIKANZAN.value = HT020_QTTORIHIKI.value * HT020_VLKANZANKEISU.value;#EOL#&#x9;HT020_KBTORIHIKIUM.oldValue = HT020_KBSIIREUM.value;#EOL#&#x9;HT020_QTTORIHIKIKANZAN.oldValue = HT020_QTTORIHIKI.oldValue * HT020_VLKANZANKEISU.value;#EOL#}#EOL##EOL#////////////////////////////////#EOL#// 内貨取引額と消費税額の設定 //#EOL#////////////////////////////////#EOL#var rtRate = session.getMonthlyExchangeRate(AT030_KBCURRENCY.value, HT020_DTTORIHIKI.value, 'TTS');#EOL#HT020_AMTORIHIKINAIKA.value = Math.round(HT020_AMTORIHIKI.value * rtRate);#EOL#rtRate = session.getMonthlyExchangeRate(AT030_KBCURRENCY.value, HT020_DTTORIHIKI.oldValue, 'TTS');#EOL#HT020_AMTORIHIKINAIKA.oldValue = Math.round(HT020_AMTORIHIKI.oldValue * rtRate);#EOL#if (AT030_KBCOUNTRY.value == (session.getSystemVariantString('SYSTEM_COUNTRY') + '')) {#EOL#&#x9;HT020_AMTAX.value = session.getTaxAmount(HT020_DTTORIHIKI.value, HT020_AMTORIHIKINAIKA.value);#EOL#&#x9;HT020_AMTAX.oldValue = session.getTaxAmount(HT020_DTTORIHIKI.oldValue, HT020_AMTORIHIKINAIKA.oldValue);#EOL#} else {#EOL#&#x9;HT020_AMTAX.value = 0;#EOL#&#x9;HT020_AMTAX.oldValue = 0;#EOL#}#EOL##EOL#////////////////////#EOL#// ロット№の設定 //#EOL#////////////////////#EOL#if (BT020_FGLOTKANRI.value == 'F') {#EOL#&#x9;HT020_TXLOTNUMBER.editable = false;#EOL#} else {#EOL#&#x9;if (HT020_TXLOTNUMBER.value == '') {#EOL#&#x9;&#x9;HT020_TXLOTNUMBER.error = '入荷品のロット№を入力してください。';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 受払単価の設定 //#EOL#////////////////////#EOL#if (HT020_KBTOKUSYUSIIRE.value == '20') { // 20：直接入荷 //#EOL#&#x9;if (HT020_QTTORIHIKIKANZAN.value != 0) {#EOL#&#x9;&#x9;HT020_PRUKEBARAI.value = Math.round(HT020_AMTORIHIKINAIKA.value / HT020_QTTORIHIKIKANZAN.value);#EOL#&#x9;}#EOL#&#x9;if (HT020_QTTORIHIKIKANZAN.oldValue != 0) {#EOL#&#x9;&#x9;HT020_PRUKEBARAI.oldValue = Math.round(HT020_AMTORIHIKINAIKA.oldValue / HT020_QTTORIHIKIKANZAN.oldValue);#EOL#&#x9;}#EOL#}"/><Script EventP="AC" EventR="" Function="" Name="追加後の関連レコード処理" Order="0040" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var uCT010; var cCT100; var cET100; var rET010; var uET010; var cET010;#EOL#var rtRate = 0.000; var prSiireNaika = 0;#EOL#var amSiireNaika = 0; var amSiire = 0; var amTax = 0; var amKeijyouUpdated = 0; var amSagaku = 0;#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0; var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0; var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var errorMessage = ''; var edt; var dtNend = 0; var dtMSeq = 0; var siireKubun = ''; var ukebaraiKubun = '';#EOL##EOL#/////////////////////////////////////////#EOL#// 関連する仕入先マスター(CT010)の検索 //#EOL#/////////////////////////////////////////#EOL#rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#rCT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#rCT010.addKeyValue('NRTORIHIKISAKI', HT020_NRTORIHIKISAKI.value);#EOL#if (rCT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(HT020_DTTORIHIKI.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(HT020_DTTORIHIKI.value);#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// 区分別金額の符号設定 //#EOL#&#x9;//////////////////////////#EOL#&#x9;if (HT020_KBTOKUSYUSIIRE.value == '10') {#EOL#&#x9;&#x9;siireKubun = '02'; //仕入返品//#EOL#&#x9;&#x9;ukebaraiKubun = '12'; //仕入返品//#EOL##EOL#&#x9;&#x9;qtSiire = HT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;amSiireNaika = HT020_AMTORIHIKINAIKA.value * -1;#EOL#&#x9;&#x9;amSiire = HT020_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;amTax = HT020_AMTAX.value * -1;#EOL##EOL#&#x9;&#x9;amUkebarai = HT020_PRUKEBARAI.value * HT020_QTTORIHIKIKANZAN.value * -1;#EOL#&#x9;&#x9;amSagaku = amUkebarai - amSiireNaika;#EOL#&#x9;&#x9;amNyuko = 0;#EOL#&#x9;&#x9;amSyukko = HT020_PRUKEBARAI.value * HT020_QTTORIHIKIKANZAN.value;#EOL##EOL#&#x9;&#x9;qtUkebarai = HT020_QTTORIHIKIKANZAN.value * -1;#EOL#&#x9;&#x9;qtNyuko = 0;#EOL#&#x9;&#x9;qtSyukko = HT020_QTTORIHIKIKANZAN.value#EOL#&#x9;}#EOL#&#x9;if (HT020_KBTOKUSYUSIIRE.value == '20') {#EOL#&#x9;&#x9;siireKubun = '01'; //直仕入(発注なしの入荷仕入)//#EOL#&#x9;&#x9;ukebaraiKubun = '11'; //直入荷//#EOL##EOL#&#x9;&#x9;amSiireNaika = HT020_AMTORIHIKINAIKA.value;#EOL#&#x9;&#x9;amSiire = HT020_PRTORIHIKI.value * HT020_QTTORIHIKI.value;#EOL#&#x9;&#x9;amTax = HT020_AMTAX.value;#EOL##EOL#&#x9;&#x9;amUkebarai = amSiireNaika;#EOL#&#x9;&#x9;amNyuko = amUkebarai;#EOL#&#x9;&#x9;amSyukko = 0;#EOL##EOL#&#x9;&#x9;qtUkebarai = HT020_QTTORIHIKIKANZAN.value;#EOL#&#x9;&#x9;qtNyuko = qtUkebarai;#EOL#&#x9;&#x9;qtSyukko = 0;#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 仕入実績(CT100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;siireKubun);#EOL#&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT020_PRTORIHIKI.value);#EOL#&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;HT020_QTTORIHIKI.value);#EOL#&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;HT020_KBTORIHIKIUM.value);#EOL#&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiire);#EOL#&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTax);#EOL#&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;HT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;HT020_NRLOCATION.value);#EOL#&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;HT020_TXLOTNUMBER.value);#EOL#&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagaku);#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko);#EOL#&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko);#EOL#&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('NRLOCATION',&#x9;HT020_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER', &#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;HT020_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 仕入先マスター(CT010)の買掛残高更新 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rCT010.getValueOf('AMKEIJYOU')) + Number(amSiire) + Number(amTax);#EOL#&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Field Decimal="2" ID="PRTORIHIKI" Name="取引単価" Nullable="F" Order="0090" Remarks="取引通貨での値" Size="10" Type="DECIMAL" TypeOptions=""/><Field Decimal="" ID="QTTORIHIKI" Name="取引数量" Nullable="F" Order="0100" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTTORIHIKIKANZAN" Name="在庫単位換算数" Nullable="F" Order="0180" Remarks="在庫単位での取引数。仕入返品は在庫単位ベースで処理されるので、仕入返品数と一致する。いっぽう、直接入荷では仕入単位ベースで処理されるので、入荷数に換算係数を掛け合わせた値になる。" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="AD" EventR="" Function="" Name="削除後の関連レコード処理" Order="0060" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var uCT010; var rCT100; var uCT100; var cCT100;#EOL#var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;#EOL#var qtSiire = 0; var amSiireNaika = 0; var amSiire = 0; var amTax = 0; var amKeijyouUpdated = 0;#EOL#var amUkebarai = 0; var amSagaku = 0; var amNyuko = 0; var amSyukko = 0; var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0; var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var siireKubun = ''; var ukebaraiKubun = ''; var errorMessage = '';#EOL##EOL#/////////////////////////////////////////#EOL#// 関連する仕入先マスター(CT010)の検索 //#EOL#/////////////////////////////////////////#EOL#rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#rCT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#rCT010.addKeyValue('NRTORIHIKISAKI', HT020_NRTORIHIKISAKI.value);#EOL#if (rCT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(HT020_DTTORIHIKI.oldValue);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(HT020_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// 区分別金額の符号設定 //#EOL#&#x9;//////////////////////////#EOL#&#x9;if (HT020_KBTOKUSYUSIIRE.value == '10') {#EOL#&#x9;&#x9;siireKubun = '02'; //仕入返品//#EOL#&#x9;&#x9;ukebaraiKubun = '12'; //返品出庫//#EOL##EOL#&#x9;&#x9;qtSiire = HT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;amSiireNaika = HT020_AMTORIHIKINAIKA.oldValue;#EOL#&#x9;&#x9;amSiire = HT020_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;amTax = HT020_AMTAX.oldValue;#EOL##EOL#&#x9;&#x9;amUkebarai = HT020_PRUKEBARAI.oldValue * HT020_QTTORIHIKIKANZAN.oldValue;#EOL#&#x9;&#x9;amSagaku = amSiireNaika - umUkebarai;#EOL#&#x9;&#x9;amNyuko = 0;#EOL#&#x9;&#x9;amSyukko = amUkebarai * -1;#EOL##EOL#&#x9;&#x9;qtUkebarai = HT020_QTTORIHIKIKANZAN.oldValue;#EOL#&#x9;&#x9;qtNyuko = 0;#EOL#&#x9;&#x9;qtSyukko = qtUkebarai * -1;#EOL#&#x9;}#EOL#&#x9;if (HT020_KBTOKUSYUSIIRE.value == '20') {#EOL#&#x9;&#x9;siireKubun = '01'; //直仕入(発注なしの入荷仕入)//#EOL#&#x9;&#x9;ukebaraiKubun = '11'; //仕入入庫//#EOL##EOL#&#x9;&#x9;qtSiire = HT020_QTTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amSiireNaika = HT020_AMTORIHIKINAIKA.oldValue * -1;#EOL#&#x9;&#x9;amSiire = HT020_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amTax = HT020_AMTAX.oldValue * -1;#EOL##EOL#&#x9;&#x9;amUkebarai = amSiireNaika;#EOL#&#x9;&#x9;amSagaku = 0;#EOL#&#x9;&#x9;amNyuko = amUkebarai; //amUkebaraiは負数//#EOL#&#x9;&#x9;amSyukko = 0;#EOL##EOL#&#x9;&#x9;qtUkebarai = HT020_QTTORIHIKIKANZAN.oldValue * -1;#EOL#&#x9;&#x9;qtNyuko = qtUkebarai; //qtUkebaraiは負数//#EOL#&#x9;&#x9;qtSyukko = 0;#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する仕入実績(CT100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;&#x9;rCT100.setSelectFields('NRSIIRE, NRSIHARAIIRAI, UPDCOUNTER');#EOL#&#x9;&#x9;rCT100.addKeyValue('NRTORIHIKIKANRI', HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;&#x9;if (rCT100.getValueOf('NRSIHARAIIRAI').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する仕入実績が支払依頼処理されているため、変更処理はキャンセルされます。関連する支払依頼(' + rCT100.getValueOf('NRSIHARAIIRAI') + ')から当該の仕入実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;uCT100 = instance.createTableOperator('Update', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addValue('UPDCOUNTER',&#x9;Number(rCT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('NRSIIRE',&#x9;&#x9;rCT100.getValueOf('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('UPDCOUNTER',&#x9;rCT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 仕入実績(CT100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;siireKubun);#EOL#&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT020_PRTORIHIKI.oldValue);#EOL#&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;qtSiire);#EOL#&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;HT020_KBTORIHIKIUM.oldValue);#EOL#&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiire);#EOL#&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTax);#EOL#&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;HT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;HT020_NRLOCATION.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.oldValue);#EOL#&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;HT020_TXLOTNUMBER.oldValue);#EOL#&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagaku);#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko);#EOL#&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko);#EOL#&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 仕入先マスター(CT010)の買掛残高更新 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rCT010.getValueOf('AMKEIJYOU')) + Number(amSiire) + Number(amTax);#EOL#&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="更新後の関連レコード処理" Order="0050" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rCT010; var uCT010; var rCT100; var uCT100; var cCT100;#EOL#var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;  #EOL#var amSiireNaikaNew = 0; var amSiireNew = 0; var amTaxNew = 0; var qtSiireNew = 0; #EOL#var amSiireNaikaOld = 0; var amSiireOld = 0; var amTaxOld = 0; var qtSiireOld = 0;#EOL#var dtNendNew = 0; var dtMSeqNew = 0; var dtNendOld = 0; var dtMSeqOld = 0;#EOL#var amUkebaraiNew = 0; var amNyukoNew = 0; var amSyukkoNew = 0;#EOL#var amUkebaraiOld = 0; var amNyukoOld = 0; var amSyukkoOld = 0;#EOL#var qtUkebaraiNew = 0; var qtNyukoNew = 0; var qtSyukkoNew = 0;#EOL#var qtUkebaraiOld = 0; var qtNyukoOld = 0; var qtSyukkoOld = 0;#EOL#var amSagakuOld = 0; var amSagakuNew = 0;#EOL#var qtNyukoUpdated = 0; var amNyukoUpdated = 0; var qtSyukkoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var amKeijyouUpdated = 0; var siireKubun = ''; var ukebaraiKubun = ''; var errorMessage = ''; var count = 0;#EOL##EOL#//////////////////////////#EOL#// フィールド値変更検査 //#EOL#//////////////////////////#EOL#if (HT020_DTTORIHIKI.valueChanged || HT020_NRSYOHIN.valueChanged || HT020_NRSOUKO.valueChanged ||#EOL#&#x9;HT020_NRLOCATION.valueChanged || HT020_QTTORIHIKI.valueChanged || HT020_TXLOTNUMBER.valueChanged ||#EOL#&#x9;HT020_PRTORIHIKI.valueChanged || HT020_NRSOUKO.valueChanged) {#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 関連する仕入先マスター(CT010)の検索 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#&#x9;rCT010.setSelectFields('AMKEIJYOU, UPDCOUNTER');#EOL#&#x9;rCT010.addKeyValue('NRTORIHIKISAKI', HT020_NRTORIHIKISAKI.value);#EOL#&#x9;if (rCT010.next()) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 赤伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendOld = session.getFYearOfDate(HT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;dtMSeqOld = session.getMSeqOfDate(HT020_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 区分別金額の符号設定 //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;if (HT020_KBTOKUSYUSIIRE.value == '10') {#EOL#&#x9;&#x9;&#x9;siireKubun = '02'; //仕入返品//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '12'; //返品出庫//#EOL##EOL#&#x9;&#x9;&#x9;qtSiireOld = HT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;amSiireNaikaOld = HT020_AMTORIHIKINAIKA.oldValue;#EOL#&#x9;&#x9;&#x9;amSiireOld = HT020_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;amTaxOld = HT020_AMTAX.oldValue;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiOld = HT020_PRUKEBARAI.oldValue * HT020_QTTORIHIKIKANZAN.oldValue;#EOL#&#x9;&#x9;&#x9;amSagakuOld = amSiireNaikaOld - amUkebaraiOld;#EOL#&#x9;&#x9;&#x9;amNyukoOld = 0;#EOL#&#x9;&#x9;&#x9;amSyukkoOld = amUkebaraiOld * -1;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiOld = HT020_QTTORIHIKIKANZAN.oldValue;#EOL#&#x9;&#x9;&#x9;qtNyukoOld = 0;#EOL#&#x9;&#x9;&#x9;qtSyukkoOld = qtUkebaraiOld * -1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT020_KBTOKUSYUSIIRE.value == '20') {#EOL#&#x9;&#x9;&#x9;siireKubun = '01'; //直仕入(発注なしの入荷仕入)//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '11'; //直入荷//#EOL##EOL#&#x9;&#x9;&#x9;qtSiireOld = HT020_QTTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amSiireNaikaOld = HT020_AMTORIHIKINAIKA.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amSiireOld = HT020_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amTaxOld = HT020_AMTAX.oldValue * -1;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiOld = amSiireNaikaOld;#EOL#&#x9;&#x9;&#x9;amSagakuOld = 0;#EOL#&#x9;&#x9;&#x9;amNyukoOld = amUkebaraiOld; //amUkebaraiOldは負数//#EOL#&#x9;&#x9;&#x9;amSyukkoOld = 0;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiOld = HT020_QTTORIHIKIKANZAN.oldValue * -1;#EOL#&#x9;&#x9;&#x9;qtNyukoOld = qtUkebaraiOld; //qtUkebaraiOldは負数//#EOL#&#x9;&#x9;&#x9;qtSyukkoOld = 0;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する仕入実績(CT100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;&#x9;&#x9;rCT100.setSelectFields('NRSIIRE, NRSIHARAIIRAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rCT100.addKeyValue('NRTORIHIKIKANRI', HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;if (rCT100.getValueOf('NRSIHARAIIRAI').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する仕入実績が支払依頼処理されているため、変更処理はキャンセルされます。関連する支払依頼(' + rCT100.getValueOf('NRSIHARAIIRAI') + ')から当該の仕入実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100 = instance.createTableOperator('Update', 'CT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addValue('UPDCOUNTER',&#x9;Number(rCT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('NRSIIRE',&#x9;&#x9;rCT100.getValueOf('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uCT100.addKeyValue('UPDCOUNTER',&#x9;rCT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uCT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 仕入実績(CT100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;siireKubun);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT020_PRTORIHIKI.oldValue);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;qtSiireOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;HT020_KBTORIHIKIUM.oldValue);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiireOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTaxOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;&#x9;&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;HT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;HT020_NRLOCATION.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;HT020_TXLOTNUMBER.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebaraiOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebaraiOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagakuOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 黒伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendNew = session.getFYearOfDate(HT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;dtMSeqNew = session.getMSeqOfDate(HT020_DTTORIHIKI.value);#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 区分別金額の符号設定 //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;if (HT020_KBTOKUSYUSIIRE.value == '10') {#EOL#&#x9;&#x9;&#x9;siireKubun = '02'; //仕入返品//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '12'; //返品出庫//#EOL##EOL#&#x9;&#x9;&#x9;qtSiireNew = HT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;amSiireNaikaNew = HT020_AMTORIHIKINAIKA.value * -1;#EOL#&#x9;&#x9;&#x9;amSiireNew = HT020_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;amTaxNew = HT020_AMTAX.value * -1;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiNew = HT020_PRUKEBARAI.value * HT020_QTTORIHIKIKANZAN.value * -1;#EOL#&#x9;&#x9;&#x9;amSagakuNew = amUkebaraiNew - amSiireNaikaNew;#EOL#&#x9;&#x9;&#x9;amNyukoNew = 0;#EOL#&#x9;&#x9;&#x9;amSyukkoNew = HT020_PRUKEBARAI.value * HT020_QTTORIHIKIKANZAN.value;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiNew = HT020_QTTORIHIKIKANZAN.value * -1;#EOL#&#x9;&#x9;&#x9;qtNyukoNew = 0;#EOL#&#x9;&#x9;&#x9;qtSyukkoNew = HT020_QTTORIHIKIKANZAN.value;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (HT020_KBTOKUSYUSIIRE.value == '20') {#EOL#&#x9;&#x9;&#x9;siireKubun = '01'; //直仕入(発注なしの入荷仕入)//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '11'; //仕入入庫//#EOL##EOL#&#x9;&#x9;&#x9;qtSiireNew = HT020_QTTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;amSiireNaikaNew = HT020_AMTORIHIKINAIKA.value;#EOL#&#x9;&#x9;&#x9;amSiireNew = HT020_AMTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;amTaxNew = HT020_AMTAX.value;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiNew = amSiireNaikaNew;#EOL#&#x9;&#x9;&#x9;amSagakuNew = 0;#EOL#&#x9;&#x9;&#x9;amNyukoNew = amUkebaraiNew;#EOL#&#x9;&#x9;&#x9;amSyukkoNew = 0;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiNew = HT020_QTTORIHIKIKANZAN.value;#EOL#&#x9;&#x9;&#x9;qtNyukoNew = qtUkebaraiNew;#EOL#&#x9;&#x9;&#x9;qtSyukkoNew = 0;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 仕入実績(CT100)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cCT100 = instance.createTableOperator('Insert', 'CT100');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSIIRE',&#x9;&#x9;&#x9;session.getNextNumber('NRSIIRE'));#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIRE',&#x9;&#x9;&#x9;siireKubun);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTSIIRE',&#x9;&#x9;&#x9;HT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('PRSIIRE',&#x9;&#x9;&#x9;HT020_PRTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBCURRENCY',&#x9;&#x9;AT030_KBCURRENCY.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('QTSIIRE',&#x9;&#x9;&#x9;qtSiireNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('KBSIIREUM',&#x9;&#x9;HT020_KBTORIHIKIUM.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMSIIRE',&#x9;&#x9;&#x9;amSiireNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTaxNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;cCT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cCT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入実績(CT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;HT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;HT020_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;HT020_TXLOTNUMBER.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebaraiNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebaraiNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagakuNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;HT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 残高更新 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新(旧値にもとづく) //#EOL#&#x9;&#x9;///////////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyukoOld);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukkoOld);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新(新値にもとづく) //#EOL#&#x9;&#x9;///////////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('NRLOCATION',&#x9;HT020_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;HT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;HT020_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;// 仕入先マスター(CT010)の買掛残高更新 //#EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;amKeijyouUpdated = Number(rCT010.getValueOf('AMKEIJYOU'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amSiireOld) + Number(amTaxOld)#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amSiireNew) + Number(amTaxNew);#EOL#&#x9;&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先マスタ(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;//返品通知書の発行//#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;if (HT020_KBTOKUSYUSIIRE.value == '10') {#EOL#&#x9;&#x9;&#x9;if (AT030_KBCOUNTRY.value == 'JPN') {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('HF022A'); //返品通知書(日本語)//#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('HF022B'); //返品通知書(英語)//#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '仕入先マスタが存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="PRUKEBARAI" Name="受払単価" Nullable="T" Order="0120" Remarks="仕入返品時には在庫出庫額（内貨）として入力され、直接入荷時には自動設定される。" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="KBTORIHIKIUM" Name="取引単位区分" Nullable="F" Order="0110" Size="5" Type="CHAR" TypeOptions="KUBUN(KBZAIKOUM)"/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0080" Remarks="ロット管理商品であれば設定される" Size="40" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMTORIHIKINAIKA" Name="内貨税抜取引額" Nullable="T" Order="0200" Remarks="内貨での値" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Refer Fields="QTKISYUZAIKO;QTNYUKO;QTSYUKKO;AMKISYUZAIKO;AMNYUKO;AMSYUKKO;NRLOCATION" Optional="T" Order="0070" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="HT020.NRSYOHIN;HT020.NRSOUKO"/><Field ID="VLKANZANKEISU" Name="単位換算係数" NoUpdate="T" Nullable="F" Order="0160" Remarks="範囲検索されたCT011から設定される" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="2" ID="PRSIIRETANKA" Name="契約仕入単価" NoUpdate="T" Nullable="F" Order="0170" Remarks="範囲検索されたCT011から設定される" Size="10" Type="DECIMAL" TypeOptions="VIRTUAL"/><Field ID="KBSIIREUM" Name="仕入単位区分" NoUpdate="T" Nullable="F" Order="0150" Remarks="範囲検索されたCT011から設定される" Size="5" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(KBZAIKOUM)"/><Script EventP="BC;BU;BD;AR" EventR="AR()" Function="" Name="仮想フィールドの設定" Order="0010" Text="////////////////////////////#EOL#// 仕入先別商品明細の読取 //#EOL#////////////////////////////#EOL#var rCT011 = instance.createTableOperator('Select', 'CT011');#EOL#rCT011.addKeyValue('NRTORIHIKISAKI',&#x9;HT020_NRTORIHIKISAKI.value);#EOL#rCT011.addKeyValue('NRSYOHIN',&#x9;&#x9;&#x9;HT020_NRSYOHIN.value);#EOL#rCT011.addKeyValue('DTHAKKOU &lt;=',&#x9;&#x9;HT020_DTTORIHIKI.value);#EOL#rCT011.addKeyValue('DTSIKKOU >=',&#x9;&#x9;HT020_DTTORIHIKI.value);#EOL#if (rCT011.next()) {#EOL#&#x9;HT020_KBSIIREUM.value = rCT011.getValueOf('KBSIIREUM');#EOL#&#x9;HT020_VLKANZANKEISU.value = rCT011.getValueOf('VLKANZANKEISU');#EOL#&#x9;HT020_PRSIIRETANKA.value = rCT011.getValueOf('PRSIIRETANKA');#EOL#}"/></Table><Table ActiveWhere="" ID="JT020" Name="特殊売上" RangeKey="" Remarks="「顧客からの返品」および「受注なしの出荷」に関する情報を保持するためのテーブル" SubsystemID="J"><Field Decimal="" ID="NRTOKUSYUURIAGE" Name="特殊売上№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTOKUSYUURIAGE)"/><Field Decimal="" ID="KBTOKUSYUURIAGE" Name="取引区分" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBTOKUSYUURIAGE)"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0030" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQSYUKKASAKI" Name="出荷先行番" Nullable="F" Order="0040" Remarks="売上返品では無意味だが、直接出荷において指定必須であるためにNull不可にしてある。売上返品では便宜上最初の出荷先の行番が自動設定される。" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="DTTORIHIKI" Name="取引日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="商品№" Nullable="F" Order="0060" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSOUKO" Name="取引倉庫№" Nullable="F" Order="0080" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRLOCATION" Name="ロケ№" Nullable="F" Order="0090" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="PRTORIHIKI" Name="取引単価" Nullable="F" Order="0100" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTTORIHIKI" Name="取引数量" Nullable="F" Order="0110" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0130" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0150" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Key Fields="NRTOKUSYUURIAGE" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Field Decimal="" ID="NRSEIKYU" Name="都度請求№" Nullable="T" Order="0140" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMTORIHIKI" Name="税抜取引額" Nullable="T" Order="0151" Remarks="" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMTAX" Name="消費税額" Nullable="T" Order="0152" Remarks="" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Refer Fields="TXKANJI" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="JT020.NRTORIHIKISAKI"/><Refer Fields="NRTANTOUJYUGYOIN;KBSEIKYUHOUSHIKI" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="JT020.NRTORIHIKISAKI"/><Refer Fields="TXSYOHIN;TXHINBAN;TXSIYOU;PRHANBAI;KBZAIKOUM;QTHANBAIUNIT;QTANZENZAIKO;QTJYOUGENZAIKO;FGLOTKANRI" Order="0050" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="JT020.NRSYOHIN"/><Refer Fields="TXSOUKO" Order="0060" OrderBy="" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="JT020.NRSOUKO"/><Refer Fields="TXKANJI" Order="0030" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Refer Fields="TXKANJI;NRYUBIN;TXJYUSYO" Order="0040" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI;SQSYUKKASAKI" ToTable="DT011" WithKeyFields="JT020.NRTORIHIKISAKI;JT020.SQSYUKKASAKI"/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0000" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#JT020_KBTOKUSYUURIAGE.editable = false;#EOL#JT020_AMTORIHIKI.editable = false;#EOL#JT020_AMTAX.editable = false;#EOL#JT020_NRSEIKYU.editable = false;#EOL#JT020_PRUKEBARAI.editable = false;#EOL##EOL#//////////////////////////////////////////#EOL#// 取引日の初期値設定と会計期間チェック //#EOL#//////////////////////////////////////////#EOL#if (JT020_DTTORIHIKI.value == null || JT020_DTTORIHIKI.value == '') {#EOL#&#x9;JT020_DTTORIHIKI.value = session.today + '';#EOL#}#EOL#JT020_DTTORIHIKI.error = session.getErrorOfAccountDate(JT020_DTTORIHIKI.value);#EOL##EOL#////////////////////#EOL#// ロケの初期設定 //#EOL#////////////////////#EOL#if (JT020_NRLOCATION.value == '') {#EOL#&#x9;JT020_NRLOCATION.value = ET010_NRLOCATION.value;#EOL#}#EOL##EOL#////////////////////////////////////////////////////////#EOL#// 売上返品での出荷先行番のダミー設定                 //#EOL#// (入力項目ではないにもかかわらず入力必須であるため) //#EOL#////////////////////////////////////////////////////////#EOL#if (JT020_KBTOKUSYUURIAGE.value == '10') { //売上返品//#EOL#&#x9;var rDT011 = instance.createTableOperator('Select', 'DT011');#EOL#&#x9;rDT011.setSelectFields('SQSYUKKASAKI');#EOL#&#x9;rDT011.addKeyValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;while (rDT011.next()) {#EOL#&#x9;&#x9;JT020_SQSYUKKASAKI.value = rDT011.getValueOf('SQSYUKKASAKI');#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 受払単価の設定 //#EOL#////////////////////#EOL#if (JT020_KBTOKUSYUURIAGE.value == '10') { //売上返品//#EOL#&#x9;JT020_PRUKEBARAI.value = JT020_PRTORIHIKI.value;#EOL#}#EOL#if (JT020_KBTOKUSYUURIAGE.value == '20') { //直接出荷//#EOL#&#x9;var amGenzaiko = ET010_AMKISYUZAIKO.value - ET010_AMSYUKKO.value + Number(ET010_AMNYUKO.value);#EOL#&#x9;var qtGenzaiko = ET010_QTKISYUZAIKO.value - ET010_QTSYUKKO.value + Number(ET010_QTNYUKO.value);#EOL#&#x9;if (qtGenzaiko == 0) {#EOL#&#x9;&#x9;JT020_PRUKEBARAI.error = '現在庫数がゼロのため、出庫単価を設定できません';#EOL#&#x9;} else {#EOL#&#x9;&#x9;JT020_PRUKEBARAI.value = Math.round(amGenzaiko / qtGenzaiko);#EOL#&#x9;}#EOL#}#EOL##EOL#/////////////////////////////#EOL#// 取引金額,消費税額の設定 //#EOL#/////////////////////////////#EOL#JT020_AMTORIHIKI.value = JT020_QTTORIHIKI.value * JT020_PRTORIHIKI.value;#EOL#JT020_AMTAX.value = session.getTaxAmount(JT020_DTTORIHIKI.value, JT020_AMTORIHIKI.value);#EOL##EOL#//////////////////////#EOL#// ロット番号の設定 //#EOL#//////////////////////#EOL#if (BT020_FGLOTKANRI.value == 'T') {#EOL#&#x9;JT020_TXLOTNUMBER.editable = true;#EOL#&#x9;if (JT020_TXLOTNUMBER.value == '') {#EOL#&#x9;&#x9;JT020_TXLOTNUMBER.error = 'ロット管理品です。ロット№を入力してください。';#EOL#&#x9;}#EOL#}#EOL#if (BT020_FGLOTKANRI.value == 'F') {#EOL#&#x9;JT020_TXLOTNUMBER.editable = false;#EOL#}#EOL##EOL#//////////////////////////////////////////#EOL#// 都度請求処理対象であれば請求№を採番 //#EOL#//////////////////////////////////////////#EOL#if (DT010_KBSEIKYUHOUSHIKI.value == '20') {#EOL#&#x9;JT020_NRSEIKYU.value = session.getNextNumber('NRSEIKYU');#EOL#} else {#EOL#&#x9;JT020_NRSEIKYU.value = '';#EOL#}#EOL#"/><Script EventP="BU;BD;AR" EventR="AR()" Function="" Name="更新・削除前設定" Order="0001" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#JT020_KBTOKUSYUURIAGE.editable = false;#EOL#JT020_NRTORIHIKISAKI.editable = false;#EOL#JT020_AMTORIHIKI.editable = false;#EOL#JT020_AMTAX.editable = false;#EOL#JT020_NRSEIKYU.editable = false;#EOL#JT020_NRSYOHIN.editable = false;#EOL#JT020_NRSOUKO.editable = false;#EOL#if (JT020_KBTOKUSYUURIAGE.value == '20') {#EOL#&#x9;JT020_PRUKEBARAI.editable = false;#EOL#}#EOL##EOL#////////////////////#EOL#// 会計日チェック //#EOL#////////////////////#EOL#if (instance.functionID == 'JF021C' || instance.functionID == 'JF021D') {#EOL#&#x9;JT020_DTTORIHIKI.error = session.getErrorOfAccountDate(JT020_DTTORIHIKI.value);#EOL#}#EOL##EOL#//////////////////////#EOL#// ロット番号の設定 //#EOL#//////////////////////#EOL#if (BT020_FGLOTKANRI.value == 'T') {#EOL#&#x9;JT020_TXLOTNUMBER.editable = true;#EOL#&#x9;if (JT020_TXLOTNUMBER.value == '') {#EOL#&#x9;&#x9;JT020_TXLOTNUMBER.error = 'ロット管理品です。ロット№を入力してください。';#EOL#&#x9;}#EOL#} else {#EOL#&#x9;JT020_TXLOTNUMBER.editable = false;#EOL#}#EOL##EOL#///////////////////////////#EOL#// 取引額,消費税額の設定 //#EOL#///////////////////////////#EOL#JT020_AMTORIHIKI.value = JT020_QTTORIHIKI.value * JT020_PRTORIHIKI.value;#EOL#JT020_AMTAX.value = session.getTaxAmount(JT020_DTTORIHIKI.value, JT020_AMTORIHIKI.value);#EOL#JT020_AMTORIHIKI.oldValue = JT020_QTTORIHIKI.oldValue * JT020_PRTORIHIKI.oldValue;#EOL#JT020_AMTAX.oldValue = session.getTaxAmount(JT020_DTTORIHIKI.oldValue, JT020_AMTORIHIKI.oldValue);#EOL#"/><Script EventP="AC" EventR="" Function="" Name="追加時の関連レコード処理" Order="0002" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var cDT100; var cET100; var rET010; var uET010; var cET010;#EOL#var amUriage = 0; var amTax = 0; var amKeijyouUpdated = 0;#EOL#var amUkebarai = 0; var amSagaku = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0; var qtUriage = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0; var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var errorMessage = ''; var dtNend = 0; var dtMSeq = 0; var uriageKubun = ''; var ukebaraiKubun = '';#EOL##EOL#///////////////////////////////////////#EOL#// 関連する顧客マスター(DT010)の検索 //#EOL#///////////////////////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#rDT010.setSelectFields('AMKEIJYOU, NRTANTOUJYUGYOIN, KBSEIKYUHOUSHIKI, UPDCOUNTER');#EOL#rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#if (rDT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(JT020_DTTORIHIKI.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(JT020_DTTORIHIKI.value);#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 取引額と区分の設定 //#EOL#&#x9;////////////////////////#EOL#&#x9;if (JT020_KBTOKUSYUURIAGE.value == '10') {#EOL#&#x9;&#x9;uriageKubun = '02'; //顧客からの返品//#EOL#&#x9;&#x9;ukebaraiKubun = '22'; //返品入庫//#EOL##EOL#&#x9;&#x9;qtUtiage = JT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;amUriage = JT020_PRTORIHIKI.value * qtUtiage;#EOL#&#x9;&#x9;amTax = JT020_AMTAX.value * -1;#EOL##EOL#&#x9;&#x9;amUkebarai = Number(JT020_PRTORIHIKI.value * JT020_QTTORIHIKI.value) - Number(amTax);#EOL#&#x9;&#x9;amSagaku = 0;#EOL#&#x9;&#x9;amNyuko = amUkebarai;#EOL#&#x9;&#x9;amSyukko = 0;#EOL##EOL#&#x9;&#x9;qtUkebarai = JT020_QTTORIHIKI.value;#EOL#&#x9;&#x9;qtNyuko = qtUkebarai;#EOL#&#x9;&#x9;qtSyukko = 0;#EOL#&#x9;}#EOL#&#x9;if (JT020_KBTOKUSYUURIAGE.value == '20') {#EOL#&#x9;&#x9;uriageKubun = '01'; //直出荷(受注なしの出荷売上)//#EOL#&#x9;&#x9;ukebaraiKubun = '21'; //直出荷//#EOL##EOL#&#x9;&#x9;qtUtiage = JT020_QTTORIHIKI.value;#EOL#&#x9;&#x9;amUriage = JT020_PRTORIHIKI.value * qtUtiage;#EOL#&#x9;&#x9;amTax = JT020_AMTAX.value;#EOL##EOL#&#x9;&#x9;amUkebarai = JT020_PRUKEBARAI.value * JT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;amSagaku = Number(amUriage) + Number(amTax) + Number(amUkebarai); // amUkebaraiは負数 //#EOL#&#x9;&#x9;amNyuko = 0;#EOL#&#x9;&#x9;amSyukko = JT020_PRUKEBARAI.value * JT020_QTTORIHIKI.value;#EOL##EOL#&#x9;&#x9;qtUkebarai = JT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;qtNyuko = 0;#EOL#&#x9;&#x9;qtSyukko = JT020_QTTORIHIKI.value;#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 売上実績(DT100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;uriageKubun);#EOL#&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT020_DTTORIHIKI.value);#EOL#&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;BT020_PRHANBAI.value);#EOL#&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;JT020_PRTORIHIKI.value);#EOL#&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;qtUtiage);#EOL#&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;BT020_KBZAIKOUM.value);#EOL#&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amUriage);#EOL#&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;amUkebarai * -1);#EOL#&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;JT020_NRSEIKYU.value);#EOL#&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;count = cDT100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;JT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;JT020_NRLOCATION.value);#EOL#&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;JT020_SQSYUKKASAKI.value);#EOL#&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;JT020_TXLOTNUMBER.value);#EOL#&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagaku);#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko);#EOL#&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko);#EOL#&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('NRLOCATION',&#x9;JT020_NRLOCATION.value)#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER', &#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;JT020_NRLOCATION.value)#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rDT010.getValueOf('AMKEIJYOU')) + Number(amUriage) + Number(amTax);#EOL#&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客マスタ(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 都度請求対象であれば請求指示データ生成 //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;if (rDT010.getValueOf('KBSEIKYUHOUSHIKI') == '20') {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRSEIKYU',&#x9;&#x9;JT020_NRSEIKYU.value);#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;instance.callFunction('DF112');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '顧客マスタが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="更新時の関連レコード処理" Order="0003" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var rDT100; var uDT100; var cDT100;#EOL#var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;#EOL#var amUriageNew = 0; var amTaxNew = 0; var amUriageOld = 0; var amTaxOld = 0; var amKeijyouUpdated = 0;#EOL#var amUkebaraiNew = 0; var amSagakuNew = 0; var amNyukoNew = 0; var amSyukkoNew = 0;#EOL#var amUkebaraiOld = 0; var amSagakuOld = 0; var amNyukoOld = 0; var amSyukkoOld = 0;#EOL#var qtUkebaraiNew = 0; var qtNyukoNew = 0; var qtSyukkoNew = 0; var qtUriageNew = 0;#EOL#var qtUkebaraiOld = 0; var qtNyukoOld = 0; var qtSyukkoOld = 0; var qtUriageOld = 0;#EOL#var dtNendNew = 0; var dtMSeqNew = 0; var dtNendOld = 0; var dtMSeqOld = 0; var amSeikyu = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0; var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var errorMessage = ''; var uriageKubun = ''; var ukebaraiKubun = '';#EOL##EOL#//////////////////////////#EOL#// フィールド値変更検査 //#EOL#//////////////////////////#EOL#if (JT020_DTTORIHIKI.valueChanged || JT020_NRSOUKO.valueChanged ||#EOL#&#x9;JT020_NRLOCATION.valueChanged || JT020_QTTORIHIKI.valueChanged || JT020_PRTORIHIKI.valueChanged) {#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する顧客マスター(DT010)の検索 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#&#x9;rDT010.setSelectFields('AMKEIJYOU, NRTANTOUJYUGYOIN, KBSEIKYUHOUSHIKI, UPDCOUNTER');#EOL#&#x9;rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;if (rDT010.next()) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 赤伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendOld = session.getFYearOfDate(JT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;dtMSeqOld = session.getMSeqOfDate(JT020_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 取引額と区分の設定 //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;if (JT020_KBTOKUSYUURIAGE.value == '10') {#EOL#&#x9;&#x9;&#x9;uriageKubun = '02'; //顧客からの返品//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '22'; //返品入庫//#EOL##EOL#&#x9;&#x9;&#x9;qtUriageOld = JT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;amUriageOld = JT020_PRTORIHIKI.oldValue * qtUriageOld;#EOL#&#x9;&#x9;&#x9;amTaxOld = JT020_AMTAX.oldValue;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiOld = Number(JT020_PRUKEBARAI.oldValue * JT020_QTTORIHIKI.oldValue) + Number(amTaxOld);#EOL#&#x9;&#x9;&#x9;amUkebaraiOld = amUkebaraiOld * -1;#EOL#&#x9;&#x9;&#x9;amSagakuOld = 0;#EOL#&#x9;&#x9;&#x9;amNyukoOld = amUkebaraiOld;#EOL#&#x9;&#x9;&#x9;amSyukkoOld = 0;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiOld = JT020_QTTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;qtNyukoOld = qtUkebaraiOld;#EOL#&#x9;&#x9;&#x9;qtSyukkoOld = 0;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (JT020_KBTOKUSYUURIAGE.value == '20') {#EOL#&#x9;&#x9;&#x9;uriageKubun = '01'; //直出荷(受注なしの出荷売上)//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '21'; //直出荷//#EOL##EOL#&#x9;&#x9;&#x9;qtUriageOld = JT020_QTTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amUriageOld = JT020_PRTORIHIKI.oldValue * qtUriageOld;#EOL#&#x9;&#x9;&#x9;amTaxOld = JT020_AMTAX.oldValue * -1;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiOld = JT020_PRUKEBARAI.oldValue * JT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;amSagakuOld = Number(amUriageOld) + Number(amTaxOld) + Number(amUkebaraiOld); // amUriageOldは負数。amSagakuOldも通常は負数 //#EOL#&#x9;&#x9;&#x9;amNyukoOld = 0;#EOL#&#x9;&#x9;&#x9;amSyukkoOld = amUkebaraiOld * -1;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiOld = JT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;qtNyukoOld = 0;#EOL#&#x9;&#x9;&#x9;qtSyukkoOld = qtUkebaraiOld * -1;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する売上実績(DT100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;&#x9;&#x9;rDT100.setSelectFields('NRURIAGE, NRSEIKYU, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rDT100.addKeyValue('NRTORIHIKIKANRI', JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;if (rDT100.getValueOf('NRSEIKYU').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する売上実績が請求処理されているため、取消処理はキャンセルされます。関連する請求指示(' + rDT100.getValueOf('NRSEIKYU') + ')から当該の売上実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 売上実績(DT100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;uriageKubun);#EOL#&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;BT020_PRHANBAI.value);#EOL#&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;JT020_PRTORIHIKI.oldValue);#EOL#&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;qtUriageOld);#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;BT020_KBZAIKOUM.value);#EOL#&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amUriageOld);#EOL#&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;amUkebaraiOld * -1);#EOL#&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;&#x9;&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;JT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;JT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;JT020_NRLOCATION.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;JT020_SQSYUKKASAKI.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;JT020_TXLOTNUMBER.oldValue);#EOL#&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebaraiOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebaraiOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagakuOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 黒伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendNew = session.getFYearOfDate(JT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;dtMSeqNew = session.getMSeqOfDate(JT020_DTTORIHIKI.value);#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 取引額と区分の設定 //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;if (JT020_KBTOKUSYUURIAGE.value == '10') {#EOL#&#x9;&#x9;&#x9;uriageKubun = '02'; //顧客からの返品//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '22'; //返品入庫//#EOL##EOL#&#x9;&#x9;&#x9;qtUriageNew = JT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;amUriageNew = JT020_PRTORIHIKI.value * qtUriageNew;#EOL#&#x9;&#x9;&#x9;amTaxNew = JT020_AMTAX.value * -1;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiNew = Number(JT020_PRTORIHIKI.value * JT020_QTTORIHIKI.value) - Number(amTaxNew);#EOL#&#x9;&#x9;&#x9;amSagakuNew = 0;#EOL#&#x9;&#x9;&#x9;amNyukoNew = amUkebaraiNew;#EOL#&#x9;&#x9;&#x9;amSyukkoNew = 0;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiNew = JT020_QTTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;qtNyukoNew = qtUkebaraiNew;#EOL#&#x9;&#x9;&#x9;qtSyukkoNew = 0;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (JT020_KBTOKUSYUURIAGE.value == '20') {#EOL#&#x9;&#x9;&#x9;uriageKubun = '01'; //直出荷(受注なしの出荷売上)//#EOL#&#x9;&#x9;&#x9;ukebaraiKubun = '21'; //直出荷//#EOL##EOL#&#x9;&#x9;&#x9;qtUriageNew = JT020_QTTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;amUriageNew = JT020_PRTORIHIKI.value * qtUriageNew;#EOL#&#x9;&#x9;&#x9;amTaxNew = JT020_AMTAX.value;#EOL##EOL#&#x9;&#x9;&#x9;amUkebaraiNew = JT020_PRUKEBARAI.value * JT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;amSagakuNew = Number(amUriageNew) + Number(amTaxNew) + Number(amUkebaraiNew); // amUkebaraiNewは負数 //#EOL#&#x9;&#x9;&#x9;amNyukoNew = 0;#EOL#&#x9;&#x9;&#x9;amSyukkoNew = JT020_PRUKEBARAI.value * JT020_QTTORIHIKI.value;#EOL##EOL#&#x9;&#x9;&#x9;qtUkebaraiNew = JT020_QTTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;qtNyukoNew = 0;#EOL#&#x9;&#x9;&#x9;qtSyukkoNew = JT020_QTTORIHIKI.value;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 売上実績(DT100)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;uriageKubun);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;BT020_PRHANBAI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;JT020_PRTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;qtUriageNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;BT020_KBZAIKOUM.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amUriageNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;amUkebaraiNew * -1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;JT020_NRSEIKYU.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;JT020_DTTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;JT020_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;JT020_SQSYUKKASAKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;JT020_TXLOTNUMBER.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebaraiNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebaraiNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagakuNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 残高更新 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) - qtNyukoOld + Number(qtNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) - amNyukoOld + Number(amNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) - qtSyukkoOld + Number(qtSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) - amSyukkoOld + Number(amSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('NRLOCATION',&#x9;JT020_NRLOCATION.value)#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER', &#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;JT020_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;JT020_NRLOCATION.value)#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyukoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukkoNew);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;amKeijyouUpdated = Number(rDT010.getValueOf('AMKEIJYOU'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amUriageOld) + Number(amTaxOld)#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amUriageNew) + Number(amTaxNew);#EOL#&#x9;&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '顧客マスタ(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 都度請求対象であれば請求指示データ生成 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rDT010.getValueOf('KBSEIKYUHOUSHIKI') == '20') {#EOL#&#x9;&#x9;&#x9;&#x9;amSeikyu = Number(amUriageOld) + Number(amTaxOld) + Number(amUriageNew) + Number(amTaxNew);#EOL#&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('NRSEIKYU',&#x9;&#x9;JT020_NRSEIKYU.value);#EOL#&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('AMSEIKYU',&#x9;&#x9;amSeikyu);#EOL#&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('DF112');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '顧客マスタが存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="削除時の関連レコード処理" Order="0004" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var cDT100; var cET100; var rET010; var uET010; var cET010;#EOL#var amUriage = 0; var amTax = 0; var amKeijyouUpdated = 0;#EOL#var amUkebarai = 0; var amSagaku = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0; var qtUriage = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0; var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var errorMessage = ''; var nrSeikyu = ''; var amSeikyu = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var uriageKubun = ''; var ukebaraiKubun = '';#EOL##EOL#///////////////////////////////////////#EOL#// 関連する顧客マスター(DT010)の検索 //#EOL#///////////////////////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#rDT010.setSelectFields('AMKEIJYOU, NRTANTOUJYUGYOIN, UPDCOUNTER');#EOL#rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#if (rDT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(JT020_DTTORIHIKI.oldValue);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(JT020_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 取引額と区分の設定 //#EOL#&#x9;////////////////////////#EOL#&#x9;if (JT020_KBTOKUSYUURIAGE.value == '10') {#EOL#&#x9;&#x9;uriageKubun = '02'; //顧客からの返品//#EOL#&#x9;&#x9;ukebaraiKubun = '22'; //返品入庫//#EOL##EOL#&#x9;&#x9;qtUriage = JT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;amUriage = JT020_PRTORIHIKI.oldValue * qtUriage;#EOL#&#x9;&#x9;amTax = JT020_AMTAX.oldValue;#EOL##EOL#&#x9;&#x9;amUkebarai = Number(JT020_PRUKEBARAI.oldValue * JT020_QTTORIHIKI.oldValue) + Number(amTax);#EOL#&#x9;&#x9;amUkebarai = amUkebarai * -1;#EOL#&#x9;&#x9;amSagaku = 0;#EOL#&#x9;&#x9;amNyuko = amUkebarai;#EOL#&#x9;&#x9;amSyukko = 0;#EOL##EOL#&#x9;&#x9;qtUkebarai = JT020_QTTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;qtNyuko = qtUkebarai;#EOL#&#x9;&#x9;qtSyukko = 0;#EOL#&#x9;}#EOL#&#x9;if (JT020_KBTOKUSYUURIAGE.value == '20') {#EOL#&#x9;&#x9;uriageKubun = '01'; //直出荷(受注なしの出荷売上)//#EOL#&#x9;&#x9;ukebaraiKubun = '21'; //直出荷//#EOL##EOL#&#x9;&#x9;qtUriage = JT020_QTTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amUriage = JT020_PRTORIHIKI.oldValue * qtUriage;#EOL#&#x9;&#x9;amTax = JT020_AMTAX.oldValue * -1;#EOL##EOL#&#x9;&#x9;amUkebarai = JT020_PRUKEBARAI.oldValue * JT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;amSagaku = Number(amUriage) + Number(amTax) + Number(amUkebarai); // amUriageは負数。amSagakuも通常は負数 //#EOL#&#x9;&#x9;amNyuko = 0;#EOL#&#x9;&#x9;amSyukko = amUkebarai * -1;#EOL##EOL#&#x9;&#x9;qtUkebarai = JT020_QTTORIHIKI.oldValue;#EOL#&#x9;&#x9;qtNyuko = 0;#EOL#&#x9;&#x9;qtSyukko = qtUkebarai * -1;#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する売上実績(DT100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;&#x9;rDT100.setSelectFields('NRURIAGE, NRSEIKYU, UPDCOUNTER');#EOL#&#x9;&#x9;rDT100.addKeyValue('NRTORIHIKIKANRI', JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;&#x9;if (rDT100.getValueOf('NRSEIKYU').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する売上実績が請求処理されているため、取消処理はキャンセルされます。関連する請求指示(' + rDT100.getValueOf('NRSEIKYU') + ')から当該の売上実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 売上実績(DT100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////#EOL#&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;uriageKubun);#EOL#&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT020_DTTORIHIKI.oldValue);#EOL#&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;BT020_TXSYOHIN.value);#EOL#&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;BT020_PRHANBAI.value);#EOL#&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;JT020_PRTORIHIKI.oldValue);#EOL#&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;qtUriage);#EOL#&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;BT020_KBZAIKOUM.value);#EOL#&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amUriage);#EOL#&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;amUkebarai * -1);#EOL#&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;count = cDT100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;JT020_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;JT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;JT020_NRLOCATION.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;JT020_SQSYUKKASAKI.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;JT020_TXLOTNUMBER.oldValue);#EOL#&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;amSagaku);#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;JT020_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;JT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko);#EOL#&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko);#EOL#&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;JT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;JT020_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;JT020_NRSOUKO.oldValue);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rDT010.getValueOf('AMKEIJYOU')) + Number(amUriage) + Number(amTax);#EOL#&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT020_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客マスタ(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '顧客マスタが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Field Decimal="" ID="PRUKEBARAI" Name="受払単価" Nullable="T" Order="0121" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0071" Remarks="ロット管理商品であれば設定される" Size="40" Type="CHAR" TypeOptions=""/><Refer Fields="NRLOCATION;QTKISYUZAIKO;QTNYUKO;QTSYUKKO;AMKISYUZAIKO;AMNYUKO;AMSYUKKO" Optional="T" Order="0070" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="JT020.NRSYOHIN;JT020.NRSOUKO"/></Table><Table ActiveWhere="" ID="JT010" Name="売上振替" RangeKey="" Remarks="売掛に関連する勘定科目との振替指示情報を保持するためのテーブル。" SubsystemID="J"><Field Decimal="" ID="NRURIAGEHURIKAE" Name="売上振替№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRURIAGEHURIKAE)"/><Field Decimal="" ID="KBURIAGEHURIKAE" Name="振替区分" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBURIAGEHURIKAE)"/><Field Decimal="" ID="DTTORIHIKI" Name="取引日" Nullable="F" Order="0030" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0040" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMTORIHIKI" Name="税抜取引額" Nullable="F" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="振替摘要" Nullable="F" Order="0060" Size="30" Type="CHAR" TypeOptions="KANJI"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0080" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field Decimal="" ID="AMTAX" Name="消費税額" Nullable="T" Order="0090" Remarks="" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Key Fields="NRURIAGEHURIKAE" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Refer Fields="TXKANJI" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="JT010.NRTORIHIKISAKI"/><Refer Fields="KBSEIKYUHOUSHIKI" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="JT010.NRTORIHIKISAKI"/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0010" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#JT010_AMTAX.editable = false;#EOL#JT010_NRSEIKYU.editable = false;#EOL##EOL#//////////////////////////////////////////#EOL#// 取引日の初期値設定と会計期間チェック //#EOL#//////////////////////////////////////////#EOL#if (JT010_DTTORIHIKI.value == '') {#EOL#&#x9;JT010_DTTORIHIKI.value = session.getToday() + '';#EOL#}#EOL#JT010_DTTORIHIKI.error = session.getErrorOfAccountDate(JT010_DTTORIHIKI.value);#EOL##EOL#////////////////////#EOL#// 消費税額の設定 //#EOL#////////////////////#EOL#if (JT010_KBURIAGEHURIKAE.value == '10' || JT010_KBURIAGEHURIKAE.value == '11' || JT010_KBURIAGEHURIKAE.value == '30') {#EOL#&#x9;JT010_AMTAX.value = session.getTaxAmount(JT010_DTTORIHIKI.value, JT010_AMTORIHIKI.value);#EOL#} else {#EOL#&#x9;JT010_AMTAX.value = 0;#EOL#}#EOL##EOL#//////////////////////////////////////////#EOL#// 都度請求処理対象であれば請求№を採番 //#EOL#//////////////////////////////////////////#EOL#if (DT010_KBSEIKYUHOUSHIKI.value == '20') {#EOL#&#x9;JT010_NRSEIKYU.value = session.getNextNumber('NRSEIKYU');#EOL#} else {#EOL#&#x9;JT010_NRSEIKYU.value = '';#EOL#}#EOL##EOL#"/><Script EventP="BU;BD;AR" EventR="AR()" Function="" Name="更新・削除前設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#JT010_NRTORIHIKISAKI.editable = false;#EOL#JT010_KBURIAGEHURIKAE.editable = false;#EOL#JT010_AMTAX.editable = false;#EOL#JT010_NRSEIKYU.editable = false;#EOL##EOL#//////////////////////#EOL#// 会計期間チェック //#EOL#//////////////////////#EOL#if (instance.functionID == 'JF011') {#EOL#&#x9;JT010_DTTORIHIKI.error = session.getErrorOfAccountDate(JT010_DTTORIHIKI.value);#EOL#}#EOL##EOL#////////////////////#EOL#// 消費税額の設定 //#EOL#////////////////////#EOL#if (JT010_KBURIAGEHURIKAE.value == '10' || JT010_KBURIAGEHURIKAE.value == '11' || JT010_KBURIAGEHURIKAE.value == '30') {#EOL#&#x9;JT010_AMTAX.value = session.getTaxAmount(JT010_DTTORIHIKI.value, JT010_AMTORIHIKI.value);#EOL#&#x9;JT010_AMTAX.oldValue = session.getTaxAmount(JT010_DTTORIHIKI.oldValue, JT010_AMTORIHIKI.oldValue);#EOL#} else {#EOL#&#x9;JT010_AMTAX.value = 0;#EOL#&#x9;JT010_AMTAX.oldValue = 0;#EOL#}#EOL#"/><Script EventP="AC" EventR="" Function="" Name="追加時の関連レコード処理" Order="0030" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT010; var uDT010; var cDT100;#EOL#var amHurikae = 0; var amTax = 0; var prHanbai = 0; var amKeijyouUpdated = 0;#EOL#var errorMessage = ''; var dtNend = 0; var dtMSeq = 0;#EOL##EOL#///////////////////////////////////////#EOL#// 関連する顧客マスター(DT010)の検索 //#EOL#///////////////////////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#rDT010.setSelectFields('AMKEIJYOU, NRTANTOUJYUGYOIN, KBSEIKYUHOUSHIKI, UPDCOUNTER');#EOL#rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#if (rDT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(JT010_DTTORIHIKI.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(JT010_DTTORIHIKI.value);#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 区分別取引額の設定 //#EOL#&#x9;////////////////////////#EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '10') {&#x9;//雑益売上// #EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.value;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.value;#EOL#&#x9;&#x9;prHanbai = JT010_AMTORIHIKI.value;#EOL#&#x9;}#EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '11') { //雑損振替//#EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.value * -1;#EOL#&#x9;&#x9;prHanbai = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;}#EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '20') { //相殺(買掛金振替)//#EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.value * -1;#EOL#&#x9;&#x9;prHanbai = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;}#EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '30') { //販売費振替(値引)//#EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.value * -1;#EOL#&#x9;&#x9;prHanbai = 0;#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 売上実績(DT100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;JT010_KBURIAGEHURIKAE.value);#EOL#&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT010_DTTORIHIKI.value);#EOL#&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;JT010_TXTEKIYO.value);#EOL#&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;prHanbai);#EOL#&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amHurikae);#EOL#&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;1);#EOL#&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amHurikae);#EOL#&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTax);#EOL#&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;JT010_NRSEIKYU.value);#EOL#&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT010_NRTORIHIKIKANRI.value);#EOL#&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;count = cDT100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rDT010.getValueOf('AMKEIJYOU')) + Number(amHurikae) + Number(amTax);#EOL#&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客マスタ(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 都度請求対象であれば請求指示データ生成 //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;if (rDT010.getValueOf('KBSEIKYUHOUSHIKI') == '20' &amp;&amp; errorMessage == '') {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRSEIKYU', &#x9;&#x9;JT010_NRSEIKYU.value);#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRTORIHIKISAKI', &#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;instance.callFunction('DF112');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '顧客マスターが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="削除時の関連レコード処理" Order="0040" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var rDT100; var uDT100; var cDT100;#EOL#var amHurikae = 0; var amTax = 0; var prHanbai = 0; var amKeijyouUpdated = 0;#EOL#var errorMessage = ''; var dtNend = 0; var dtMSeq = 0;#EOL##EOL#///////////////////////////////////////#EOL#// 関連する顧客マスター(DT010)の検索 //#EOL#///////////////////////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#rDT010.setSelectFields('AMKEIJYOU, NRTANTOUJYUGYOIN, UPDCOUNTER');#EOL#rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#if (rDT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(JT010_DTTORIHIKI.oldValue);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(JT010_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 区分別取引額の設定 //#EOL#&#x9;////////////////////////#EOL#&#x9;// １０：雑益売上 #EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '10') {#EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.oldValue;#EOL#&#x9;&#x9;prHanbai = JT010_AMTORIHIKI.oldValue;#EOL#&#x9;}#EOL#&#x9;// １１：雑損振替 #EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '11') {#EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;prHanbai = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;}#EOL#&#x9;// ２０：相殺(買掛金振替) #EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '20') {#EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;prHanbai = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;}#EOL#&#x9;// ３０：販売費振替(値引)#EOL#&#x9;if (JT010_KBURIAGEHURIKAE.value == '30') {#EOL#&#x9;&#x9;amHurikae = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;amTax = JT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;prHanbai = 0;#EOL#&#x9;}#EOL#&#x9;amHurikae = amHurikae * -1;#EOL#&#x9;amTax = amTax * -1;#EOL#&#x9;prHanbai = prHanbai * -1;#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する売上実績(DT100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;&#x9;rDT100.setSelectFields('NRURIAGE, NRSEIKYU, UPDCOUNTER');#EOL#&#x9;&#x9;rDT100.addKeyValue('NRTORIHIKIKANRI',JT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;&#x9;if (rDT100.getValueOf('NRSEIKYU').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する売上実績が請求処理されているため、取消処理はキャンセルされます。関連する請求指示(' + rDT100.getValueOf('NRSEIKYU') + ')から当該の売上実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;DT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 売上実績(DT100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;JT010_KBURIAGEHURIKAE.oldValue);#EOL#&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT010_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;JT010_TXTEKIYO.oldValue);#EOL#&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;prHanbaiOld * -1);#EOL#&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amHurikaeOld * -1);#EOL#&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amHurikae);#EOL#&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTax);#EOL#&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKeijyouUpdated = Number(rDT010.getValueOf('AMKEIJYOU')) + Number(amHurikae) + Number(amTax);#EOL#&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客マスター(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#} else {#EOL#&#x9;errorMessage = '顧客マスターが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="更新時の関連レコード処理" Order="0031" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT010; var uDT010; var rDT100; var uDT100; var cDT100;#EOL#var amHurikaeNew = 0; var amTaxNew = 0; var prHanbaiNew = 0;#EOL#var amHurikaeOld = 0; var amTaxOld = 0; var prHanbaiOld = 0;#EOL#var dtNendNew = 0; var dtMSeqNew = 0; var dtNendOld = 0; var dtMSeqOld = 0;#EOL#var amKeijyouUpdated = 0; var amSeikyu = 0; var errorMessage = ''; var count = 0;#EOL##EOL#//////////////////////////#EOL#// フィールド値変更検査 //#EOL#//////////////////////////#EOL#if (JT010_DTTORIHIKI.valueChanged || JT010_AMTORIHIKI.valueChanged ) {#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する顧客マスター(DT010)の検索 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#&#x9;rDT010.setSelectFields('AMKEIJYOU, NRTANTOUJYUGYOIN, KBSEIKYUHOUSHIKI, UPDCOUNTER');#EOL#&#x9;rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;if (rDT010.next()) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 赤伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendOld = session.getFYearOfDate(JT010_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;dtMSeqOld = session.getMSeqOfDate(JT010_DTTORIHIKI.oldValue);#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 区分別取引額の設定 //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// １０：雑益売上 #EOL#&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '10') {#EOL#&#x9;&#x9;&#x9;amHurikaeOld = JT010_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;&#x9;amTaxOld = JT010_AMTAX.oldValue;#EOL#&#x9;&#x9;&#x9;prHanbaiOld = JT010_AMTORIHIKI.oldValue;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;// １１：雑損振替 #EOL#&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '11') {#EOL#&#x9;&#x9;&#x9;amHurikaeOld = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amTaxOld = JT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;&#x9;prHanbaiOld = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;// ２０：相殺(買掛金振替) #EOL#&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '20') {#EOL#&#x9;&#x9;&#x9;amHurikaeOld = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amTaxOld = JT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;&#x9;prHanbaiOld = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;// ３０：販売費振替(値引)#EOL#&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '30') {#EOL#&#x9;&#x9;&#x9;amHurikaeOld = JT010_AMTORIHIKI.oldValue * -1;#EOL#&#x9;&#x9;&#x9;amTaxOld = JT010_AMTAX.oldValue * -1;#EOL#&#x9;&#x9;&#x9;prHanbaiOld = 0;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;amHurikaeOld = amHurikaeOld * -1;#EOL#&#x9;&#x9;amTaxOld = amTaxOld * -1;#EOL#&#x9;&#x9;prHanbaiOld = prHanbaiOld * -1;#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する売上実績(DT100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;&#x9;&#x9;rDT100.setSelectFields('NRURIAGE, NRSEIKYU, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rDT100.addKeyValue('NRTORIHIKIKANRI',&#x9;JT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;if (rDT100.getValueOf('NRSEIKYU').trim() != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '関連する売上実績が請求処理されているため、取消処理はキャンセルされます。関連する請求指示(' + rDT100.getValueOf('NRSEIKYU') + ')から当該の売上実績を切り離したうえで再試行してください。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 売上実績(DT100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;JT010_KBURIAGEHURIKAE.oldValue);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT010_DTTORIHIKI.oldValue);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;JT010_TXTEKIYO.oldValue);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;prHanbaiOld * -1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amHurikaeOld * -1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amHurikaeOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTaxOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 黒伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;dtNendNew = session.getFYearOfDate(JT010_DTTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;dtMSeqNew = session.getMSeqOfDate(JT010_DTTORIHIKI.value);#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;&#x9;// 区分別取引額の設定 //#EOL#&#x9;&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;&#x9;// １０：雑益売上 #EOL#&#x9;&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '10') {#EOL#&#x9;&#x9;&#x9;&#x9;amHurikaeNew = JT010_AMTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;&#x9;amTaxNew = JT010_AMTAX.value;#EOL#&#x9;&#x9;&#x9;&#x9;prHanbaiNew = JT010_AMTORIHIKI.value;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;// １１：雑損振替 #EOL#&#x9;&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '11') {#EOL#&#x9;&#x9;&#x9;&#x9;amHurikaeNew = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;&#x9;amTaxNew = JT010_AMTAX.value * -1;#EOL#&#x9;&#x9;&#x9;&#x9;prHanbaiNew = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;// ２０：相殺(買掛金振替) #EOL#&#x9;&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '20') {#EOL#&#x9;&#x9;&#x9;&#x9;amHurikaeNew = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;&#x9;amTaxNew = JT010_AMTAX.value * -1;#EOL#&#x9;&#x9;&#x9;&#x9;prHanbaiNew = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;// ３０：販売費振替(値引)#EOL#&#x9;&#x9;&#x9;if (JT010_KBURIAGEHURIKAE.value == '30') {#EOL#&#x9;&#x9;&#x9;&#x9;amHurikaeNew = JT010_AMTORIHIKI.value * -1;#EOL#&#x9;&#x9;&#x9;&#x9;amTaxNew = JT010_AMTAX.value * -1;#EOL#&#x9;&#x9;&#x9;&#x9;prHanbaiNew = 0;#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;// 売上実績(DT100)の追加 //#EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;JT010_KBURIAGEHURIKAE.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;JT010_DTTORIHIKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;JT010_TXTEKIYO.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;prHanbaiNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amHurikaeNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amHurikaeNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;amTaxNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;JT010_NRSEIKYU.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;JT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;amKeijyouUpdated = Number(rDT010.getValueOf('AMKEIJYOU'))#EOL#&#x9;&#x9;&#x9;&#x9; + Number(amHurikaeOld) + Number(amTaxOld) + Number(amHurikaeNew) + Number(amTaxNew);#EOL#&#x9;&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;amKeijyouUpdated);#EOL#&#x9;&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '顧客マスタ(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 都度請求対象であれば請求指示データ生成 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rDT010.getValueOf('KBSEIKYUHOUSHIKI') == '20') {#EOL#&#x9;&#x9;&#x9;&#x9;amSeikyu = Number(amHurikaeOld) + Number(amTaxOld) + Number(amHurikaeNew) + Number(amTaxNew);#EOL#&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('NRSEIKYU',&#x9;&#x9;JT010_NRSEIKYU.value);#EOL#&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('AMSEIKYU',&#x9;&#x9;amSeikyu);#EOL#&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('NRTORIHIKISAKI',&#x9;JT010_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('DF112');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '顧客マスターが存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}#EOL#"/><Field Decimal="" ID="NRSEIKYU" Name="都度請求№" Nullable="T" Order="0061" Size="7" Type="CHAR" TypeOptions=""/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="GT031" Name="見積明細" RangeKey="" Remarks="商品毎の見積明細情報を保持するためのテーブル。１件の見積見出しレコードに、複数の見積明細レコードが対応する。#EOL#" SubsystemID="G"><Field Decimal="" ID="NRSYOHIN" Name="見積商品№" Nullable="F" Order="0060" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="PRJYUTYU" Name="見積単価" Nullable="F" Order="0070" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTJYUTYU" Name="注文数量" Nullable="F" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="DTKIBOUNOUKI" Name="希望納期" Nullable="F" Order="0100" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="SQMITSUMORI" Name="見積行" Nullable="F" Order="0040" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="SQVERSION" Name="版№" Nullable="F" Order="0030" Size="2" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="NRMITSUMORI" Name="見積№" Nullable="F" Order="0020" Size="7" Type="CHAR" TypeOptions=""/><Key Fields="NRMITSUMORI;SQVERSION;SQMITSUMORI" Type="PK"/><Refer Fields="" Order="0010" TableAlias="" ToKeyFields="NRMITSUMORI;SQVERSION" ToTable="GT030" WithKeyFields="GT031.NRMITSUMORI;GT031.SQVERSION"/><Refer Fields="TXSYOHIN;TXHINBAN;TXSIYOU;PRHANBAI;KBZAIKOUM;TXIMAGEFILENAME" Order="0020" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="GT031.NRSYOHIN"/><Script EventP="BC" EventR="BR()" Function="" Name="追加時設定" Order="0000" Text="/////////////////////////////////////////////////////////////////////#EOL#// GF052において、見出し部分の希望納期を明細行の希望納期に設定する //#EOL#/////////////////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'GF052') {#EOL#&#x9;if (GT031_DTKIBOUNOUKI.value == '') {#EOL#&#x9;&#x9;GT031_DTKIBOUNOUKI.value = GT030_DTKIBOUNOUKI.value;#EOL#&#x9;}#EOL#}"/></Table><Table ActiveWhere="" ID="GT030" Name="見積見出し" RangeKey="" Remarks="顧客への見積見出し情報を保持するためのテーブル。新規受注情報のコピー元にもなる。#EOL#" SubsystemID="G"><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="T" Order="0040" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0080" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Field Decimal="" ID="NRMITSUMORI" Name="見積№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRMITSUMORI)"/><Field Decimal="" ID="DTMITSUMORI" Name="見積日" Nullable="F" Order="0030" Remarks="" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="SQVERSION" Name="版№" Nullable="F" Order="0020" Size="2" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="SQSYUKKASAKI" Name="出荷先行番" Nullable="T" Order="0050" Size="3" Type="SMALLINT" TypeOptions=""/><Field ID="TXTYUBAN" Name="顧客注文番号" Nullable="T" Order="0070" Size="15" Type="CHAR" TypeOptions=""/><Key Fields="NRMITSUMORI;SQVERSION" Type="PK"/><Field Decimal="" ID="TXKOKYAKUMEI" Name="未登録顧客名" Nullable="T" Order="0060" Remarks="" Size="40" Type="CHAR" TypeOptions="KANJI"/><Refer Fields="TXKANJI" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="GT030.NRTORIHIKISAKI"/><Refer Fields="CDKAKERITSURANK;TXTANTOUBUSYO;TXTANTOUSYA;NRTANTOUJYUGYOIN" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="GT030.NRTORIHIKISAKI"/><Refer Fields="TXKANJI" Order="0040" TableAlias="" ToKeyFields="NRTORIHIKISAKI;SQSYUKKASAKI" ToTable="DT011" WithKeyFields="GT030.NRTORIHIKISAKI;GT030.SQSYUKKASAKI"/><Field Decimal="" ID="DTKIBOUNOUKI" Name="希望納期省略値" Nullable="T" Order="0090" Remarks="見積明細に対する希望納期省略値。追加時にのみパネル上で入力される" Size="10" Type="DATE" TypeOptions="VIRTUAL"/><Refer Fields="TXKANJI" Order="0050" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Script EventP="AR" EventR="AR()" Function="" Name="仮想フィールドの設定" Order="0000" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rGT010;#EOL#var nrJyutyu = '';#EOL##EOL#/////////////////////////////////////////////////#EOL#// 受注見出し(GT010)から確定受注№を検索・設定 //#EOL#/////////////////////////////////////////////////#EOL#rGT010 = instance.createTableOperator('Select', 'GT010');#EOL#rGT010.setSelectFields('NRJYUTYU');#EOL#rGT010.addKeyValue('NRMITSUMORI',&#x9;GT030_NRMITSUMORI.value);#EOL#rGT010.addKeyValue('SQVERSION',&#x9;&#x9;GT030_SQVERSION.value);#EOL#while (rGT010.next()) {#EOL#&#x9;if (nrJyutyu == '') {#EOL#&#x9;&#x9;nrJyutyu = rGT010.getValueOf('NRJYUTYU');#EOL#&#x9;} else {#EOL#&#x9;&#x9;nrJyutyu = '(複数)';#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL#if (nrJyutyu == '') {#EOL#&#x9;GT030_NRJYUTYU.value = '(なし)';#EOL#} else {#EOL#&#x9;GT030_NRJYUTYU.value = nrJyutyu;#EOL#}#EOL##EOL#//////////////////////#EOL#// 仮想顧客名の設定 //#EOL#//////////////////////#EOL#if (GT030_NRTORIHIKISAKI.value == '') {#EOL#&#x9;GT030_TXWORK.value = GT030_TXKOKYAKUMEI.value;#EOL#} else {#EOL#&#x9;GT030_TXWORK.value = AT030_TXKANJI.value;#EOL#}#EOL#"/><Field Decimal="" ID="TXWORK" Name="仮想顧客名" Nullable="T" Order="0100" Remarks="既存顧客であればその漢字名が、未登録顧客であれば「未登録顧客名」が設定される。" Size="40" Type="CHAR" TypeOptions="VIRTUAL,KANJI"/><Script EventP="BC" EventR="BR()" Function="" Name="追加時設定" Order="0010" Text="GT030_SQVERSION.value = 1;"/><Field Decimal="" ID="NRJYUTYU" Name="確定受注№" Nullable="T" Order="0110" Remarks="対応する受注見出しレコードを検索して設定される。複数見つかれば&quot;(複数)&quot;と設定される。" Size="7" Type="CHAR" TypeOptions="VIRTUAL"/><Refer Fields="TXKAKERITSURANK;VLKAKERITSU" Optional="T" Order="0030" TableAlias="" ToKeyFields="CDKAKERITSURANK" ToTable="DT020" WithKeyFields="DT010.CDKAKERITSURANK"/><Script EventP="BD" EventR="AR()" Function="" Name="削除チェック" Order="0020" Text="var rGT031 = instance.createTableOperator('Count', 'GT031');#EOL#rGT031.addKeyValue('NRMITSUMORI',&#x9;GT030_NRMITSUMORI.value);#EOL#rGT031.addKeyValue('SQVERSION',&#x9;GT030_SQVERSION.value);#EOL#if (rGT031.execute() > 0) {#EOL#&#x9;GT030_NRMITSUMORI.error = '見積明細をともなうため、このレコードは削除できません。';#EOL#}"/></Table><Table ActiveWhere="" ID="DT120" Name="受領明細" RangeKey="" Remarks="請求にもとづく受領結果を保持するためのテーブル。販売管理システム上で会計上の回収がなされたとみなされ売掛残高が減じられる。" SubsystemID="D"><Field Decimal="" ID="NRJYURYOU" Name="受領№" Nullable="F" Order="0000" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRJYURYOU)"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0010" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="DTJYURYOU" Name="受領日" Nullable="F" Order="0020" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="KBNYUKINHOUHOU" Name="入金方法区分" Nullable="F" Order="0030" Size="2" Type="CHAR" TypeOptions="KUBUN(KBNYUKINHOUHOU)"/><Field Decimal="" ID="AMJYURYOU" Name="受領額" Nullable="F" Order="0040" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMTESURYOU" Name="手数料" Nullable="T" Order="0050" Remarks="" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0060" Size="300" Type="VARCHAR" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0070" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Key Fields="NRJYURYOU" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Refer Fields="TXKANJI;TXJYUSYO1;TXJYUSYO2" Order="0040" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="DT120.NRTORIHIKISAKI"/><Refer Fields="" Order="0050" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="DT120.NRTORIHIKISAKI"/><Script EventP="AC" EventR="" Function="" Name="追加時の関連レコード処理" Order="0020" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var cDT100;#EOL#var amJyuryou = 0; amTesuryou = 0; var amKaisyuUpdated = 0;#EOL#var errorMessage = ''; var dtNend = 0; var dtMSeq = 0;#EOL##EOL#///////////////////////////////////////#EOL#// 関連する顧客マスター(DT010)の検索 //#EOL#///////////////////////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#rDT010.setSelectFields('AMKAISYU, NRTANTOUJYUGYOIN, UPDCOUNTER');#EOL#rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#if (rDT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(DT120_DTJYURYOU.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(DT120_DTJYURYOU.value);#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// 受領額と手数料の設定 //#EOL#&#x9;//////////////////////////#EOL#&#x9;amJyuryou = DT120_AMJYURYOU.value * -1;#EOL#&#x9;amTesuryou = DT120_AMTESURYOU.value * -1;#EOL##EOL#&#x9;///////////////////////////////////#EOL#&#x9;// 回収額分売上実績(DT100)の追加 //#EOL#&#x9;///////////////////////////////////#EOL#&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'90');#EOL#&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.value);#EOL#&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amJyuryou);#EOL#&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;1);#EOL#&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amJyuryou);#EOL#&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;count = cDT100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;// 手数料(販売費振替)分売上実績(DT100)の追加 //#EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;if (errorMessage == '' &amp;&amp; amTesuryou != 0) {#EOL#&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'30');#EOL#&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.value);#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amTesuryou);#EOL#&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amTesuryou);#EOL#&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKaisyuUpdated = Number(rDT010.getValueOf('AMKAISYU'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;- Number(amJyuryou) - Number(amTesuryou); // amJyuryouもamTesuryouも負値 //#EOL#&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;uDT010.addValue('AMKAISYU',&#x9;&#x9;amKaisyuUpdated);#EOL#&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客マスター(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#} else {#EOL#&#x9;errorMessage = '顧客マスターが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="更新時の関連レコード処理" Order="0030" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var rDT100; var uDT100; var cDT100;#EOL#var amJyuryouNew = 0; var amJyuryouOld = 0; var amTesuryouNew = 0; var amTesuryouOld = 0;#EOL#var dtNendNew = 0; var dtMSeqNew = 0; var dtNendOld = 0; var dtMSeqOld = 0;#EOL#var amKaisyuUpdated = 0; var errorMessage = '';#EOL##EOL#//////////////////////////#EOL#// フィールド値変更検査 //#EOL#//////////////////////////#EOL#if (DT120_DTJYURYOU.valueChanged || DT120_AMJYURYOU.valueChanged || DT120_AMTESURYOU.valueChanged ) {#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する顧客マスター(DT010)の検索 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#&#x9;rDT010.setSelectFields('AMKAISYU, NRTANTOUJYUGYOIN, UPDCOUNTER');#EOL#&#x9;rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;if (rDT010.next()) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;//////////////////////////// 赤伝処理 //////////////////////////////////#EOL#&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;dtNendOld = session.getFYearOfDate(DT120_DTJYURYOU.oldValue);#EOL#&#x9;&#x9;dtMSeqOld = session.getMSeqOfDate(DT120_DTJYURYOU.oldValue);#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 受領額と手数料の設定 //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;amJyuryouOld = DT120_AMJYURYOU.oldValue;#EOL#&#x9;&#x9;amTesuryouOld = DT120_AMTESURYOU.oldValue;#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する売上実績(DT100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;&#x9;&#x9;rDT100.setSelectFields('NRURIAGE, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rDT100.addKeyValue('NRTORIHIKIKANRI', &#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////////////////////#EOL#&#x9;&#x9;// 受領額分売上実績(DT100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'90');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.oldValue);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amJyuryouOld * -1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amJyuryouOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 手数料(販売費振替)分売上実績(DT100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '' &amp;&amp; amTesuryouOld != 0) {#EOL#&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'30');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.oldValue);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amTesuryouOld * -1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amTesuryouOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;//////////////////////////// 黒伝処理 //////////////////////////////////#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;// 年度・月度の設定 //#EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;dtNendNew = session.getFYearOfDate(DT120_DTJYURYOU.value);#EOL#&#x9;&#x9;&#x9;dtMSeqNew = session.getMSeqOfDate(DT120_DTJYURYOU.value);#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;&#x9;// 受領額と手数料の設定 //#EOL#&#x9;&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;&#x9;amJyuryouNew = DT120_AMJYURYOU.value * -1;#EOL#&#x9;&#x9;&#x9;amTesuryouNew = DT120_AMTESURYOU.value * -1;#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 受領額分売上実績(DT100)の追加（黒伝）//#EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'90');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amJyuryouNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amJyuryouNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 手数料(販売費振替)分売上実績(DT100)の追加（黒伝）//#EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '' &amp;&amp; amTesuryouNew != 0) {#EOL#&#x9;&#x9;&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'30');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.value);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amTesuryouNew);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amTesuryouNew);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendNew);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqNew);#EOL#&#x9;&#x9;&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;amKaisyuUpdated = Number(rDT010.getValueOf('AMKAISYU'))#EOL#&#x9;&#x9;&#x9;&#x9; - Number(amJyuryouOld) - Number(amJyuryouNew)#EOL#&#x9;&#x9;&#x9;&#x9; - Number(amTesuryouOld) - Number(amTesuryouNew); // Oldは正値、Newは負値 //#EOL#&#x9;&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;&#x9;uDT010.addValue('AMKAISYU',&#x9;&#x9;amKaisyuUpdated);#EOL#&#x9;&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '顧客マスター(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '顧客マスターが存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="削除時の関連レコード処理" Order="0040" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT010; var uDT010; var rDT100; var uDT100; var cDT100;#EOL#var amJyuryou = 0; var amTesuryou = 0; var amKaisyuUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var errorMessage = '';#EOL##EOL#///////////////////////////////////////#EOL#// 関連する顧客マスター(DT010)の検索 //#EOL#///////////////////////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#rDT010.setSelectFields('AMKAISYU, NRTANTOUJYUGYOIN, UPDCOUNTER');#EOL#rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#if (rDT010.next()) {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(DT120_DTJYURYOU.oldValue);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(DT120_DTJYURYOU.oldValue);#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// 受領額と手数料の設定 //#EOL#&#x9;//////////////////////////#EOL#&#x9;amJyuryou = DT120_AMJYURYOU.oldValue;#EOL#&#x9;amTesuryou = DT120_AMTESURYOU.oldValue;#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する売上実績(DT100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;&#x9;rDT100.setSelectFields('NRURIAGE, UPDCOUNTER');#EOL#&#x9;&#x9;rDT100.addKeyValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;&#x9;uDT100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;// 受領額分売上実績(DT100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'90');#EOL#&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.oldValue);#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amJyuryou * -1);#EOL#&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amJyuryou);#EOL#&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////////////////////////#EOL#&#x9;// 手数料(販売費振替)分売上実績(DT100)の追加（赤伝）//#EOL#&#x9;//////////////////////////////////////////////////////#EOL#&#x9;if (errorMessage == '' &amp;&amp; amTesuryou != 0) {#EOL#&#x9;&#x9;cDT100 = instance.createTableOperator('Insert', 'DT100');#EOL#&#x9;&#x9;cDT100.addValue('NRURIAGE',&#x9;&#x9;&#x9;session.getNextNumber('NRURIAGE'));#EOL#&#x9;&#x9;cDT100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGE',&#x9;&#x9;&#x9;'30');#EOL#&#x9;&#x9;cDT100.addValue('DTURIAGE',&#x9;&#x9;&#x9;DT120_DTJYURYOU.oldValue);#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;cDT100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('TXSYOHIN',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('PRHANBAI',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('PRURIAGE',&#x9;&#x9;&#x9;amTesuryou * -1);#EOL#&#x9;&#x9;cDT100.addValue('QTURIAGE',&#x9;&#x9;&#x9;-1);#EOL#&#x9;&#x9;cDT100.addValue('KBURIAGEUM',&#x9;&#x9;'CNT');#EOL#&#x9;&#x9;cDT100.addValue('AMURIAGE',&#x9;&#x9;&#x9;amTesuryou);#EOL#&#x9;&#x9;cDT100.addValue('AMTAX',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('AMGENKA',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cDT100.addValue('NRSEIKYU',&#x9;&#x9;&#x9;'');#EOL#&#x9;&#x9;cDT100.addValue('NRJYUGYOIN',&#x9;&#x9;rDT010.getValueOf('NRTANTOUJYUGYOIN'));#EOL#&#x9;&#x9;cDT100.addValue('NRTORIHIKIKANRI',&#x9;DT120_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cDT100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cDT100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cDT100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cDT100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cDT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '売上実績(DT100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 顧客マスター(DT010)の売掛残高更新 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;amKaisyuUpdated = Number(rDT010.getValueOf('AMKAISYU')) - Number(amJyuryou) - Number(amTesuryou);#EOL#&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;uDT010.addValue('AMKAISYU',&#x9;&#x9;amKaisyuUpdated);#EOL#&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;DT120_NRTORIHIKISAKI.value);#EOL#&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客マスター(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#} else {#EOL#&#x9;errorMessage = '顧客マスターが存在しません。処理はキャンセルされます。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0010" Text="////////////////////////#EOL#// 受領日の初期値設定 //#EOL#////////////////////////#EOL#if (DT120_DTJYURYOU.value == null || DT120_DTJYURYOU.value == '') {#EOL#&#x9;DT120_DTJYURYOU.value = session.getToday() + '';#EOL#}#EOL##EOL#//////////////////////#EOL#// 会計期間チェック //#EOL#//////////////////////#EOL#DT120_DTJYURYOU.error = session.getErrorOfAccountDate(DT120_DTJYURYOU.value);#EOL#"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="更新前設定" Order="0011" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#DT120_NRTORIHIKISAKI.editable = false;#EOL##EOL#//////////////////////#EOL#// 会計期間チェック //#EOL#//////////////////////#EOL#DT120_DTJYURYOU.error = session.getErrorOfAccountDate(DT120_DTJYURYOU.value);#EOL#"/></Table><Table ActiveWhere="" ID="DT110" Name="請求指示" RangeKey="" Remarks="売上実績にもとづく請求情報を保持するためのテーブル。請求エントリーを実行することで追加される。このとき、選択された顧客について、請求№がブランクであるような「受領」分の売上実績も、自動的に新たな請求指示の請求№で更新される。それらは「前回請求以降の入金額」を算出するための基礎となる。" SubsystemID="D"><Field Decimal="" ID="NRSEIKYU" Name="請求№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSEIKYU)"/><Field Decimal="" ID="DTSEIKYU" Name="請求日" Nullable="F" Order="0020" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0030" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMSEIKYU" Name="請求額" Nullable="T" Order="0130" Remarks="この請求指示に関連する「受領」以外の売上実績データの売上額" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0060" Size="300" Type="VARCHAR" TypeOptions=""/><Key Fields="NRSEIKYU" Type="PK"/><Refer Fields="TXKANJI;NRYUBIN;TXJYUSYO1;TXJYUSYO2;NRDENWA" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="DT110.NRTORIHIKISAKI"/><Refer Fields="TXTANTOUBUSYO;TXTANTOUSYA;TXTANTOUSYASYOKUI;TXTANTOUSYAEMAIL;TXTANTOUSYADENWA;KBSEIKYUHOUSHIKI;NRTANTOUJYUGYOIN;AMKISYUURIKAKE;AMKEIJYOU;AMKAISYU" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="DT110.NRTORIHIKISAKI"/><Refer Fields="TXKANJI" Order="0030" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Script EventP="BC" EventR="BR()" Function="" Name="追加レコード初期設定" Order="0010" Text="//////////////////////////////#EOL#// 請求日のデフォルト値設定 //#EOL#//////////////////////////////#EOL#if (DT110_DTSEIKYU.value == '') {#EOL#&#x9;DT110_DTSEIKYU.value = session.getToday() + '';#EOL#}#EOL#"/><Script EventP="BU;BD;AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0030" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT100; var amUriage = 0; var amTax = 0; var amNyukin = 0; var count = 0;#EOL##EOL#////////////////////////////////////#EOL#// 明細件数、入金額、請求額の設定 //#EOL#////////////////////////////////////#EOL#rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#rDT100.setSelectFields('KBURIAGE, AMURIAGE, AMTAX');#EOL#rDT100.addKeyValue('NRSEIKYU',&#x9;DT110_NRSEIKYU.value);#EOL#while (rDT100.next()) {#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '90') { //入金//#EOL#&#x9;&#x9;amNyukin = Number(amNyukin) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;} else {#EOL#&#x9;&#x9;amUriage = Number(amUriage) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amTax = Number(amTax) + Number(rDT100.getValueOf('AMTAX'));#EOL#&#x9;}#EOL#&#x9;count++;#EOL#}#EOL#DT110_NRMEISAI.value = count;#EOL#DT110_AMSEIKYU.value = Number(amUriage) + Number(amTax);#EOL#DT110_AMNYUKIN.value = amNyukin * -1;#EOL##EOL#//////////////////////#EOL#// ステータスの設定 //#EOL#//////////////////////#EOL#DT110_STSEIKYU.value = '10'; //未発行//#EOL#if (DT110_DTHAKKOU.value != '') {#EOL#&#x9;DT110_STSEIKYU.value = '20'; //発行済//#EOL#&#x9;if (DT110_DTNYUKIN.value != '') {#EOL#&#x9;&#x9;DT110_STSEIKYU.value = '30'; //入金確認済//#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="AMNYUKIN" Name="前回以降入金額" Nullable="T" Order="0110" Remarks="この請求指示に関連する「受領」分の売上実績データの売上額" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="DTHAKKOU" Name="発行日" Nullable="T" Order="0070" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="DTNYUKIN" Name="入金確認日" Nullable="T" Order="0080" Size="10" Type="DATE" TypeOptions=""/><Field ID="STSEIKYU" Name="請求状況" Nullable="F" Order="0140" Remarks="" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STSEIKYU)"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="更新不可設定" Order="0040" Text="DT110_DTSEIKYU.editable = false;#EOL#DT110_NRTORIHIKISAKI.editable = false;#EOL#DT110_DTHAKKOU.editable = false;#EOL#DT110_AMNYUKIN.editable = false;#EOL#DT110_AMSEIKYU.editable = false;#EOL#DT110_STSEIKYU.editable = false;#EOL##EOL##EOL#"/><Field ID="NRMEISAI" Name="明細行数" Nullable="T" Order="0090" Remarks="削除妥当性検査の際に参照される" Size="4" Type="SMALLINT" TypeOptions="VIRTUAL"/><Script EventP="BD" EventR="BR()" Function="" Name="削除妥当性チェック" Order="0050" Text="if (DT110_NRMEISAI.value > 0) {#EOL#&#x9;DT110_NRSEIKYU.error = '関連する売上実績を伴うため削除できません。それらをこの請求指示から切り離す必要があります。';#EOL#}"/><Script EventP="AC" EventR="" Function="" Name="追加時の関連レコード処理" Order="0020" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT100; var uDT100;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#//////////////////////////////////////////#EOL#// 有効未処理分の「受領」売上実績の更新 //#EOL#//////////////////////////////////////////#EOL#rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#rDT100.setSelectFields('NRURIAGE, NRSEIKYU, UPDCOUNTER');#EOL#rDT100.addKeyValue('NRTORIHIKISAKI',&#x9;DT110_NRTORIHIKISAKI.value);#EOL#rDT100.addKeyValue('NRSEIKYU',&#x9;&#x9;&#x9;'       ');#EOL#rDT100.addKeyValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#rDT100.addKeyValue('KBURIAGE',&#x9;&#x9;&#x9;'90');#EOL#while (rDT100.next()) {#EOL#&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;uDT100.addValue('NRSEIKYU',&#x9;&#x9;DT110_NRSEIKYU.value);#EOL#&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;count = uDT100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '関連する売上実績(DT100)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/></Table><Table ActiveWhere="" ID="KT010" Name="棚卸指示" RangeKey="" Remarks="棚卸の１回のまとまりに関する情報を保持するためのテーブル" SubsystemID="K"><Field Decimal="" ID="NRTANAOROSHI" Name="棚卸№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTANAOROSHI)"/><Field Decimal="" ID="DTKIJYUN" Name="調査基準日時" Nullable="T" Order="0040" Size="23" Type="DATETIME" TypeOptions=""/><Field Decimal="" ID="DTKOUSHIN" Name="確定更新日時" Nullable="T" Order="0050" Size="23" Type="DATETIME" TypeOptions=""/><Field Decimal="" ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0020" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0060" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Key Fields="NRTANAOROSHI" Type="PK"/><Field Decimal="" ID="NRLOCATION" Name="ロケ№" Nullable="T" Order="0030" Size="5" Type="CHAR" TypeOptions=""/><Refer Fields="TXSOUKO" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="KT010.NRSOUKO"/><Script EventP="BC" EventR="BR()" Function="" Name="追加前設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#KT010_DTKIJYUN.editable = false;#EOL#KT010_DTKOUSHIN.editable = false;#EOL##EOL#//////////////////////////#EOL#// 基準日時の初期値設定 //#EOL#//////////////////////////#EOL#KT010_DTKIJYUN.value = session.getTimeStamp() + '';#EOL#"/><Script EventP="AC" EventR="" Function="" Name="追加時の明細レコード追加" Order="0030" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET010; var cKT011;#EOL#var locationLength = KT010_NRLOCATION.value.length();#EOL#var jyokenLocationValue = KT010_NRLOCATION.value + '';#EOL#var qtGenzaiko = 0; var amGenzaiko = 0; var prUkebarai = 0; var errorMessage = '';#EOL#var isToBeSelected = false; var wrkStr = &quot;&quot;;#EOL##EOL#///////////////////////////////////////////////////////#EOL#// 関連する倉庫在庫(ET010)の検索と棚卸指示明細の追加 //#EOL#///////////////////////////////////////////////////////#EOL#rET010 = instance.createTableOperator('Select', 'ET010');#EOL#rET010.addKeyValue('NRSOUKO',&#x9;KT010_NRSOUKO.value);#EOL#rET010.setOrderBy('NRLOCATION');#EOL#while (rET010.next()) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 対象ロケかどうかの検査 //#EOL#&#x9;////////////////////////////#EOL#&#x9;isToBeSelected = false;#EOL#&#x9;if (KT010_NRLOCATION.value == '') {#EOL#&#x9;&#x9;isToBeSelected = true;#EOL#&#x9;} else {#EOL#&#x9;&#x9;wrkStr = rET010.getValueOf('NRLOCATION').substring(0, locationLength) + '';#EOL#&#x9;&#x9;if (wrkStr == jyokenLocationValue) {#EOL#&#x9;&#x9;&#x9;isToBeSelected = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////////#EOL#&#x9;// 対象ロケであれば棚卸指示明細を追加 //#EOL#&#x9;////////////////////////////////////////#EOL#&#x9;if (isToBeSelected) {#EOL#&#x9;&#x9;amGenzaiko = Number(rET010.getValueOf('AMKISYUZAIKO')) + Number(rET010.getValueOf('AMNYUKO')) - Number(rET010.getValueOf('AMSYUKKO'));#EOL#&#x9;&#x9;qtGenzaiko = Number(rET010.getValueOf('QTKISYUZAIKO')) + Number(rET010.getValueOf('QTNYUKO')) - Number(rET010.getValueOf('QTSYUKKO'));#EOL#&#x9;&#x9;if (amGenzaiko > 0 &amp;&amp; qtGenzaiko > 0) {#EOL#&#x9;&#x9;&#x9;prUkebarai = Math.round(amGenzaiko / qtGenzaiko);#EOL#&#x9;&#x9;&#x9;cKT011 = instance.createTableOperator('Insert', 'KT011');#EOL#&#x9;&#x9;&#x9;cKT011.addValue('NRTANAOROSHI',&#x9;&#x9;KT010_NRTANAOROSHI.value);#EOL#&#x9;&#x9;&#x9;cKT011.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rET010.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;cKT011.addValue('NRLOCATION',&#x9;&#x9;rET010.getValueOf('NRLOCATION'));#EOL#&#x9;&#x9;&#x9;cKT011.addValue('PRUKEBARAI',&#x9;&#x9;prUkebarai);#EOL#&#x9;&#x9;&#x9;cKT011.addValue('QTTYOUBO',&#x9;&#x9;&#x9;qtGenzaiko);#EOL#&#x9;&#x9;&#x9;cKT011.addValue('QTJITSUTANA',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;count = cKT011.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '棚卸指示明細(KT011)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="確定更新時の関連レコード処理" Order="0060" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rKT011; var rBT020; var cET100; var rET010; var uET010; var cET010;#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var ukebaraiKubun = '';#EOL#var count = 0; var errorMessage = ''; var dtUkebarai = '';#EOL##EOL#//////////////////////////////#EOL#// 確定更新されたことの検査 //#EOL#//////////////////////////////#EOL#if (KT010_DTKOUSHIN.oldValue == '' &amp;&amp; KT010_DTKOUSHIN.value != '') {#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 年度・月度・日付・区分の設定 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(KT010_DTKOUSHIN.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(KT010_DTKOUSHIN.value);#EOL#&#x9;dtUkebarai = KT010_DTKOUSHIN.value + '';#EOL#&#x9;dtUkebarai = dtUkebarai.substring(0, 10);#EOL#&#x9;ukebaraiKubun = '90'; //棚増棚減//#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 棚卸明細(KT011)の検索 //#EOL#&#x9;///////////////////////////#EOL#&#x9;rKT011 = instance.createTableOperator('Select', 'KT011');#EOL#&#x9;rKT011.addKeyValue('NRTANAOROSHI',&#x9;KT010_NRTANAOROSHI.value);#EOL#&#x9;while (rKT011.next()) {#EOL##EOL#&#x9;&#x9;///////////////////////#EOL#&#x9;&#x9;// 商品(BT020)の検索 //#EOL#&#x9;&#x9;///////////////////////#EOL#&#x9;&#x9;rBT020 = instance.createTableOperator('Select', 'BT020');#EOL#&#x9;&#x9;rBT020.setSelectFields('QTANZENZAIKO, QTJYOUGENZAIKO');#EOL#&#x9;&#x9;rBT020.addKeyValue('NRSYOHIN',&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;if (rBT020.next()) {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;&#x9;// 受払高の計算 //#EOL#&#x9;&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;&#x9;qtUkebarai = rKT011.getValueOf('QTJITSUTANA') - rKT011.getValueOf('QTTYOUBO');#EOL#&#x9;&#x9;&#x9;amUkebarai = qtUkebarai * rKT011.getValueOf('PRUKEBARAI');#EOL#&#x9;&#x9;&#x9;if (qtUkebarai != 0) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;dtUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;rKT011.getValueOf('NRLOCATION'));#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 受払高の符号にもとづいて、絶対値の入庫高と出庫高を設定する //#EOL#&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (qtUkebarai > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtNyuko = qtUkebarai;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amNyuko = amUkebarai;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtNyuko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukko = qtUkebarai * -1;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amNyuko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukko = amUkebarai * -1;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('NRLOCATION',&#x9;rKT011.getValueOf('NRLOCATION'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;rKT011.getValueOf('NRLOCATION'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;rBT020.getValueOf('QTANZENZAIKO'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;rBT020.getValueOf('QTJYOUGENZAIKO'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Script EventP="BU;AR" EventR="BR()" Function="" Name="更新前設定" Order="0040" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#KT010_NRSOUKO.editable = false;#EOL#KT010_NRLOCATION.editable = false;#EOL#KT010_DTKIJYUN.editable = false;#EOL#KT010_DTKOUSHIN.editable = false;#EOL#KT010_DTKOUSHINWORK.editable = false;#EOL#KT010_NRTORIHIKIKANRI.editable = false;#EOL##EOL#////////////////////#EOL#// 結果更新時設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF016B') {#EOL#&#x9;if (KT010_DTKOUSHIN.value != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage('確定済の棚卸指示に対する結果報告はできません。');#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 確定更新時設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF017A') {#EOL#&#x9;if (KT010_DTKOUSHIN.value == '') {#EOL#&#x9;&#x9;KT010_DTKOUSHIN.value = session.getTimeStamp() + '';#EOL#&#x9;}#EOL#&#x9;KT010_DTKOUSHIN.error = session.getErrorOfAccountDate(KT010_DTKOUSHIN.value);#EOL#}#EOL##EOL#////////////////////#EOL#// 確定解除時設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF017B') {#EOL#&#x9;KT010_DTKOUSHIN.error = session.getErrorOfAccountDate(KT010_DTKOUSHIN.value);#EOL#&#x9;if (KT010_DTKOUSHIN.error == '') {#EOL#&#x9;&#x9;KT010_DTKOUSHIN.value = '';#EOL#&#x9;}#EOL#}#EOL#"/><Script EventP="AU" EventR="" Function="" Name="確定解除の関連レコード処理" Order="0070" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rKT011; var rBT020; var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var ukebaraiKubun = '';#EOL#var count = 0; var errorMessage = ''; var dtUkebarai = '';#EOL##EOL#//////////////////////////////#EOL#// 確定解除されたことの検査 //#EOL#//////////////////////////////#EOL#if (KT010_DTKOUSHIN.value == '' &amp;&amp; KT010_DTKOUSHIN.oldValue != '') {#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', KT010_NRTORIHIKIKANRI.value);#EOL#&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 年度・月度・日付・区分の設定 //#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;dtNend = session.getFYearOfDate(KT010_DTKOUSHIN.oldValue);#EOL#&#x9;&#x9;dtMSeq = session.getMSeqOfDate(KT010_DTKOUSHIN.oldValue);#EOL#&#x9;&#x9;dtUkebarai = KT010_DTKOUSHIN.oldValue + '';#EOL#&#x9;&#x9;dtUkebarai = dtUkebarai.substring(0, 10);#EOL#&#x9;&#x9;ukebaraiKubun = '90'; //棚増棚減//#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 棚卸明細(KT011)の検索 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;rKT011 = instance.createTableOperator('Select', 'KT011');#EOL#&#x9;&#x9;rKT011.addKeyValue('NRTANAOROSHI',&#x9;KT010_NRTANAOROSHI.value);#EOL#&#x9;&#x9;while (rKT011.next()) {#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////#EOL#&#x9;&#x9;&#x9;// 商品(BT020)の検索 //#EOL#&#x9;&#x9;&#x9;///////////////////////#EOL#&#x9;&#x9;&#x9;rBT020 = instance.createTableOperator('Select', 'BT020');#EOL#&#x9;&#x9;&#x9;rBT020.setSelectFields('QTANZENZAIKO, QTJYOUGENZAIKO');#EOL#&#x9;&#x9;&#x9;rBT020.addKeyValue('NRSYOHIN',&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;if (rBT020.next()) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 受払高の計算 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;&#x9;&#x9;qtUkebarai = (rKT011.getValueOf('QTJITSUTANA') - rKT011.getValueOf('QTTYOUBO')) * -1;#EOL#&#x9;&#x9;&#x9;&#x9;amUkebarai = qtUkebarai * rKT011.getValueOf('PRUKEBARAI');#EOL#&#x9;&#x9;&#x9;&#x9;if (qtUkebarai != 0) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;dtUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;rKT011.getValueOf('NRLOCATION'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;// 受払高の符号にもとづいて、絶対値の入庫高と出庫高を設定する //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (qtUkebarai > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtNyuko = qtUkebarai;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amNyuko = amUkebarai;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amSyukko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtNyuko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukko = qtUkebarai * -1;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amNyuko = 0;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amSyukko = amUkebarai * -1;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) - Number(qtNyuko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) - Number(amNyuko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) - Number(qtSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) - Number(amSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rKT011.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko * -1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;rBT020.getValueOf('QTANZENZAIKO'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;rBT020.getValueOf('QTJYOUGENZAIKO'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="STTANAOROSHI" Name="処理状況" Nullable="F" Order="0080" Remarks="" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STTANAOROSHI)"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0010" Text="////////////////////#EOL#// 状況区分の設定 //#EOL#////////////////////#EOL#if (KT010_DTKOUSHIN.value == '') {#EOL#&#x9;KT010_STTANAOROSHI.value = '10'; //未確定//#EOL#} else {#EOL#&#x9;KT010_STTANAOROSHI.value = '20'; //確定済//#EOL#}#EOL##EOL#////////////////////////////////////#EOL#// 確定更新日時表示用ワークの設定 //#EOL#////////////////////////////////////#EOL#KT010_DTKOUSHINWORK.value = KT010_DTKOUSHIN.value;#EOL#"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0070" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Field Decimal="" ID="DTKOUSHINWORK" Name="確定更新日時表示用ワーク" Nullable="T" Order="0081" Size="26" Type="TIMESTAMP" TypeOptions="VIRTUAL"/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="KT021" Name="在庫移動指示明細" RangeKey="" Remarks="商品･ロット･ロケ別の移動指示情報を保持するためのテーブル。１件の在庫移動指示レコードに、複数の在庫移動指示明細レコードが対応する。" SubsystemID="K"><Field Decimal="" ID="NRZAIKOIDOU" Name="移動指示№" Nullable="F" Order="0000" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQZAIKOIDOU" Name="指示行" Nullable="F" Order="0010" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="商品№" Nullable="F" Order="0030" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="PRIDOU" Name="取引単価" Nullable="T" Order="0060" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="NRZAIKOIDOU;SQZAIKOIDOU" Type="PK"/><Field Decimal="" ID="NRLOCATIONTO" Name="先ロケ№" Nullable="T" Order="0022" Remarks="入庫先倉庫でのロケ№。入庫元のロケ№は倉庫在庫より動的に得る" Size="5" Type="CHAR" TypeOptions=""/><Refer Fields="DTSHIJI;NRSOUKOFROM;NRSOUKOTO;NRTORIHIKIKANRI;TMKANRYO" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRZAIKOIDOU" ToTable="KT020" WithKeyFields="KT021.NRZAIKOIDOU"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM;QTANZENZAIKO;QTJYOUGENZAIKO;FGLOTKANRI" Order="0020" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="KT021.NRSYOHIN"/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0010" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#KT021_NRZAIKOIDOU.editable = false;#EOL#KT021_NRSYOHIN.editable = false;#EOL#KT021_PRIDOU.editable = false;#EOL##EOL#////////////////////////////////////////////////#EOL#// 移動先在庫のロケを移動先ロケとして初期設定 //#EOL#////////////////////////////////////////////////#EOL#KT021_NRLOCATIONTO.value = ET010TO_NRLOCATION.value;"/><Field Decimal="" ID="QTIDOU" Name="移動数量" Nullable="F" Order="0051" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="NRTORIHIKIKANRIFROM" Type="SK"/><Key Fields="NRTORIHIKIKANRITO" Type="SK"/><Script EventP="AU" EventR="" Function="" Name="完了更新時の関連レコード処理(KF026)" Order="0040" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var dET200; var cET100; var rET010; var uET010; var cET010;#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var ukebaraiKubun = '';#EOL#var count = 0; var errorMessage = ''; var dtUkebarai = '';#EOL##EOL#//////////////////////////////////////#EOL#// 完了更新されたのであれば在庫更新 //#EOL#//////////////////////////////////////#EOL#if (instance.functionID == 'KF026') {#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払予定(ET200)の削除 //#EOL#&#x9;///////////////////////////#EOL#&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRIFROM.value);#EOL#&#x9;dET200.execute();#EOL#&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRITO.value);#EOL#&#x9;dET200.execute();#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 年度・月度・日付・区分の設定 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(KT020_TMKANRYO.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(KT020_TMKANRYO.value);#EOL#&#x9;dtUkebarai = KT020_TMKANRYO.value + '';#EOL#&#x9;dtUkebarai = dtUkebarai.substring(0, 10);#EOL##EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL#&#x9;////////////////////////// 出 庫 処 理 //////////////////////////#EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 受払区分と出庫高の設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;ukebaraiKubun = '30'; //移動出庫//#EOL#&#x9;qtUkebarai = KT021_QTIDOU.value * -1;#EOL#&#x9;amUkebarai = qtUkebarai * KT021_PRIDOU.value;#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;dtUkebarai);#EOL#&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;ET010FROM_NRLOCATION.value);#EOL#&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT021_TXLOTNUMBER.value);#EOL#&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT020_NRTORIHIKIKANRI.value);#EOL#&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;count = cET100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 出庫側の倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) - Number(qtUkebarai); // qtUkebarai &lt; 0 //#EOL#&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) - Number(amUkebarai); // amUkebarai &lt; 0 //#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amUkebarai * -1); // amUkebaraiは負値 //#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtUkebarai * -1); // qtUkebaraiは負値 //#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL#&#x9;////////////////////////// 入 庫 処 理 //////////////////////////#EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 受払区分と入庫高の設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;ukebaraiKubun = '31'; //移動入庫//#EOL#&#x9;qtUkebarai = KT021_QTIDOU.value;#EOL#&#x9;amUkebarai = qtUkebarai * KT021_PRIDOU.value;#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;dtUkebarai);#EOL#&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;KT021_NRLOCATIONTO.value);#EOL#&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT021_TXLOTNUMBER.value);#EOL#&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT020_NRTORIHIKIKANRI.value);#EOL#&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;count = cET100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 入庫側の倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtUkebarai);#EOL#&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amUkebarai);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('NRLOCATIONTO',&#x9;KT021_NRLOCATIONTO.value);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATIONTO',&#x9;&#x9;KT021_NRLOCATIONTO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Script EventP="AC" EventR="" Function="" Name="追加時の受払予定設定" Order="0030" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var cET200;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#/////////////////////////////////////////////#EOL#// 移動未完了であれば受払予定(ET200)を追加 //#EOL#/////////////////////////////////////////////#EOL#if (KT020_TMKANRYO.value == '') {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 出庫予定 //#EOL#&#x9;//////////////#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRIFROM.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'30');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;KT020_DTSHIJI.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET200.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;KT021_QTIDOU.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;KT021_NRZAIKOIDOU.value + '-' + KT021_SQZAIKOIDOU.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 入庫予定 //#EOL#&#x9;//////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRITO.value);#EOL#&#x9;&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'31');#EOL#&#x9;&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;KT020_DTSHIJI.value);#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;cET200.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;KT021_QTIDOU.value);#EOL#&#x9;&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;KT021_NRZAIKOIDOU.value + '-' + KT021_SQZAIKOIDOU.value);#EOL#&#x9;&#x9;count = cET200.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="削除時の受払予定削除" Order="0050" Text="////////////////////////////#EOL#// 関連する受払予定の削除 //#EOL#////////////////////////////#EOL#var dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRIFROM.value);#EOL#dET200.execute();#EOL#dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRITO.value);#EOL#dET200.execute();#EOL#"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="更新前設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#KT021_NRSYOHIN.editable = false;#EOL#KT021_PRIDOU.editable = false;#EOL##EOL#////////////////////#EOL#// ロット№の設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF024B') {#EOL#&#x9;if (BT020_FGLOTKANRI.value == 'F') {#EOL#&#x9;&#x9;KT021_TXLOTNUMBER.value = '記載不要';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 完了更新時設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF026') {#EOL#&#x9;var qtGenzaiko = Number(ET010FROM_QTKISYUZAIKO.value) + Number(ET010FROM_QTNYUKO.value) - Number(ET010FROM_QTSYUKKO.value);#EOL#&#x9;var amGenzaiko = Number(ET010FROM_AMKISYUZAIKO.value) + Number(ET010FROM_AMNYUKO.value) - Number(ET010FROM_AMSYUKKO.value);#EOL#&#x9;if (qtGenzaiko == 0) {#EOL#&#x9;&#x9;KT021_PRIDOU.value = 0;#EOL#&#x9;} else {#EOL#&#x9;&#x9;KT021_PRIDOU.value = Math.round(amGenzaiko / qtGenzaiko);#EOL#&#x9;}#EOL##EOL#&#x9;if (KT021_NRLOCATIONTO.value == '') {#EOL#&#x9;&#x9;KT021_NRLOCATIONTO.error = '移動先ロケを入力してください';#EOL#&#x9;}#EOL##EOL#&#x9;if (BT020_FGLOTKANRI.value == 'T') {#EOL#&#x9;&#x9;KT021_TXLOTNUMBER.editable = true;#EOL#&#x9;&#x9;if (KT021_TXLOTNUMBER.value == '') {#EOL#&#x9;&#x9;&#x9;KT021_TXLOTNUMBER.error = 'ロット管理品です。ロット№を入力してください。';#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;KT021_TXLOTNUMBER.editable = false;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 完了取消時設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF027') {#EOL#&#x9;KT021_PRIDOU.editable = false;#EOL#&#x9;KT021_QTIDOU.editable = false;#EOL#&#x9;KT021_NRLOCATIONTO.editable = false;#EOL#}#EOL#"/><Script EventP="AU" EventR="" Function="" Name="更新時の受払予定設定(KF022,25)" Order="0031" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var dET200; var cET200;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#///////////////////////////////////////////////////#EOL#// 移動未完了であれば受払予定(ET200)の削除・追加 //#EOL#///////////////////////////////////////////////////#EOL#if (KT020_TMKANRYO.value == '' &amp;&amp; (instance.functionID == 'KF022' || instance.functionID == 'KF025')) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 関連する受払予定の削除 //#EOL#&#x9;////////////////////////////#EOL#&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRIFROM.value);#EOL#&#x9;dET200.execute();#EOL#&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRITO.value);#EOL#&#x9;dET200.execute();#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 出庫予定の追加 //#EOL#&#x9;////////////////////#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRIFROM.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'30');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;KT020_DTSHIJI.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET200.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;KT021_QTIDOU.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;KT021_NRZAIKOIDOU.value + '-' + KT021_SQZAIKOIDOU.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 入庫予定の追加 //#EOL#&#x9;////////////////////#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRITO.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'31');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;KT020_DTSHIJI.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET200.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;KT021_QTIDOU.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;KT021_NRZAIKOIDOU.value + '-' + KT021_SQZAIKOIDOU.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="完了取消時の関連レコード処理(KF027)" Order="0041" Text="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rET100; var uET100; var cET100; var cET200; var rET010; var uET010; var cET010;#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL#var dtNend = 0; var dtMSeq = 0; var ukebaraiKubun = '';#EOL#var count = 0; var errorMessage = ''; var dtUkebarai = ''; var today = '';#EOL##EOL#//////////////////////////////////////#EOL#// 完了取消されたのであれば赤黒訂正 //#EOL#//////////////////////////////////////#EOL#if (instance.functionID == 'KF027') {#EOL##EOL#&#x9;///////////////////////////#EOL#&#x9;// 受払予定(ET200)の追加 //#EOL#&#x9;///////////////////////////#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRIFROM.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'30');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;KT020_DTSHIJI.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET200.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;KT021_QTIDOU.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;KT021_NRZAIKOIDOU.value + '-' + KT021_SQZAIKOIDOU.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;KT021_NRTORIHIKIKANRITO.value);#EOL#&#x9;&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'31');#EOL#&#x9;&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;KT020_DTSHIJI.value);#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;cET200.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;KT021_QTIDOU.value);#EOL#&#x9;&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;KT021_NRZAIKOIDOU.value + '-' + KT021_SQZAIKOIDOU.value);#EOL#&#x9;&#x9;count = cET200.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', KT020_NRTORIHIKIKANRI.value);#EOL#&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// 年度・月度・日付・区分の設定 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;today = session.getToday() + '';#EOL#&#x9;dtNend = session.getFYearOfDate(today);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(today);#EOL#&#x9;dtUkebarai = today + '';#EOL##EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL#&#x9;////////////////////////// 出 庫 処 理 //////////////////////////#EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 受払区分と出庫高の設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;ukebaraiKubun = '30'; //移動出庫//#EOL#&#x9;qtUkebarai = KT021_QTIDOU.value;#EOL#&#x9;amUkebarai = qtUkebarai * KT021_PRIDOU.value;#EOL##EOL#&#x9;///////////////////////////////#EOL#&#x9;// 出庫実績(ET100)の赤伝追加 //#EOL#&#x9;///////////////////////////////#EOL#&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;dtUkebarai);#EOL#&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;ET010FROM_NRLOCATION.value);#EOL#&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT021_TXLOTNUMBER.value);#EOL#&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT020_NRTORIHIKIKANRI.value);#EOL#&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;count = cET100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 出庫側の倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) - Number(qtUkebarai); // qtUkebarai &lt; 0 //#EOL#&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) - Number(amUkebarai); // amUkebarai &lt; 0 //#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amUkebarai * -1);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtUkebarai * -1);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL#&#x9;////////////////////////// 入 庫 処 理 //////////////////////////#EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 受払区分と入庫高の設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;ukebaraiKubun = '31'; //移動入庫//#EOL#&#x9;qtUkebarai = KT021_QTIDOU.value * -1;#EOL#&#x9;amUkebarai = qtUkebarai * KT021_PRIDOU.value;#EOL##EOL#&#x9;///////////////////////////////#EOL#&#x9;// 入庫実績(ET100)の赤伝追加 //#EOL#&#x9;///////////////////////////////#EOL#&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;dtUkebarai);#EOL#&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;KT021_NRLOCATIONTO.value);#EOL#&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;KT020_NRSOUKOFROM.value);#EOL#&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT021_TXLOTNUMBER.value);#EOL#&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT020_NRTORIHIKIKANRI.value);#EOL#&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;count = cET100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 入庫側の倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtUkebarai);#EOL#&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amUkebarai);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT021_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT020_NRSOUKOTO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Refer Fields="TXSOUKO" Order="0050" OrderBy="" TableAlias="KT020BT030FROM" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="KT020.NRSOUKOFROM"/><Refer Fields="TXSOUKO" Order="0060" TableAlias="KT020BT030TO" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="KT020.NRSOUKOTO"/><Refer Fields="" Order="0080" OrderBy="" TableAlias="KT021BT031TO" ToKeyFields="NRSOUKO;NRLOCATION" ToTable="BT031" WithKeyFields="KT020.NRSOUKOTO;KT021.NRLOCATIONTO"/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0041" Remarks="ロット管理品の場合、入力必須" Size="40" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKIKANRIFROM" Name="出庫管理№" Nullable="F" Order="0063" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field Decimal="" ID="NRTORIHIKIKANRITO" Name="入庫管理№" Nullable="F" Order="0064" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Refer Fields="NRLOCATION;QTKISYUZAIKO;QTNYUKO;QTSYUKKO;AMKISYUZAIKO;AMNYUKO;AMSYUKKO" Order="0090" OrderBy="" TableAlias="ET010FROM" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="KT021.NRSYOHIN;KT020.NRSOUKOFROM"/><Refer Fields="NRLOCATION" Optional="T" Order="0100" OrderBy="" TableAlias="ET010TO" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="KT021.NRSYOHIN;KT020.NRSOUKOTO"/></Table><Table ActiveWhere="" ID="KT020" Name="在庫移動指示" RangeKey="" Remarks="在庫の倉庫／ロケを変更するための指示情報を保持するためのテーブル" SubsystemID="K"><Field Decimal="" ID="NRZAIKOIDOU" Name="移動指示№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRZAIKOIDOU)"/><Field Decimal="" ID="DTSHIJI" Name="指示日" Nullable="F" Order="0020" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRSOUKOFROM" Name="元倉庫№" Nullable="F" Order="0030" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSOUKOTO" Name="先倉庫№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0070" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Key Fields="NRZAIKOIDOU" Type="PK"/><Refer Fields="TXSOUKO;TXJYUSYO" Order="0010" TableAlias="BT030FROM" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="KT020.NRSOUKOFROM"/><Refer Fields="TXSOUKO;TXJYUSYO" Order="0020" TableAlias="BT030TO" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="KT020.NRSOUKOTO"/><Field Decimal="" ID="STZAIKOIDOU" Name="処理状況" Nullable="F" Order="0080" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STZAIKOIDOU)"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0030" Text="////////////////////#EOL#// 状況区分の設定 //#EOL#////////////////////#EOL#if (KT020_TMKANRYO.value == '') {#EOL#&#x9;if (KT020_TMHAKKOU.value == '') {#EOL#&#x9;&#x9;KT020_STZAIKOIDOU.value = '10'; //未発行//#EOL#&#x9;} else {#EOL#&#x9;&#x9;KT020_STZAIKOIDOU.value = '20'; //移動中//#EOL#&#x9;}#EOL#} else {#EOL#&#x9;KT020_STZAIKOIDOU.value = '30'; //移動完了//#EOL#}#EOL#"/><Field Decimal="" ID="DTKANRYOYOTEI" Name="完了予定日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0010" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#KT020_TMHAKKOU.editable = false;#EOL#KT020_TMKANRYO.editable = false;#EOL#KT020_STZAIKOIDOU.editable = false;#EOL##EOL#////////////////////////////////////#EOL#// 指示日と完了予定日の初期値設定 //#EOL#////////////////////////////////////#EOL#KT020_DTSHIJI.value = session.getToday() + '';#EOL#KT020_DTKANRYOYOTEI.value = session.getToday() + '';"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0071" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Script EventP="BU" EventR="AR()" Function="" Name="更新前設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#KT020_NRSOUKOFROM.editable = false;#EOL#KT020_NRSOUKOTO.editable = false;#EOL#KT020_TMHAKKOU.editable = false;#EOL#KT020_TMKANRYO.editable = false;#EOL#KT020_NRTORIHIKIKANRI.editable = false;#EOL#KT020_STZAIKOIDOU.editable = false;#EOL##EOL#////////////////////#EOL#// 完了更新時設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF026') {#EOL#&#x9;KT020_DTSHIJI.editable = false;#EOL#&#x9;KT020_DTKANRYOYOTEI.editable = false;#EOL#&#x9;if (KT020_TMKANRYO.value == '') {#EOL#&#x9;&#x9;KT020_TMKANRYO.value = session.getTimeStamp() + '';#EOL#&#x9;}#EOL#&#x9;KT020_TMKANRYO.error = session.getErrorOfAccountDate(KT020_TMKANRYO.value);#EOL#}#EOL##EOL#////////////////////#EOL#// 完了取消時設定 //#EOL#////////////////////#EOL#if (instance.functionID == 'KF027') {#EOL#&#x9;KT020_DTSHIJI.editable = false;#EOL#&#x9;KT020_DTKANRYOYOTEI.editable = false;#EOL#&#x9;KT020_TMKANRYO.error = session.getErrorOfAccountDate(KT020_TMKANRYO.value);#EOL#&#x9;if (KT020_TMKANRYO.error == '') {#EOL#&#x9;&#x9;KT020_TMKANRYO.value = '';#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="TMHAKKOU" Name="発行日時" Nullable="T" Order="0053" Size="23" Type="DATETIME" TypeOptions=""/><Field Decimal="" ID="TMKANRYO" Name="完了日時" Nullable="T" Order="0061" Size="23" Type="DATETIME" TypeOptions=""/></Table><Table ActiveWhere="" ID="YT020" Name="月次取引SUM" RangeKey="" Remarks="年月度別の実績集計情報を保持するためのテーブル。年次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0010" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMURIKISYUZAN" Name="期首売掛残高" Nullable="T" Order="0030" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURISYUK" Name="期間出荷売上額" Nullable="T" Order="0040" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITYOK" Name="期間直出荷売上" Nullable="T" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIHENPIN" Name="期間出荷返品額" Nullable="T" Order="0060" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUEKI" Name="期間雑益売上額" Nullable="T" Order="0070" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUSON" Name="期間雑損振替額" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURISOUSAI" Name="期間売上相殺額" Nullable="T" Order="0090" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURINEBIKI" Name="期間営業値引額" Nullable="T" Order="0100" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIJYURYO" Name="期間売上受領額" Nullable="T" Order="0110" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIGENKA" Name="期間売上原価" Nullable="T" Order="0120" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITAX" Name="期間売上消費税" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIKISYUZAN" Name="期首買掛残高" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAINYUK" Name="期間入荷仕入額" Nullable="T" Order="0150" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAITYOK" Name="期間直入荷仕入" Nullable="T" Order="0160" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIHENPIN" Name="期間入荷返品額" Nullable="T" Order="0170" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIZATSUEKI" Name="期間雑益振替額" Nullable="T" Order="0180" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIZATSUSON" Name="期間雑損仕入額" Nullable="T" Order="0190" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAISOUSAI" Name="期間仕入相殺額" Nullable="T" Order="0200" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIGENKA" Name="期間原価振替額" Nullable="T" Order="0210" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAISIHARAI" Name="期間仕入支払額" Nullable="T" Order="0220" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAITAX" Name="期間仕入消費税" Nullable="T" Order="0230" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIKISYUZAN" Name="期首在庫残高" Nullable="T" Order="0240" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAINYUK" Name="期間仕入入庫額" Nullable="T" Order="0250" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAINYUKHEN" Name="期間仕入返品額" Nullable="T" Order="0260" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISYUK" Name="期間売上出庫額" Nullable="T" Order="0270" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISYUKHEN" Name="期間売上返品額" Nullable="T" Order="0280" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIIDOU" Name="期間移動額" Nullable="T" Order="0290" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIGENMOU" Name="期間減耗額" Nullable="T" Order="0300" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAZON" Name="期間評価損額" Nullable="T" Order="0310" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAEKI" Name="期間評価益額" Nullable="T" Order="0320" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISIKAKARI" Name="期間仕掛出庫額" Nullable="T" Order="0330" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUSON" Name="期間雑損額" Nullable="T" Order="0340" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUEKI" Name="期間雑益額" Nullable="T" Order="0350" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIKANSEI" Name="期間完成入庫額" Nullable="T" Order="0360" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIKAKOUHI" Name="期間加工費繰入" Nullable="T" Order="0370" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZOUGEN" Name="期間棚増減額" Nullable="T" Order="0380" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="DTNEND;DTMSEQ" Type="PK"/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0020" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field Decimal="" ID="AMURIKIMATSUZAN" Name="期末売掛残高" Nullable="T" Order="0410" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMKAIKIMATSUZAN" Name="期末買掛残高" Nullable="T" Order="0430" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMZAIKIMATSUZAN" Name="期末在庫残高" Nullable="T" Order="0460" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMURIHANHURI" Name="期間販売費振替" Nullable="T" Order="0101" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIARARI" Name="期間粗利額" Nullable="T" Order="0381" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT020_AMURIKIMATSUZAN.value = Number(YT020_AMURIKISYUZAN.value) + Number(YT020_AMURISYUK.value)#EOL#&#x9; + Number(YT020_AMURITYOK.value) + Number(YT020_AMURIHENPIN.value) + Number(YT020_AMURIZATSUEKI.value)#EOL#&#x9; + Number(YT020_AMURIZATSUSON.value) + Number(YT020_AMURISOUSAI.value)#EOL#&#x9; + Number(YT020_AMURIHANHURI.value) + Number(YT020_AMURITAX.value) + Number(YT020_AMURIJYURYO.value);#EOL##EOL#YT020_AMURIARARI.value = Number(YT020_AMURISYUK.value) + Number(YT020_AMURITYOK.value)#EOL#&#x9; + Number(YT020_AMURIHENPIN.value) - Number(YT020_AMURIGENKA.value);#EOL##EOL#YT020_AMKAIKIMATSUZAN.value = Number(YT020_AMKAIKISYUZAN.value) + Number(YT020_AMKAINYUK.value)#EOL#&#x9; + Number(YT020_AMKAITYOK.value) + Number(YT020_AMKAIHENPIN.value) + Number(YT020_AMKAIZATSUEKI.value)#EOL#&#x9; + Number(YT020_AMKAIZATSUSON.value) + Number(YT020_AMKAISOUSAI.value)#EOL#&#x9; + Number(YT020_AMKAIGENKA.value) + Number(YT020_AMKAITAX.value) + Number(YT020_AMKAISIHARAI.value);#EOL##EOL#YT020_AMZAIKIMATSUZAN.value = Number(YT020_AMZAIKISYUZAN.value) + Number(YT020_AMZAINYUK.value)#EOL#&#x9; + Number(YT020_AMZAINYUKHEN.value) + Number(YT020_AMZAISYUK.value) + Number(YT020_AMZAISYUKHEN.value)#EOL#&#x9; + Number(YT020_AMZAIIDOU.value) + Number(YT020_AMZAIGENMOU.value) + Number(YT020_AMZAIHYOKAZON.value)#EOL#&#x9; + Number(YT020_AMZAIHYOKAEKI.value) + Number(YT020_AMZAISIKAKARI.value) + Number(YT020_AMZAIZATSUSON.value)#EOL#&#x9; + Number(YT020_AMZAIZATSUEKI.value) + Number(YT020_AMZAIKANSEI.value)#EOL#&#x9; + Number(YT020_AMZAIKAKOUHI.value) + Number(YT020_AMZAIZOUGEN.value);"/></Table><Table ActiveWhere="" ID="YT030" Name="商品別月次取引SUM" RangeKey="" Remarks="商品･年月度別の実績集計情報を保持するためのテーブル。月次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0010" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMZAINYUK" Name="期間仕入入庫額" Nullable="T" Order="0220" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAINYUKHEN" Name="期間仕入返品額" Nullable="T" Order="0240" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISYUK" Name="期間売上出庫額" Nullable="T" Order="0260" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISYUKHEN" Name="期間売上返品額" Nullable="T" Order="0280" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIIDOU" Name="期間移動額" Nullable="T" Order="0300" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIGENMOU" Name="期間減耗額" Nullable="T" Order="0320" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAZON" Name="期間評価損額" Nullable="T" Order="0340" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAEKI" Name="期間評価益額" Nullable="T" Order="0350" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISIKAKARI" Name="期間仕掛出庫額" Nullable="T" Order="0360" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUSON" Name="期間雑損額" Nullable="T" Order="0380" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUEKI" Name="期間雑益額" Nullable="T" Order="0400" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIKANSEI" Name="期間完成入庫額" Nullable="T" Order="0420" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIKAKOUHI" Name="期間加工費繰入" Nullable="T" Order="0440" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZOUGEN" Name="期間棚増減額" Nullable="T" Order="0450" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0020" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Key Fields="DTNEND;DTMSEQ;NRSYOHIN" Type="PK"/><Field Decimal="" ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0030" Size="7" Type="CHAR" TypeOptions=""/><Refer Fields="TXSYOHIN;TXHINBAN;PRHANBAI;PRSIIRE;KBZAIKOUM;KBSYOHIN" Order="0010" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="YT030.NRSYOHIN"/><Field Decimal="" ID="AMZAIKIMATSUZAN" Name="期末在庫残高" Nullable="T" Order="0490" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMZAIKISYUZAN" Name="期首在庫残高" Nullable="T" Order="0200" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAINYUK" Name="期間仕入入庫数" Nullable="T" Order="0230" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAINYUKHEN" Name="期間仕入返品数" Nullable="T" Order="0250" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAISYUK" Name="期間売上出庫数" Nullable="T" Order="0270" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAISYUKHEN" Name="期間売上返品数" Nullable="T" Order="0290" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIIDOU" Name="期間移動数" Nullable="T" Order="0310" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIGENMOU" Name="期間減耗数" Nullable="T" Order="0330" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAISIKAKARI" Name="期間仕掛出庫数" Nullable="T" Order="0370" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIZATSUSON" Name="期間雑損数" Nullable="T" Order="0390" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIZATSUEKI" Name="期間雑益数" Nullable="T" Order="0410" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIKANSEI" Name="期間完成入庫数" Nullable="T" Order="0430" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIZOUGEN" Name="期間棚増減数" Nullable="T" Order="0460" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIKISYUZAN" Name="期首在庫残数" Nullable="T" Order="0210" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIKIMATSUZAN" Name="期末在庫残数" Nullable="T" Order="0500" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMZAIARARI" Name="期間粗利額" Nullable="T" Order="0470" Size="9" Type="INTEGER" TypeOptions=""/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT030_AMZAIKIMATSUZAN.value = Number(YT030_AMZAIKISYUZAN.value) + Number(YT030_AMZAINYUK.value)#EOL#&#x9; + Number(YT030_AMZAINYUKHEN.value) + Number(YT030_AMZAISYUK.value) + Number(YT030_AMZAISYUKHEN.value)#EOL#&#x9; + Number(YT030_AMZAIIDOU.value) + Number(YT030_AMZAIGENMOU.value) + Number(YT030_AMZAIHYOKAZON.value)#EOL#&#x9; + Number(YT030_AMZAIHYOKAEKI.value) + Number(YT030_AMZAISIKAKARI.value) + Number(YT030_AMZAIZATSUSON.value)#EOL#&#x9; + Number(YT030_AMZAIZATSUEKI.value) + Number(YT030_AMZAIKANSEI.value)#EOL#&#x9; + Number(YT030_AMZAIKAKOUHI.value) + Number(YT030_AMZAIZOUGEN.value);#EOL##EOL#YT030_QTZAIKIMATSUZAN.value = Number(YT030_QTZAIKISYUZAN.value) + Number(YT030_QTZAINYUK.value)#EOL#&#x9; + Number(YT030_QTZAINYUKHEN.value) + Number(YT030_QTZAISYUK.value) + Number(YT030_QTZAISYUKHEN.value)#EOL#&#x9; + Number(YT030_QTZAIIDOU.value) + Number(YT030_QTZAIGENMOU.value) + Number(YT030_QTZAISIKAKARI.value)#EOL#&#x9; + Number(YT030_QTZAIZATSUSON.value) + Number(YT030_QTZAIZATSUEKI.value)#EOL#&#x9; + Number(YT030_QTZAIKANSEI.value) + Number(YT030_QTZAIZOUGEN.value);#EOL#"/></Table><Table ActiveWhere="" ID="YT010" Name="年次取引SUM" RangeKey="" Remarks="年度別の実績集計情報を保持するためのテーブル。最上位のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0010" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMURIKISYUZAN" Name="期首売掛残高" Nullable="T" Order="0020" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURISYUK" Name="期間出荷売上額" Nullable="T" Order="0030" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURITYOK" Name="期間直出荷売上" Nullable="T" Order="0040" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURIHENPIN" Name="期間出荷返品額" Nullable="T" Order="0050" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUEKI" Name="期間雑益売上額" Nullable="T" Order="0060" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUSON" Name="期間雑損振替額" Nullable="T" Order="0070" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURISOUSAI" Name="期間売上相殺額" Nullable="T" Order="0080" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURINEBIKI" Name="期間営業値引額" Nullable="T" Order="0090" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURIJYURYO" Name="期間売上受領額" Nullable="T" Order="0100" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURIGENKA" Name="期間売上原価" Nullable="T" Order="0110" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMURITAX" Name="期間売上消費税" Nullable="T" Order="0120" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAIKISYUZAN" Name="期首買掛残高" Nullable="T" Order="0130" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAINYUK" Name="期間入荷仕入額" Nullable="T" Order="0140" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAITYOK" Name="期間直入荷仕入" Nullable="T" Order="0150" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAIHENPIN" Name="期間入荷返品額" Nullable="T" Order="0160" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAIZATSUEKI" Name="期間雑益振替額" Nullable="T" Order="0170" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAIZATSUSON" Name="期間雑損仕入額" Nullable="T" Order="0180" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAISOUSAI" Name="期間仕入相殺額" Nullable="T" Order="0190" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAIGENKA" Name="期間原価振替額" Nullable="T" Order="0200" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAISIHARAI" Name="期間仕入支払額" Nullable="T" Order="0210" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMKAITAX" Name="期間仕入消費税" Nullable="T" Order="0220" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIKISYUZAN" Name="期首在庫残高" Nullable="T" Order="0230" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAINYUK" Name="期間仕入入庫額" Nullable="T" Order="0240" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAINYUKHEN" Name="期間仕入返品額" Nullable="T" Order="0250" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAISYUK" Name="期間売上出庫額" Nullable="T" Order="0260" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAISYUKHEN" Name="期間売上返品額" Nullable="T" Order="0270" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIIDOU" Name="期間移動額" Nullable="T" Order="0280" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIGENMOU" Name="期間減耗額" Nullable="T" Order="0290" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAZON" Name="期間評価損額" Nullable="T" Order="0300" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAEKI" Name="期間評価益額" Nullable="T" Order="0310" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAISIKAKARI" Name="期間仕掛出庫額" Nullable="T" Order="0320" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUSON" Name="期間雑損額" Nullable="T" Order="0330" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUEKI" Name="期間雑益額" Nullable="T" Order="0340" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIKANSEI" Name="期間完成入庫額" Nullable="T" Order="0350" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIKAKOUHI" Name="期間加工費繰入" Nullable="T" Order="0360" Size="10" Type="BIGINT" TypeOptions=""/><Field Decimal="" ID="AMZAIZOUGEN" Name="期間棚増減額" Nullable="T" Order="0370" Size="10" Type="BIGINT" TypeOptions=""/><Key Fields="DTNEND" Type="PK"/><Field Decimal="" ID="AMURIKIMATSUZAN" Name="期末売掛残高" Nullable="T" Order="0400" Size="10" Type="BIGINT" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMKAIKIMATSUZAN" Name="期末買掛残高" Nullable="T" Order="0420" Size="10" Type="BIGINT" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMZAIKIMATSUZAN" Name="期末在庫残高" Nullable="T" Order="0450" Size="10" Type="BIGINT" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMURIHANHURI" Name="期間販売費振替" Nullable="T" Order="0091" Size="10" Type="BIGINT" TypeOptions=""/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT010_AMURIKIMATSUZAN.value = Number(YT010_AMURIKISYUZAN.value) + Number(YT010_AMURISYUK.value)#EOL#&#x9; + Number(YT010_AMURITYOK.value) + Number(YT010_AMURIHENPIN.value) + Number(YT010_AMURIZATSUEKI.value)#EOL#&#x9; + Number(YT010_AMURIZATSUSON.value) + Number(YT010_AMURISOUSAI.value)#EOL#&#x9; + Number(YT010_AMURIHANHURI.value) + Number(YT010_AMURITAX.value) + Number(YT010_AMURIJYURYO.value);#EOL##EOL#YT010_AMURIARARI.value = Number(YT010_AMURISYUK.value) + Number(YT010_AMURITYOK.value)#EOL#&#x9; + Number(YT010_AMURIHENPIN.value) - Number(YT010_AMURIGENKA.value);#EOL##EOL#YT010_AMKAIKIMATSUZAN.value = Number(YT010_AMKAIKISYUZAN.value) + Number(YT010_AMKAINYUK.value)#EOL#&#x9; + Number(YT010_AMKAITYOK.value) + Number(YT010_AMKAIHENPIN.value) + Number(YT010_AMKAIZATSUEKI.value)#EOL#&#x9; + Number(YT010_AMKAIZATSUSON.value) + Number(YT010_AMKAISOUSAI.value)#EOL#&#x9; + Number(YT010_AMKAIGENKA.value) + Number(YT010_AMKAITAX.value) + Number(YT010_AMKAISIHARAI.value);#EOL##EOL#YT010_AMZAIKIMATSUZAN.value = Number(YT010_AMZAIKISYUZAN.value) + Number(YT010_AMZAINYUK.value)#EOL#&#x9; + Number(YT010_AMZAINYUKHEN.value) + Number(YT010_AMZAISYUK.value) + Number(YT010_AMZAISYUKHEN.value)#EOL#&#x9; + Number(YT010_AMZAIIDOU.value) + Number(YT010_AMZAIGENMOU.value) + Number(YT010_AMZAIHYOKAZON.value)#EOL#&#x9; + Number(YT010_AMZAIHYOKAEKI.value) + Number(YT010_AMZAISIKAKARI.value) + Number(YT010_AMZAIZATSUSON.value)#EOL#&#x9; + Number(YT010_AMZAIZATSUEKI.value) + Number(YT010_AMZAIKANSEI.value)#EOL#&#x9; + Number(YT010_AMZAIKAKOUHI.value) + Number(YT010_AMZAIZOUGEN.value);"/><Field Decimal="" ID="AMURIARARI" Name="期間粗利額" Nullable="T" Order="0371" Size="10" Type="BIGINT" TypeOptions="VIRTUAL"/></Table><Table ActiveWhere="" ID="YT040" Name="仕入先別月次取引SUM" RangeKey="" Remarks="仕入先･年月度別の実績集計情報を保持するためのテーブル。月次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0000" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMKAIKISYUZAN" Name="期首買掛残高" Nullable="T" Order="0120" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAINYUK" Name="期間入荷仕入額" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAITYOK" Name="期間直入荷仕入" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIHENPIN" Name="期間入荷返品額" Nullable="T" Order="0150" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIZATSUEKI" Name="期間雑益振替額" Nullable="T" Order="0160" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIZATSUSON" Name="期間雑損仕入額" Nullable="T" Order="0170" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAISOUSAI" Name="期間仕入相殺額" Nullable="T" Order="0180" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIGENKA" Name="期間原価振替額" Nullable="T" Order="0190" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAISIHARAI" Name="期間支払額" Nullable="T" Order="0200" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAITAX" Name="期間消費税" Nullable="T" Order="0210" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0001" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Key Fields="DTNEND;DTMSEQ;NRTORIHIKISAKI" Type="PK"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0002" Size="8" Type="CHAR" TypeOptions=""/><Refer Fields="TXKANJI;KBCOUNTRY" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="YT040.NRTORIHIKISAKI"/><Field Decimal="" ID="AMKAIKIMATSUZAN" Name="期末買掛残高" Nullable="T" Order="0212" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT040_AMKAIKIMATSUZAN.value = Number(YT040_AMKAIKISYUZAN.value) + Number(YT040_AMKAINYUK.value)#EOL#&#x9; + Number(YT040_AMKAITYOK.value) + Number(YT040_AMKAIHENPIN.value) + Number(YT040_AMKAIZATSUEKI.value)#EOL#&#x9; + Number(YT040_AMKAIZATSUSON.value) + Number(YT040_AMKAISOUSAI.value) + Number(YT040_AMKAIGENKA.value)#EOL#&#x9; + Number(YT040_AMKAITAX.value) + Number(YT040_AMKAISIHARAI.value);"/></Table><Table ActiveWhere="" ID="YT031" Name="商品倉庫別月次取引SUM" RangeKey="" Remarks="商品･倉庫･年月度別の実績集計情報を保持するためのテーブル。商品別月次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0010" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMZAINYUK" Name="期間仕入入庫額" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAINYUKHEN" Name="期間仕入返品額" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISYUK" Name="期間売上出庫額" Nullable="T" Order="0150" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISYUKHEN" Name="期間売上返品額" Nullable="T" Order="0160" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIIDOU" Name="期間移動額" Nullable="T" Order="0170" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIGENMOU" Name="期間減耗額" Nullable="T" Order="0180" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAZON" Name="期間評価損額" Nullable="T" Order="0190" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIHYOKAEKI" Name="期間評価益額" Nullable="T" Order="0200" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAISIKAKARI" Name="期間仕掛出庫額" Nullable="T" Order="0210" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUSON" Name="期間雑損額" Nullable="T" Order="0220" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZATSUEKI" Name="期間雑益額" Nullable="T" Order="0230" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIKANSEI" Name="期間完成入庫額" Nullable="T" Order="0240" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIKAKOUHI" Name="期間加工費繰入" Nullable="T" Order="0250" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMZAIZOUGEN" Name="期間棚増減額" Nullable="T" Order="0260" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0020" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field Decimal="" ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0030" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMZAIKIMATSUZAN" Name="期末在庫残高" Nullable="T" Order="0320" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMZAIKISYUZAN" Name="期首在庫残高" Nullable="T" Order="0120" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAINYUK" Name="期間仕入入庫数" Nullable="T" Order="0131" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAINYUKHEN" Name="期間仕入返品数" Nullable="T" Order="0141" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAISYUK" Name="期間売上出庫数" Nullable="T" Order="0151" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAISYUKHEN" Name="期間売上返品数" Nullable="T" Order="0161" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIIDOU" Name="期間移動数" Nullable="T" Order="0171" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIGENMOU" Name="期間減耗数" Nullable="T" Order="0181" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAISIKAKARI" Name="期間仕掛出庫数" Nullable="T" Order="0211" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIZATSUSON" Name="期間雑損数" Nullable="T" Order="0221" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIZATSUEKI" Name="期間雑益数" Nullable="T" Order="0231" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIKANSEI" Name="期間完成入庫数" Nullable="T" Order="0241" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIZOUGEN" Name="期間棚増減数" Nullable="T" Order="0261" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIKISYUZAN" Name="期首在庫残数" Nullable="T" Order="0121" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTZAIKIMATSUZAN" Name="期末在庫残数" Nullable="T" Order="0321" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Key Fields="DTNEND;DTMSEQ;NRSYOHIN;NRSOUKO" Type="PK"/><Field ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0031" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMZAIARARI" Name="期間粗利額" Nullable="T" Order="0263" Size="9" Type="INTEGER" TypeOptions=""/><Refer Fields="TXSOUKO" Order="0010" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="YT031.NRSOUKO"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM" Order="0020" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="YT031.NRSYOHIN"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT031_AMZAIKIMATSUZAN.value = Number(YT031_AMZAIKISYUZAN.value) + Number(YT031_AMZAINYUK.value)#EOL#&#x9; + Number(YT031_AMZAINYUKHEN.value) + Number(YT031_AMZAISYUK.value) + Number(YT031_AMZAISYUKHEN.value)#EOL#&#x9; + Number(YT031_AMZAIIDOU.value) + Number(YT031_AMZAIGENMOU.value) + Number(YT031_AMZAIHYOKAZON.value)#EOL#&#x9; + Number(YT031_AMZAIHYOKAEKI.value) + Number(YT031_AMZAISIKAKARI.value) + Number(YT031_AMZAIZATSUSON.value)#EOL#&#x9; + Number(YT031_AMZAIZATSUEKI.value) + Number(YT031_AMZAIKANSEI.value)#EOL#&#x9; + Number(YT031_AMZAIKAKOUHI.value) + Number(YT031_AMZAIZOUGEN.value);#EOL##EOL#YT031_QTZAIKIMATSUZAN.value = Number(YT031_QTZAIKISYUZAN.value) + Number(YT031_QTZAINYUK.value)#EOL#&#x9; + Number(YT031_QTZAINYUKHEN.value) + Number(YT031_QTZAISYUK.value) + Number(YT031_QTZAISYUKHEN.value)#EOL#&#x9; + Number(YT031_QTZAIIDOU.value) + Number(YT031_QTZAIGENMOU.value) + Number(YT031_QTZAISIKAKARI.value)#EOL#&#x9; + Number(YT031_QTZAIZATSUSON.value) + Number(YT031_QTZAIZATSUEKI.value)#EOL#&#x9; + Number(YT031_QTZAIKANSEI.value) + Number(YT031_QTZAIZOUGEN.value);#EOL#"/></Table><Table ActiveWhere="" ID="YT041" Name="仕入商品別月次取引SUM" RangeKey="" Remarks="商品･仕入先･年月度別の実績集計情報を保持するためのテーブル。仕入先別月次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0000" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMKAINYUK" Name="期間入荷仕入額" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAITYOK" Name="期間直入荷仕入額" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIHENPIN" Name="期間入荷返品額" Nullable="T" Order="0150" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMKAIGENKA" Name="期間原価振替額" Nullable="T" Order="0190" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0001" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="仕入先№" Nullable="F" Order="0002" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0003" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMKAITAX" Name="期間仕入消費税" Nullable="T" Order="0192" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTKAINYUK" Name="期間入荷仕入数" Nullable="T" Order="0131" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTKAITYOK" Name="期間直入荷仕入数" Nullable="T" Order="0141" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTKAIHENPIN" Name="期間入荷返品数" Nullable="T" Order="0151" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="DTNEND;DTMSEQ;NRTORIHIKISAKI;NRSYOHIN" Type="PK"/><Refer Fields="TXKANJI;KBCOUNTRY" Order="0010" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="YT041.NRTORIHIKISAKI"/><Refer Fields="TXSYOHIN;TXHINBAN;PRSIIRE;KBZAIKOUM;KBSYOHIN;PRHANBAI;PRARARI" Order="0020" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="YT041.NRSYOHIN"/></Table><Table ActiveWhere="" ID="YT051" Name="顧客商品別月次取引SUM" RangeKey="" Remarks="顧客･商品･年月度別の実績集計情報を保持するためのテーブル。顧客別月次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0000" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMURISYUK" Name="期間出荷売上額" Nullable="T" Order="0020" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITYOK" Name="期間直出荷売上額" Nullable="T" Order="0030" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIHENPIN" Name="期間出荷返品額" Nullable="T" Order="0040" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURINEBIKI" Name="期間営業値引額" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIGENKA" Name="期間売上原価" Nullable="T" Order="0100" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0001" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0002" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0003" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="QTURISYUK" Name="期間出荷売上数" Nullable="T" Order="0021" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTURITYOK" Name="期間直出荷売上数" Nullable="T" Order="0031" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTURIHENPIN" Name="期間出荷返品数" Nullable="T" Order="0041" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITAX" Name="期間売上消費税" Nullable="T" Order="0101" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIARARI" Name="期間粗利額" Nullable="T" Order="0102" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMURIHANHURI" Name="期間販売費振替" Nullable="T" Order="0081" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="DTNEND;DTMSEQ;NRTORIHIKISAKI;NRSYOHIN" Type="PK"/><Refer Fields="TXKANJI" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="YT051.NRTORIHIKISAKI"/><Refer Fields="NRTANTOUJYUGYOIN" Order="0030" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="YT051.NRTORIHIKISAKI"/><Refer Fields="" Order="0040" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM;PRHANBAI;KBSYOHIN;PRSIIRE;PRARARI" Order="0050" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="YT051.NRSYOHIN"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT051_AMURIARARI.value = Number(YT051_AMURISYUK.value) + Number(YT051_AMURITYOK.value)#EOL#&#x9; + Number(YT051_AMURIHENPIN.value) - Number(YT051_AMURIGENKA.value);"/></Table><Table ActiveWhere="" ID="YT060" Name="営業担当別月次取引SUM" RangeKey="" Remarks="営業担当別の実績集計情報を保持するためのテーブル。月次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0000" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMURISYUK" Name="期間出荷売上額" Nullable="T" Order="0020" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITYOK" Name="期間直出荷売上" Nullable="T" Order="0030" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIHENPIN" Name="期間出荷返品額" Nullable="T" Order="0040" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUEKI" Name="期間雑益売上額" Nullable="T" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUSON" Name="期間雑損振替額" Nullable="T" Order="0060" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURINEBIKI" Name="期間営業値引額" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIGENKA" Name="期間売上原価" Nullable="T" Order="0100" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITAX" Name="期間売上消費税" Nullable="T" Order="0110" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0001" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field ID="NRTANTOUJYUGYOIN" Name="担当営業№" Nullable="F" Order="0004" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMURIARARI" Name="期間粗利額" Nullable="T" Order="0111" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMURIHANHURI" Name="期間販売費振替" Nullable="T" Order="0081" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="DTNEND;DTMSEQ;NRTANTOUJYUGYOIN" Type="PK"/><Refer Fields="TXKANJI" Order="0010" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="YT060.NRTANTOUJYUGYOIN"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT060_AMURIARARI.value = Number(YT060_AMURISYUK.value) + Number(YT060_AMURITYOK.value)#EOL#&#x9; + Number(YT060_AMURIHENPIN.value) - Number(YT060_AMURIGENKA.value);"/></Table><Table ActiveWhere="" ID="YT050" Name="顧客別月次取引SUM" RangeKey="" Remarks="顧客･年月度別の実績集計情報を保持するためのテーブル。月次の直下のサマリレベル。" SubsystemID="Y"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0010" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field Decimal="" ID="AMURISYUK" Name="期間出荷売上額" Nullable="T" Order="0060" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITYOK" Name="期間直出荷売上" Nullable="T" Order="0070" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIHENPIN" Name="期間出荷返品額" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUEKI" Name="期間雑益売上額" Nullable="T" Order="0090" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIZATSUSON" Name="期間雑損振替額" Nullable="T" Order="0100" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURISOUSAI" Name="期間売上相殺額" Nullable="T" Order="0110" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURINEBIKI" Name="期間営業値引額" Nullable="T" Order="0120" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIJYURYO" Name="期間受領額" Nullable="T" Order="0130" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIGENKA" Name="期間売上原価" Nullable="T" Order="0140" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0020" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field Decimal="" ID="NRTORIHIKISAKI" Name="顧客№" Nullable="F" Order="0030" Size="8" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMURIKISYUZAN" Name="期首売掛残高" Nullable="T" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURITAX" Name="期間消費税" Nullable="T" Order="0150" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMURIKIMATSUZAN" Name="期末売掛残高" Nullable="T" Order="0170" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMURIARARI" Name="期間粗利額" Nullable="T" Order="0160" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMURIHANHURI" Name="期間販売費振替" Nullable="T" Order="0121" Size="9" Type="INTEGER" TypeOptions=""/><Key Fields="DTNEND;DTMSEQ;NRTORIHIKISAKI" Type="PK"/><Refer Fields="TXKANJI" Order="0010" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="AT030" WithKeyFields="YT050.NRTORIHIKISAKI"/><Refer Fields="NRTANTOUJYUGYOIN" Order="0020" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="YT050.NRTORIHIKISAKI"/><Refer Fields="TXKANJI" Order="0030" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0000" Text="YT050_AMURIKIMATSUZAN.value = Number(YT050_AMURIKISYUZAN.value) + Number(YT050_AMURISYUK.value)#EOL#&#x9; + Number(YT050_AMURITYOK.value) + Number(YT050_AMURIHENPIN.value) + Number(YT050_AMURIZATSUEKI.value)#EOL#&#x9; + Number(YT050_AMURIZATSUSON.value) + Number(YT050_AMURISOUSAI.value)#EOL#&#x9; + Number(YT050_AMURIHANHURI.value) + Number(YT050_AMURITAX.value) + Number(YT050_AMURIJYURYO.value);#EOL##EOL#YT050_AMURIARARI.value = Number(YT050_AMURISYUK.value) + Number(YT050_AMURITYOK.value)#EOL#&#x9; + Number(YT050_AMURIHENPIN.value) - Number(YT050_AMURIGENKA.value);"/></Table><Table ActiveWhere="" ID="ZT081" Name="月次為替レート" RangeKey="" Remarks="月次為替レートを保持するためのテーブル" SubsystemID="Z"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0030" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0040" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/><Field ID="KBCURRENCY" Name="通貨区分" Nullable="F" Order="0020" Size="3" Type="CHAR" TypeOptions="KUBUN(KBCURRENCY)"/><Key Fields="KBCURRENCY;DTNEND;DTMSEQ" Type="PK"/><Field Decimal="3" ID="VLRATEB" Name="ＴＴＢレート" Nullable="F" Order="0051" Size="10" Type="NUMERIC" TypeOptions=""/><Field Decimal="3" ID="VLRATEM" Name="ＴＴＭレート" Nullable="F" Order="0052" Size="10" Type="NUMERIC" TypeOptions=""/><Field Decimal="3" ID="VLRATES" Name="ＴＴＳレート" Nullable="F" Order="0053" Size="10" Type="NUMERIC" TypeOptions=""/></Table><Table ActiveWhere="" ID="ZT080" Name="年次為替レート" RangeKey="" Remarks="年次為替レートを保持するためのテーブル" SubsystemID="Z"><Field Decimal="" ID="DTNEND" Name="年度" Nullable="F" Order="0020" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/><Field ID="KBCURRENCY" Name="通貨区分" Nullable="F" Order="0011" Size="3" Type="CHAR" TypeOptions="KUBUN(KBCURRENCY)"/><Key Fields="KBCURRENCY;DTNEND" Type="PK"/><Field Decimal="3" ID="VLRATEB" Name="ＴＴＢレート" Nullable="F" Order="0032" Size="10" Type="NUMERIC" TypeOptions=""/><Field Decimal="3" ID="VLRATEM" Name="ＴＴＭレート" Nullable="F" Order="0033" Size="10" Type="NUMERIC" TypeOptions=""/><Field Decimal="3" ID="VLRATES" Name="ＴＴＳレート" Nullable="F" Order="0034" Size="10" Type="NUMERIC" TypeOptions=""/></Table><Table ActiveWhere="" ID="BT021" Name="セット構成" RangeKey="" Remarks="セット商品の構成品を登録するためのテーブル。構成数や納品書上に構成を示すかどうかのフラグなどを保持する。" SubsystemID="B"><Field Decimal="" ID="NRCHILD" Name="構成品内部商品№" Nullable="F" Order="0030" Remarks="「子品番」の内部商品№" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="RTKOUSEI" Name="構成数" Nullable="F" Order="0040" Remarks="子品番の在庫管理単位にもとづく値が指定される" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="FGNOUHIN" Name="納品書出力対象" Nullable="F" Order="0050" Size="1" Type="CHAR" TypeOptions="KUBUN(KBFLAG1)"/><Field Decimal="" ID="SQLIST" Name="構成一覧順" Nullable="T" Order="0060" Size="3" Type="SMALLINT" TypeOptions="NO_EDIT"/><Key Fields="NRSYOHIN;NRCHILD" Type="PK"/><Field ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0020" Remarks="「親品番」の内部商品№" Size="7" Type="CHAR" TypeOptions=""/><Key Fields="NRSYOHIN;SQLIST" Type="XK"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM" Order="0030" TableAlias="BT020A" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="BT021.NRSYOHIN"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM" Order="0040" TableAlias="BT020B" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="BT021.NRCHILD"/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="LT011" Name="セット指示構成明細" RangeKey="" Remarks="セット指示に関連する構成品の内訳を管理するためのテーブル。指示レコードの追加にともなって、セット構成マスターの内容にもとづいて自動展開される。" SubsystemID="L"><Field Decimal="" ID="NRSET" Name="セット指示№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="SQKOUSEI" Name="構成行" Nullable="F" Order="0020" Size="3" Type="SMALLINT" TypeOptions=""/><Field Decimal="" ID="QTSHIJI" Name="予定取引数" Nullable="T" Order="0040" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTJISSEKI" Name="実績取引数" Nullable="T" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="AMJISSEKI" Name="実績取引額" Nullable="T" Order="0130" Remarks="実績取引数×取引単価" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="NRLOCATION" Name="ロケ№" Nullable="T" Order="0090" Size="5" Type="CHAR" TypeOptions=""/><Key Fields="NRSET;SQKOUSEI" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Field Decimal="" ID="NRCHILD" Name="構成品内部商品№" Nullable="F" Order="0030" Size="7" Type="CHAR" TypeOptions=""/><Refer Fields="TXSYOHIN;TXHINBAN;TXIMAGEFILENAME;KBZAIKOUM;FGLOTKANRI" Order="0010" OrderBy="" TableAlias="BT020CHILD" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="LT011.NRCHILD"/><Script EventP="BU;AR" EventR="AR()" Function="" Name="仮想フィールド等の設定" Order="0000" Text="////////////////#EOL#// 実績投入額 //#EOL#////////////////#EOL#LT011_AMJISSEKI.value = LT011_PRTORIHIKI.value * LT011_QTJISSEKI.value;#EOL##EOL#//////////////////////////////////#EOL#// セット指示書のロット№の設定 //#EOL#//////////////////////////////////#EOL#if (instance.functionID == 'LF012A' &amp;&amp; BT020CHILD_FGLOTKANRI.value == 'F') {#EOL#&#x9;LT011_TXLOTNUMBER.value = '記載不要';#EOL#}"/><Refer Fields="NRSOUKO;TMJISSEKI;NRTORIHIKIKANRI" Optional="F" Order="0020" OrderBy="" TableAlias="" ToKeyFields="NRSET" ToTable="LT010" WithKeyFields="LT011.NRSET"/><Script EventP="BU" EventR="AR()" Function="" Name="完了更新前設定(LF014A)" Order="0011" Text="////////////////////////////////////////////////////////#EOL#// セット指示完了エントリー(LF014A)による更新前の処理 //#EOL#////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'LF014A') {#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 入力不可設定 //#EOL#&#x9;//////////////////#EOL#&#x9;LT011_NRCHILD.editable = false;#EOL#&#x9;LT011_QTSHIJI.editable = false;#EOL#&#x9;LT011_AMJISSEKI.editable = false;#EOL#&#x9;if (BT020CHILD_FGLOTKANRI.value == 'T') {#EOL#&#x9;&#x9;LT011_TXLOTNUMBER.editable = true;#EOL#&#x9;} else {#EOL#&#x9;&#x9;LT011_TXLOTNUMBER.editable = false;#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////#EOL#&#x9;// 実績セット数のデフォルト値設定 //#EOL#&#x9;////////////////////////////////////#EOL#&#x9;if (LT011_QTJISSEKI.value == 0) {#EOL#&#x9;&#x9;LT011_QTJISSEKI.value = LT011_QTSHIJI.value;#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// ブランクチェック //#EOL#&#x9;//////////////////////#EOL#&#x9;if (LT011_TXLOTNUMBER.editable &amp;&amp; LT011_TXLOTNUMBER.value == '') {#EOL#&#x9;&#x9;LT011_TXLOTNUMBER.error = '材料のロット№を指定してください。'#EOL#&#x9;}#EOL#&#x9;if (LT011_QTJISSEKI.value == 0) {#EOL#&#x9;&#x9;LT011_QTJISSEKI.error = '投入数を指定してください。'#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// 取引金額の設定と集計 //#EOL#&#x9;//////////////////////////#EOL#&#x9;LT011_AMJISSEKI.value = LT011_PRTORIHIKI.value * LT011_QTJISSEKI.value;#EOL#&#x9;LT010_AMJISSEKI.value = Number(LT010_AMJISSEKI.value) + Number(LT011_AMJISSEKI.value);#EOL##EOL#}"/><Script EventP="AU" EventR="" Function="" Name="完了更新にともなう関連レコード処理(LF014A)" Order="0012" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rBT020; var dET200; var cET100; var rET010; var uET010;#EOL#var dtNend = 0; var dtMSeq = 0; var amUkebarai = 0; var qtUkebarai = 0;#EOL#var qtSyukko = 0; var amSyukko = 0; var qtSyukkoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var errorMessage = ''; var count = 0;#EOL##EOL#////////////////////////////////////////////////////////#EOL#// 完了エントリー(LF014A)によって更新された場合の処理 //#EOL#////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'LF014A' &amp;&amp; LT010_TMJISSEKI.value != '') {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(LT010_TMJISSEKI.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(LT010_TMJISSEKI.value);#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 構成品の商品マスター(BT020)の検索 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;rBT020 = instance.createTableOperator('Select', 'BT020');#EOL#&#x9;rBT020.setSelectFields('TXSYOHIN, KBZAIKOUM');#EOL#&#x9;rBT020.addKeyValue('NRSYOHIN',&#x9;LT011_NRCHILD.value);#EOL#&#x9;if (rBT020.next()) {#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// 受払予定の削除 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;LT011_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;dET200.execute();#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 各種取引額の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;amUkebarai = LT011_QTJISSEKI.value  * LT011_PRTORIHIKI.value * -1;#EOL#&#x9;&#x9;qtUkebarai = LT011_QTJISSEKI.value * -1;#EOL#&#x9;&#x9;amSyukko = LT011_QTJISSEKI.value * LT011_PRTORIHIKI.value;#EOL#&#x9;&#x9;qtSyukko = LT011_QTJISSEKI.value;#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'43'); //材料出庫//#EOL#&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;LT010_TMJISSEKI.value.substring(0,10));#EOL#&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;ET010CHILD_NRLOCATION.value);#EOL#&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;LT011_NRCHILD.value);#EOL#&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;LT011_TXLOTNUMBER.value);#EOL#&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;// 関連する倉庫在庫(ET010)の検索と更新 //#EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;LT011_NRCHILD.value);#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;LT011_NRCHILD.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER', &#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '材料出庫元の倉庫在庫(ET010)が存在しません。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '対応する商品マスタ(BT020)が存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}#EOL#"/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0100" Remarks="" Size="40" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0120" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field Decimal="" ID="PRTORIHIKI" Name="取引単価" Nullable="T" Order="0080" Remarks="指示追加時の在庫単価が自動設定される。ゼロの場合、指示の追加は取り消される。" Size="9" Type="INTEGER" TypeOptions=""/><Refer Fields="NRLOCATION" Optional="F" Order="0040" OrderBy="" TableAlias="ET010CHILD" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="LT011.NRCHILD;LT010.NRSOUKO"/></Table><Table ActiveWhere="" ID="LT010" Name="セット指示" RangeKey="" Remarks="セット商品の加工指示を管理するためのテーブル。指示レコードの追加にともなって、セット構成マスターの内容にもとづいて明細が自動展開される。セット商品を分解した場合には、「在庫振替」を用いて登録する。" SubsystemID="L"><Field Decimal="" ID="NRSET" Name="セット指示№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSET)"/><Field Decimal="" ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0030" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="DTYOTEI" Name="作業予定日" Nullable="F" Order="0040" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="セット品内部商品№" Nullable="F" Order="0070" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="QTSHIJI" Name="予定セット数" Nullable="F" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTJISSEKI" Name="実績セット数" Nullable="T" Order="0090" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="NRLOCATION" Name="ロケ№" Nullable="T" Order="0110" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0130" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0140" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field Decimal="" ID="STSET" Name="指示状況" Nullable="F" Order="0150" Size="2" Type="CHAR" TypeOptions="VIRTUAL,KUBUN(STSET)"/><Key Fields="NRSET" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM;FGLOTKANRI;TXIMAGEFILENAME" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="LT010.NRSYOHIN"/><Refer Fields="TXSOUKO;NRDEFAULTLOCATION" Order="0020" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="LT010.NRSOUKO"/><Refer Fields="" Order="0030" OrderBy="" TableAlias="" ToKeyFields="NRSOUKO;NRLOCATION" ToTable="BT031" WithKeyFields="LT010.NRSOUKO;LT010.NRLOCATION"/><Script EventP="AR" EventR="AR()" Function="" Name="仮想フィールド等の設定" Order="0010" Text="////////////////////#EOL#// 状況区分の設定 //#EOL#////////////////////#EOL#LT010_STSET.value = '10'; //未発行//#EOL#if (LT010_TMHAKKOU.value != '') {#EOL#&#x9;LT010_STSET.value = '20'; //作業中//#EOL#}#EOL#if (LT010_TMJISSEKI.value != '') {#EOL#&#x9;LT010_STSET.value = '30'; //完了済//#EOL#}#EOL##EOL#////////////////////////////////////////#EOL#// セット指示書のロット№とロケの設定 //#EOL#////////////////////////////////////////#EOL#if (instance.functionID == 'LF012A') {#EOL#&#x9;if (LT010_NRLOCATION.value == '') {#EOL#&#x9;&#x9;BT030_TXSOUKO.value = BT030_TXSOUKO.value + ' ロケ：_______';#EOL#&#x9;} else {#EOL#&#x9;&#x9;BT030_TXSOUKO.value = BT030_TXSOUKO.value + ' ロケ：' + LT010_NRLOCATION.value;#EOL#&#x9;}#EOL#&#x9;if (BT020_FGLOTKANRI.value == 'T') {#EOL#&#x9;&#x9;LT010_TXLOTNUMBER.value = '______________________';#EOL#&#x9;}#EOL#&#x9;if (BT020_FGLOTKANRI.value == 'F') {#EOL#&#x9;&#x9;LT010_TXLOTNUMBER.value = '記載不要';#EOL#&#x9;}#EOL#}#EOL#"/><Script EventP="BC" EventR="AR()" Function="" Name="追加レコード初期設定" Order="0020" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#LT010_STSET.editable = false;#EOL##EOL#//////////////////////////////////#EOL#// 完了予定日のデフォルト値設定 //#EOL#//////////////////////////////////#EOL#if (LT010_DTYOTEI.value == '') {#EOL#&#x9;LT010_DTYOTEI.value = session.getToday() + '';#EOL#}#EOL##EOL#//////////////////////////////////////#EOL#// セット構成が存在しなければエラー //#EOL#//////////////////////////////////////#EOL#var rBT021 = instance.createTableOperator('Select', 'BT021');#EOL#rBT021.addKeyValue('NRSYOHIN',&#x9;LT010_NRSYOHIN.value);#EOL#if (!rBT021.next()) {#EOL#&#x9;LT010_NRSYOHIN.error = 'セット構成をともなう商品を指定してください。';#EOL#}#EOL##EOL#////////////////////////////////#EOL#// 入庫ロケのデフォルト値設定 //#EOL#////////////////////////////////#EOL#LT010_NRLOCATION.value = ET010_NRLOCATION.value;"/><Script EventP="AC" EventR="" Function="" Name="追加時の関連レコード処理" Order="0030" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var cET200; var rBT021; var cLT011; var rET010;#EOL#var qtGenzaiko = 0; var amGenzaiko = 0; var prGenzaiko = 0; var qtShiji = 0; var sqKousei = 0;#EOL#var count = 0; var nrTorihikikanri = ''; var errorMessage = '';#EOL##EOL#///////////////////////////#EOL#// 受払予定(ET200)の追加 //#EOL#///////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'41');#EOL#&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;LT010_DTYOTEI.value);#EOL#&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;LT010_QTSHIJI.value);#EOL#&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;LT010_NRSET.value);#EOL#&#x9;count = cET200.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#/////////////////////////////////////#EOL#// 関連するセット構成(BT031)の検索 //#EOL#/////////////////////////////////////#EOL#rBT021 = instance.createTableOperator('Select', 'BT021');#EOL#rBT021.addKeyValue('NRSYOHIN',&#x9;LT010_NRSYOHIN.value);#EOL#rBT021.setOrderBy('SQLIST');#EOL#while (rBT021.next()) {#EOL##EOL#&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;rET010.addKeyValue('NRSOUKO',&#x9;LT010_NRSOUKO.value);#EOL#&#x9;if (rET010.next()) {#EOL##EOL#&#x9;&#x9;qtGenzaiko = Number(rET010.getValueOf('QTKISYUZAIKO')) + Number(rET010.getValueOf('QTNYUKO')) - Number(rET010.getValueOf('QTSYUKKO'));#EOL#&#x9;&#x9;amGenzaiko = Number(rET010.getValueOf('AMKISYUZAIKO')) + Number(rET010.getValueOf('AMNYUKO')) - Number(rET010.getValueOf('AMSYUKKO'));#EOL#&#x9;&#x9;if (qtGenzaiko > 0) {#EOL#&#x9;&#x9;&#x9;prGenzaiko = Math.round(amGenzaiko / qtGenzaiko);#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (prGenzaiko == 0) {#EOL#&#x9;&#x9;&#x9;errorMessage = '材料の出庫単価がゼロなので明細データを設定できません。処理はキャンセルされます。';#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;&#x9;// 指示構成明細(LT011)の追加 //#EOL#&#x9;&#x9;&#x9;///////////////////////////////#EOL#&#x9;&#x9;&#x9;sqKousei++;#EOL#&#x9;&#x9;&#x9;nrTorihikikanri = session.getNextNumber('NRTORIHIKIKANRI');#EOL#&#x9;&#x9;&#x9;qtShiji = Number(rBT021.getValueOf('RTKOUSEI')) * Number(LT010_QTSHIJI.value);#EOL#&#x9;&#x9;&#x9;cLT011 = instance.createTableOperator('Insert', 'LT011');#EOL#&#x9;&#x9;&#x9;cLT011.addValue('NRSET',&#x9;&#x9;&#x9;LT010_NRSET.value);#EOL#&#x9;&#x9;&#x9;cLT011.addValue('SQKOUSEI',&#x9;&#x9;&#x9;sqKousei);#EOL#&#x9;&#x9;&#x9;cLT011.addValue('NRCHILD',&#x9;&#x9;&#x9;rBT021.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;&#x9;cLT011.addValue('QTSHIJI',&#x9;&#x9;&#x9;qtShiji);#EOL#&#x9;&#x9;&#x9;cLT011.addValue('QTJISSEKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cLT011.addValue('PRTORIHIKI',&#x9;&#x9;prGenzaiko);#EOL#&#x9;&#x9;&#x9;cLT011.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cLT011.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#&#x9;&#x9;&#x9;count = cLT011.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = 'セット指示構成明細(LT011)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;// 受払予定(ET200)の追加 //#EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;nrTorihikikanri);#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'40');#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;LT010_DTYOTEI.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rBT021.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;qtShiji);#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;LT010_NRSET.value + '-' + sqKousei);#EOL#&#x9;&#x9;&#x9;&#x9;count = cET200.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '材料在庫が存在しないため、明細データを設定できません。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Field Decimal="" ID="AMJISSEKI" Name="実績取引額" Nullable="T" Order="0100" Remarks="構成商品の実際出庫額を積み上げた値。自動設定される。" Size="9" Type="INTEGER" TypeOptions=""/><Script EventP="BU" EventR="AR()" Function="" Name="完了更新前設定(LF014A)" Order="0040" Text="////////////////////////////////////////////////////////#EOL#// セット指示完了エントリー(LF014A)による更新前の処理 //#EOL#////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'LF014A') {#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 入力不可設定 //#EOL#&#x9;//////////////////#EOL#&#x9;LT010_DTYOTEI.editable = false;#EOL#&#x9;LT010_NRSYOHIN.editable = false;#EOL#&#x9;LT010_QTSHIJI.editable = false;#EOL#&#x9;LT010_AMJISSEKI.editable = false;#EOL#&#x9;if (BT020_FGLOTKANRI.value == 'T') {#EOL#&#x9;&#x9;LT010_TXLOTNUMBER.editable = true;#EOL#&#x9;} else {#EOL#&#x9;&#x9;LT010_TXLOTNUMBER.editable = false;#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// 実際完了日時のセット //#EOL#&#x9;//////////////////////////#EOL#&#x9;if (LT010_TMJISSEKIWORK.value == '') {#EOL#&#x9;&#x9;LT010_TMJISSEKIWORK.value = session.getTimeStamp();#EOL#&#x9;}#EOL#&#x9;if (LT010_TMJISSEKI.value == '') {#EOL#&#x9;&#x9;LT010_TMJISSEKI.value = LT010_TMJISSEKIWORK.value;#EOL#&#x9;}#EOL#&#x9;if (!LT010_TMJISSEKI.value.equals(LT010_TMJISSEKIWORK.value)) {#EOL#&#x9;&#x9;instance.cancelWithMessage('この指示は既に完了報告済みです。いったん完了取消してから、再度完了入力してください。。');#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////#EOL#&#x9;// 実績セット数のデフォルト値設定 //#EOL#&#x9;////////////////////////////////////#EOL#&#x9;if (LT010_QTJISSEKI.value == 0) {#EOL#&#x9;&#x9;LT010_QTJISSEKI.value = LT010_QTSHIJI.value;#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 実績取引額の初期化 //#EOL#&#x9;////////////////////////#EOL#&#x9;LT010_AMJISSEKI.value = 0;#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// ブランクチェック //#EOL#&#x9;//////////////////////#EOL#&#x9;if (LT010_NRLOCATION.value == '') {#EOL#&#x9;&#x9;LT010_NRLOCATION.error = '入庫先ロケを選択してください。'#EOL#&#x9;}#EOL#&#x9;if (LT010_TXLOTNUMBER.editable &amp;&amp; LT010_TXLOTNUMBER.value == '') {#EOL#&#x9;&#x9;LT010_TXLOTNUMBER.error = 'セット商品のロット№を指定してください。'#EOL#&#x9;}#EOL#}"/><Script EventP="BU" EventR="AR()" Function="" Name="完了取消前設定(LF014B)" Order="0060" Text="//////////////////////////////////////////////////#EOL#// セット指示完了取消(LF014B)による更新前の処理 //#EOL#//////////////////////////////////////////////////#EOL#if (instance.functionID == 'LF014B') {#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 入力不可設定 //#EOL#&#x9;//////////////////#EOL#&#x9;LT010_DTYOTEI.editable = false;#EOL#&#x9;LT010_TMJISSEKIWORK.editable = false;#EOL#&#x9;LT010_NRSYOHIN.editable = false;#EOL#&#x9;LT010_QTSHIJI.editable = false;#EOL#&#x9;LT010_QTJISSEKI.editable = false;#EOL#&#x9;LT010_AMJISSEKI.editable = false;#EOL#&#x9;LT010_NRLOCATION.editable = false;#EOL#&#x9;LT010_TXLOTNUMBER.editable = false;#EOL##EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;// 表示用完了日時の設定と完了日時のクリア //#EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;if (LT010_TMJISSEKIWORK.value == '') {#EOL#&#x9;&#x9;LT010_TMJISSEKIWORK.value = LT010_TMJISSEKI.value;#EOL#&#x9;&#x9;if (LT010_TMJISSEKIWORK.value == '') {#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage('この指示はまだ作業中です。完了取消できません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;LT010_TMJISSEKI.value = '';#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="完了更新にともなう関連レコード処理(LF014A)" Order="0070" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rBT020; var dET200; var cET100; var rET010; var uET010; var cET010;#EOL#var dtNend = 0; var dtMSeq = 0; var qtNyukoUpdated = 0; var amNyukoUpdated = 0;#EOL#var errorMessage = ''; var count = 0;#EOL##EOL#////////////////////////////////////////////////////////#EOL#// 完了エントリー(LF014A)によって更新された場合の処理 //#EOL#////////////////////////////////////////////////////////#EOL#if (instance.functionID == 'LF014A' &amp;&amp; LT010_TMJISSEKI.value != '') {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(LT010_TMJISSEKI.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(LT010_TMJISSEKI.value);#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// セット商品の商品マスター(BT020)の検索 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;rBT020 = instance.createTableOperator('Select', 'BT020');#EOL#&#x9;rBT020.setSelectFields('TXSYOHIN, KBZAIKOUM, QTANZENZAIKO, QTJYOUGENZAIKO');#EOL#&#x9;rBT020.addKeyValue('NRSYOHIN',&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;if (rBT020.next()) {#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// 受払予定の削除 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;dET200.execute();#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 受払実績(ET100)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'53'); //完成入庫//#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;LT010_TMJISSEKI.value.substring(0,10));#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;LT010_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;LT010_TXLOTNUMBER.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;LT010_QTJISSEKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;LT010_AMJISSEKI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;// 関連する倉庫在庫(ET010)の検索と更新 //#EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(LT010_QTJISSEKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(LT010_AMJISSEKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('NRLOCATION',&#x9;LT010_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER', &#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;LT010_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;LT010_AMJISSEKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;LT010_QTJISSEKI.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '対応する商品マスタ(BT020)が存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="完了前削除時の関連レコード処理" Order="0100" Text="///////////////////////////////////#EOL#// セット品完成予定(ET200)の削除 //#EOL#///////////////////////////////////#EOL#var dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#dET200.execute();#EOL##EOL#/////////////////////////////////////////#EOL#// 関連する構成品投入予定(ET200)の削除 //#EOL#/////////////////////////////////////////#EOL#rLT011 = instance.createTableOperator('Select', 'LT011');#EOL#rLT011.addKeyValue('NRSET',&#x9;LT010_NRSET.value);#EOL#while (rLT011.next()) {#EOL#&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;rLT011.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;dET200.execute();#EOL#}#EOL##EOL#///////////////////////////////////#EOL#// 関連する構成明細(LT011)の削除 //#EOL#///////////////////////////////////#EOL#var dLT011 = instance.createTableOperator('Delete', 'LT011');#EOL#dLT011.addKeyValue('NRSET',&#x9;LT010_NRSET.value);#EOL#dLT011.execute();#EOL#"/><Script EventP="AU" EventR="" Function="" Name="完了取消にともなう関連レコード処理(LF014B)" Order="0080" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rBT020; var cET200; var cET100; var uET100; var rET010; var uET010; var cET010;#EOL#var dtNend = 0; var dtMSeq = 0; var amUkebarai = 0; var qtUkebarai = 0;#EOL#var qtSyukkoUpdated = 0; var amSyukkoUpdated = 0; var errorMessage = ''; var count = 0;#EOL##EOL#//////////////////////////////////////////////////#EOL#// 完了取消(LF014B)によって更新された場合の処理 //#EOL#//////////////////////////////////////////////////#EOL#if (instance.functionID == 'LF014B' &amp;&amp; LT010_TMJISSEKI.value == '') {#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 年度・月度の設定 //#EOL#&#x9;//////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(LT010_TMJISSEKI.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(LT010_TMJISSEKI.value);#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// セット商品の商品マスター(BT020)の検索 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;rBT020 = instance.createTableOperator('Select', 'BT020');#EOL#&#x9;rBT020.setSelectFields('TXSYOHIN, KBZAIKOUM, QTANZENZAIKO, QTJYOUGENZAIKO');#EOL#&#x9;rBT020.addKeyValue('NRSYOHIN',&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;if (rBT020.next()) {#EOL##EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;// 受払予定(ET200)の追加 //#EOL#&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'41');#EOL#&#x9;&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;LT010_DTYOTEI.value);#EOL#&#x9;&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;LT010_QTSHIJI.value);#EOL#&#x9;&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;LT010_NRSET.value);#EOL#&#x9;&#x9;count = cET200.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;&#x9;&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;// 各種取引額の設定 //#EOL#&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;amUkebarai = LT010_AMJISSEKI.value * -1;#EOL#&#x9;&#x9;qtUkebarai = LT010_QTJISSEKI.value * -1;#EOL##EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'53'); //完成入庫//#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;session.getToday() + '');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;LT010_NRLOCATION.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;LT010_TXLOTNUMBER.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;// 関連する倉庫在庫(ET010)の検索と更新 //#EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;LT010_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER', &#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = 'セット商品出庫元の倉庫在庫(ET010)が存在しません。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;#EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '対応する商品マスタ(BT020)が存在しません。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////#EOL#&#x9;// 関連する構成明細(LT011)の処理 //#EOL#&#x9;///////////////////////////////////#EOL#&#x9;rLT011 = instance.createTableOperator('Select', 'LT011');#EOL#&#x9;rLT011.addKeyValue('NRSET',&#x9;LT010_NRSET.value);#EOL#&#x9;while (rLT011.next()) {#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////////#EOL#&#x9;&#x9;// セット構成品の商品マスター(BT020)の検索 //#EOL#&#x9;&#x9;/////////////////////////////////////////////#EOL#&#x9;&#x9;rBT020 = instance.createTableOperator('Select', 'BT020');#EOL#&#x9;&#x9;rBT020.setSelectFields('TXSYOHIN, KBZAIKOUM, QTANZENZAIKO, QTJYOUGENZAIKO');#EOL#&#x9;&#x9;rBT020.addKeyValue('NRSYOHIN',&#x9;rLT011.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;if (rBT020.next()) {#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;// 受払予定(ET200)の追加 //#EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '' &amp;&amp; rLT011.getValueOf('QTSHIJI') > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;cET200 = instance.createTableOperator('Insert', 'ET200');#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRTORIHIKIKANRI',&#x9;rLT011.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('KBYOTEI',&#x9;&#x9;&#x9;'40');#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('DTYOTEI',&#x9;&#x9;&#x9;LT010_DTYOTEI.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rLT011.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('QTYOTEI',&#x9;&#x9;&#x9;rLT011.getValueOf('QTSHIJI'));#EOL#&#x9;&#x9;&#x9;&#x9;cET200.addValue('NRSANSYOU',&#x9;&#x9;LT010_NRSET.value + '-' + rLT011.getValueOf('SQKOUSEI'));#EOL#&#x9;&#x9;&#x9;&#x9;count = cET200.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '受払予定(ET200)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;// 各種取引額の設定 //#EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;amUkebarai = rLT011.getValueOf('QTJISSEKI') * rLT011.getValueOf('PRTORIHIKI');#EOL#&#x9;&#x9;&#x9;qtUkebarai = rLT011.getValueOf('QTJISSEKI');#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 受払実績(ET100)の追加（赤伝）//#EOL#&#x9;&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;'43'); //材料出庫//#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;session.getToday() + '');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;rLT011.getValueOf('NRLOCATION'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rLT011.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;rLT011.getValueOf('TXLOTNUMBER'));#EOL#&#x9;&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;LT010_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 関連する倉庫在庫(ET010)の検索と更新 //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;rLT011.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) - Number(qtUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) - Number(amUkebarai);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;rLT011.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER', &#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoUpdated = qtUkebarai * -1;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoUpdated = amUkebarai * -1;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rLT011.getValueOf('NRCHILD'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;LT010_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;errorMessage = '対応する商品マスタ(BT020)が存在しません。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////#EOL#&#x9;&#x9;// エラーならBREAK //#EOL#&#x9;&#x9;/////////////////////#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Field Decimal="" ID="TMHAKKOU" Name="発行日時" Nullable="T" Order="0050" Size="23" Type="DATETIME" TypeOptions=""/><Field Decimal="" ID="TMJISSEKI" Name="実際完了日時" Nullable="T" Order="0060" Size="23" Type="DATETIME" TypeOptions=""/><Field ID="TMJISSEKIWORK" Name="実績完了日時ワーク" Nullable="T" Order="0160" Remarks="LF014Bでクリアされる完了日時をパネル表示するためのワークフィールド" Size="23" Type="DATETIME" TypeOptions="VIRTUAL"/><Script EventP="BD" EventR="BR()" Function="" Name="削除妥当性検査" Order="0090" Text="if (LT010_TMJISSEKI.value != '') {#EOL#&#x9;LT010_NRSET.error = '完了済なので削除できません。'#EOL#}"/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0120" Remarks="ロット管理品の場合に設定される。" Size="40" Type="CHAR" TypeOptions=""/><Refer Fields="NRLOCATION" Optional="T" Order="0040" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN;NRSOUKO" ToTable="ET010" WithKeyFields="LT010.NRSYOHIN;LT010.NRSOUKO"/></Table><Table ActiveWhere="" ID="ET200" Name="受払予定" RangeKey="" Remarks="今後の入出荷予定情報を保持するためのテーブル。発注にもとづく入荷予定、受注にもとづく出荷予定等の追加・変更にともなって自動維持される。" SubsystemID="E"><Field ID="KBYOTEI" Name="受払予定区分" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBYOTEI)"/><Field ID="DTYOTEI" Name="受払予定日" Nullable="F" Order="0030" Size="10" Type="DATE" TypeOptions=""/><Field ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field ID="NRIDOUSOUKO" Name="移動倉庫№" Nullable="T" Order="0050" Size="5" Type="CHAR" TypeOptions=""/><Field ID="NRTORIHIKISAKI" Name="取引先№" Nullable="T" Order="0060" Size="8" Type="CHAR" TypeOptions=""/><Field ID="NRSYOHIN" Name="内部商品№" Nullable="F" Order="0070" Size="7" Type="CHAR" TypeOptions=""/><Field ID="QTYOTEI" Name="受払予定数" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="TXAITESAKI" Name="相手先名" Nullable="T" Order="0100" Remarks="結合フィールド「取引先名」か「倉庫名」のうち、ブランクでないほうがセットされる" Size="40" Type="CHAR" TypeOptions="VIRTUAL,KANJI"/><Field ID="NRSANSYOU" Name="参照№" Nullable="F" Order="0090" Remarks="取引の元ネタとなるトランザクションデータの主キー値がセットされる。複合主キーの場合は&quot;-&quot;(ダッシュ)でフォーマットされる。" Size="15" Type="CHAR" TypeOptions="AUTO_NUMBER()"/><Field ID="TXTANTOU" Name="担当者名" Nullable="T" Order="0101" Remarks="" Size="20" Type="CHAR" TypeOptions="VIRTUAL,KANJI"/><Field ID="QTZAIKOSUII" Name="在庫推移数" Nullable="T" Order="0091" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0011" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Key Fields="NRTORIHIKIKANRI" Type="PK"/><Key Fields="NRSYOHIN;NRSOUKO" Type="XK"/><Refer Fields="TXSOUKO" Order="0010" OrderBy="" TableAlias="BT030A" ToKeyFields="" ToTable="BT030" WithKeyFields="ET200.NRSOUKO"/><Refer Fields="TXHINBAN;TXSYOHIN;KBZAIKOUM" Order="0030" TableAlias="" ToKeyFields="" ToTable="BT020" WithKeyFields="ET200.NRSYOHIN"/><Refer Fields="TXKANJI" Order="0040" TableAlias="" ToKeyFields="" ToTable="AT030" WithKeyFields="ET200.NRTORIHIKISAKI"/><Refer Fields="TXSOUKO" Order="0020" TableAlias="BT030B" ToKeyFields="" ToTable="BT030" WithKeyFields="ET200.NRIDOUSOUKO"/><Refer Fields="NRTANTOUJYUGYOIN" Order="0050" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="CT010" WithKeyFields="ET200.NRTORIHIKISAKI"/><Refer Fields="NRTANTOUJYUGYOIN" Order="0070" TableAlias="" ToKeyFields="NRTORIHIKISAKI" ToTable="DT010" WithKeyFields="ET200.NRTORIHIKISAKI"/><Refer Fields="TXKANJI" Order="0060" TableAlias="CT010AT020" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="CT010.NRTANTOUJYUGYOIN"/><Refer Fields="TXKANJI" Order="0080" TableAlias="DT010AT020" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="DT010.NRTANTOUJYUGYOIN"/><Script EventP="AR" EventR="AR()" Function="" Name="推移在庫への予定数量の加算(EF011)" Order="0" Text="if (instance.functionID == 'EF011') {#EOL#&#x9;////////////////////////#EOL#&#x9;// 入庫予定ならば加算 //#EOL#&#x9;////////////////////////#EOL#&#x9;if (ET200_KBYOTEI.value == '10' || ET200_KBYOTEI.value == '31') {#EOL#&#x9;&#x9;ET010_QTSUMMARY.value = Number(ET010_QTSUMMARY.value) + Number(ET200_QTYOTEI.value);#EOL#&#x9;}#EOL#&#x9;////////////////////////#EOL#&#x9;// 出庫予定ならば減算 //#EOL#&#x9;////////////////////////#EOL#&#x9;if (ET200_KBYOTEI.value == '20' || ET200_KBYOTEI.value == '30') {#EOL#&#x9;&#x9;ET010_QTSUMMARY.value = Number(ET010_QTSUMMARY.value) - Number(ET200_QTYOTEI.value);#EOL#&#x9;}#EOL#&#x9;ET200_QTZAIKOSUII.value = ET010_QTSUMMARY.value;#EOL#}"/><Script EventP="AR" EventR="AR()" Name="仮想フィールドの設定" Order="1" Text="//////////////#EOL#// 相手先名 //#EOL#//////////////#EOL#if (AT030_TXKANJI.value != '') {#EOL#&#x9;ET200_TXAITESAKI.value = AT030_TXKANJI.value;#EOL#} else {#EOL#&#x9;if (BT030B_TXSOUKO.value != '') {#EOL#&#x9;&#x9;ET200_TXAITESAKI.value = BT030B_TXSOUKO.value;#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////#EOL#// 担当者名 //#EOL#//////////////#EOL#if (CT010AT020_TXKANJI.value != '') {#EOL#&#x9;ET200_TXTANTOU.value = CT010AT020_TXKANJI.value;#EOL#} else {#EOL#&#x9;if (DT010AT020_TXKANJI.value != '') {#EOL#&#x9;&#x9;ET200_TXTANTOU.value = DT010AT020_TXKANJI.value;#EOL#&#x9;} else {#EOL#&#x9;&#x9;ET200_TXTANTOU.value = '（在庫管理者）';#EOL#&#x9;}#EOL#}"/></Table><Table ActiveWhere="" ID="KT011" Name="棚卸指示明細" RangeKey="" Remarks="商品･ロット･ロケ別の実棚情報を保持するためのテーブル。１件の棚卸指示レコードに、複数の棚卸指示明細レコードが対応する。" SubsystemID="K"><Field Decimal="" ID="NRTANAOROSHI" Name="棚卸№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="商品№" Nullable="F" Order="0020" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRLOCATION" Name="ロケ№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="QTTYOUBO" Name="帳簿在庫数量" Nullable="T" Order="0060" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTJITSUTANA" Name="実棚数量" Nullable="T" Order="0070" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="TXDUMMY" Name="実棚数量記入用ダミー" Nullable="T" Order="0090" Remarks="" Size="5" Type="CHAR" TypeOptions="VIRTUAL"/><Field Decimal="" ID="PRUKEBARAI" Name="受払単価" Nullable="F" Order="0050" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTSASUU" Name="実棚差数" Nullable="T" Order="0091" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Field Decimal="" ID="AMSAGAKU" Name="実棚差額" Nullable="T" Order="0092" Size="9" Type="INTEGER" TypeOptions="VIRTUAL"/><Key Fields="NRTANAOROSHI;NRSYOHIN" Type="PK"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="KT011.NRSYOHIN"/><Refer Fields="NRSOUKO;DTKOUSHIN" Order="0030" TableAlias="" ToKeyFields="NRTANAOROSHI" ToTable="KT010" WithKeyFields="KT011.NRTANAOROSHI"/><Refer Fields="" Order="0050" TableAlias="" ToKeyFields="NRSOUKO;NRLOCATION" ToTable="BT031" WithKeyFields="KT010.NRSOUKO;KT011.NRLOCATION"/><Refer Fields="TXSOUKO" Order="0040" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="KT010.NRSOUKO"/><Script EventP="AR" EventR="BR()" Function="" Name="仮想フィールド設定" Order="0010" Text="KT011_QTSASUU.value = KT011_QTJITSUTANA.value - KT011_QTTYOUBO.value;#EOL#KT011_AMSAGAKU.value = KT011_QTSASUU.value * KT011_PRUKEBARAI.value;"/><Script EventP="BC;BU" EventR="AR()" Function="" Name="更新前設定" Order="0011" Text="KT011_NRTANAOROSHI.editable = false;#EOL#KT011_QTTYOUBO.editable = false;#EOL#KT011_QTSASUU.editable = false;#EOL#KT011_AMSAGAKU.editable = false;#EOL##EOL#if (instance.functionID == 'KF015') {#EOL#&#x9;if (KT010_DTKOUSHIN.value != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage('確定済の棚卸指示に対する明細入力はできません。');#EOL#&#x9;}#EOL#&#x9;if (KT011_QTJITSUTANA.value > 0 &amp;&amp; KT011_PRUKEBARAI.value == 0) {#EOL#&#x9;&#x9;KT011_PRUKEBARAI.error = '在庫単価を入力してください。';#EOL#&#x9;}#EOL#}"/></Table><Table ActiveWhere="" ID="KT030" Name="在庫振替" RangeKey="" Remarks="在庫に関連する勘定科目との振替指示情報を保持するためのテーブル" SubsystemID="K"><Field Decimal="" ID="NRZAIKOHURIKAE" Name="在庫振替№" Nullable="F" Order="0010" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRZAIKOHURIKAE)"/><Field Decimal="" ID="DTHURIKAE" Name="振替日" Nullable="F" Order="0030" Size="10" Type="DATE" TypeOptions=""/><Field Decimal="" ID="NRSOUKO" Name="倉庫№" Nullable="F" Order="0040" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRLOCATION" Name="ロケ№" Nullable="T" Order="0050" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="NRSYOHIN" Name="商品№" Nullable="F" Order="0060" Size="7" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="AMHURIKAE" Name="振替金額" Nullable="T" Order="0090" Size="9" Type="INTEGER" TypeOptions=""/><Field Decimal="" ID="QTHURIKAE" Name="振替数量" Nullable="T" Order="0080" Size="9" Type="INTEGER" TypeOptions=""/><Field ID="KBZAIKOHURIKAE" Name="振替区分" Nullable="F" Order="0020" Remarks="" Size="2" Type="CHAR" TypeOptions="KUBUN(KBZAIKOHURIKAE)"/><Field Decimal="" ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0091" Size="300" Type="VARCHAR" TypeOptions="KANJI"/><Field Decimal="" ID="NRTORIHIKIKANRI" Name="取引管理№" Nullable="F" Order="0092" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRTORIHIKIKANRI)"/><Field ID="TXLOTNUMBER" Name="ロット№" Nullable="T" Order="0071" Remarks="" Size="40" Type="CHAR" TypeOptions=""/><Key Fields="NRZAIKOHURIKAE" Type="PK"/><Key Fields="NRTORIHIKIKANRI" Type="SK"/><Refer Fields="TXSOUKO" Order="0010" OrderBy="" TableAlias="" ToKeyFields="NRSOUKO" ToTable="BT030" WithKeyFields="KT030.NRSOUKO"/><Refer Fields="" Order="0020" TableAlias="" ToKeyFields="NRSOUKO;NRLOCATION" ToTable="BT031" WithKeyFields="KT030.NRSOUKO;KT030.NRLOCATION"/><Refer Fields="TXSYOHIN;TXHINBAN;KBZAIKOUM;QTANZENZAIKO;QTJYOUGENZAIKO" Order="0030" TableAlias="" ToKeyFields="NRSYOHIN" ToTable="BT020" WithKeyFields="KT030.NRSYOHIN"/><Script EventP="BC" EventR="AR()" Function="" Name="追加前設定" Order="0000" Text="//////////////////////////////////////#EOL#// 振替日の初期化・会計期間チェック //#EOL#//////////////////////////////////////#EOL#if (KT030_DTHURIKAE.value == '') {#EOL#&#x9;KT030_DTHURIKAE.value = session.getToday() + '';#EOL#}#EOL#KT030_DTHURIKAE.error = session.getErrorOfAccountDate(KT030_DTHURIKAE.value);#EOL##EOL#//////////////////////////////////////////////////////////////#EOL#// 在庫明細処理キーがブランクでなければ諸項目をチェックする //#EOL#//////////////////////////////////////////////////////////////#EOL#if (KT030_NRSYOHIN.value != '' &amp;&amp; KT030_NRSOUKO.value != '') {#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 数量・金額チェック //#EOL#&#x9;////////////////////////#EOL#&#x9;if (KT030_QTHURIKAE.value == 0 &amp;&amp; KT030_AMHURIKAE.value == 0) {#EOL#&#x9;&#x9;KT030_QTHURIKAE.error = '数量か金額のいずれかを入力してください';#EOL#&#x9;&#x9;KT030_AMHURIKAE.error = '金額か数量のいずれかを入力してください';#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////////////////////////////////////#EOL#&#x9;// 「雑益(50)」か「完成入庫(53)」以外では倉庫在庫が存在しなければエラー　//#EOL#&#x9;///////////////////////////////////////////////////////////////////////////////#EOL#&#x9;if (KT030_KBZAIKOHURIKAE.value != '50' &amp;&amp; KT030_KBZAIKOHURIKAE.value != '53') {#EOL#&#x9;&#x9;var rET010 = instance.createTableOperator('Count', 'ET010');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;if (rET010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;KT030_NRSOUKO.error = '対応する在庫データが存在しません。';#EOL#&#x9;&#x9;&#x9;KT030_NRSYOHIN.error = '対応する在庫データが存在しません。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}"/><Script EventP="BU;BD" EventR="AR()" Function="" Name="更新・削除前設定" Order="0001" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#KT030_KBZAIKOHURIKAE.editable = false;#EOL#KT030_NRSOUKO.editable = false;#EOL#KT030_NRLOCATION.editable = false;#EOL#KT030_NRSYOHIN.editable = false;#EOL##EOL#//////////////////////#EOL#// 会計期間チェック //#EOL#//////////////////////#EOL#if (instance.functionID == 'KF031') {#EOL#&#x9;KT030_DTHURIKAE.error = session.getErrorOfAccountDate(KT030_DTHURIKAE.value);#EOL#}#EOL##EOL#////////////////////////#EOL#// 数量・金額チェック //#EOL#////////////////////////#EOL#if (KT030_QTHURIKAE.value == 0 &amp;&amp; KT030_AMHURIKAE.value == 0) {#EOL#&#x9;KT030_QTHURIKAE.error = '数量か金額のいずれかを入力してください';#EOL#&#x9;KT030_AMHURIKAE.error = '金額か数量のいずれかを入力してください';#EOL#}"/><Script EventP="AC" EventR="" Function="" Name="追加時の関連レコード処理" Order="0001" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var cET100; var rET010; var uET010; var cET010;#EOL#var dtNend = 0; var dtMSeq = 0; var ukebaraiKubun = ''; var errorMessage = '';#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL##EOL#////////////////////////////////#EOL#// 年度・月度・受払区分の設定 //#EOL#////////////////////////////////#EOL#dtNend = session.getFYearOfDate(KT030_DTHURIKAE.value);#EOL#dtMSeq = session.getMSeqOfDate(KT030_DTHURIKAE.value);#EOL#ukebaraiKubun = KT030_KBZAIKOHURIKAE.value;#EOL##EOL#////////////////////////////#EOL#// 受払区分別取引高の設定 //#EOL#////////////////////////////#EOL#if (ukebaraiKubun == '40' || ukebaraiKubun == '41' ||#EOL#&#x9;ukebaraiKubun == '42' || ukebaraiKubun == '43') {#EOL#&#x9;amUkebarai = KT030_AMHURIKAE.value * -1;#EOL#&#x9;amNyuko = 0;#EOL#&#x9;amSyukko = KT030_AMHURIKAE.value;#EOL#&#x9;qtUkebarai = KT030_QTHURIKAE.value * -1;#EOL#&#x9;qtNyuko = 0;#EOL#&#x9;qtSyukko = KT030_QTHURIKAE.value;#EOL#}#EOL#if (ukebaraiKubun == '50' || ukebaraiKubun == '51' ||#EOL#&#x9;ukebaraiKubun == '52' || ukebaraiKubun == '53') {#EOL#&#x9;amUkebarai = KT030_AMHURIKAE.value;#EOL#&#x9;amNyuko = KT030_AMHURIKAE.value;#EOL#&#x9;amSyukko = 0;#EOL#&#x9;qtUkebarai = KT030_QTHURIKAE.value;#EOL#&#x9;qtNyuko = KT030_QTHURIKAE.value;#EOL#&#x9;qtSyukko = 0;#EOL#}#EOL##EOL#///////////////////////////#EOL#// 受払実績(ET100)の追加 //#EOL#///////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;KT030_DTHURIKAE.value);#EOL#&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;KT030_NRLOCATION.value);#EOL#&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT030_TXLOTNUMBER.value);#EOL#&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT030_NRTORIHIKIKANRI.value);#EOL#&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;count = cET100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#///////////////////////////////////////////#EOL#// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#///////////////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT030_NRSOUKO.value);#EOL#&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko);#EOL#&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko);#EOL#&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko);#EOL#&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko);#EOL#&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko);#EOL#&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko);#EOL#&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/><Script EventP="AU" EventR="" Function="" Name="更新時の関連レコード処理" Order="0001" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;#EOL#var dtNend = 0; var dtMSeq = 0; var dtNendOld = 0; var dtMSeqOld = 0;#EOL#var ukebaraiKubun = ''; var errorMessage = '';#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var amUkebaraiOld = 0; var amNyukoOld = 0; var amSyukkoOld = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0;#EOL#var qtUkebaraiOld = 0; var qtNyukoOld = 0; var qtSyukkoOld = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL##EOL#//////////////////////#EOL#// 値の変更チェック //#EOL#//////////////////////#EOL#if (KT030_DTHURIKAE.valueChanged || KT030_QTHURIKAE.valueChanged || KT030_AMHURIKAE.valueChanged) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 年度・月度・受払区分の設定 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;dtNend = session.getFYearOfDate(KT030_DTHURIKAE.value);#EOL#&#x9;dtMSeq = session.getMSeqOfDate(KT030_DTHURIKAE.value);#EOL#&#x9;dtNendOld = session.getFYearOfDate(KT030_DTHURIKAE.oldValue);#EOL#&#x9;dtMSeqOld = session.getMSeqOfDate(KT030_DTHURIKAE.oldValue);#EOL#&#x9;ukebaraiKubun = KT030_KBZAIKOHURIKAE.value;#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 受払区分別取引高の設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;if (ukebaraiKubun == '40' || ukebaraiKubun == '41' ||#EOL#&#x9;&#x9;ukebaraiKubun == '42' || ukebaraiKubun == '43') {#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amUkebaraiOld = KT030_AMHURIKAE.oldValue;#EOL#&#x9;&#x9;amNyukoOld = 0;#EOL#&#x9;&#x9;amSyukkoOld = KT030_AMHURIKAE.oldValue;#EOL#&#x9;&#x9;qtUkebaraiOld = KT030_QTHURIKAE.oldValue;#EOL#&#x9;&#x9;qtNyukoOld = 0;#EOL#&#x9;&#x9;qtSyukkoOld = KT030_QTHURIKAE.oldValue;#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amUkebarai = KT030_AMHURIKAE.value * -1;#EOL#&#x9;&#x9;amNyuko = 0;#EOL#&#x9;&#x9;amSyukko = KT030_AMHURIKAE.value;#EOL#&#x9;&#x9;qtUkebarai = KT030_QTHURIKAE.value * -1;#EOL#&#x9;&#x9;qtNyuko = 0;#EOL#&#x9;&#x9;qtSyukko = KT030_QTHURIKAE.value;#EOL##EOL#&#x9;}#EOL#&#x9;if (ukebaraiKubun == '50' || ukebaraiKubun == '51' ||#EOL#&#x9;&#x9;ukebaraiKubun == '52' || ukebaraiKubun == '53') {#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amUkebaraiOld = KT030_AMHURIKAE.oldValue * -1;#EOL#&#x9;&#x9;amNyukoOld = KT030_AMHURIKAE.oldValue;#EOL#&#x9;&#x9;amSyukkoOld = 0;#EOL#&#x9;&#x9;qtUkebaraiOld = KT030_QTHURIKAE.oldValue * -1;#EOL#&#x9;&#x9;qtNyukoOld = KT030_QTHURIKAE.oldValue;#EOL#&#x9;&#x9;qtSyukkoOld = 0;#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amUkebarai = KT030_AMHURIKAE.value;#EOL#&#x9;&#x9;amNyuko = KT030_AMHURIKAE.value;#EOL#&#x9;&#x9;amSyukko = 0;#EOL#&#x9;&#x9;qtUkebarai = KT030_QTHURIKAE.value;#EOL#&#x9;&#x9;qtNyuko = KT030_QTHURIKAE.value;#EOL#&#x9;&#x9;qtSyukko = 0;#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 関連する受払実績(ET100)の失効処理 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#&#x9;rET100.addKeyValue('NRTORIHIKIKANRI', KT030_NRTORIHIKIKANRI.value);#EOL#&#x9;while (rET100.next()) {#EOL#&#x9;&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;&#x9;uET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;uET100.addValue('UPDCOUNTER',&#x9;&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加（赤伝） //#EOL#&#x9;///////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;KT030_DTHURIKAE.oldValue);#EOL#&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;KT030_NRLOCATION.value);#EOL#&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT030_TXLOTNUMBER.oldValue);#EOL#&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebaraiOld);#EOL#&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebaraiOld);#EOL#&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT030_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNendOld);#EOL#&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeqOld);#EOL#&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////#EOL#&#x9;// 受払実績(ET100)の追加（黒伝） //#EOL#&#x9;///////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'1');#EOL#&#x9;&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;KT030_DTHURIKAE.value);#EOL#&#x9;&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;KT030_NRLOCATION.value);#EOL#&#x9;&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT030_TXLOTNUMBER.value);#EOL#&#x9;&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT030_NRTORIHIKIKANRI.value);#EOL#&#x9;&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;&#x9;count = cET100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko) - Number(qtNyukoOld);#EOL#&#x9;&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko) - Number(amNyukoOld);#EOL#&#x9;&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko) - Number(qtSyukkoOld);#EOL#&#x9;&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko) - Number(amSyukkoOld);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko - amNyukoOld);#EOL#&#x9;&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko - amSyukkoOld);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko - qtNyukoOld);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko - qtSyukkoOld);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}"/><Script EventP="AD" EventR="" Function="" Name="削除時の関連レコード処理" Order="0001" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET100; var uET100; var cET100; var rET010; var uET010; var cET010;#EOL#var dtNend = 0; var dtMSeq = 0; var ukebaraiKubun = ''; var errorMessage = '';#EOL#var amUkebarai = 0; var amNyuko = 0; var amSyukko = 0;#EOL#var qtUkebarai = 0; var qtNyuko = 0; var qtSyukko = 0;#EOL#var amNyukoUpdated = 0; var amSyukkoUpdated = 0;#EOL#var qtNyukoUpdated = 0; var qtSyukkoUpdated = 0;#EOL##EOL#////////////////////////////////#EOL#// 年度・月度・受払区分の設定 //#EOL#////////////////////////////////#EOL#dtNend = session.getFYearOfDate(KT030_DTHURIKAE.oldValue);#EOL#dtMSeq = session.getMSeqOfDate(KT030_DTHURIKAE.oldValue);#EOL#ukebaraiKubun = KT030_KBZAIKOHURIKAE.value;#EOL##EOL#////////////////////////////#EOL#// 受払区分別取引高の設定 //#EOL#////////////////////////////#EOL#if (ukebaraiKubun == '40' || ukebaraiKubun == '41' ||#EOL#&#x9;ukebaraiKubun == '42' || ukebaraiKubun == '43') {#EOL#&#x9;amUkebarai = KT030_AMHURIKAE.oldValue;#EOL#&#x9;amNyuko = 0;#EOL#&#x9;amSyukko = KT030_AMHURIKAE.oldValue * -1;#EOL#&#x9;qtUkebarai = KT030_QTHURIKAE.oldValue;#EOL#&#x9;qtNyuko = 0;#EOL#&#x9;qtSyukko = KT030_QTHURIKAE.oldValue * -1;#EOL#}#EOL#if (ukebaraiKubun == '50' || ukebaraiKubun == '51' ||#EOL#&#x9;ukebaraiKubun == '52' || ukebaraiKubun == '53') {#EOL#&#x9;amUkebarai = KT030_AMHURIKAE.oldValue * -1;#EOL#&#x9;amNyuko = KT030_AMHURIKAE.oldValue * -1;#EOL#&#x9;amSyukko = 0;#EOL#&#x9;qtUkebarai = KT030_QTHURIKAE.oldValue * -1;#EOL#&#x9;qtNyuko = KT030_QTHURIKAE.oldValue * -1;#EOL#&#x9;qtSyukko = 0;#EOL#}#EOL##EOL#///////////////////////////////////////#EOL#// 関連する受払実績(ET100)の失効処理 //#EOL#///////////////////////////////////////#EOL#rET100 = instance.createTableOperator('Select', 'ET100');#EOL#rET100.setSelectFields('NRUKEBARAI, UPDCOUNTER');#EOL#rET100.addKeyValue('NRTORIHIKIKANRI', KT030_NRTORIHIKIKANRI.value);#EOL#while (rET100.next()) {#EOL#&#x9;uET100 = instance.createTableOperator('Update', 'ET100');#EOL#&#x9;uET100.addValue('FGVALID',&#x9;&#x9;'F');#EOL#&#x9;uET100.addValue('UPDCOUNTER',&#x9;Number(rET100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;uET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;uET100.addKeyValue('UPDCOUNTER',&#x9;rET100.getValueOf('UPDCOUNTER'));#EOL#&#x9;count = uET100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払実績(ET100)の失効処理に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL##EOL#///////////////////////////////////#EOL#// 受払実績(ET100)の追加（赤伝） //#EOL#///////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;cET100 = instance.createTableOperator('Insert', 'ET100');#EOL#&#x9;cET100.addValue('NRUKEBARAI',&#x9;&#x9;session.getNextNumber('NRUKEBARAI'));#EOL#&#x9;cET100.addValue('KBAKADEN',&#x9;&#x9;&#x9;'2');#EOL#&#x9;cET100.addValue('KBUKEBARAI',&#x9;&#x9;ukebaraiKubun);#EOL#&#x9;cET100.addValue('DTUKEBARAI',&#x9;&#x9;KT030_DTHURIKAE.oldValue);#EOL#&#x9;cET100.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;cET100.addValue('NRLOCATION',&#x9;&#x9;KT030_NRLOCATION.value);#EOL#&#x9;cET100.addValue('NRIDOUSOUKO',&#x9;&#x9;'');#EOL#&#x9;cET100.addValue('NRTORIHIKISAKI',&#x9;'');#EOL#&#x9;cET100.addValue('SQSYUKKASAKI',&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;cET100.addValue('TXLOTNUMBER',&#x9;&#x9;KT030_TXLOTNUMBER.value);#EOL#&#x9;cET100.addValue('QTUKEBARAI',&#x9;&#x9;qtUkebarai);#EOL#&#x9;cET100.addValue('AMUKEBARAI',&#x9;&#x9;amUkebarai);#EOL#&#x9;cET100.addValue('AMSAGAKU',&#x9;&#x9;&#x9;0);#EOL#&#x9;cET100.addValue('NRTORIHIKIKANRI',&#x9;KT030_NRTORIHIKIKANRI.value);#EOL#&#x9;cET100.addValue('DTCREATE',&#x9;&#x9;&#x9;'CURRENT_TIMESTAMP');#EOL#&#x9;cET100.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;cET100.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;cET100.addValue('FGVALID',&#x9;&#x9;&#x9;'F');#EOL#&#x9;count = cET100.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '受払実績(ET100)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL#}#EOL##EOL#///////////////////////////////////////////#EOL#// 関連する倉庫在庫(ET010)の在庫残高更新 //#EOL#///////////////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;rET010 = instance.createTableOperator('Select', 'ET010');#EOL#&#x9;rET010.setSelectFields('QTKISYUZAIKO, QTNYUKO, QTSYUKKO, AMKISYUZAIKO, AMNYUKO, AMSYUKKO, UPDCOUNTER');#EOL#&#x9;rET010.addKeyValue('NRSYOHIN',&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;rET010.addKeyValue('NRSOUKO',&#x9;KT030_NRSOUKO.value);#EOL#&#x9;if (rET010.next()) {#EOL#&#x9;&#x9;qtNyukoUpdated = Number(rET010.getValueOf('QTNYUKO')) + Number(qtNyuko);#EOL#&#x9;&#x9;amNyukoUpdated = Number(rET010.getValueOf('AMNYUKO')) + Number(amNyuko);#EOL#&#x9;&#x9;qtSyukkoUpdated = Number(rET010.getValueOf('QTSYUKKO')) + Number(qtSyukko);#EOL#&#x9;&#x9;amSyukkoUpdated = Number(rET010.getValueOf('AMSYUKKO')) + Number(amSyukko);#EOL#&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoUpdated);#EOL#&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoUpdated);#EOL#&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoUpdated);#EOL#&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoUpdated);#EOL#&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;cET010 = instance.createTableOperator('Insert', 'ET010');#EOL#&#x9;&#x9;cET010.addValue('NRSYOHIN',&#x9;&#x9;&#x9;KT030_NRSYOHIN.value);#EOL#&#x9;&#x9;cET010.addValue('NRSOUKO',&#x9;&#x9;&#x9;KT030_NRSOUKO.value);#EOL#&#x9;&#x9;cET010.addValue('NRLOCATION',&#x9;&#x9;'');#EOL#&#x9;&#x9;cET010.addValue('AMKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('AMNYUKO',&#x9;&#x9;&#x9;amNyuko);#EOL#&#x9;&#x9;cET010.addValue('AMSYUKKO',&#x9;&#x9;&#x9;amSyukko);#EOL#&#x9;&#x9;cET010.addValue('QTKISYUZAIKO',&#x9;&#x9;0);#EOL#&#x9;&#x9;cET010.addValue('QTNYUKO',&#x9;&#x9;&#x9;qtNyuko);#EOL#&#x9;&#x9;cET010.addValue('QTSYUKKO',&#x9;&#x9;&#x9;qtSyukko);#EOL#&#x9;&#x9;cET010.addValue('QTANZENZAIKO',&#x9;&#x9;BT020_QTANZENZAIKO.value);#EOL#&#x9;&#x9;cET010.addValue('QTJYOUGENZAIKO',&#x9;BT020_QTJYOUGENZAIKO.value);#EOL#&#x9;&#x9;count = cET010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '倉庫在庫(ET010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}"/></Table><Table ActiveWhere="" ID="ZT021" Name="ユーザフィルター値" RangeKey="" Remarks="XF100およびXF110でのフィルター値をユーザ毎に保管・復元するためのテーブル" SubsystemID="Z"><Field Decimal="" ID="IDUSER" Name="ユーザＩＤ" Nullable="F" Order="0000" Size="5" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="IDFUNCTION" Name="ファンクションID" Nullable="F" Order="0010" Size="20" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="IDFILTER" Name="フィルターID" Nullable="F" Order="0020" Size="40" Type="CHAR" TypeOptions=""/><Field Decimal="" ID="TXVALUE" Name="フィルター値" Nullable="T" Order="0030" Size="50" Type="CHAR" TypeOptions=""/><Key Fields="IDUSER;IDFUNCTION;IDFILTER" Type="PK"/></Table><Function DetailFunction="AF011" ID="AF010" InitialListing="T" InitialMsg="" KeyFields="" Name="部門データの一覧・保守" OrderBy="AT010.CDBUMON" PrimaryTable="AT010" Size="AUTO" SubsystemID="A" Type="XF100"><Filter DataSource="AT010.TXBUMON" FieldOptions="SCAN,CAPTION(部門名SCAN)" Order="0"/><Column DataSource="AT010.TXBUMON" FieldOptions="" Order="1"/><Column DataSource="AT010.NRKANRISYA" FieldOptions="" Order="2"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(管理者名)" Order="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(AF012)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function HeaderFunction="AF012" HeaderKeyFields="" HeaderTable="AT010" ID="AF011" Name="部門と関連情報の確認" Size="AUTO" SubsystemID="A" Type="XF300"><Field DataSource="AT010.CDBUMON" FieldOptions="" Order="0"/><Field DataSource="AT010.TXBUMON" FieldOptions="" Order="1"/><Field DataSource="AT010.NRKANRISYA" FieldOptions="" Order="2"/><Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="3"/><Field DataSource="AT010.TXTEKIYO" FieldOptions="" Order="4"/><Detail Caption="上位部門" DetailFunction="AF013" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="AT011"><Column DataSource="AT011.DTHAKKOUNENGETSU" FieldOptions="" Order="0010"/><Column DataSource="AT011.CDJYOUIBUMON" FieldOptions="" Order="0030"/><Column DataSource="AT011.DTSIKKOUNENGETSU" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="HEADER" Caption="部門情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT010_2.TXBUMON" FieldOptions="CAPTION(上位部門名)" Order="0040"/></Detail><Detail Caption="所属メンバー" DetailFunction="AF024" InitialMsg="" KeyFields="CDBUMON;NRJYUGYOIN;DTSYOZOKUNENGETSU" Order="1" Table="AT021"><Column DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="0040"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(メンバー名),WIDTH(290)" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="部門情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT021.DTLASTNENGETSU" FieldOptions="" Order="0050"/><Column DataSource="AT021.KBPRESENT" FieldOptions="" Order="0060"/><Column DataSource="AT020.TXKANA" FieldOptions="WIDTH(240)" Order="0010"/><Filter DataSource="AT021.KBPRESENT" FieldOptions="PROMPT_LIST1,VALUE(T)" Order="0010"/></Detail></Function><Function ContinueAdd="T" DataName="" ID="AF012" InitialMsg="" KeyFields="" Name="部門データの保守" PrimaryTable="AT010" Size="AUTO" SubsystemID="A" Type="XF200" UpdateOnly=""><Field DataSource="AT010.CDBUMON" FieldOptions="" Order="0"/><Field DataSource="AT010.TXBUMON" FieldOptions="" Order="1"/><Field DataSource="AT010.NRKANRISYA" FieldOptions="" Order="2"/><Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="3"/><Field DataSource="AT010.TXTEKIYO" FieldOptions="" Order="4"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DataName="上位部門" ID="AF013" InitialMsg="" KeyFields="" Name="上位部門データの保守" PrimaryTable="AT011" Size="AUTO" SubsystemID="A" Type="XF200"><Field DataSource="AT011.CDBUMON" FieldOptions="" Order="0"/><Field DataSource="AT010_1.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="1"/><Field DataSource="AT011.CDJYOUIBUMON" FieldOptions="" Order="2"/><Field DataSource="AT010_2.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="3"/><Field DataSource="AT011.DTHAKKOUNENGETSU" FieldOptions="" Order="4"/><Field DataSource="AT011.DTSIKKOUNENGETSU" FieldOptions="HORIZONTAL" Order="5"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailFunction="AF021" ID="AF020" InitialListing="" InitialMsg="" KeyFields="" Name="従業員データの一覧・保守" OrderBy="AT020.TXKANA" PrimaryTable="AT020" Size="AUTO" SubsystemID="A" Type="XF100"><Filter DataSource="AT020.TXKANJI" FieldOptions="SCAN,CAPTION(漢字名SCAN)" Order="0"/><Filter DataSource="AT020.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="1"/><Filter DataSource="AT020.KBKOYOU" FieldOptions="PROMPT_LIST1" Order="2"/><Column DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/><Column DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/><Column DataSource="AT020.TXKANA" FieldOptions="" Order="2"/><Column DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(AF022)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function HeaderFunction="AF022" HeaderKeyFields="" HeaderTable="AT020" ID="AF021" Name="従業員と関連情報の確認" Size="AUTO" SubsystemID="A" Type="XF300"><Field DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/><Field DataSource="AT020.TXKANA" FieldOptions="" Order="1"/><Field DataSource="AT020.TXKANJI" FieldOptions="" Order="2"/><Field DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/><Field DataSource="AT020.DTNYUSYA" FieldOptions="" Order="4"/><Field DataSource="AT020.DTTAISYA" FieldOptions="" Order="5"/><Detail Caption="所属部門" DetailFunction="AF023" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="AT021"><Column DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="0"/><Column DataSource="AT021.CDBUMON" FieldOptions="" Order="1"/><Column DataSource="AT010.TXBUMON" FieldOptions="CAPTION(所属部門名)" Order="2"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="HEADER" Caption="従業員情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Detail></Function><Function ContinueAdd="T" DataName="" ID="AF022" InitialMsg="" KeyFields="" Name="従業員データの保守" PrimaryTable="AT020" Size="AUTO" SubsystemID="A" Type="XF200"><Field DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/><Field DataSource="AT020.TXKANA" FieldOptions="" Order="1"/><Field DataSource="AT020.TXKANJI" FieldOptions="" Order="2"/><Field DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/><Field DataSource="AT020.DTNYUSYA" FieldOptions="" Order="4"/><Field DataSource="AT020.DTTAISYA" FieldOptions="" Order="5"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DataName="所属情報" ID="AF023" InitialMsg="" KeyFields="" Name="従業員所属データの保守" PrimaryTable="AT021" Size="AUTO" SubsystemID="A" Type="XF200"><Field DataSource="AT021.NRJYUGYOIN" FieldOptions="" Order="0"/><Field DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/><Field DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="2"/><Field DataSource="AT021.CDBUMON" FieldOptions="PROMPT_CALL(AF100),PROMPT_CALL_TO_GET(AT010.CDBUMON;AT010.TXBUMON),PROMPT_CALL_TO_GET_TO(AT021.CDBUMON;AT010.TXBUMON)" Order="3"/><Field DataSource="AT010.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="4"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DataName="所属情報" ID="AF024" InitialMsg="" KeyFields="" Name="従業員所属情報の表示" PrimaryTable="AT021" Size="AUTO" SubsystemID="A" Type="XF200"><Field DataSource="AT021.NRJYUGYOIN" FieldOptions="" Order="0"/><Field DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/><Field DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="2"/><Field DataSource="AT021.CDBUMON" FieldOptions="" Order="3"/><Field DataSource="AT010.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="4"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailFunction="AF031" ID="AF030" InitialMsg="" KeyFields="" Name="取引先データの一覧・保守" OrderBy="AT030.TXKANA" PrimaryTable="AT030" Size="AUTO" SubsystemID="A" Type="XF100"><Filter DataSource="AT030.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="0"/><Filter DataSource="AT030.FGKOKYAKU" FieldOptions="PROMPT_LIST1" Order="1"/><Filter DataSource="AT030.FGSIIRESAKI" FieldOptions="PROMPT_LIST1" Order="1"/><Column DataSource="AT030.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Column DataSource="AT030.TXKANJI" FieldOptions="" Order="0020"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0060"/><Column DataSource="CT010.AMGENKAIKAKE" FieldOptions="" Order="0030"/><Column DataSource="DT010.AMGENURIKAKE" FieldOptions="WIDTH(119)" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.KBCOUNTRY" FieldOptions="WIDTH(73),VERTICAL" Order="0050"/><Column DataSource="AT030.KBNAIKA" FieldOptions="CAPTION(CUR)" Order="0080"/><Column DataSource="AT030.KBGAIKA" FieldOptions="CAPTION(CUR)" Order="0040"/></Function><Function ContinueAdd="T" DataName="取引先" ID="AF031" InitialMsg="" KeyFields="" Name="取引先データの保守" PrimaryTable="AT030" Size="AUTO" SubsystemID="A" Type="XF200"><Field DataSource="AT030.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Field DataSource="AT030.TXKANA" FieldOptions="" Order="0020"/><Field DataSource="AT030.TXKANJI" FieldOptions="" Order="0030"/><Field DataSource="AT030.NRYUBIN" FieldOptions="" Order="0060"/><Field DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0070"/><Field DataSource="AT030.TXJYUSYO2" FieldOptions="" Order="0080"/><Field DataSource="AT030.NRDENWA" FieldOptions="" Order="0090"/><Field DataSource="AT030.NRFAX" FieldOptions="" Order="0100"/><Field DataSource="AT030.TXURL" FieldOptions="" Order="0110"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.KBCOUNTRY" FieldOptions="" Order="0040"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="HORIZONTAL,COMMENT(当面は輸入取引用通貨)" Order="0050"/></Function><Function DetailFunction="" ID="AF100" InitialListing="T" InitialMsg="" KeyFields="" Name="部門検索" OrderBy="AT010.CDBUMON" ParmType="COLUMNS" PrimaryTable="AT010" Size="AUTO" SubsystemID="A" Type="XF100"><Filter DataSource="AT010.TXBUMON" FieldOptions="SCAN,CAPTION(部門名SCAN)" Order="0"/><Column DataSource="AT010.CDBUMON" FieldOptions="" Order="0"/><Column DataSource="AT010.TXBUMON" FieldOptions="" Order="1"/><Column DataSource="AT010.NRKANRISYA" FieldOptions="" Order="2"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(管理者名)" Order="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/></Function><Function DetailFunction="" ID="AF110" InitialMsg="" KeyFields="" Name="従業員検索" OrderBy="AT020.TXKANA" ParmType="COLUMNS" PrimaryTable="AT020" Size="AUTO" SubsystemID="A" Type="XF100"><Filter DataSource="AT020.TXKANJI" FieldOptions="SCAN,CAPTION(漢字名SCAN)" Order="0"/><Filter DataSource="AT020.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="1"/><Filter DataSource="AT020.KBKOYOU" FieldOptions="PROMPT_LIST1" Order="2"/><Column DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/><Column DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/><Column DataSource="AT020.TXKANA" FieldOptions="" Order="2"/><Column DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/></Function><Function DetailFunction="" ID="AF120" InitialMsg="" KeyFields="" Name="取引先検索" OrderBy="AT030.TXKANA" ParmType="COLUMNS" PrimaryTable="AT030" Size="AUTO" SubsystemID="A" Type="XF100"><Filter DataSource="AT030.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="0"/><Filter DataSource="AT030.FGKOKYAKU" FieldOptions="PROMPT_LIST1" Order="1"/><Filter DataSource="AT030.FGSIIRESAKI" FieldOptions="PROMPT_LIST1" Order="1"/><Column DataSource="AT030.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Column DataSource="AT030.TXKANJI" FieldOptions="" Order="0020"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0060"/><Column DataSource="CT010.AMGENKAIKAKE" FieldOptions="" Order="0030"/><Column DataSource="DT010.AMGENURIKAKE" FieldOptions="WIDTH(119)" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Column DataSource="AT030.KBNAIKA" FieldOptions="CAPTION(CUR)" Order="0080"/><Column DataSource="AT030.KBGAIKA" FieldOptions="CAPTION(CUR)" Order="0040"/><Column DataSource="AT030.KBCOUNTRY" FieldOptions="WIDTH(73),VERTICAL" Order="0050"/></Function><Function DetailFunction="BF011" ID="BF010" InitialMsg="" KeyFields="" Name="メーカーデータの一覧・保守" OrderBy="BT010.TXMAKERABR" PrimaryTable="BT010" Size="AUTO" SubsystemID="B" Type="XF100"><Filter DataSource="BT010.TXMAKER" FieldOptions="SCAN,CAPTION(名称SCAN)" Order="0"/><Column DataSource="BT010.TXMAKERABR" FieldOptions="" Order="0010"/><Column DataSource="BT010.TXMAKER" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT010.KBCOUNTRY" FieldOptions="" Order="0030"/></Function><Function ContinueAdd="T" DataName="" ID="BF011" InitialMsg="" KeyFields="" Name="メーカーデータの保守" PrimaryTable="BT010" Size="AUTO" SubsystemID="B" Type="XF200"><Field DataSource="BT010.CDMAKER" FieldOptions="" Order="0010"/><Field DataSource="BT010.TXMAKER" FieldOptions="" Order="0020"/><Field DataSource="BT010.TXMAKERABR" FieldOptions="" Order="0030"/><Field DataSource="BT010.NRYUBIN" FieldOptions="" Order="0060"/><Field DataSource="BT010.TXJYUSYO" FieldOptions="" Order="0070"/><Field DataSource="BT010.NRDENWA" FieldOptions="" Order="0080"/><Field DataSource="BT010.NRFAX" FieldOptions="" Order="0090"/><Field DataSource="BT010.TXURL" FieldOptions="" Order="0100"/><Field DataSource="BT010.TXEMAIL" FieldOptions="" Order="0110"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT010.KBCOUNTRY" FieldOptions="" Order="0040"/></Function><Function DetailFunction="BF021" ID="BF020" InitialMsg="" KeyFields="" Name="商品データの一覧・保守" OrderBy="BT020.TXHINBAN" PrimaryTable="BT020" Size="AUTO" SubsystemID="B" Type="XF100"><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,WIDTH(150),CAPTION(品番SCAN)" Order="0"/><Filter DataSource="BT020.TXSYOHIN" FieldOptions="SCAN,WIDTH(150),CAPTION(商品名SCAN)" Order="1"/><Filter DataSource="BT020.TXSIYOU" FieldOptions="SCAN,WIDTH(150),CAPTION(仕様SCAN)" Order="2"/><Filter DataSource="BT020.KBSYOHIN" FieldOptions="VERTICAL,PROMPT_LIST1" Order="3"/><Filter DataSource="BT010.TXMAKERABR" FieldOptions="HORIZONTAL(85),WIDTH(131),PROMPT_LIST1" Order="4"/><Filter DataSource="BT020.FGLISTSYOHIN" FieldOptions="HORIZONTAL(123),VALUE(VALUE:T)" Order="5"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Column DataSource="BT020.KBSYOHIN" FieldOptions="" Order="0040"/><Column DataSource="BT010.TXMAKERABR" FieldOptions="VERTICAL" Order="0050"/><Column DataSource="BT020.TXSIYOU" FieldOptions="WIDTH(546)" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(BF022)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0010"/><Column DataSource="BT020.FGLOTKANRI" FieldOptions="CAPTION(L管理)" Order="0080"/></Function><Function HeaderFunction="BF022" HeaderKeyFields="" HeaderTable="BT020" ID="BF021" Name="商品と関連情報の確認" Size="AUTO" SubsystemID="B" Type="XF300"><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0010"/><Field DataSource="BT020.NRSYOHIN" FieldOptions="HORIZONTAL(320)" Order="0020"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Field DataSource="BT020.KBSYOHIN" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="BT010.TXMAKERABR" FieldOptions="CAPTION(メーカー)" Order="0050"/><Field DataSource="BT020.TXSIYOU" FieldOptions="HORIZONTAL" Order="0060"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="" Order="0070"/><Field DataSource="BT020.TXIMAGEFILENAME" FieldOptions="WIDTH(560),HORIZONTAL(77)" Order="0080"/><Field DataSource="BT020.PRHANBAI" FieldOptions="" Order="0090"/><Field DataSource="BT020.PRSIIRE" FieldOptions="" Order="0100"/><Field DataSource="BT020.PRARARI" FieldOptions="" Order="0120"/><Field DataSource="BT020.QTHANBAIUNIT" FieldOptions="" Order="0130"/><Field DataSource="BT020.FGLOTKANRI" FieldOptions="" Order="0160"/><Field DataSource="BT020.FGLISTSYOHIN" FieldOptions="" Order="0170"/><Detail Caption="倉庫在庫" DetailFunction="EF011" InitialMsg="" KeyFields="" Order="0" OrderBy="ET010.NRSOUKO" Table="ET010"><Column DataSource="BT030.TXSOUKO" FieldOptions="" Order="0010"/><Column DataSource="ET010.QTGENZAIKO" FieldOptions="" Order="0050"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="商品情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET010.AMGENZAIKO" FieldOptions="" Order="0040"/><Column DataSource="ET010.NRLOCATION" FieldOptions="" Order="0030"/></Detail><Detail Caption="仕入先" DetailFunction="CF013" InitialMsg="" KeyFields="" Order="0" OrderBy="AT030.TXKANA" Table="CT011"><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名),WIDTH(200)" Order="0010"/><Column DataSource="CT011.DTHAKKOU" FieldOptions="" Order="0020"/><Column DataSource="CT011.DTSIKKOU" FieldOptions="" Order="0030"/><Column DataSource="CT011.QTSIIRETANNI" FieldOptions="" Order="0060"/><Column DataSource="CT011.PRSIIRETANKA" FieldOptions="" Order="0040"/><Column DataSource="CT011.VLLEADTIME" FieldOptions="CAPTION(標準ＬＴ)" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="商品情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0070"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050"/><Column DataSource="CT011.VLKANZANKEISU" FieldOptions="" Order="0080"/></Detail><Detail Caption="月次取引" DetailFunction="YF031" HeaderKeyFields="" InitialMsg="" KeyFields="NRSYOHIN;DTNEND;DTMSEQ" Order="0010" Table="YT030"><Column DataSource="YT030.AMZAIKISYUZAN" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="商品情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="YT030.DTNEND" FieldOptions="VALUE(SESSION_ATTRIBUTE:CurrentFYear)" Order="0010"/><Column DataSource="YT030.QTZAIKISYUZAN" FieldOptions="" Order="0040"/><Column DataSource="YT030.AMZAINYUK" FieldOptions="" Order="0050"/><Column DataSource="YT030.QTZAINYUK" FieldOptions="" Order="0060"/><Column DataSource="YT030.AMZAINYUKHEN" FieldOptions="" Order="0070"/><Column DataSource="YT030.QTZAINYUKHEN" FieldOptions="" Order="0080"/><Column DataSource="YT030.AMZAISYUK" FieldOptions="" Order="0090"/><Column DataSource="YT030.QTZAISYUK" FieldOptions="" Order="0100"/><Column DataSource="YT030.AMZAISYUKHEN" FieldOptions="" Order="0110"/><Column DataSource="YT030.QTZAISYUKHEN" FieldOptions="" Order="0120"/><Column DataSource="YT030.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT030.DTMSEQ" FieldOptions="" Order="0020"/></Detail><Field DataSource="BT020.QTANZENZAIKO" FieldOptions="" Order="0140"/><Field DataSource="BT020.QTJYOUGENZAIKO" FieldOptions="" Order="0150"/><Detail Caption="セット構成" DetailFunction="BF023" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0020" OrderBy="BT021.NRSYOHIN;BT021.SQLIST" Table="BT021"><Column DataSource="BT021.RTKOUSEI" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="HEADER" Caption="商品情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT020B.TXSYOHIN" FieldOptions="" Order="0020"/><Column DataSource="BT020B.TXHINBAN" FieldOptions="CAPTION(構成品番)" Order="0010"/><Column DataSource="BT020B.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0040"/></Detail></Function><Function ContinueAdd="T" DataName="" ID="BF022" InitialMsg="" KeyFields="" Name="商品データの保守" PrimaryTable="BT020" Size="AUTO" SubsystemID="B" Type="XF200"><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0010"/><Field DataSource="BT020.NRSYOHIN" FieldOptions="HORIZONTAL(320)" Order="0020"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Field DataSource="BT020.KBSYOHIN" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="BT010.TXMAKERABR" FieldOptions="PROMPT_LIST,CAPTION(メーカー)" Order="0050"/><Field DataSource="BT020.TXSIYOU" FieldOptions="HORIZONTAL" Order="0060"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="" Order="0070"/><Field DataSource="BT020.TXIMAGEFILENAME" FieldOptions="WIDTH(560),HORIZONTAL(77)" Order="0080"/><Field DataSource="BT020.PRHANBAI" FieldOptions="" Order="0090"/><Field DataSource="BT020.PRSIIRE" FieldOptions="" Order="0100"/><Field DataSource="BT020.PRARARI" FieldOptions="" Order="0120"/><Field DataSource="BT020.QTHANBAIUNIT" FieldOptions="" Order="0130"/><Field DataSource="BT020.FGLOTKANRI" FieldOptions="" Order="0160"/><Field DataSource="BT020.FGLISTSYOHIN" FieldOptions="" Order="0170"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.QTANZENZAIKO" FieldOptions="" Order="0140"/><Field DataSource="BT020.QTJYOUGENZAIKO" FieldOptions="" Order="0150"/></Function><Function DetailFunction="BF031" ID="BF030" InitialMsg="" KeyFields="" Name="倉庫データの一覧・保守" OrderBy="BT030.NRSOUKO" PrimaryTable="BT030" Size="AUTO" SubsystemID="B" Type="XF100"><Filter DataSource="BT030.TXSOUKO" FieldOptions="SCAN,CAPTION(倉庫名SCAN)" Order="0"/><Column DataSource="BT030.NRSOUKO" FieldOptions="" Order="0"/><Column DataSource="BT030.TXSOUKO" FieldOptions="" Order="1"/><Column DataSource="BT030.TXJYUSYO" FieldOptions="" Order="2"/><Column DataSource="BT030.NRDENWA" FieldOptions="" Order="2"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(BF032)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function HeaderFunction="BF032" HeaderKeyFields="" HeaderTable="BT030" ID="BF031" Name="倉庫と関連情報の確認" Size="AUTO" SubsystemID="B" Type="XF300"><Field DataSource="BT030.NRSOUKO" FieldOptions="" Order="0010"/><Field DataSource="BT030.TXSOUKO" FieldOptions="" Order="0020"/><Field DataSource="BT030.NRYUBIN" FieldOptions="" Order="0040"/><Field DataSource="BT030.TXJYUSYO" FieldOptions="" Order="0050"/><Field DataSource="BT030.NRDENWA" FieldOptions="" Order="0070"/><Field DataSource="BT030.NRFAX" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="BT030.NRDEFAULTLOCATION" FieldOptions="HORIZONTAL" Order="0090"/><Detail Caption="ロケ" DetailFunction="BF033" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="BT031"><Column DataSource="BT031.NRLOCATION" FieldOptions="" Order="0"/><Column DataSource="BT031.TXTEKIYO" FieldOptions="" Order="1"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="HEADER" Caption="倉庫情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Detail><Field DataSource="BT030.TXSOUKOENG" FieldOptions="" Order="0030"/><Field DataSource="BT030.TXJYUSYOENG" FieldOptions="" Order="0060"/></Function><Function ContinueAdd="T" DataName="" ID="BF032" InitialMsg="" KeyFields="" Name="倉庫データの保守" PrimaryTable="BT030" Size="AUTO" SubsystemID="B" Type="XF200"><Field DataSource="BT030.NRSOUKO" FieldOptions="" Order="0010"/><Field DataSource="BT030.TXSOUKO" FieldOptions="" Order="0020"/><Field DataSource="BT030.NRYUBIN" FieldOptions="" Order="0040"/><Field DataSource="BT030.TXJYUSYO" FieldOptions="" Order="0050"/><Field DataSource="BT030.NRDENWA" FieldOptions="" Order="0070"/><Field DataSource="BT030.NRFAX" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="BT030.NRDEFAULTLOCATION" FieldOptions="HORIZONTAL" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT030.TXSOUKOENG" FieldOptions="" Order="0030"/><Field DataSource="BT030.TXJYUSYOENG" FieldOptions="" Order="0060"/></Function><Function ContinueAdd="T" DataName="" ID="BF033" InitialMsg="" KeyFields="" Name="倉庫ロケの保守" PrimaryTable="BT031" Size="AUTO" SubsystemID="B" Type="XF200"><Field DataSource="BT031.NRSOUKO" FieldOptions="" Order="0"/><Field DataSource="BT030.TXSOUKO" FieldOptions="" Order="1"/><Field DataSource="BT031.NRLOCATION" FieldOptions="" Order="2"/><Field DataSource="BT031.TXTEKIYO" FieldOptions="" Order="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailFunction="" ID="BF100" InitialMsg="" KeyFields="" Name="商品検索" OrderBy="BT020.TXHINBAN" ParmType="COLUMNS" PrimaryTable="BT020" Size="AUTO" SubsystemID="B" Type="XF100"><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="0"/><Filter DataSource="BT020.TXSYOHIN" FieldOptions="SCAN,CAPTION(商品名SCAN)" Order="1"/><Filter DataSource="BT020.KBSYOHIN" FieldOptions="VERTICAL,PROMPT_LIST1" Order="2"/><Filter DataSource="BT010.TXMAKERABR" FieldOptions="HORIZONTAL(85),PROMPT_LIST1" Order="3"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Column DataSource="BT020.KBSYOHIN" FieldOptions="" Order="0040"/><Column DataSource="BT010.TXMAKERABR" FieldOptions="VERTICAL" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Column DataSource="BT020.PRHANBAI" FieldOptions="" Order="0080"/><Column DataSource="BT020.TXSIYOU" FieldOptions="WIDTH(419)" Order="0060"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/><Column DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0010"/></Function><Function DetailFunction="CF011" ID="CF010" InitialMsg="" KeyFields="" Name="仕入先データの一覧・保守" OrderBy="AT030.TXKANA" PrimaryTable="CT010" Size="AUTO" SubsystemID="C" Type="XF100"><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,CAPTION(名称SCAN)" Order="0"/><Column DataSource="CT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0030"/><Column DataSource="CT010.AMGENKAIKAKE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(CF012)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050"/></Function><Function HeaderFunction="CF012" HeaderKeyFields="" HeaderTable="CT010" ID="CF011" Name="仕入先と関連情報の確認" Size="AUTO" SubsystemID="C" Type="XF300"><Field DataSource="CT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="AT030.TXJYUSYO1" FieldOptions="CAPTION(住所)" Order="0030"/><Field DataSource="CT010.AMGENKAIKAKE" FieldOptions="HORIZONTAL" Order="0060"/><Detail Caption="仕入商品" DetailFunction="CF013" InitialMsg="" KeyFields="NRTORIHIKISAKI;NRSYOHIN;DTHAKKOU" Order="0010" Table="CT011"><Column DataSource="CT011.DTHAKKOU" FieldOptions="" Order="0030"/><Column DataSource="CT011.DTSIKKOU" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="HEADER" Caption="仕入先情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT011.QTSIIRETANNI" FieldOptions="" Order="0070"/><Column DataSource="CT011.PRSIIRETANKA" FieldOptions="" Order="0050"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(200)" Order="0010"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(200)" Order="0020"/><Column DataSource="CT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0080"/><Column DataSource="CT011.VLKANZANKEISU" FieldOptions="" Order="0090"/><Column DataSource="CT011.VLLEADTIME" FieldOptions="" Order="0110"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0060"/></Detail><Detail Caption="仕入実績" DetailFunction="CF101" FixedWhere="" InitialMsg="" KeyFields="NRTORIHIKISAKI;NRSIIRE" Order="0020" OrderBy="CT100.DTSIIRE;CT100.NRSIIRE" Table="CT100"><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="仕入先情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0080"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0070"/><Filter DataSource="CT100.FGVALID" FieldOptions="PROMPT_LIST1,VALUE(VALUE:T)" Order="0030"/><Filter DataSource="CT100.KBSIIRE" FieldOptions="PROMPT_LIST1" Order="0020"/><Filter DataSource="CT100.DTSIIRE" FieldOptions="GE,CAPTION(仕入日≧),VALUE(SESSION_ATTRIBUTE:Date3MonthsAgo)" Order="0010"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="" Order="0050"/></Detail><Field DataSource="CT010.AMKISYUKAIKAKE" FieldOptions="" Order="0050"/><Field DataSource="CT010.AMKEIJYOU" FieldOptions="" Order="0090"/><Field DataSource="CT010.AMSIHARAI" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="CT010.TXTEKIYO" FieldOptions="" Order="0110"/><Detail Caption="支払依頼" DetailFunction="CF121" InitialMsg="" KeyFields="NRTORIHIKISAKI;NRSIHARAIIRAI" Order="0030" Table="CT110"><Column DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Column DataSource="CT110.DTSIHARAIIRAI" FieldOptions="" Order="0020"/><Column DataSource="CT110.TXSEIKYUNO" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="仕入先情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT110.FGSYOUNIN" FieldOptions="CAPTION(承認状況)" Order="0080"/><Column DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="" Order="0030"/><Column DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0040"/><Column DataSource="CT110.AMTAX" FieldOptions="" Order="0060"/></Detail><Detail Caption="月次取引" DetailFunction="YF041" HeaderKeyFields="" InitialMsg="" KeyFields="NRTORIHIKISAKI;DTNEND;DTMSEQ" Order="0040" Table="YT040"><Column DataSource="YT040.AMKAIKISYUZAN" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="仕入先情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="YT040.DTNEND" FieldOptions="VALUE(SESSION_ATTRIBUTE:CurrentFYear)" Order="0010"/><Column DataSource="YT040.AMKAINYUK" FieldOptions="" Order="0040"/><Column DataSource="YT040.AMKAITYOK" FieldOptions="" Order="0050"/><Column DataSource="YT040.AMKAIHENPIN" FieldOptions="" Order="0060"/><Column DataSource="YT040.AMKAIZATSUEKI" FieldOptions="" Order="0070"/><Column DataSource="YT040.AMKAIZATSUSON" FieldOptions="" Order="0080"/><Column DataSource="YT040.AMKAISOUSAI" FieldOptions="" Order="0090"/><Column DataSource="YT040.AMKAIGENKA" FieldOptions="" Order="0100"/><Column DataSource="YT040.AMKAISIHARAI" FieldOptions="" Order="0110"/><Column DataSource="YT040.AMKAITAX" FieldOptions="" Order="0120"/><Column DataSource="YT040.AMKAIKIMATSUZAN" FieldOptions="" Order="0130"/><Column DataSource="YT040.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT040.DTMSEQ" FieldOptions="" Order="0020"/></Detail><Field DataSource="AT030.TXJYUSYO2" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="HORIZONTAL" Order="0070"/></Function><Function ContinueAdd="T" DataName="" ID="CF012" InitialMsg="" KeyFields="" Name="仕入先データの保守" PrimaryTable="CT010" Size="AUTO" SubsystemID="C" Type="XF200"><Field DataSource="CT010.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(AF120),PROMPT_CALL_TO_GET(AT030.NRTORIHIKISAKI;AT030.TXKANJI;AT030.TXJYUSYO1),PROMPT_CALL_TO_GET_TO(CT010.NRTORIHIKISAKI;AT030.TXKANJI;AT030.TXJYUSYO1)" Order="0010"/><Field DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020"/><Field DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0030"/><Field DataSource="AT030.TXJYUSYO2" FieldOptions="" Order="0040"/><Field DataSource="CT010.TXTANTOUBUSYO" FieldOptions="" Order="0050"/><Field DataSource="CT010.TXTANTOUSYA" FieldOptions="" Order="0070"/><Field DataSource="CT010.TXTANTOUSYASYOKUI" FieldOptions="" Order="0080"/><Field DataSource="CT010.TXTANTOUSYAEMAIL" FieldOptions="CAPTION(メール),HORIZONTAL" Order="0090"/><Field DataSource="CT010.TXTANTOUSYADENWA" FieldOptions="CAPTION(電話),HORIZONTAL" Order="0060"/><Field DataSource="CT010.KBSIHARAIHOUHOU" FieldOptions="" Order="0100"/><Field DataSource="CT010.VLNYUKINSAITO" FieldOptions="" Order="0120"/><Field DataSource="CT010.NRTANTOUJYUGYOIN" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="CT010.TXTEKIYO" FieldOptions="" Order="0210"/><Field DataSource="CT010.AMKISYUKAIKAKE" FieldOptions="" Order="0150"/><Field DataSource="CT010.AMGENKAIKAKE" FieldOptions="HORIZONTAL" Order="0160"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL,PROMPT_CALL(AF110),PROMPT_CALL_TO_GET(AT020.NRJYUGYOIN;AT020.TXKANJI),PROMPT_CALL_TO_GET_TO(CT010.NRTANTOUJYUGYOIN;AT020.TXKANJI)" Order="0140"/><Field DataSource="CT010.TXHURIKOMISAKI" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="CT010.AMKEIJYOU" FieldOptions="" Order="0190"/><Field DataSource="CT010.AMSIHARAI" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="HORIZONTAL" Order="0170"/></Function><Function ContinueAdd="T" DataName="仕入契約商品" ID="CF013" InitialMsg="" KeyFields="" Name="仕入契約商品の保守" PrimaryTable="CT011" Size="AUTO" SubsystemID="C" Type="XF200"><Field DataSource="CT011.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(CF200),PROMPT_CALL_TO_GET(CT010.NRTORIHIKISAKI;AT030.TXKANJI),PROMPT_CALL_TO_GET_TO(CT011.NRTORIHIKISAKI;AT030.TXKANJI)" Order="0010"/><Field DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN),PROMPT_CALL_TO_GET_TO(CT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN)" Order="0030"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0040"/><Field DataSource="CT011.DTHAKKOU" FieldOptions="" Order="0050"/><Field DataSource="CT011.DTSIKKOU" FieldOptions="" Order="0060"/><Field DataSource="CT011.QTSIIRETANNI" FieldOptions="" Order="0070"/><Field DataSource="CT011.VLKANZANKEISU" FieldOptions="" Order="0090"/><Field DataSource="CT011.PRSIIRETANKA" FieldOptions="" Order="0110"/><Field DataSource="CT011.VLLEADTIME" FieldOptions="CAPTION(標準発注ＬＴ)" Order="0140"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="CT011.KBSIIREUM" FieldOptions="NO_CAPTION,HORIZONTAL,COMMENT(仕入先の出荷まるめ数と単位)" Order="0080"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/></Function><Function DetailFunction="" ID="CF200" InitialMsg="" KeyFields="" Name="仕入先検索" OrderBy="AT030.TXKANA" ParmType="COLUMNS" PrimaryTable="CT010" Size="AUTO" SubsystemID="C" Type="XF100"><Filter DataSource="AT030.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="0"/><Filter DataSource="AT020.TXKANJI" FieldOptions="SCAN,CAPTION(担当名SCAN)" Order="1"/><Column DataSource="AT030.TXKANA" FieldOptions="WIDTH(200)" Order="0020"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="WIDTH(200)" Order="0030"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(仕入担当者),WIDTH(200)" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Column DataSource="CT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050"/></Function><Function DetailFunction="DF011" ID="DF010" InitialMsg="" KeyFields="" Name="顧客データの一覧・保守" OrderBy="AT030.TXKANA" PrimaryTable="DT010" Size="AUTO" SubsystemID="D" Type="XF100"><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,CAPTION(名称SCAN)" Order="0"/><Filter DataSource="DT020.TXKAKERITSURANK" FieldOptions="PROMPT_LIST1,CAPTION(掛率ランク)" Order="1"/><Filter DataSource="AT020.TXKANJI" FieldOptions="SCAN,CAPTION(担当名SCAN)" Order="2"/><Column DataSource="DT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Column DataSource="AT030.TXKANJI" FieldOptions="WIDTH(200),CAPTION(顧客名)" Order="0030"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="WIDTH(200)" Order="0040"/><Column DataSource="DT020.TXKAKERITSURANK" FieldOptions="WIDTH(120),CAPTION(掛率ランク)" Order="0050"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(担当営業),WIDTH(150)" Order="0060"/><Column DataSource="DT010.AMGENURIKAKE" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(DF012)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT010.KBNAIKA" FieldOptions="" Order="0020"/></Function><Function HeaderFunction="DF012" HeaderKeyFields="" HeaderTable="DT010" ID="DF011" Name="顧客と関連情報の確認" Size="AUTO" SubsystemID="D" Type="XF300"><Field DataSource="DT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0030"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="CAPTION(掛率ランク),HORIZONTAL" Order="0040"/><Field DataSource="DT010.AMGENURIKAKE" FieldOptions="HORIZONTAL" Order="0060"/><Detail Caption="出荷先" DetailFunction="DF013" FixedWhere="" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="DT011"><Column DataSource="DT011.TXKANJI" FieldOptions="" Order="0020"/><Column DataSource="DT011.TXJYUSYO" FieldOptions="" Order="0030"/><Column DataSource="DT011.VLUNSOULT" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="HEADER" Caption="顧客情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(DF014)" Caption="残高確認書" Number="10" Position="5"/><Column DataSource="DT011.NRDENWA" FieldOptions="" Order="0010"/></Detail><Field DataSource="DT010.AMKISYUURIKAKE" FieldOptions="" Order="0050"/><Field DataSource="DT010.AMKEIJYOU" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="DT010.AMKAISYU" FieldOptions="HORIZONTAL" Order="0090"/><Field DataSource="DT010.TXTEKIYO" FieldOptions="" Order="0100"/><Detail Caption="売上実績" DetailFunction="DF101" FixedWhere="" InitialMsg="" KeyFields="NRTORIHIKISAKI;NRURIAGE" Order="0010" OrderBy="DT100.DTURIAGE;DT100.NRURIAGE" Table="DT100"><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="顧客情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0090"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0100"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0110"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0050"/><Column DataSource="DT100.AMNEBIKI" FieldOptions="" Order="0140"/><Column DataSource="DT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="DT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0130"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0120"/><Column DataSource="DT100.NRSEIKYU" FieldOptions="" Order="0150"/><Button Action="CALL(DF014)" Caption="残高確認書" Number="10" Position="5"/><Filter DataSource="DT100.FGVALID" FieldOptions="PROMPT_LIST1,VALUE(VALUE:T)" Order="0030"/><Filter DataSource="DT100.KBURIAGE" FieldOptions="PROMPT_LIST1" Order="0020"/><Filter DataSource="DT100.DTURIAGE" FieldOptions="GE,CAPTION(売上日≧),VALUE(SESSION_ATTRIBUTE:Date3MonthsAgo)" Order="0010"/><Column DataSource="DT100.TXSYOHIN" FieldOptions="" Order="0060"/></Detail><Detail Caption="請求実績" DetailFunction="DF113" InitialMsg="" KeyFields="NRTORIHIKISAKI;NRSEIKYU" Order="0020" Table="DT110"><Column DataSource="DT110.NRSEIKYU" FieldOptions="" Order="0020"/><Column DataSource="DT110.DTSEIKYU" FieldOptions="" Order="0010"/><Column DataSource="DT110.AMSEIKYU" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="顧客情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT110.STSEIKYU" FieldOptions="" Order="0040"/><Button Action="CALL(DF014)" Caption="残高確認書" Number="10" Position="5"/></Detail><Detail Caption="受領実績" DetailFunction="DF121" InitialMsg="" KeyFields="NRTORIHIKISAKI;NRJYURYOU" Order="0030" Table="DT120"><Column DataSource="DT120.NRJYURYOU" FieldOptions="" Order="0020"/><Column DataSource="DT120.DTJYURYOU" FieldOptions="" Order="0010"/><Column DataSource="DT120.KBNYUKINHOUHOU" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="HEADER" Caption="顧客情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(DF014)" Caption="残高確認書" Number="10" Position="5"/><Column DataSource="DT120.AMJYURYOU" FieldOptions="" Order="0040"/><Column DataSource="DT120.AMTESURYOU" FieldOptions="" Order="0050"/></Detail><Detail Caption="月次取引" DetailFunction="YF051" HeaderKeyFields="" InitialMsg="" KeyFields="NRTORIHIKISAKI;DTNEND;DTMSEQ" Order="0040" Table="YT050"><Column DataSource="YT050.AMURIKISYUZAN" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="顧客情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="YT050.DTNEND" FieldOptions="VALUE(SESSION_ATTRIBUTE:CurrentFYear)" Order="0010"/><Column DataSource="YT050.AMURISYUK" FieldOptions="" Order="0040"/><Column DataSource="YT050.AMURITYOK" FieldOptions="" Order="0050"/><Column DataSource="YT050.AMURIHENPIN" FieldOptions="" Order="0060"/><Column DataSource="YT050.AMURIZATSUEKI" FieldOptions="" Order="0070"/><Column DataSource="YT050.AMURIZATSUSON" FieldOptions="" Order="0080"/><Column DataSource="YT050.AMURISOUSAI" FieldOptions="" Order="0090"/><Column DataSource="YT050.AMURINEBIKI" FieldOptions="" Order="0100"/><Column DataSource="YT050.AMURIHANHURI" FieldOptions="" Order="0110"/><Column DataSource="YT050.AMURIJYURYO" FieldOptions="" Order="0120"/><Column DataSource="YT050.AMURIGENKA" FieldOptions="" Order="0130"/><Column DataSource="YT050.AMURITAX" FieldOptions="" Order="0140"/><Column DataSource="YT050.AMURIARARI" FieldOptions="" Order="0150"/><Column DataSource="YT050.AMURIKIMATSUZAN" FieldOptions="" Order="0160"/><Column DataSource="YT050.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT050.DTMSEQ" FieldOptions="" Order="0020"/><Button Action="CALL(DF014)" Caption="残高確認書" Number="10" Position="5"/></Detail></Function><Function ContinueAdd="T" DataName="" ID="DF012" InitialMsg="" KeyFields="" Name="顧客情報の保守" PrimaryTable="DT010" Size="AUTO" SubsystemID="D" Type="XF200"><Field DataSource="DT010.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(AF120),PROMPT_CALL_TO_GET(AT030.NRTORIHIKISAKI;AT030.TXKANJI;AT030.TXJYUSYO1),PROMPT_CALL_TO_GET_TO(DT010.NRTORIHIKISAKI;AT030.TXKANJI;AT030.TXJYUSYO1)" Order="0010"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0030"/><Field DataSource="AT030.TXJYUSYO2" FieldOptions="" Order="0040"/><Field DataSource="DT010.TXTANTOUBUSYO" FieldOptions="" Order="0050"/><Field DataSource="DT010.TXTANTOUSYA" FieldOptions="" Order="0060"/><Field DataSource="DT010.TXTANTOUSYASYOKUI" FieldOptions="CAPTION(職位)" Order="0070"/><Field DataSource="DT010.TXTANTOUSYADENWA" FieldOptions="CAPTION(電話),HORIZONTAL" Order="0080"/><Field DataSource="DT010.TXTANTOUSYAEMAIL" FieldOptions="CAPTION(メール)" Order="0090"/><Field DataSource="DT010.KBSEIKYUHOUSHIKI" FieldOptions="" Order="0110"/><Field DataSource="DT010.CDNOUHINSYOYOSHIKI" FieldOptions="HORIZONTAL(12)" Order="0120"/><Field DataSource="DT010.KBNYUKINHOUHOU" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="DT010.VLNYUKINSAITO" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="DT010.AMYOSHIN" FieldOptions="" Order="0150"/><Field DataSource="DT010.NRTANTOUJYUGYOIN" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL,PROMPT_CALL(AF110),PROMPT_CALL_TO_GET(AT020.NRJYUGYOIN;AT020.TXKANJI),PROMPT_CALL_TO_GET_TO(DT010.NRTANTOUJYUGYOIN;AT020.TXKANJI)" Order="0170"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="CAPTION(掛率ランク),PROMPT_LIST" Order="0180"/><Field DataSource="DT010.TXTEKIYO" FieldOptions="" Order="0230"/><Field DataSource="DT010.AMKISYUURIKAKE" FieldOptions="" Order="0190"/><Field DataSource="DT010.AMKAISYU" FieldOptions="HORIZONTAL" Order="0220"/><Field DataSource="DT010.AMGENURIKAKE" FieldOptions="HORIZONTAL" Order="0200"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="DT010.AMKEIJYOU" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="DT010.TXSIMEBI" FieldOptions="HORIZONTAL" Order="0100"/></Function><Function ContinueAdd="T" DataName="" ID="DF013" InitialMsg="" KeyFields="" Name="出荷先情報の保守" PrimaryTable="DT011" Size="AUTO" SubsystemID="D" Type="XF200"><Field DataSource="DT011.NRTORIHIKISAKI" FieldOptions="" Order="00"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="02"/><Field DataSource="DT011.TXKANJI" FieldOptions="" Order="03"/><Field DataSource="DT011.NRYUBIN" FieldOptions="CAPTION(〒／住所)" Order="04"/><Field DataSource="DT011.TXJYUSYO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="05"/><Field DataSource="DT011.NRDENWA" FieldOptions="" Order="06"/><Field DataSource="DT011.NRFAX" FieldOptions="HORIZONTAL" Order="07"/><Field DataSource="DT011.VLUNSOULT" FieldOptions="HORIZONTAL" Order="08"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailFunction="" ID="DF200" InitialMsg="" KeyFields="" Name="顧客検索" OrderBy="AT030.TXKANA" ParmType="COLUMNS" PrimaryTable="DT010" Size="AUTO" SubsystemID="D" Type="XF100"><Filter DataSource="AT030.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="0"/><Filter DataSource="AT020.TXKANJI" FieldOptions="SCAN,CAPTION(担当名SCAN)" Order="1"/><Column DataSource="AT030.TXKANA" FieldOptions="WIDTH(200)" Order="0020"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="WIDTH(200)" Order="0030"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(担当営業),WIDTH(200)" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Column DataSource="DT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Button Action="NULL" Caption="クリア" Number="9" Position="6"/><Column DataSource="DT010.CDKAKERITSURANK" FieldOptions="CAPTION(ランク)" Order="0050"/></Function><Function DetailFunction="ZF011" ID="ZF010" InitialListing="T" InitialMsg="" KeyFields="" Name="システム変数の一覧・保守" OrderBy="ZT010.IDVARIANT" PrimaryTable="ZT010" Size="AUTO" SubsystemID="Z" Type="XF100"><Column DataSource="ZT010.IDVARIANT" FieldOptions="" Order="0010"/><Column DataSource="ZT010.TXTYPE" FieldOptions="" Order="0050"/><Column DataSource="ZT010.TXVALUE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ZT010.TXNAME" FieldOptions="SCAN,CAPTION(変数名SCAN)" Order="0010"/><Column DataSource="ZT010.TXNAME" FieldOptions="" Order="0030"/></Function><Function ContinueAdd="T" DataName="" ID="ZF011" InitialMsg="" KeyFields="" Name="システム変数の保守" PrimaryTable="ZT010" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT010.IDVARIANT" FieldOptions="" Order="0010"/><Field DataSource="ZT010.TXTYPE" FieldOptions="" Order="0030"/><Field DataSource="ZT010.TXVALUE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ZT010.TXNAME" FieldOptions="" Order="0020"/><Field DataSource="ZT010.TXREMARKS" FieldOptions="" Order="0060"/></Function><Function DetailFunction="ZF021" ID="ZF020" InitialListing="T" InitialMsg="" KeyFields="" Name="ユーザの一覧・保守" OrderBy="ZT020.IDUSER" PrimaryTable="ZT020" Size="AUTO" SubsystemID="Z" Type="XF100"><Column DataSource="ZT020.IDUSER" FieldOptions="" Order="0010"/><Column DataSource="ZT020.TXMENUS" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ZT020.TXNAME" FieldOptions="SCAN,CAPTION(ユーザ名SCAN)" Order="0010"/><Column DataSource="ZT020.TXNAME" FieldOptions="" Order="0020"/><Column DataSource="ZT020.TXEMAIL" FieldOptions="" Order="0030"/><Column DataSource="ZT020.NREMPLOYEE" FieldOptions="" Order="0040"/></Function><Function ContinueAdd="T" DataName="ユーザ" ID="ZF021" InitialMsg="" KeyFields="" Name="ユーザの保守" PrimaryTable="ZT020" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT020.IDUSER" FieldOptions="" Order="0010"/><Field DataSource="ZT020.TXPASSWORD" FieldOptions="COMMENT(デフォルトは0000000000のハッシュ値。セッション中でユーザ自身がF12で変更できます。)" Order="0030"/><Field DataSource="ZT020.DTVALID" FieldOptions="" Order="0040"/><Field DataSource="ZT020.DTEXPIRE" FieldOptions="" Order="0050"/><Field DataSource="ZT020.TXMENUS" FieldOptions="COMMENT(メニューＩＤをコンマで区切って指定するか、ALLを指定してください。)" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ZT020.NREMPLOYEE" FieldOptions="" Order="0080"/><Field DataSource="ZT020.TXNAME" FieldOptions="" Order="0020"/><Field DataSource="ZT020.TXEMAIL" FieldOptions="" Order="0060"/></Function><Function DetailFunction="ZF031" ID="ZF030" InitialListing="T" InitialMsg="" KeyFields="" Name="採番定義の一覧・保守" OrderBy="ZT030.IDNUMBER" PrimaryTable="ZT030" Size="AUTO" SubsystemID="Z" Type="XF100"><Filter DataSource="ZT030.IDNUMBER" FieldOptions="SCAN,CAPTION(番号ＩＤ SCAN)" Order="0"/><Column DataSource="ZT030.IDNUMBER" FieldOptions="" Order="0"/><Column DataSource="ZT030.TXPREFIX" FieldOptions="" Order="1"/><Column DataSource="ZT030.NRNUMDIGIT" FieldOptions="" Order="2"/><Column DataSource="ZT030.NRCURRENT" FieldOptions="" Order="3"/><Column DataSource="ZT030.FGWITHCD" FieldOptions="CAPTION(C/D)" Order="4"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function ContinueAdd="T" DataName="採番定義" ID="ZF031" InitialMsg="" KeyFields="" Name="採番定義の保守" PrimaryTable="ZT030" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT030.IDNUMBER" FieldOptions="" Order="0"/><Field DataSource="ZT030.TXPREFIX" FieldOptions="" Order="1"/><Field DataSource="ZT030.NRNUMDIGIT" FieldOptions="" Order="2"/><Field DataSource="ZT030.NRCURRENT" FieldOptions="" Order="3"/><Field DataSource="ZT030.FGWITHCD" FieldOptions="" Order="4"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailFunction="ZF041" ID="ZF040" InitialListing="T" InitialMsg="" KeyFields="" Name="ユーザ区分定義の一覧・保守" OrderBy="ZT040.IDUSERKUBUN;ZT040.SQLIST" PrimaryTable="ZT040" Size="AUTO" SubsystemID="Z" Type="XF100"><Filter DataSource="ZT040.IDUSERKUBUN" FieldOptions="SCAN,CAPTION(区分ＩＤ SCAN)" Order="0"/><Column DataSource="ZT040.IDUSERKUBUN" FieldOptions="" Order="0"/><Column DataSource="ZT040.SQLIST" FieldOptions="" Order="1"/><Column DataSource="ZT040.KBUSERKUBUN" FieldOptions="" Order="2"/><Column DataSource="ZT040.TXUSERKUBUN" FieldOptions="" Order="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function ContinueAdd="T" DataName="" ID="ZF041" InitialMsg="" KeyFields="" Name="ユーザ区分定義の保守" PrimaryTable="ZT040" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT040.IDUSERKUBUN" FieldOptions="" Order="0"/><Field DataSource="ZT040.KBUSERKUBUN" FieldOptions="" Order="1"/><Field DataSource="ZT040.TXUSERKUBUN" FieldOptions="" Order="2"/><Field DataSource="ZT040.SQLIST" FieldOptions="" Order="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailFunction="ZF051" ID="ZF050" InitialMsg="" KeyFields="" Name="セッション状況の一覧" OrderBy="ZT050.NRSESSION(D)" ParmType="KEYS" PrimaryTable="ZT050" Size="AUTO" SubsystemID="Z" Type="XF100"><Filter DataSource="ZT050.DTLOGIN" FieldOptions="GENERIC,CAPTION(日時上位桁)" Order="0"/><Filter DataSource="ZT050.KBSESSIONSTATUS" FieldOptions="PROMPT_LIST1" Order="2"/><Column DataSource="ZT050.NRSESSION" FieldOptions="" Order="0010"/><Column DataSource="ZT050.DTLOGIN" FieldOptions="" Order="0020"/><Column DataSource="ZT050.DTLOGOUT" FieldOptions="" Order="0030"/><Column DataSource="ZT050.IDUSER" FieldOptions="CAPTION(User)" Order="0040"/><Column DataSource="ZT050.TXIPADDRESS" FieldOptions="" Order="0060"/><Column DataSource="ZT050.KBSESSIONSTATUS" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(ZF053)" Caption="LOGIN制御" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ZT020.TXNAME" FieldOptions="SCAN,CAPTION(ユーザ名SCAN)" Order="0012"/><Column DataSource="ZT020.TXNAME" FieldOptions="WIDTH(150)" Order="0050"/><Column DataSource="ZT050.VLVERSION" FieldOptions="CAPTION(処理系)" Order="0070"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="ZT050" ID="ZF051" Name="セッションと関連情報の確認" Size="AUTO" SubsystemID="Z" Type="XF300"><Field DataSource="ZT050.NRSESSION" FieldOptions="" Order="0010"/><Field DataSource="ZT050.DTLOGIN" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="ZT050.DTLOGOUT" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="ZT050.IDUSER" FieldOptions="" Order="0040"/><Field DataSource="ZT050.TXIPADDRESS" FieldOptions="HORIZONTAL(28)" Order="0070"/><Field DataSource="ZT050.KBSESSIONSTATUS" FieldOptions="" Order="0060"/><Detail Caption="機能利用履歴" DetailFunction="ZF052" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="ZT051"><Column DataSource="ZT051.DTSTART" FieldOptions="" Order="0"/><Column DataSource="ZT051.IDMENU" FieldOptions="" Order="1"/><Column DataSource="ZT051.IDPROGRAM" FieldOptions="" Order="2"/><Column DataSource="ZT051.TXPROGRAM" FieldOptions="" Order="3"/><Column DataSource="ZT051.KBPROGRAMSTATUS" FieldOptions="" Order="4"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Detail><Field DataSource="ZT020.TXNAME" FieldOptions="HORIZONTAL(14)" Order="0050"/><Field DataSource="ZT050.VLVERSION" FieldOptions="HORIZONTAL(42)" Order="0080"/></Function><Function DetailFunction="ZF061" ID="ZF060" InitialListing="T" InitialMsg="" KeyFields="" Name="消費税率の一覧・保守" OrderBy="ZT060.DTSTART" ParmType="KEYS" PrimaryTable="ZT060" Size="AUTO" SubsystemID="Z" Type="XF100"><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ZT060.DTSTART" FieldOptions="GE,CAPTION(開始日≧)" Order="0010"/><Column DataSource="ZT060.DTSTART" FieldOptions="" Order="0011"/><Column DataSource="ZT060.VLTAXRATE" FieldOptions="" Order="0021"/></Function><Function ContinueAdd="T" DataName="" ID="ZF061" InitialMsg="" KeyFields="" Name="消費税率の保守" PrimaryTable="ZT060" Size="AUTO" SubsystemID="Z" Type="XF200"><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ZT060.DTSTART" FieldOptions="" Order="0011"/><Field DataSource="ZT060.VLTAXRATE" FieldOptions="" Order="0021"/></Function><Function DetailFunction="FF013" ID="FF010" InitialMsg="" KeyFields="" Name="発注データの一覧・保守" OrderBy="" PrimaryTable="FT010" Size="AUTO" SubsystemID="F" Type="XF100"><Column DataSource="FT010.NRHATTYU" FieldOptions="" Order="0020"/><Column DataSource="FT010.DTHATTYU" FieldOptions="" Order="0010"/><Column DataSource="FT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(FF011)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名),WIDTH(250)" Order="0040"/><Filter DataSource="FT010.DTHATTYU" FieldOptions="GE,CAPTION(発注日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Column DataSource="FT010.STHATTYU" FieldOptions="" Order="0080"/><Filter DataSource="FT010.STHATTYU" FieldOptions="HORIZONTAL(127),PROMPT_LIST1" Order="0050"/><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,CAPTION(仕入先名SCAN)" Order="0030"/><Column DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(入荷予定倉庫),WIDTH(150)" Order="0070"/><Filter DataSource="FT010.NRTORIHIKISAKI" FieldOptions="" Order="0020"/><Column DataSource="FT010.NRJYUGYOIN" FieldOptions="" Order="0050"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(発注担当者),WIDTH(200)" Order="0060"/><Filter DataSource="FT010.NRJYUGYOIN" FieldOptions="VERTICAL" Order="0040"/></Function><Function DataName="" FunctionAfterInsert="FF012A" ID="FF011" InitialMsg="" KeyFields="" Name="発注見出しの保守" PrimaryTable="FT010" Size="AUTO" SubsystemID="F" Type="XF200"><Field DataSource="FT010.NRHATTYU" FieldOptions="" Order="0010"/><Field DataSource="FT010.STHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT010.DTHATTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT010.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(CF200),PROMPT_CALL_TO_GET(CT010.NRTORIHIKISAKI;AT030.TXKANJI;CT010.NRTANTOUJYUGYOIN;AT020.TXKANJI),PROMPT_CALL_TO_GET_TO(FT010.NRTORIHIKISAKI;AT030.TXKANJI;FT010.NRJYUGYOIN;AT020.TXKANJI)" Order="0040"/><Field DataSource="FT010.TXTEKIYO" FieldOptions="" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(入荷予定倉庫),PROMPT_LIST" Order="0060"/><Field DataSource="FT010.FGKAKUNIN" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="FT010.NRJYUGYOIN" FieldOptions="" Order="0080"/><Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/></Function><Function HeaderFunction="FF011" HeaderKeyFields="" HeaderTable="FT010" ID="FF013" Name="発注見出し／明細の検討" Size="AUTO" SubsystemID="F" Type="XF300"><Field DataSource="FT010.NRHATTYU" FieldOptions="" Order="0010"/><Field DataSource="FT010.STHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT010.DTHATTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT010.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="FT010.NRSOUKO" FieldOptions="CAPTION(入荷予定倉庫)" Order="0060"/><Field DataSource="FT010.TXTEKIYO" FieldOptions="" Order="0080"/><Detail Caption="発注明細" DetailFunction="FF017" InitialMsg="" KeyFields="" Order="0010" Table="FT011"><Column DataSource="FT011.PRHATTYU" FieldOptions="" Order="0030"/><Column DataSource="FT011.QTHATTYU" FieldOptions="" Order="0050"/><Column DataSource="FT011.DTKIBOUNOUKI" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="発注見出し" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(FF014)" Caption="明細追加" Number="6" Position="2"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(200)" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(150)" Order="0010"/><Button Action="CALL(FF016)" Caption="発注書" Number="10" Position="5"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0040"/><Column DataSource="FT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0070"/></Detail><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/></Function><Function DetailFunction="GF013" ID="GF010" InitialMsg="" KeyFields="" Name="受注データの一覧・保守" OrderBy="" PrimaryTable="GT010" Size="AUTO" SubsystemID="G" Type="XF100"><Column DataSource="GT010.NRJYUTYU" FieldOptions="" Order="0020"/><Column DataSource="GT010.STJYUTYU" FieldOptions="" Order="0080"/><Column DataSource="GT010.DTJYUTYU" FieldOptions="" Order="0010"/><Column DataSource="GT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(GF011)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名),WIDTH(230)" Order="0040"/><Column DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先),WIDTH(230)" Order="0050"/><Filter DataSource="GT010.STJYUTYU" FieldOptions="HORIZONTAL(111),PROMPT_LIST1" Order="0030"/><Filter DataSource="GT010.DTJYUTYU" FieldOptions="GE,CAPTION(受注日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,HORIZONTAL(111),CAPTION(顧客名SCAN)" Order="0050"/><Column DataSource="GT010.TXTYUBAN" FieldOptions="" Order="0060"/><Filter DataSource="GT010.NRTORIHIKISAKI" FieldOptions="VERTICAL" Order="0040"/><Filter DataSource="GT010.TXTYUBAN" FieldOptions="" Order="0020"/><Filter DataSource="GT010.NRMITSUMORI" FieldOptions="" Order="0060"/><Column DataSource="GT010.NRMITSUMORI" FieldOptions="" Order="0070"/></Function><Function DataName="" FunctionAfterInsert="GF012A" ID="GF011" InitialMsg="" KeyFields="" Name="受注見出しの保守" PrimaryTable="GT010" Size="AUTO" SubsystemID="G" Type="XF200"><Field DataSource="GT010.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT010.STJYUTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT010.DTJYUTYU" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="GT010.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(DF200),PROMPT_CALL_TO_GET(DT010.NRTORIHIKISAKI;AT030.TXKANJI;DT010.CDKAKERITSURANK),PROMPT_CALL_TO_GET_TO(GT010.NRTORIHIKISAKI;AT030.TXKANJI;DT010.CDKAKERITSURANK)" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先),PROMPT_LIST" Order="0080"/><Field DataSource="GT010.TXTEKIYO" FieldOptions="WIDTH(1030)" Order="0130"/><Field DataSource="GT010.TXTYUBAN" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(出荷予定倉庫),PROMPT_LIST" Order="0090"/><Field DataSource="GT010.DTTORIKESHI" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="GT010.NRMITSUMORI" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="GT010.SQVERSION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0070"/></Function><Function HeaderFunction="GF011" HeaderKeyFields="" HeaderTable="GT010" ID="GF013" Name="受注見出し／明細の検討" Size="AUTO" SubsystemID="G" Type="XF300"><Field DataSource="GT010.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT010.STJYUTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT010.DTJYUTYU" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="GT010.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="GT010.TXTEKIYO" FieldOptions="WIDTH(1010)" Order="0140"/><Detail Caption="受注明細" DetailFunction="GF017" InitialMsg="" KeyFields="" Order="0010" Table="GT011"><Column DataSource="GT011.PRJYUTYU" FieldOptions="" Order="0050"/><Column DataSource="GT011.QTJYUTYU" FieldOptions="" Order="0060"/><Column DataSource="GT011.QTSYUKKAZUMI" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(GF014)" Caption="明細追加" Number="6" Position="2"/><Button Action="HEADER" Caption="受注見出し" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(200)" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0010"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0080"/><Button Action="CALL(GF016)" Caption="注文請書" Number="10" Position="5"/><Column DataSource="BT020.PRHANBAI" FieldOptions="" Order="0040"/><Column DataSource="BT020.TXSIYOU" FieldOptions="WIDTH(200)" Order="0030"/><Column DataSource="GT011.DTKIBOUNOUKI" FieldOptions="" Order="0090"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0070"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先)" Order="0080"/><Field DataSource="DT011.VLUNSOULT" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0090"/><Field DataSource="GT010.TXTYUBAN" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT010.NRMITSUMORI" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="GT010.SQVERSION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/><Field DataSource="GT010.DTTORIKESHI" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(出荷予定倉庫)" Order="0100"/></Function><Function DataName="プログラム利用履歴" ID="ZF052" InitialMsg="" KeyFields="" Name="プログラム利用履歴の確認" PrimaryTable="ZT051" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT051.NRSESSION" FieldOptions="" Order="0010"/><Field DataSource="ZT051.SQPROGRAM" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="ZT051.IDMENU" FieldOptions="" Order="0050"/><Field DataSource="ZT051.IDPROGRAM" FieldOptions="HORIZONTAL" Order="0060"/><Field DataSource="ZT051.TXPROGRAM" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="ZT051.KBPROGRAMSTATUS" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="ZT051.TXERRORLOG" FieldOptions="ROWS(16),WIDTH(850)" Order="0090"/><Field DataSource="ZT051.DTSTART" FieldOptions="" Order="0100"/><Field DataSource="ZT051.DTEND" FieldOptions="HORIZONTAL" Order="0110"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ZT020.TXNAME" FieldOptions="WIDTH(250),HORIZONTAL" Order="0030"/></Function><Function ID="ZF053" Name="ログイン制御" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数定義 //#EOL#&#x9;//////////////#EOL#&#x9;var rZT010; var uZT010;#EOL#&#x9;var count = 0; var errorMessage = ''; var ans;#EOL##EOL#&#x9;//////////////////////////////////////////////////////////////////////////////////////#EOL#&#x9;// システム変数テーブル(ZT010)のログイン認可フラグ(LOGIN_PERMITTED)を調べて更新する //#EOL#&#x9;//////////////////////////////////////////////////////////////////////////////////////#EOL#&#x9;rZT010 = instance.createTableOperator('Select', 'ZT010');#EOL#&#x9;rZT010.addKeyValue('IDVARIANT',&#x9;'LOGIN_PERMITTED');#EOL#&#x9;if (rZT010.next()) {#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;// フラグをログイン禁止(F)として更新する //#EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;var value  = rZT010.getValueOf('TXVALUE').trim();#EOL#&#x9;&#x9;if (value == 'T') {#EOL##EOL#&#x9;&#x9;&#x9;ans = JOptionPane.showConfirmDialog(null, '新たなログインを禁止しますか？', 'LOGIN制御', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;&#x9;&#x9;if (ans == JOptionPane.OK_OPTION) {#EOL#&#x9;&#x9;&#x9;&#x9;uZT010 = instance.createTableOperator('Update', 'ZT010');#EOL#&#x9;&#x9;&#x9;&#x9;uZT010.addValue('TXVALUE',&#x9;'F');#EOL#&#x9;&#x9;&#x9;&#x9;uZT010.addKeyValue('IDVARIANT',&#x9;'LOGIN_PERMITTED');#EOL#&#x9;&#x9;&#x9;&#x9;count = uZT010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;instance.commit();#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = 'システム変数(ZT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// フラグをログイン認可(T)として更新する //#EOL#&#x9;&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (value == 'F') {#EOL#&#x9;&#x9;&#x9;&#x9;ans = JOptionPane.showConfirmDialog(null, '現在、新たなログインは禁止されています。解除しますか？', 'LOGIN制御', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;&#x9;&#x9;&#x9;if (ans == JOptionPane.OK_OPTION) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uZT010 = instance.createTableOperator('Update', 'ZT010');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uZT010.addValue('TXVALUE','T');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;uZT010.addKeyValue('IDVARIANT','LOGIN_PERMITTED');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;count = uZT010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.commit();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = 'システム変数(ZT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;JOptionPane.showMessageDialog(null, 'ログイン制御用のシステム変数(LOGIN_PERMITTED)が登録されていないので処理できません。');#EOL#&#x9;}#EOL#}" SubsystemID="Z" Type="XF000"/><Function Direction="NORMAL" ID="DF014" KeyFields="" Margins="50;50;50;50" Name="売掛残高確認書の印刷" PageSize="A4" PrimaryTable="DT010" SubsystemID="D" Type="XF290"><Phrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(お支払残高確認書)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="-18" Value="&amp;DataSource(AT030.TXKANJI)&amp;Text( 御中)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="400" Order="0150" SpacingAfter="-18" Value="&amp;Text(お支払残額)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="30" Value="&amp;Text(毎度お世話になっております。)&amp;Date(jp11)&amp;Text( 時点でのお支払残高をお知らせいたします。)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="400" Order="0090" SpacingAfter="-18" Value="&amp;Text(前期繰越額)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="320" Order="0100" SpacingAfter="0" Value="&amp;Text(￥)&amp;DataSource(DT010.AMKISYUURIKAKE;a1)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="UNDERLINE" MarginLeft="0" MarginRight="320" Order="0160" SpacingAfter="0" Value="&amp;Text(￥)&amp;DataSource(DT010.AMGENURIKAKE;a1)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="320" Order="0120" SpacingAfter="0" Value="&amp;Text(￥)&amp;DataSource(DT010.AMKEIJYOU;a1)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="320" Order="0140" SpacingAfter="0" Value="&amp;Text(￥)&amp;DataSource(DT010.AMKAISYU;a1)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="400" Order="0110" SpacingAfter="-18" Value="&amp;Text(当期お買上額)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="400" Order="0130" SpacingAfter="-18" Value="&amp;Text(当期お支払額)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="20" Value="&amp;Text(営業担当 )&amp;DataSource(AT020.TXKANJI)"/></Function><Function DetailKeyFields="" DetailTable="FT011" Direction="NORMAL" HeaderKeyFields="" HeaderTable="FT010" ID="FF016A" Margins="50;50;50;50" Name="発注書の印刷（日本語）" PageSize="A4" SubsystemID="F" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="5" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(発注書)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(注文番号 )&amp;DataSource(FT010.NRHATTYU)&amp;Text(  注文日 )&amp;DataSource(FT010.DTHATTYU)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;DataSource(AT030.TXKANJI)&amp;Text( 御中)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0090" SpacingAfter="0" Value="&amp;Leading(30)&amp;Text(毎度お世話になっております。下記の商品を注文いたします。よろしくお願いします。)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0110" SpacingAfter="0" Value="&amp;Leading(30)&amp;Text(納品先 )&amp;DataSource(BT030.TXSOUKO)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0120" SpacingAfter="0" Value="&amp;Text(　　　 )&amp;DataSource(BT030.NRYUBIN)&amp;Text( )&amp;DataSource(BT030.TXJYUSYO)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;DataSource(CT010.TXTANTOUBUSYO)&amp;Text( )&amp;DataSource(CT010.TXTANTOUSYA)&amp;Text(様)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="0" Value="&amp;Text(購買担当 )&amp;DataSource(AT020.TXKANJI)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0061" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><Detail Caption="" CaptionFontSize="12" FixedWhere="" FontID="Font0" FontSize="9" HeaderKeyFields="" KeyFields="" Order="0010" OrderBy="" RowNoWidth="5" Table="FT011"><Column Alignment="LEFT" DataSource="FT011.NRSYOHIN" FieldOptions="CAPTION(商品№)" Order="0010" Width="13"/><Column Alignment="RIGHT" DataSource="FT011.PRHATTYU" FieldOptions="" Order="0040" Width="10"/><Column Alignment="RIGHT" DataSource="FT011.QTHATTYU" FieldOptions="" Order="0050" Width="10"/><Column Alignment="CENTER" DataSource="FT011.DTKIBOUNOUKI" FieldOptions="" Order="0080" Width="15"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030" Width="32"/><Column Alignment="LEFT" DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0020" Width="10"/><Column Alignment="CENTER" DataSource="FT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0060" Width="5"/></Detail></Function><Function DetailKeyFields="" DetailTable="FT011" Direction="NORMAL" HeaderKeyFields="" HeaderTable="FT010" ID="FF016B" Margins="20;20;50;50" Name="発注書の印刷（英語）" PageSize="A4" SubsystemID="F" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="5" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(Purchase Order)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(Order No. )&amp;DataSource(FT010.NRHATTYU)&amp;Text(  Order Date )&amp;DataSource(FT010.DTHATTYU;en11)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME_ENG)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS_ENG)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;DataSource(AT030.TXKANA)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;Leading(30)&amp;Text(SHIP TO: )&amp;DataSource(BT030.TXSOUKOENG)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="0" Value="&amp;Text(　　　 )&amp;DataSource(BT030.NRYUBIN)&amp;Text( )&amp;DataSource(BT030.TXJYUSYOENG)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0051" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)"/><Detail Caption="" CaptionFontSize="12" FixedWhere="" FontID="Font0" FontSize="9" HeaderKeyFields="" KeyFields="" Order="0010" OrderBy="" RowNoWidth="5" Table="FT011"><Column Alignment="LEFT" DataSource="FT011.NRSYOHIN" FieldOptions="CAPTION(Product No)" Order="0010" Width="13"/><Column Alignment="RIGHT" DataSource="FT011.PRHATTYU" FieldOptions="CAPTION(Price)" Order="0040" Width="8"/><Column Alignment="RIGHT" DataSource="FT011.QTHATTYU" FieldOptions="CAPTION(Quantity)" Order="0060" Width="8"/><Column Alignment="CENTER" DataSource="FT011.DTKIBOUNOUKI" FieldOptions="CAPTION(Req' Due Date),EDIT_CODE(en11)" Order="0090" Width="15"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="CAPTION(Product Name)" Order="0030" Width="41"/><Column Alignment="LEFT" DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050" Width="5"/><Column Alignment="LEFT" DataSource="BT020.TXIMAGEFILENAME" FieldOptions="CAPTION( )" Order="0020" Width="10"/><Column Alignment="CENTER" DataSource="FT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0080" Width="5"/></Detail></Function><Function DetailKeyFields="" DetailTable="GT011" Direction="NORMAL" HeaderKeyFields="" HeaderTable="GT010" ID="GF016" Margins="40;40;50;50" Name="注文請書の印刷" PageSize="A4" SubsystemID="G" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="4" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(注文請書)"/><Column Alignment="RIGHT" DataSource="GT011.PRJYUTYU" FieldOptions="" Order="0040" Width="10"/><Column Alignment="RIGHT" DataSource="GT011.QTJYUTYU" FieldOptions="" Order="0050" Width="10"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;DataSource(AT030.TXKANJI)&amp;Text( 御中)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(注文番号 )&amp;DataSource(GT010.TXTYUBAN)&amp;Text(  受注日 )&amp;DataSource(GT010.DTJYUTYU)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="-18" Value="&amp;DataSource(DT010.TXTANTOUBUSYO)&amp;Text( )&amp;DataSource(DT010.TXTANTOUSYA)&amp;Text(様)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="10" Value="&amp;Text(営業担当 )&amp;DataSource(AT020.TXKANJI)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0080" SpacingAfter="0" Value="&amp;Text(毎度お世話になっております。下記の注文を承りましたので、ご確認ください。)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0090" SpacingAfter="0" Value="&amp;Text(納品先 )&amp;DataSource(DT011.TXKANJI)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0100" SpacingAfter="0" Value="&amp;Text(　　　 )&amp;DataSource(DT011.NRYUBIN)&amp;Text( )&amp;DataSource(DT011.TXJYUSYO)"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030" Width="30"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020" Width="18"/><Column Alignment="CENTER" DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0060" Width="5"/><Column Alignment="CENTER" DataSource="GT011.DTKIBOUNOUKI" FieldOptions="CAPTION(ご希望納期)" Order="0070" Width="13"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0061" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><Column Alignment="LEFT" DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0010" Width="10"/></Function><Function BatchKeyFields="NRTORIHIKISAKI;SQSYUKKASAKI;NRSOUKO" BatchRecordFunction="GF021" BatchRecordFunctionMsg="同時に出荷指示書を発行する" BatchTable="GT020" BatchWithKeyFields="GT010.NRTORIHIKISAKI;GT010.SQSYUKKASAKI;GT012.NRSOUKO" FixedWhere="NRSYUKKA = ''" ID="GF020" InitialMsg="" KeyFields="" Name="出荷指示エントリー" OrderBy="GT012.DTYOTEISYUKKA" PrimaryTable="GT012" Size="AUTO" SubsystemID="G" Type="XF110"><Column DataSource="GT012.NRJYUTYU" FieldOptions="" Order="0020"/><Column DataSource="GT012.DTYOTEISYUKKA" FieldOptions="CAPTION(出荷予定日)" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="PREV" Caption="戻る" Number="4" Position="2"/><Button Action="NEXT" Caption="次へ" Number="5" Position="4"/><Button Action="UPDATE" Caption="更新" Number="5" Position="4"/><Filter DataSource="GT012.DTYOTEISYUKKA" FieldOptions="GE,CAPTION(出荷予定日≧)" Order="0010"/><Filter DataSource="BT030.TXSOUKO" FieldOptions="PROMPT_LIST1,CAPTION(出荷予定倉庫)" Order="0020"/><Filter DataSource="AT030.TXKANA" FieldOptions="SCAN,CAPTION(顧客カナ名Scan)" Order="0040"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名),WIDTH(200)" Order="0030"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(265)" Order="0070"/><Column DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先),WIDTH(200)" Order="0040"/><BatchField DataSource="GT020.DTSYUKKA" FieldOptions="" Order="0010"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(出荷倉庫),WIDTH(150)" Order="0050"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0060"/></Function><Function DataName="" ID="FF031" InitialMsg="" KeyFields="" Name="入荷見出しの保守" PrimaryTable="FT020" Size="AUTO" SubsystemID="F" Type="XF200"><Field DataSource="FT020.NRNYUKA" FieldOptions="" Order="0010"/><Field DataSource="FT020.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="FT020.DTNYUKA" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT020.NRSOUKO" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="FT020.STNYUKA" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/></Function><Function DetailFunction="FF041" ID="FF040" InitialMsg="" KeyFields="" Name="入荷データの一覧・保守" OrderBy="FT020.DTNYUKA" ParmType="KEYS" PrimaryTable="FT020" Size="AUTO" SubsystemID="F" Type="XF100"><Column DataSource="FT020.NRNYUKA" FieldOptions="" Order="0020"/><Column DataSource="FT020.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="FT020.DTNYUKA" FieldOptions="" Order="0010"/><Column DataSource="FT020.NRSOUKO" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="FT020.NRNYUKA" FieldOptions="" Order="0010"/><Filter DataSource="FT020.NRTORIHIKISAKI" FieldOptions="" Order="0020"/><Filter DataSource="FT020.NRSOUKO" FieldOptions="" Order="0040"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0040"/><Filter DataSource="FT020.STNYUKA" FieldOptions="PROMPT_LIST1" Order="0050"/><Column DataSource="FT020.STNYUKA" FieldOptions="" Order="0070"/><Column DataSource="BT030.TXSOUKO" FieldOptions="WIDTH(150)" Order="0060"/></Function><Function HeaderFunction="FF031" HeaderKeyFields="" HeaderTable="FT020" ID="FF041" Name="入荷見出し／明細の検討" Size="AUTO" SubsystemID="F" Type="XF300"><Field DataSource="FT020.NRNYUKA" FieldOptions="" Order="0010"/><Field DataSource="FT020.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="FT020.DTNYUKA" FieldOptions="HORIZONTAL" Order="0030"/><Detail Caption="入荷明細" DetailFunction="FF042" InitialMsg="" KeyFields="NRNYUKA;NRHATTYU;SQHATTYU;SQNYUKA" Order="0010" Table="FT012"><Column DataSource="FT012.NRHATTYU" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="入荷見出し" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(FF022)" Caption="指示書発行" Number="10" Position="5"/><Column DataSource="BT020A.TXSYOHIN" FieldOptions="WIDTH(190)" Order="0030"/><Column DataSource="BT020A.TXHINBAN" FieldOptions="WIDTH(150)" Order="0020"/><Column DataSource="FT012.QTYOTEISIIRE" FieldOptions="WIDTH(110)" Order="0060"/><Column DataSource="FT012.QTJITSUSIIRE" FieldOptions="WIDTH(110)" Order="0070"/><Column DataSource="FT012.QTJITSUNYUKO" FieldOptions="WIDTH(110)" Order="0100"/><Column DataSource="BT020A.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0110"/><Column DataSource="FT012.TXLOTNUMBER" FieldOptions="WIDTH(190)" Order="0130"/><Column DataSource="FT012.NRLOCATION" FieldOptions="WIDTH(150)" Order="0120"/><Button Action="CALL(FF030)" Caption="編集" Number="5" Position="2"/><Column DataSource="FT012.PRSIIRE" FieldOptions="WIDTH(110)" Order="0040"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050"/><Column DataSource="FT012.KBSIIREUM1" FieldOptions="" Order="0090"/></Detail><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(入荷倉庫),CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0070"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="FT020.STNYUKA" FieldOptions="HORIZONTAL" Order="0020"/></Function><Function DetailKeyFields="NRNYUKA;NRHATTYU;SQHATTYU;SQNYUKA" DetailTable="FT012" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="FT020" ID="FF022" Margins="20;20;50;50" Name="倉入指示書の印刷" PageSize="A4" SubsystemID="F" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="3" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(倉入指示書)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(入荷№　)&amp;DataSource(FT020.NRNYUKA)&amp;Text(　　入荷日 )&amp;DataSource(FT020.DTNYUKA;jp11)&amp;Text(　　倉庫 )&amp;DataSource(FT020.NRSOUKO)&amp;Text( )&amp;DataSource(BT030.TXSOUKO)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;Text(仕入先　)&amp;DataSource(FT020.NRTORIHIKISAKI)&amp;Text( )&amp;DataSource(AT030.TXKANJI)"/><Detail Caption="" CaptionFontSize="12" FixedWhere="" FontID="Font0" FontSize="9" HeaderKeyFields="" KeyFields="NRNYUKA;NRHATTYU;SQHATTYU;SQNYUKA" Order="0010" OrderBy="" RowNoWidth="3" Table="FT012"><Column Alignment="LEFT" DataSource="FT012.NRHATTYU" FieldOptions="" Order="0010" Width="6"/><Column Alignment="LEFT" DataSource="BT020A.TXSYOHIN" FieldOptions="" Order="0040" Width="23"/><Column Alignment="LEFT" DataSource="BT020A.TXHINBAN" FieldOptions="" Order="0030" Width="9"/><Column Alignment="CENTER" DataSource="BT020A.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090" Width="4"/><Column Alignment="LEFT" DataSource="BT020A.TXIMAGEFILENAME" FieldOptions="" Order="0020" Width="5"/><Column Alignment="LEFT" DataSource="ET010.NRLOCATION" FieldOptions="" Order="0100" Width="7"/><Column Alignment="RIGHT" DataSource="FT012.QTYOTEISIIRE" FieldOptions="" Order="0050" Width="7"/><Column Alignment="RIGHT" DataSource="FT012.QTYOTEINYUKO" FieldOptions="" Order="0080" Width="7"/><Column Alignment="LEFT" DataSource="FT012.TXLOTNUMBER" FieldOptions="" Order="0110" Width="25"/><Column Alignment="CENTER" DataSource="FT012.KBSIIREUM1" FieldOptions="" Order="0070" Width="4"/></Detail></Function><Function DetailFunction="FF021" ID="FF020" InitialMsg="" KeyFields="" Name="入荷指示エントリー／仕入先の選択" OrderBy="AT030.TXKANA" ParmType="KEYS" PrimaryTable="CT010" Size="AUTO" SubsystemID="F" Type="XF100"><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,CAPTION(名称SCAN)" Order="0010"/><Column DataSource="CT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="CT010.NRTANTOUJYUGYOIN" FieldOptions="VALUE(USER_ATTRIBUTE:EmployeeNo)" Order="0020"/><Column DataSource="CT010.NRTANTOUJYUGYOIN" FieldOptions="" Order="0040"/></Function><Function BatchKeyFields="NRTORIHIKISAKI" BatchRecordFunction="FF022" BatchRecordFunctionMsg="同時に倉入指示書を発行する" BatchTable="FT020" BatchWithKeyFields="FT010.NRTORIHIKISAKI" FixedWhere="NRNYUKA = ''" ID="FF021" InitialMsg="" KeyFields="" Name="入荷指示エントリー／入荷明細の選択・更新" OrderBy="FT012.DTYOTEINYUKA;FT012.NRHATTYU;FT012.SQHATTYU" PrimaryTable="FT012" Size="AUTO" SubsystemID="F" Type="XF110"><Column DataSource="FT012.DTYOTEINYUKA" FieldOptions="LIST1" Order="0010"/><Column DataSource="FT012.NRHATTYU" FieldOptions="" Order="0020"/><Column DataSource="FT012.SQHATTYU" FieldOptions="" Order="0040"/><Column DataSource="BT020A.TXHINBAN" FieldOptions="CAPTION(入荷品番)" Order="0050"/><Column DataSource="BT020A.TXSYOHIN" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="PREV" Caption="戻る" Number="4" Position="2"/><Button Action="NEXT" Caption="次へ" Number="5" Position="4"/><Button Action="UPDATE" Caption="更新" Number="5" Position="4"/><Filter DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名),NON_EDITABLE" Order="0020"/><BatchField DataSource="FT020.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><BatchField DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><BatchField DataSource="FT020.DTNYUKA" FieldOptions="" Order="0030"/><BatchField DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(実際入荷倉庫),HORIZONTAL,PROMPT_LIST" Order="0050"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT030A.TXSOUKO" FieldOptions="CAPTION(入荷予定倉庫),WIDTH(150)" Order="0030"/><Column DataSource="FT012.QTYOTEISIIRE" FieldOptions="" Order="0070"/><Column DataSource="FT012.KBSIIREUM1" FieldOptions="" Order="0090"/></Function><Function ID="GF031" InitialMsg="" KeyFields="" Name="出荷見出しの保守" PrimaryTable="GT020" Size="AUTO" SubsystemID="G" Type="XF200"><Field DataSource="GT020.NRSYUKKA" FieldOptions="" Order="0010"/><Field DataSource="GT020.NRTORIHIKISAKI" FieldOptions="" Order="0070"/><Field DataSource="GT020.NRSOUKO" FieldOptions="" Order="0050"/><Field DataSource="GT020.DTSYUKKA" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT020.NRSEIKYU" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="GT020.TMHAKKOU" FieldOptions="" Order="0130"/><Field DataSource="GT020.TMKANRYO" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="GT020.STSYUKKA" FieldOptions="HORIZONTAL" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT030GT020.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="AT030GT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="DT011GT020.TXKANJI" FieldOptions="CAPTION(出荷先)" Order="0100"/><Field DataSource="GT020.TXTEKIYO" FieldOptions="" Order="0120"/></Function><Function DetailFunction="GF041" ID="GF040" InitialMsg="" KeyFields="" Name="出荷データの一覧・保守" OrderBy="" PrimaryTable="GT020" Size="AUTO" SubsystemID="G" Type="XF100"><Column DataSource="GT020.NRSYUKKA" FieldOptions="" Order="0020"/><Column DataSource="GT020.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="GT020.NRSOUKO" FieldOptions="" Order="0050"/><Column DataSource="GT020.DTSYUKKA" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="GT020.NRSYUKKA" FieldOptions="" Order="0010"/><Filter DataSource="GT020.NRTORIHIKISAKI" FieldOptions="" Order="0020"/><Filter DataSource="GT020.STSYUKKA" FieldOptions="PROMPT_LIST1" Order="0040"/><Filter DataSource="GT020.NRSOUKO" FieldOptions="" Order="0030"/><Column DataSource="GT020.STSYUKKA" FieldOptions="" Order="0070"/><Column DataSource="BT030GT020.TXSOUKO" FieldOptions="WIDTH(150)" Order="0060"/><Column DataSource="AT030GT020.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0040"/></Function><Function HeaderFunction="GF031" HeaderKeyFields="" HeaderTable="GT020" ID="GF041" Name="出荷見出し／明細の検討" Size="AUTO" SubsystemID="G" Type="XF300"><Field DataSource="GT020.NRSYUKKA" FieldOptions="" Order="0010"/><Field DataSource="GT020.NRTORIHIKISAKI" FieldOptions="" Order="0070"/><Field DataSource="GT020.NRSOUKO" FieldOptions="" Order="0050"/><Field DataSource="GT020.DTSYUKKA" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT020.NRSEIKYU" FieldOptions="HORIZONTAL" Order="0040"/><Detail Caption="出荷明細" DetailFunction="GF042" InitialMsg="" KeyFields="NRSYUKKA;NRJYUTYU;SQJYUTYU;SQSYUKKA" Order="0010" Table="GT012"><Column DataSource="GT012.NRJYUTYU" FieldOptions="" Order="0010"/><Column DataSource="GT012.DTYOTEISYUKKA" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="出荷見出し" Number="7" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="GT012.QTYOTEISYUKKA" FieldOptions="CAPTION(出荷指示数)" Order="0050"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0040"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0030"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Button Action="CALL(GF032)" Caption="納品書発行" Number="11" Position="5"/><Button Action="CALL(GF021)" Caption="指示書発行" Number="10" Position="4"/><Column DataSource="GT012.QTTORIKESHI" FieldOptions="" Order="0080"/><Column DataSource="GT012.QTJITSUSYUKKA" FieldOptions="" Order="0070"/><Button Action="CALL(GF030)" Caption="実績登録" Number="8" Position="3"/></Detail><Field DataSource="GT020.TMHAKKOU" FieldOptions="" Order="0110"/><Field DataSource="GT020.TMKANRYO" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="BT030GT020.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="AT030GT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="DT011GT020.TXKANJI" FieldOptions="CAPTION(出荷先)" Order="0090"/><Field DataSource="GT020.TXTEKIYO" FieldOptions="" Order="0100"/><Field DataSource="GT020.STSYUKKA" FieldOptions="HORIZONTAL" Order="0030"/></Function><Function ContinueAdd="" FunctionAfterInsert="HF012" ID="HF011" InitialMsg="" KeyFields="" Name="仕入振替の保守" PrimaryTable="HT010" Size="AUTO" SubsystemID="H" Type="XF200"><Field DataSource="HT010.NRSIIREHURIKAE" FieldOptions="" Order="0010"/><Field DataSource="HT010.KBSIIREHURIKAE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="HT010.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="HT010.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(CF200),PROMPT_CALL_TO_GET(CT010.NRTORIHIKISAKI;AT030.TXKANJI;AT030.KBCURRENCY),PROMPT_CALL_TO_GET_TO(HT010.NRTORIHIKISAKI;AT030.TXKANJI;AT030.KBCURRENCY)" Order="0040"/><Field DataSource="HT010.AMTORIHIKI" FieldOptions="" Order="0060"/><Field DataSource="HT010.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0090"/><Field DataSource="HT010.TXTEKIYO" FieldOptions="" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="HT010.AMTORIHIKINAIKA" FieldOptions="HORIZONTAL(30)" Order="0080"/></Function><Function DetailFunction="CF101" ID="CF100" InitialMsg="" KeyFields="" Name="買掛増減履歴データの一覧" OrderBy="CT100.DTSIIRE(D)" PrimaryTable="CT100" Size="AUTO" SubsystemID="C" Type="XF100"><Filter DataSource="CT100.DTSIIRE" FieldOptions="GE,CAPTION(仕入日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0"/><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,CAPTION(仕入先名SCAN)" Order="0"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="0"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0020"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0030"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0050"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名),WIDTH(190)" Order="0070"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(150)" Order="0090"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0110"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.DTMSEQ" FieldOptions="" Order="0080"/><Filter DataSource="CT100.FGVALID" FieldOptions="PROMPT_LIST1,VALUE(VALUE:T)" Order="0010"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0040"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0120"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0130"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0140"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="WIDTH(190)" Order="0100"/><Column DataSource="CT100.NRTORIHIKISAKI" FieldOptions="" Order="0060"/></Function><Function DetailFunction="CF111B" ID="CF111A" InitialMsg="" KeyFields="" Name="支払依頼エントリー／仕入先の選択" OrderBy="AT030.TXKANA" ParmType="COLUMNS" PrimaryTable="CT010" Size="AUTO" SubsystemID="C" Type="XF100"><Column DataSource="CT010.NRTORIHIKISAKI" FieldOptions="" Order="0000"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,CAPTION(名称SCAN)" Order="0010"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0050"/><Column DataSource="AT030.TXJYUSYO1" FieldOptions="" Order="0060"/></Function><Function BatchKeyFields="NRTORIHIKISAKI" BatchTable="CT110" BatchWithKeyFields="CT100.NRTORIHIKISAKI" FixedWhere="NRSIHARAIIRAI = '' and FGVALID = 'T' and KBSIIRE != '90'" ID="CF111B" InitialMsg="" KeyFields="" Name="支払依頼エントリー／仕入実績の選択" OrderBy="" PrimaryTable="CT100" Size="AUTO" SubsystemID="C" Type="XF110"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0030"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="PREV" Caption="戻る" Number="4" Position="2"/><Button Action="NEXT" Caption="次へ" Number="5" Position="4"/><Button Action="UPDATE" Caption="更新" Number="5" Position="4"/><Filter DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名),NON_EDITABLE" Order="0070"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0090"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><BatchField DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><BatchField DataSource="CT110.TXSEIKYUNO" FieldOptions="CAPTION(請求番号),HORIZONTAL" Order="0040"/><BatchField DataSource="CT110.TXTEKIYO" FieldOptions="" Order="0110"/><BatchField DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0050"/><BatchField DataSource="CT110AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><BatchField DataSource="CT110.DTSIHARAIIRAI" FieldOptions="" Order="0030"/><BatchField DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0060"/><BatchField DataSource="CT110.AMTAX" FieldOptions="HORIZONTAL" Order="0100"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0120"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0070"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0110"/><BatchField DataSource="CT110AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0080"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="" Order="0050"/></Function><Function DetailFunction="CF112" ID="CF110" InitialMsg="" KeyFields="" Name="支払依頼データの一覧・保守" OrderBy="" PrimaryTable="CT110" Size="AUTO" SubsystemID="C" Type="XF100"><Column DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Column DataSource="CT110.DTSIHARAIIRAI" FieldOptions="CAPTION(支払依頼日)" Order="0030"/><Column DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="CT110.NRSIHARAIIRAI" FieldOptions="HORIZONTAL(44)" Order="0020"/><Filter DataSource="CT110.DTSIHARAIIRAI" FieldOptions="GE,CAPTION(依頼日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Filter DataSource="CT110.TXSEIKYUNO" FieldOptions="VERTICAL,CAPTION(請求番号)" Order="0040"/><Filter DataSource="CT110.FGSYOUNIN" FieldOptions="PROMPT_LIST1,CAPTION(承認区分)" Order="0050"/><Column DataSource="CT110AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0050"/><Column DataSource="CT110.FGSYOUNIN" FieldOptions="CAPTION(承認状況)" Order="0100"/><Column DataSource="CT110.AMTAX" FieldOptions="" Order="0090"/><Column DataSource="CT110.TXSEIKYUNO" FieldOptions="CAPTION(請求番号)" Order="0020"/><Column DataSource="CT110.AMSIHARAI" FieldOptions="CAPTION(支払額)" Order="0060"/><Column DataSource="CT110AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0070"/></Function><Function DataName="仕入返品" FunctionAfterInsert="HF023A" ID="HF021C" InitialMsg="＊返品額と出庫額との差は雑損処理されます。" KeyFields="" Name="仕入返品の保守" PrimaryTable="HT020" Size="AUTO" SubsystemID="H" Type="XF200"><Field DataSource="HT020.NRTOKUSYUSIIRE" FieldOptions="" Order="0010"/><Field DataSource="HT020.KBTOKUSYUSIIRE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="HT020.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(CF200),PROMPT_CALL_TO_GET(CT010.NRTORIHIKISAKI;AT030.TXKANJI),PROMPT_CALL_TO_GET_TO(HT020.NRTORIHIKISAKI;AT030.TXKANJI)" Order="0040"/><Field DataSource="HT020.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="HT020.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="HT020.AMTORIHIKI" FieldOptions="CAPTION(税抜返品額)" Order="0180"/><Field DataSource="HT020.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0210"/><Field DataSource="HT020.TXTEKIYO" FieldOptions="" Order="0220"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN),PROMPT_CALL_TO_GET_TO(HT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN)" Order="0060"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),PROMPT_LIST" Order="0080"/><Field DataSource="HT020.PRTORIHIKI" FieldOptions="CAPTION(返品単価)" Order="0150"/><Field DataSource="HT020.QTTORIHIKI" FieldOptions="CAPTION(返品数量)" Order="0110"/><Field DataSource="HT020.KBTORIHIKIUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/><Field DataSource="HT020.QTTORIHIKIKANZAN" FieldOptions="HORIZONTAL(6)" Order="0130"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0140"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0160"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0190"/><Field DataSource="HT020.PRUKEBARAI" FieldOptions="CAPTION(内貨出庫単価),HORIZONTAL" Order="0170"/><Field DataSource="HT020.AMTORIHIKINAIKA" FieldOptions="CAPTION(内貨税抜返品額),HORIZONTAL" Order="0200"/><Field DataSource="HT020.TXLOTNUMBER" FieldOptions="" Order="0100"/></Function><Function DataName="直接入荷" FunctionAfterInsert="HF023B" ID="HF021D" InitialMsg="" KeyFields="" Name="直接入荷の保守" PrimaryTable="HT020" Size="AUTO" SubsystemID="H" Type="XF200"><Field DataSource="HT020.NRTOKUSYUSIIRE" FieldOptions="" Order="0010"/><Field DataSource="HT020.KBTOKUSYUSIIRE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="HT020.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(CF200),PROMPT_CALL_TO_GET(CT010.NRTORIHIKISAKI;AT030.TXKANJI),PROMPT_CALL_TO_GET_TO(HT020.NRTORIHIKISAKI;AT030.TXKANJI)" Order="0040"/><Field DataSource="HT020.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="HT020.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL,PROMPT_CALL(BF110),PROMPT_CALL_TO_PUT(HT020.NRSOUKO),PROMPT_CALL_TO_PUT_TO(BT030.NRSOUKO),PROMPT_CALL_TO_GET(BT031.NRLOCATION),PROMPT_CALL_TO_GET_TO(HT020.NRLOCATION)" Order="0090"/><Field DataSource="HT020.AMTORIHIKI" FieldOptions="CAPTION(税抜仕入額)" Order="0190"/><Field DataSource="HT020.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0220"/><Field DataSource="HT020.TXTEKIYO" FieldOptions="" Order="0230"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(CF210),PROMPT_CALL_TO_PUT(HT020.NRTORIHIKISAKI;HT020.DTTORIHIKI;HT020.DTTORIHIKI),PROMPT_CALL_TO_PUT_TO(CT010.NRTORIHIKISAKI;CT011.DTHAKKOU;CT011.DTSIKKOU),PROMPT_CALL_TO_GET(CT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;CT011.KBSIIREUM),PROMPT_CALL_TO_GET_TO(HT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;HT020.KBSIIREUM)" Order="0060"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),PROMPT_LIST" Order="0080"/><Field DataSource="HT020.QTTORIHIKI" FieldOptions="CAPTION(検収数量)" Order="0110"/><Field DataSource="HT020.QTTORIHIKIKANZAN" FieldOptions="HORIZONTAL(26)" Order="0140"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Field DataSource="HT020.PRTORIHIKI" FieldOptions="CAPTION(仕入単価)" Order="0160"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0170"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0200"/><Field DataSource="HT020.TXLOTNUMBER" FieldOptions="" Order="0100"/><Field DataSource="HT020.PRUKEBARAI" FieldOptions="CAPTION(入庫単価),HORIZONTAL" Order="0180"/><Field DataSource="HT020.AMTORIHIKINAIKA" FieldOptions="CAPTION(内貨税抜仕入額),HORIZONTAL" Order="0210"/><Field DataSource="HT020.KBSIIREUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/></Function><Function ID="HF021A" Name="特殊仕入の追加(切替)" Script="var dialog = session.getOptionDialog();#EOL#dialog.addOption('仕入返品'); // 0 //#EOL#dialog.addOption('直接入荷'); // 1 //#EOL#dialog.addOption('閉じる');   // 2 //#EOL#var reply = dialog.request('取引区分選択');#EOL#if (reply == 0) {#EOL#    instance.parmMap.put('KBTOKUSYUSIIRE', '10');#EOL#    instance.callFunction('HF021C'); //仕入返品の保守（追加モード）//#EOL#}#EOL#if (reply == 1) {#EOL#    instance.parmMap.put('KBTOKUSYUSIIRE', '20');#EOL#    instance.callFunction('HF021D'); //直接入荷の保守（追加モード）//#EOL#}#EOL#if (reply == 2 || reply == -1) {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}" SubsystemID="H" Type="XF000"/><Function DetailFunction="CF133" ID="CF130" InitialMsg="" KeyFields="" Name="支払指示データの一覧・保守" OrderBy="" PrimaryTable="CT120" Size="AUTO" SubsystemID="C" Type="XF100"><Column DataSource="CT120.NRSIHARAI" FieldOptions="" Order="0010"/><Column DataSource="CT120.DTSIHARAI" FieldOptions="" Order="0020"/><Column DataSource="CT120.KBSIHARAIHOUHOU" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="CT120.DTSIHARAI" FieldOptions="GE,CAPTION(支払日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0001"/><Column DataSource="CT120.AMSIHARAI" FieldOptions="" Order="0040"/><Column DataSource="CT120.AMNAIKASIHARAI" FieldOptions="" Order="0060"/><Button Action="CALL(CF131)" Caption="追加" Number="6" Position="3"/><Column DataSource="CT120.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050"/><Column DataSource="CT120.AMTESURYO" FieldOptions="" Order="0070"/></Function><Function BatchKeyFields="KBSIHARAIHOUHOU;KBCURRENCY" BatchRecordFunction="CF135" BatchRecordFunctionMsg="支払指示書を発行する" BatchTable="CT120" BatchWithKeyFields="CT110.KBSIHARAIHOUHOU;CT110AT030.KBCURRENCY" FixedWhere="NRSIHARAI = '' and FGSYOUNIN = 'T'" ID="CF131" InitialListing="T" InitialMsg="＊更新ボタンを押せば、支払指示が新規作成されると同時に、関連する仕入先の買掛残高が減額されます。" KeyFields="" Name="支払指示エントリー" OrderBy="" PrimaryTable="CT110" Size="AUTO" SubsystemID="C" Type="XF110"><Column DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Column DataSource="CT110.DTSIHARAIIRAI" FieldOptions="" Order="0030"/><Column DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Column DataSource="CT110.TXSEIKYUNO" FieldOptions="CAPTION(請求番号)" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="PREV" Caption="戻る" Number="4" Position="2"/><Button Action="NEXT" Caption="次へ" Number="5" Position="4"/><Button Action="UPDATE" Caption="更新" Number="5" Position="4"/><Column DataSource="CT110AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0050"/><BatchField DataSource="CT120.DTSIHARAI" FieldOptions="" Order="0001"/><Column DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="CAPTION(支払方法)" Order="0020"/><Filter DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="PROMPT_LIST1,CAPTION(支払方法)" Order="0001"/><Column DataSource="CT110.AMTAX" FieldOptions="" Order="0090"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0060"/><Column DataSource="CT110AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0070"/></Function><Function ID="CF132" InitialMsg="＊入力された為替差額や手数料に関しては、会計システムであらためて仕訳計上する必要があります。" KeyFields="" Name="支払指示データの保守" PrimaryTable="CT120" Size="AUTO" SubsystemID="C" Type="XF200"><Field DataSource="CT120.NRSIHARAI" FieldOptions="" Order="0010"/><Field DataSource="CT120.DTSIHARAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT120.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT120.TXTEKIYO" FieldOptions="" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="CT120.AMNAIKASIHARAI" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="CT120.AMSIHARAI" FieldOptions="" Order="0040"/><Field DataSource="CT120.AMTESURYO" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(40)" Order="0090"/><Field DataSource="CT120.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/></Function><Function HeaderFunction="CF132" HeaderKeyFields="" HeaderTable="CT120" ID="CF133" Name="支払指示データの検討" Size="AUTO" SubsystemID="C" Type="XF300"><Field DataSource="CT120.NRSIHARAI" FieldOptions="" Order="0010"/><Field DataSource="CT120.DTSIHARAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT120.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT120.TXTEKIYO" FieldOptions="" Order="0100"/><Detail Caption="支払依頼" DetailFunction="CF134" InitialMsg="" KeyFields="NRSIHARAI;NRSIHARAIIRAI" Order="0010" ParmAdditional="INSTANCE_MODE:EDIT" Table="CT110"><Column DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Column DataSource="CT110.TXSEIKYUNO" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="支払指示情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT110AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020"/><Column DataSource="CT110CT010.TXHURIKOMISAKI" FieldOptions="" Order="0040"/><Column DataSource="CT110.AMTAX" FieldOptions="" Order="0080"/><Column DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0050"/><Button Action="CALL(CF135)" Caption="支払指示書" Number="10" Position="5"/><Column DataSource="CT110AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0060"/></Detail><Field DataSource="CT120.AMSIHARAI" FieldOptions="" Order="0040"/><Field DataSource="CT120.AMNAIKASIHARAI" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="CT120.AMTESURYO" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(40)" Order="0090"/><Field DataSource="CT120.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/></Function><Function HeaderFunction="HF011" HeaderKeyFields="" HeaderTable="HT010" ID="HF012" Name="仕入振替別取引実績の検討" Size="AUTO" SubsystemID="H" Type="XF300"><Field DataSource="HT010.NRSIIREHURIKAE" FieldOptions="" Order="0010"/><Field DataSource="HT010.KBSIIREHURIKAE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="HT010.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="HT010.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="HT010.AMTORIHIKI" FieldOptions="" Order="0060"/><Field DataSource="HT010.TXTEKIYO" FieldOptions="" Order="0100"/><Detail Caption="買掛増減履歴" DetailFunction="CF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRSIIRE" Order="0010" Table="CT100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0050"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="仕入振替情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0060"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0090"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0070"/></Detail><Field DataSource="HT010.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0090"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="HT010.AMTORIHIKINAIKA" FieldOptions="HORIZONTAL(30)" Order="0080"/></Function><Function DetailFunction="HF012" ID="HF010" InitialMsg="" KeyFields="NRSIIREHURIKAE" Name="仕入振替データの一覧・保守" OrderBy="" PrimaryTable="HT010" Size="AUTO" SubsystemID="H" Type="XF100"><Column DataSource="HT010.NRSIIREHURIKAE" FieldOptions="" Order="0020"/><Column DataSource="HT010.KBSIIREHURIKAE" FieldOptions="" Order="0030"/><Column DataSource="HT010.DTTORIHIKI" FieldOptions="" Order="0010"/><Column DataSource="HT010.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Column DataSource="HT010.AMTORIHIKI" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(HF011)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="HT010.KBSIIREHURIKAE" FieldOptions="PROMPT_LIST1" Order="0020"/><Filter DataSource="HT010.DTTORIHIKI" FieldOptions="GE,CAPTION(取引日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="HT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0050"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0070"/></Function><Function DetailFunction="HF023" ID="HF020" InitialMsg="" KeyFields="" Name="特殊仕入データの一覧・保守" OrderBy="" PrimaryTable="HT020" Size="AUTO" SubsystemID="H" Type="XF100"><Column DataSource="HT020.NRTOKUSYUSIIRE" FieldOptions="" Order="0020"/><Column DataSource="HT020.KBTOKUSYUSIIRE" FieldOptions="" Order="0030"/><Column DataSource="HT020.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Column DataSource="HT020.DTTORIHIKI" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(HF021A)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="HT020.KBTOKUSYUSIIRE" FieldOptions="PROMPT_LIST1" Order="0020"/><Filter DataSource="HT020.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Filter DataSource="HT020.DTTORIHIKI" FieldOptions="GE,CAPTION(取引日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0050"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0070"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0060"/><Column DataSource="HT020.QTTORIHIKI" FieldOptions="" Order="0080"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/></Function><Function ID="CF121" InitialMsg="" KeyFields="" Name="支払依頼データの保守" PrimaryTable="CT110" Size="AUTO" SubsystemID="C" Type="XF200"><Field DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Field DataSource="CT110.DTSIHARAIIRAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="CT110.TXSEIKYUNO" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT110.TXTEKIYO" FieldOptions="" Order="0130"/><Field DataSource="CT110.FGSYOUNIN" FieldOptions="CAPTION(承認状況),HORIZONTAL" Order="0120"/><Field DataSource="CT110.NRSIHARAI" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0070"/><Field DataSource="CT110.AMTAX" FieldOptions="HORIZONTAL" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="CT110AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="CT110AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/></Function><Function DetailFunction="JF012" ID="JF010" InitialMsg="" KeyFields="" Name="売上振替データの一覧・保守" OrderBy="" PrimaryTable="JT010" Size="AUTO" SubsystemID="J" Type="XF100"><Column DataSource="JT010.NRURIAGEHURIKAE" FieldOptions="" Order="0020"/><Column DataSource="JT010.KBURIAGEHURIKAE" FieldOptions="" Order="0030"/><Column DataSource="JT010.DTTORIHIKI" FieldOptions="" Order="0010"/><Column DataSource="JT010.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Column DataSource="JT010.AMTORIHIKI" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(JF011)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="JT010.KBURIAGEHURIKAE" FieldOptions="PROMPT_LIST1" Order="0020"/><Filter DataSource="JT010.DTTORIHIKI" FieldOptions="GE,CAPTION(取引日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="JT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0050"/></Function><Function FunctionAfterInsert="JF012" ID="JF011" InitialMsg="" KeyFields="" Name="売上振替の保守" PrimaryTable="JT010" Size="AUTO" SubsystemID="J" Type="XF200"><Field DataSource="JT010.NRURIAGEHURIKAE" FieldOptions="" Order="0010"/><Field DataSource="JT010.KBURIAGEHURIKAE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="JT010.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="JT010.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(DF200),PROMPT_CALL_TO_GET(DT010.NRTORIHIKISAKI;AT030.TXKANJI),PROMPT_CALL_TO_GET_TO(JT010.NRTORIHIKISAKI;AT030.TXKANJI)" Order="0040"/><Field DataSource="JT010.AMTORIHIKI" FieldOptions="" Order="0060"/><Field DataSource="JT010.TXTEKIYO" FieldOptions="COMMENT(*請求書上の明細摘要として示されます。)" Order="0090"/><Field DataSource="JT010.AMTAX" FieldOptions="HORIZONTAL" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="JT010.NRSEIKYU" FieldOptions="HORIZONTAL" Order="0080"/></Function><Function HeaderFunction="JF011" HeaderKeyFields="" HeaderTable="JT010" ID="JF012" Name="売上振替別取引実績の検討" Size="AUTO" SubsystemID="J" Type="XF300"><Field DataSource="JT010.NRURIAGEHURIKAE" FieldOptions="" Order="0010"/><Field DataSource="JT010.KBURIAGEHURIKAE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="JT010.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="JT010.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="JT010.AMTORIHIKI" FieldOptions="" Order="0060"/><Field DataSource="JT010.TXTEKIYO" FieldOptions="" Order="0090"/><Detail Caption="売掛増減履歴" DetailFunction="DF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRURIAGE" Order="0010" Table="DT100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="DT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0050"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="売上振替情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0060"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0070"/><Column DataSource="DT100.NRSEIKYU" FieldOptions="" Order="0080"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="JT010.AMTAX" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="JT010.NRSEIKYU" FieldOptions="HORIZONTAL" Order="0080"/></Function><Function DetailFunction="JF023" ID="JF020" InitialMsg="" KeyFields="" Name="特殊売上データの一覧・保守" OrderBy="" PrimaryTable="JT020" Size="AUTO" SubsystemID="J" Type="XF100"><Column DataSource="JT020.NRTOKUSYUURIAGE" FieldOptions="" Order="0020"/><Column DataSource="JT020.KBTOKUSYUURIAGE" FieldOptions="" Order="0030"/><Column DataSource="JT020.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Column DataSource="JT020.DTTORIHIKI" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(JF021A)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="JT020.DTTORIHIKI" FieldOptions="GE,CAPTION(取引日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0001"/><Filter DataSource="JT020.KBTOKUSYUURIAGE" FieldOptions="PROMPT_LIST1" Order="0002"/><Filter DataSource="JT020.NRTORIHIKISAKI" FieldOptions="" Order="0002"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="" Order="0002"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0050"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0070"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0060"/><Column DataSource="JT020.QTTORIHIKI" FieldOptions="" Order="0090"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Column DataSource="JT020.PRTORIHIKI" FieldOptions="" Order="0080"/></Function><Function DetailFunction="GF053" ID="GF050" InitialMsg="" KeyFields="" Name="見積データの一覧・保守" OrderBy="" PrimaryTable="GT030" Size="AUTO" SubsystemID="G" Type="XF100"><Column DataSource="GT030.NRMITSUMORI" FieldOptions="" Order="0020"/><Column DataSource="GT030.SQVERSION" FieldOptions="" Order="0030"/><Column DataSource="GT030.DTMITSUMORI" FieldOptions="" Order="0010"/><Column DataSource="GT030.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(GF051)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="GT030.NRMITSUMORI" FieldOptions="" Order="0010"/><Filter DataSource="GT030.DTMITSUMORI" FieldOptions="" Order="0020"/><Filter DataSource="GT030.TXTYUBAN" FieldOptions="" Order="0030"/><Column DataSource="GT030.TXWORK" FieldOptions="CAPTION(顧客名)" Order="0050"/><Column DataSource="GT030.TXTYUBAN" FieldOptions="" Order="0060"/><Filter DataSource="GT030.TXWORK" FieldOptions="SCAN,CAPTION(顧客名SCAN)" Order="0031"/><Column DataSource="GT030.NRJYUTYU" FieldOptions="" Order="0070"/></Function><Function FunctionAfterInsert="GF052" ID="GF051" InitialMsg="" KeyFields="" Name="見積見出しの追加" PrimaryTable="GT030" Size="AUTO" SubsystemID="G" Type="XF200"><Field DataSource="GT030.NRMITSUMORI" FieldOptions="" Order="0010"/><Field DataSource="GT030.SQVERSION" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT030.DTMITSUMORI" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="GT030.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(DF200),PROMPT_CALL_TO_GET(DT010.NRTORIHIKISAKI;AT030.TXKANJI;DT010.CDKAKERITSURANK),PROMPT_CALL_TO_GET_TO(GT030.NRTORIHIKISAKI;AT030.TXKANJI;DT010.CDKAKERITSURANK)" Order="0050"/><Field DataSource="GT030.TXTYUBAN" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT030.TXTEKIYO" FieldOptions="" Order="0120"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="GT030.TXKOKYAKUMEI" FieldOptions="" Order="0110"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先),PROMPT_LIST" Order="0100"/><Field DataSource="DT010.CDKAKERITSURANK" FieldOptions="" Order="0070"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="HORIZONTAL" Order="0090"/></Function><Function AddBlankRowAllowed="T" DetailKeyFields="" DetailRowNo="SQMITSUMORI" DetailTable="GT031" HeaderKeyFields="" HeaderTable="GT030" ID="GF052" Name="見積見出し／明細の保守" Size="AUTO" SubsystemID="G" Type="XF310"><Field DataSource="GT030.NRMITSUMORI" FieldOptions="" Order="0010"/><Field DataSource="GT030.SQVERSION" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT030.DTMITSUMORI" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="GT030.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(DF200),PROMPT_CALL_TO_GET(DT010.NRTORIHIKISAKI;AT030.TXKANJI;DT010.CDKAKERITSURANK),PROMPT_CALL_TO_GET_TO(GT030.NRTORIHIKISAKI;AT030.TXKANJI;DT010.CDKAKERITSURANK)" Order="0050"/><Field DataSource="GT030.TXTYUBAN" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT030.TXTEKIYO" FieldOptions="" Order="0130"/><Column DataSource="GT031.PRJYUTYU" FieldOptions="" Order="0070"/><Column DataSource="GT031.QTJYUTYU" FieldOptions="" Order="0080"/><Column DataSource="GT031.DTKIBOUNOUKI" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先),PROMPT_LIST" Order="0100"/><Field DataSource="GT030.TXKOKYAKUMEI" FieldOptions="" Order="0110"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(403)" Order="0030"/><Column DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.TXSIYOU;BT020.KBZAIKOUM;BT020.PRHANBAI),PROMPT_CALL_TO_GET_TO(GT031.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.TXSIYOU;BT020.KBZAIKOUM;BT020.PRHANBAI)" Order="0020"/><Column DataSource="BT020.TXSIYOU" FieldOptions="VERTICAL" Order="0050"/><Column DataSource="BT020.PRHANBAI" FieldOptions="CAPTION(標準単価)" Order="0060"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Field DataSource="DT010.CDKAKERITSURANK" FieldOptions="" Order="0070"/><Field DataSource="GT030.DTKIBOUNOUKI" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="HORIZONTAL" Order="0090"/><Column DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0010"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="GT030" ID="GF053" Name="見積見出し／明細の検討" Size="AUTO" SubsystemID="G" Type="XF300"><Field DataSource="GT030.NRMITSUMORI" FieldOptions="" Order="0010"/><Field DataSource="GT030.SQVERSION" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT030.DTMITSUMORI" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="GT030.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="GT030.TXTYUBAN" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT030.TXTEKIYO" FieldOptions="" Order="0130"/><Detail Caption="見積明細" DetailFunction="" InitialMsg="" KeyFields="" Order="0010" ParmType="COLUMNS" Table="GT031"><Column DataSource="GT031.PRJYUTYU" FieldOptions="" Order="0060"/><Column DataSource="GT031.QTJYUTYU" FieldOptions="" Order="0070"/><Column DataSource="GT031.DTKIBOUNOUKI" FieldOptions="" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(GF055)" Caption="編集ツール" Number="8" Position="4"/><Button Action="CALL(GF054)" Caption="見積書" Number="10" Position="5"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXSIYOU" FieldOptions="" Order="0040"/><Column DataSource="BT020.PRHANBAI" FieldOptions="CAPTION(標準単価)" Order="0050"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0080"/></Detail><Field DataSource="DT010.CDKAKERITSURANK" FieldOptions="" Order="0070"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先)" Order="0100"/><Field DataSource="GT030.TXWORK" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="GT030.NRJYUTYU" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="HORIZONTAL" Order="0090"/></Function><Function DetailKeyFields="" DetailTable="GT031" Direction="NORMAL" HeaderKeyFields="" HeaderTable="GT030" ID="GF054" Margins="40;40;50;50" Name="見積書の印刷" PageSize="A4" SubsystemID="G" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="4" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0000" SpacingAfter="0" Value="&amp;Text(お見積書)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(見積番号 )&amp;DataSource(GT030.NRMITSUMORI)&amp;Text(-)&amp;DataSource(GT030.SQVERSION)&amp;Text(  見積日 )&amp;DataSource(GT030.DTMITSUMORI)"/><Column Alignment="RIGHT" DataSource="GT031.PRJYUTYU" FieldOptions="" Order="0040" Width="9"/><Column Alignment="RIGHT" DataSource="GT031.QTJYUTYU" FieldOptions="CAPTION(ご注文数量)" Order="0050" Width="9"/><Column Alignment="CENTER" DataSource="GT031.DTKIBOUNOUKI" FieldOptions="CAPTION(ご希望納期)" Order="0070" Width="13"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0011" SpacingAfter="-18" Value="&amp;DataSource(GT030.TXWORK)&amp;Text( 御中)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0012" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0013" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0014" SpacingAfter="0" Value="&amp;Text(毎度お世話になっております。下記のとおりお見積りいたしましたので、ご確認ください。)"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030" Width="30"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020" Width="18"/><Column Alignment="CENTER" DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0060" Width="7"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0013" SpacingAfter="10" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><Column Alignment="LEFT" DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0010" Width="10"/></Function><Function ID="GF055" Name="見積編集ツール" Script="var dialog = session.getOptionDialog();#EOL#dialog.addOption('見積編集');               // 0 //#EOL#dialog.addOption('受注として登録');         // 1 //#EOL#dialog.addOption('見積複写（新規見積№）'); // 2 //#EOL#dialog.addOption('見積複写（改版）');       // 3 //#EOL#dialog.addOption('見積削除');               // 4 //#EOL#dialog.addOption('閉じる');                 // 5 //#EOL#var reply = dialog.request('編集オプション');#EOL#if (reply == -1 || reply == 5) {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#} else {#EOL#&#x9;if (reply == 0) {#EOL#&#x9;&#x9;instance.callFunction('GF052');#EOL#&#x9;}#EOL#&#x9;if (reply == 1) {#EOL#&#x9;&#x9;instance.callFunction('GF055A');#EOL#&#x9;}#EOL#&#x9;if (reply == 2) {#EOL#&#x9;&#x9;instance.parmMap.put('NUMBER', 'NEW');#EOL#&#x9;&#x9;instance.callFunction('GF055B');#EOL#&#x9;}#EOL#&#x9;if (reply == 3) {#EOL#&#x9;&#x9;instance.parmMap.put('NUMBER', 'SAME');#EOL#&#x9;&#x9;instance.callFunction('GF055B');#EOL#&#x9;}#EOL#&#x9;if (reply == 4) {#EOL#&#x9;&#x9;instance.callFunction('GF055C');#EOL#&#x9;}#EOL#&#x9;instance.commit();#EOL#}" SubsystemID="G" Type="XF000"/><Function ID="GF055A" Name="見積にもとづく受注登録" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数設定 //#EOL#&#x9;//////////////#EOL#&#x9;var rGT030; var rGT010;#EOL#&#x9;var answer;#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 見積見出しの検索 //#EOL#&#x9;//////////////////////#EOL#&#x9;rGT030 = instance.createTableOperator('Select', 'GT030');#EOL#&#x9;rGT030.addKeyValue('NRMITSUMORI',&#x9;instance.parmMap.get('NRMITSUMORI'));#EOL#&#x9;rGT030.addKeyValue('SQVERSION',&#x9;&#x9;instance.parmMap.get('SQVERSION'));#EOL#&#x9;if (rGT030.next()) {#EOL#&#x9;&#x9;if (rGT030.getValueOf('NRTORIHIKISAKI') == '' || rGT030.getValueOf('SQSYUKKASAKI') == 0) {#EOL#&#x9;&#x9;&#x9;JOptionPane.showMessageDialog(null, 'この見積先の取引先か出荷先が未指定のままなので受注に変換できません。必要に応じて\n取引先や出荷先を新規登録して、見積情報を更新したうえで再試行してください。');#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;&#x9;// 受注見出しの存在チェック //#EOL#&#x9;&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;&#x9;rGT010 = instance.createTableOperator('Select', 'GT010');#EOL#&#x9;&#x9;&#x9;rGT010.addKeyValue('NRMITSUMORI',&#x9;instance.parmMap.get('NRMITSUMORI'));#EOL#&#x9;&#x9;&#x9;rGT010.addKeyValue('SQVERSION',&#x9;&#x9;instance.parmMap.get('SQVERSION'));#EOL#&#x9;&#x9;&#x9;if (rGT010.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;answer = JOptionPane.showConfirmDialog(null, 'この見積にもとづいて既に受注が登録されています。さらに登録しますか？', '見積にもとづく受注登録', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;answer = JOptionPane.OK_OPTION;#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 受注見出しの保守（追加モード）を起動 //#EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (answer == JOptionPane.OK_OPTION) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('TXTYUBAN', rGT030.getValueOf('TXTYUBAN'));#EOL#&#x9;&#x9;&#x9;&#x9;if (rGT030.getValueOf('NRTORIHIKISAKI') != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('NRTORIHIKISAKI', rGT030.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (rGT030.getValueOf('SQSYUKKASAKI') != 0) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('SQSYUKKASAKI', rGT030.getValueOf('SQSYUKKASAKI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('GF011'); #EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="G" Type="XF000"/><Function ID="GF055B" Name="見積複写" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数設定 //#EOL#&#x9;//////////////#EOL#&#x9;var rGT030; var cGT030; var rGT031; var cGT031;#EOL#&#x9;var answer = ''; var errorMessage = '';#EOL#&#x9;var nrMitsumori = instance.parmMap.get('NRMITSUMORI');#EOL#&#x9;var sqVersion = instance.parmMap.get('SQVERSION');#EOL#&#x9;var nrMitsumoriNew = ''; var sqVersionNew = 0; var numberType = '';#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 実行確認 //#EOL#&#x9;//////////////#EOL#&#x9;numberType = instance.parmMap.get('NUMBER');#EOL#&#x9;if (numberType == 'NEW') {#EOL#&#x9;&#x9;answer = JOptionPane.showConfirmDialog(null, '新しい見積№で複写・追加します。よろしいですか？', '見積の複写', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;}#EOL#&#x9;if (numberType == 'SAME') {#EOL#&#x9;&#x9;answer = JOptionPane.showConfirmDialog(null, '同一見積№の改版分として複写・追加します。よろしいですか？', '見積の複写', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;}#EOL#&#x9;if (answer == JOptionPane.OK_OPTION) {#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 複写先キー値の設定 //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;if (numberType == 'NEW') {#EOL#&#x9;&#x9;&#x9;nrMitsumoriNew = session.getNextNumber('NRMITSUMORI');#EOL#&#x9;&#x9;&#x9;sqVersionNew = 1;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (numberType == 'SAME') {#EOL#&#x9;&#x9;&#x9;nrMitsumoriNew = nrMitsumori;#EOL#&#x9;&#x9;&#x9;var inputValue = JOptionPane.showInputDialog(null, '新たな版番号を指定してください。', sqVersion)#EOL#&#x9;&#x9;&#x9;if (isNaN(inputValue)) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '指定された版番号が数値として正しくありません。処理はキャンセルされました。';#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;sqVersionNew = Number(inputValue);#EOL#&#x9;&#x9;&#x9;&#x9;rGT030 = instance.createTableOperator('Select', 'GT030');#EOL#&#x9;&#x9;&#x9;&#x9;rGT030.addKeyValue('NRMITSUMORI',nrMitsumoriNew);#EOL#&#x9;&#x9;&#x9;&#x9;rGT030.addKeyValue('SQVERSION',sqVersionNew);#EOL#&#x9;&#x9;&#x9;&#x9;if (rGT030.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '指定された版番号の見積データが既に存在します。処理はキャンセルされました。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// 検索＆複写 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;rGT030 = instance.createTableOperator('Select', 'GT030');#EOL#&#x9;&#x9;&#x9;rGT030.addKeyValue('NRMITSUMORI',&#x9;nrMitsumori);#EOL#&#x9;&#x9;&#x9;rGT030.addKeyValue('SQVERSION',&#x9;&#x9;sqVersion);#EOL#&#x9;&#x9;&#x9;if (rGT030.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;cGT030 = instance.createTableOperator('Insert', 'GT030');#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('NRMITSUMORI',&#x9;&#x9;nrMitsumoriNew);#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('SQVERSION',&#x9;&#x9;sqVersionNew);#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('DTMITSUMORI',&#x9;&#x9;rGT030.getValueOf('DTMITSUMORI'));#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('NRTORIHIKISAKI',&#x9;rGT030.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('SQSYUKKASAKI',&#x9;&#x9;rGT030.getValueOf('SQSYUKKASAKI'));#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('TXKOKYAKUMEI',&#x9;&#x9;rGT030.getValueOf('TXKOKYAKUMEI'));#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('TXTYUBAN',&#x9;&#x9;&#x9;rGT030.getValueOf('TXTYUBAN'));#EOL#&#x9;&#x9;&#x9;&#x9;cGT030.addValue('TXTEKIYO',&#x9;&#x9;&#x9;rGT030.getValueOf('TXTEKIYO'));#EOL#&#x9;&#x9;&#x9;&#x9;count = cGT030.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rGT031 = instance.createTableOperator('Select', 'GT031');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rGT031.addKeyValue('NRMITSUMORI',&#x9;nrMitsumori);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rGT031.addKeyValue('SQVERSION',&#x9;&#x9;sqVersion);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;while (rGT031.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031 = instance.createTableOperator('Insert', 'GT031');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031.addValue('NRMITSUMORI',&#x9;nrMitsumoriNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031.addValue('SQVERSION',&#x9;sqVersionNew);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031.addValue('SQMITSUMORI',&#x9;rGT031.getValueOf('SQMITSUMORI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031.addValue('NRSYOHIN',&#x9;&#x9;rGT031.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031.addValue('PRJYUTYU',&#x9;&#x9;rGT031.getValueOf('PRJYUTYU'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031.addValue('QTJYUTYU',&#x9;&#x9;rGT031.getValueOf('QTJYUTYU'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cGT031.addValue('DTKIBOUNOUKI',&#x9;rGT031.getValueOf('DTKIBOUNOUKI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;count = cGT031.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '見積明細(GT031)の登録に失敗しました。処理はキャンセルされました。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '見積見出し(GT030)の登録に失敗しました。処理はキャンセルされました。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '現時点で複写元が見つかりません。処理はキャンセルされました。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '10');#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊見積データを複写・追加しました。');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '11');#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '11');#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;}#EOL#}" SubsystemID="G" Type="XF000"/><Function ID="GF055C" Name="見積削除" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数設定 //#EOL#&#x9;//////////////#EOL#&#x9;var rGT030; var dGT030; var rGT031;var dGT031;#EOL#&#x9;var count = 0; var wrkCount = 0; var errorMessage = ''; var answer;#EOL#&#x9;var nrMitsumori = instance.parmMap.get('NRMITSUMORI');#EOL#&#x9;var sqVersion = instance.parmMap.get('SQVERSION');#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 削除操作の実行確認 //#EOL#&#x9;////////////////////////#EOL#&#x9;answer = JOptionPane.showConfirmDialog(null, 'この見積を明細とともに削除します。よろしいですか？', '見積削除', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;if (answer == JOptionPane.OK_OPTION) {#EOL##EOL#&#x9;&#x9;///////////////////////////////////#EOL#&#x9;&#x9;// 当該の見積見出し(GT030)の検索 //#EOL#&#x9;&#x9;///////////////////////////////////#EOL#&#x9;&#x9;rGT030 = instance.createTableOperator('Select', 'GT030');#EOL#&#x9;&#x9;rGT030.addKeyValue('NRMITSUMORI',&#x9;nrMitsumori);#EOL#&#x9;&#x9;rGT030.addKeyValue('SQVERSION',&#x9;&#x9;sqVersion);#EOL#&#x9;&#x9;if (rGT030.next()) {#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;// 見積明細(GT031)の削除 //#EOL#&#x9;&#x9;&#x9;///////////////////////////#EOL#&#x9;&#x9;&#x9;rGT031 = instance.createTableOperator('Select', 'GT031');#EOL#&#x9;&#x9;&#x9;rGT031.addKeyValue('NRMITSUMORI',&#x9;nrMitsumori);#EOL#&#x9;&#x9;&#x9;rGT031.addKeyValue('SQVERSION',&#x9;&#x9;sqVersion);#EOL#&#x9;&#x9;&#x9;wrkCount = rGT031.execute();#EOL#&#x9;&#x9;&#x9;dGT031 = instance.createTableOperator('Delete', 'GT031');#EOL#&#x9;&#x9;&#x9;dGT031.addKeyValue('NRMITSUMORI',&#x9;nrMitsumori);#EOL#&#x9;&#x9;&#x9;dGT031.addKeyValue('SQVERSION',&#x9;&#x9;sqVersion);#EOL#&#x9;&#x9;&#x9;count = dGT031.execute();#EOL#&#x9;&#x9;&#x9;if (count == wrkCount) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;/////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 見積見出し(GT030)の削除 //#EOL#&#x9;&#x9;&#x9;&#x9;/////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;dGT030 = instance.createTableOperator('Delete', 'GT030');#EOL#&#x9;&#x9;&#x9;&#x9;dGT030.addKeyValue('NRMITSUMORI',&#x9;nrMitsumori);#EOL#&#x9;&#x9;&#x9;&#x9;dGT030.addKeyValue('SQVERSION',&#x9;&#x9;sqVersion);#EOL#&#x9;&#x9;&#x9;&#x9;count = dGT030.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = '見積見出し(GT030)の削除に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '見積明細(GT031)の削除に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;errorMessage = '現時点で見積データが存在しないため、削除できません。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '30');#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊見積データを削除しました。');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '31');#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '31');#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;}#EOL#}" SubsystemID="G" Type="XF000"/><Function ID="JF021A" Name="特殊売上の追加(切替)" Script="var dialog = session.getOptionDialog();#EOL#dialog.addOption('売上返品'); // 0 //#EOL#dialog.addOption('直接出荷'); // 1 //#EOL#dialog.addOption('閉じる');   // 2 //#EOL#var reply = dialog.request('取引区分選択');#EOL#if (reply == 0) {#EOL#    instance.parmMap.put('KBTOKUSYUURIAGE', '10');#EOL#    instance.callFunction('JF021C'); //売上返品の保守（追加モード）//#EOL#}#EOL#if (reply == 1) {#EOL#    instance.parmMap.put('KBTOKUSYUURIAGE', '20');#EOL#    instance.callFunction('JF021D'); //直接出荷の保守（追加モード）//#EOL#}#EOL#if (reply == 2 || reply == -1) {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}" SubsystemID="J" Type="XF000"/><Function DataName="売上返品" FunctionAfterInsert="JF023" ID="JF021C" InitialMsg="" KeyFields="" Name="売上返品の保守" PrimaryTable="JT020" Size="AUTO" SubsystemID="J" Type="XF200"><Field DataSource="JT020.NRTOKUSYUURIAGE" FieldOptions="" Order="0010"/><Field DataSource="JT020.KBTOKUSYUURIAGE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="JT020.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(DF200),PROMPT_CALL_TO_GET(DT010.NRTORIHIKISAKI;AT030.TXKANJI),PROMPT_CALL_TO_GET_TO(JT020.NRTORIHIKISAKI;AT030.TXKANJI)" Order="0040"/><Field DataSource="JT020.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="JT020.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL,PROMPT_CALL(BF110),PROMPT_CALL_TO_PUT(JT020.NRSOUKO),PROMPT_CALL_TO_PUT_TO(BT030.NRSOUKO),PROMPT_CALL_TO_GET(BT031.NRLOCATION),PROMPT_CALL_TO_GET_TO(JT020.NRLOCATION)" Order="0090"/><Field DataSource="JT020.PRTORIHIKI" FieldOptions="CAPTION(返品単価),HORIZONTAL(54)" Order="0120"/><Field DataSource="JT020.QTTORIHIKI" FieldOptions="CAPTION(返品数量)" Order="0140"/><Field DataSource="JT020.TXTEKIYO" FieldOptions="WIDTH(860)" Order="0180"/><Field DataSource="JT020.AMTORIHIKI" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="JT020.AMTAX" FieldOptions="HORIZONTAL" Order="0170"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN),PROMPT_CALL_TO_GET_TO(JT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN)" Order="0060"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),PROMPT_LIST" Order="0080"/><Field DataSource="BT020.PRHANBAI" FieldOptions="" Order="0110"/><Field DataSource="JT020.PRUKEBARAI" FieldOptions="CAPTION(入庫単価),HORIZONTAL" Order="0130"/><Field DataSource="JT020.TXLOTNUMBER" FieldOptions="" Order="0100"/></Function><Function DataName="直接出荷" FunctionAfterInsert="JF023" ID="JF021D" InitialMsg="" KeyFields="" Name="直接出荷の保守" PrimaryTable="JT020" Size="AUTO" SubsystemID="J" Type="XF200"><Field DataSource="JT020.NRTOKUSYUURIAGE" FieldOptions="" Order="0010"/><Field DataSource="JT020.KBTOKUSYUURIAGE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="JT020.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(DF200),PROMPT_CALL_TO_GET(DT010.NRTORIHIKISAKI;AT030.TXKANJI),PROMPT_CALL_TO_GET_TO(JT020.NRTORIHIKISAKI;AT030.TXKANJI)" Order="0040"/><Field DataSource="JT020.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="JT020.PRTORIHIKI" FieldOptions="CAPTION(販売単価),HORIZONTAL(54)" Order="0130"/><Field DataSource="JT020.QTTORIHIKI" FieldOptions="CAPTION(出荷数量)" Order="0150"/><Field DataSource="JT020.TXTEKIYO" FieldOptions="WIDTH(860)" Order="0190"/><Field DataSource="JT020.AMTORIHIKI" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="JT020.AMTAX" FieldOptions="HORIZONTAL" Order="0180"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先),PROMPT_LIST" Order="0060"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN),PROMPT_CALL_TO_GET_TO(JT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN)" Order="0070"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0160"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),PROMPT_LIST" Order="0090"/><Field DataSource="JT020.PRUKEBARAI" FieldOptions="CAPTION(出庫単価),HORIZONTAL" Order="0140"/><Field DataSource="JT020.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="BT020.PRHANBAI" FieldOptions="" Order="0120"/><Field DataSource="JT020.TXLOTNUMBER" FieldOptions="" Order="0110"/></Function><Function Direction="NORMAL" ID="JF022" KeyFields="" Margins="50;50;50;50" Name="直接出荷納品書の印刷" PageSize="A4" PrimaryTable="JT020" SubsystemID="J" Type="XF290" WithPageNumber="F"><Phrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(納品書)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0080" SpacingAfter="10" Value="&amp;Text(毎度お世話になっております。下記の商品を納品させていただきます。ご確認ください。)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0090" SpacingAfter="-18" Value="&amp;Text(納品先)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(納品番号 )&amp;DataSource(JT020.NRTOKUSYUURIAGE)&amp;Text(  納品日 )&amp;DataSource(JT020.DTTORIHIKI)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="-18" Value="&amp;DataSource(AT030.TXKANJI)&amp;Text( 御中)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="10" Value="&amp;Text(営業担当 )&amp;DataSource(AT020.TXKANJI)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0100" SpacingAfter="10" Value="&amp;DataSource(DT011.NRYUBIN)&amp;Text( )&amp;DataSource(DT011.TXJYUSYO)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0110" SpacingAfter="-18" Value="&amp;Text(品番)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0140" SpacingAfter="0" Value="&amp;DataSource(BT020.TXSYOHIN)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0150" SpacingAfter="-18" Value="&amp;Text(ロット№)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0160" SpacingAfter="-18" Value="&amp;Text(納品数量)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0170" SpacingAfter="-18" Value="&amp;Text(摘要)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0120" SpacingAfter="0" Value="&amp;DataSource(BT020.TXHINBAN)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0130" SpacingAfter="-18" Value="&amp;Text(品名)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0151" SpacingAfter="0" Value="&amp;DataSource(JT020.TXLOTNUMBER)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="330" Order="0161" SpacingAfter="0" Value="&amp;DataSource(JT020.QTTORIHIKI)&amp;Text( )&amp;DataSource(BT020.KBZAIKOUM)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0171" SpacingAfter="0" Value="&amp;DataSource(JT020.TXTEKIYO)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0091" SpacingAfter="0" Value="&amp;DataSource(DT011.TXKANJI)"/></Function><Function HeaderFunction="JF021B" HeaderKeyFields="" HeaderTable="JT020" ID="JF023" Name="特殊売上別取引実績の検討" Size="AUTO" SubsystemID="J" Type="XF300"><Field DataSource="JT020.NRTOKUSYUURIAGE" FieldOptions="" Order="0010"/><Field DataSource="JT020.KBTOKUSYUURIAGE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="JT020.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="JT020.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Detail Caption="売掛増減履歴" DetailFunction="DF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRURIAGE" Order="0010" Table="DT100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="DT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0050"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="特殊売上情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(JF024)" Caption="発行" Number="10" Position="5"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0070"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0080"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0110"/><Column DataSource="DT100.NRSEIKYU" FieldOptions="" Order="0120"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0100"/></Detail><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0020" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="特殊売上情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0110"/><Column DataSource="ET100.AMSAGAKU" FieldOptions="" Order="0120"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.NRSOUKO" FieldOptions="" Order="0070"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0080"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0090"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Button Action="CALL(JF024)" Caption="発行" Number="10" Position="5"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先)" Order="0060"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0070"/><Field DataSource="JT020.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ)" Order="0090"/><Field DataSource="JT020.PRTORIHIKI" FieldOptions="" Order="0120"/><Field DataSource="JT020.QTTORIHIKI" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="JT020.PRUKEBARAI" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Field DataSource="JT020.TXTEKIYO" FieldOptions="" Order="0180"/><Field DataSource="JT020.AMTORIHIKI" FieldOptions="" Order="0160"/><Field DataSource="JT020.AMTAX" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="JT020.TXLOTNUMBER" FieldOptions="" Order="0110"/></Function><Function Direction="NORMAL" ID="HF022A" KeyFields="" Margins="50;50;50;50" Name="返品通知書の印刷(日本語)" PageSize="A4" PrimaryTable="HT020" SubsystemID="H" Type="XF290" WithPageNumber="F"><Phrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(返品通知書)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;DataSource(AT030.TXKANJI)&amp;Text( 御中)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="-36" Value="&amp;DataSource(CT010.TXTANTOUBUSYO)&amp;Text( )&amp;DataSource(CT010.TXTANTOUSYA)&amp;Text(様)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0080" SpacingAfter="10" Value="&amp;Text(購買担当 )&amp;DataSource(AT020.TXKANJI)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(返品番号 )&amp;DataSource(HT020.NRTOKUSYUSIIRE)&amp;Text(  返品日 )&amp;DataSource(HT020.DTTORIHIKI)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0090" SpacingAfter="10" Value="&amp;Text(毎度お世話になっております。下記の商品を返品いたします。ご確認ください。)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0150" SpacingAfter="-18" Value="&amp;Text(返品数量)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0160" SpacingAfter="-18" Value="&amp;Text(返品額)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0170" SpacingAfter="-18" Value="&amp;Text(消費税)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0180" SpacingAfter="-18" Value="&amp;Text(摘要)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0120" SpacingAfter="-18" Value="&amp;Text(品名)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0100" SpacingAfter="-18" Value="&amp;Text(品番)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0140" SpacingAfter="-18" Value="&amp;Text(ロット№)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0110" SpacingAfter="0" Value="&amp;DataSource(BT020.TXHINBAN)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0130" SpacingAfter="0" Value="&amp;DataSource(BT020.TXSYOHIN)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0141" SpacingAfter="0" Value="&amp;DataSource(HT020.TXLOTNUMBER)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0151" SpacingAfter="0" Value="&amp;DataSource(HT020.QTTORIHIKI)&amp;Text( )&amp;DataSource(BT020.KBZAIKOUM)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0161" SpacingAfter="0" Value="&amp;DataSource(HT020.AMTORIHIKINAIKA)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0171" SpacingAfter="0" Value="&amp;DataSource(HT020.AMTAX)"/><Phrase Alignment="LEFT" AlignmentMargin="100" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" Order="0181" SpacingAfter="0" Value="&amp;DataSource(HT020.TXTEKIYO)"/></Function><Function Direction="NORMAL" ID="HF022B" KeyFields="" Margins="50;50;50;50" Name="返品通知書の印刷(英語)" PageSize="A4" PrimaryTable="HT020" SubsystemID="H" Type="XF290" WithPageNumber="F"><Phrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(Shipment of Defect)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;DataSource(AT030.TXKANJI)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="-36" Value="&amp;DataSource(CT010.TXTANTOUBUSYO)&amp;Text( )&amp;DataSource(CT010.TXTANTOUSYA)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME_ENG)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS_ENG)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(Defect No )&amp;DataSource(HT020.NRTOKUSYUSIIRE)&amp;Text(  Ship Date )&amp;DataSource(HT020.DTTORIHIKI;en11)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0130" SpacingAfter="-18" Value="&amp;Text( Defect Qty)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0140" SpacingAfter="-18" Value="&amp;Text( Defect Amount)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0150" SpacingAfter="-18" Value="&amp;Text( Remarks)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0100" SpacingAfter="-18" Value="&amp;Text( Item Name)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0080" SpacingAfter="-18" Value="&amp;Text( Item No)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="410" Order="0120" SpacingAfter="-18" Value="&amp;Text( Lot No)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0090" SpacingAfter="0" Value="&amp;DataSource(BT020.TXHINBAN)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0110" SpacingAfter="0" Value="&amp;DataSource(BT020.TXSYOHIN)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0121" SpacingAfter="0" Value="&amp;DataSource(HT020.TXLOTNUMBER)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0131" SpacingAfter="0" Value="&amp;DataSource(HT020.QTTORIHIKI)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0141" SpacingAfter="0" Value="&amp;DataSource(HT020.AMTORIHIKI)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="100" MarginRight="0" Order="0151" SpacingAfter="0" Value="&amp;DataSource(HT020.TXTEKIYO)"/></Function><Function DetailFunction="DF101" ID="DF100" InitialMsg="" KeyFields="" Name="売掛増減履歴データの一覧" OrderBy="DT100.NRURIAGE(D)" PrimaryTable="DT100" Size="AUTO" SubsystemID="D" Type="XF100"><Filter DataSource="DT100.DTURIAGE" FieldOptions="GE,CAPTION(売上日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="AT030.TXKANJI" FieldOptions="SCAN,CAPTION(顧客名SCAN)" Order="0020"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="0030"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0020"/><Column DataSource="DT100.KBAKADEN" FieldOptions="" Order="0030"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0050"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名),WIDTH(190)" Order="0060"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(150)" Order="0070"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0100"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0120"/><Column DataSource="DT100.NRSEIKYU" FieldOptions="" Order="0130"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Filter DataSource="DT100.FGVALID" FieldOptions="PROMPT_LIST1,VALUE(VALUE:T)" Order="0040"/><Column DataSource="DT100.FGVALID" FieldOptions="" Order="0040"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0110"/><Column DataSource="DT100.TXSYOHIN" FieldOptions="WIDTH(190)" Order="0080"/></Function><Function DataName="" ID="DF101" InitialMsg="" KeyFields="" Name="売掛増減履歴データの表示" PrimaryTable="DT100" Size="AUTO" SubsystemID="D" Type="XF200"><Field DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／品名)" Order="0100"/><Field DataSource="DT100.DTURIAGE" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="DT100.KBAKADEN" FieldOptions="CAPTION(伝票区分),HORIZONTAL(79)" Order="0020"/><Field DataSource="DT100.KBURIAGE" FieldOptions="" Order="0040"/><Field DataSource="DT100.PRURIAGE" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="DT100.QTURIAGE" FieldOptions="" Order="0130"/><Field DataSource="DT100.AMURIAGE" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="DT100.AMTAX" FieldOptions="" Order="0180"/><Field DataSource="DT100.DTCREATE" FieldOptions="HORIZONTAL" Order="0220"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="DT100.FGVALID" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0030"/><Field DataSource="DT100.NRSEIKYU" FieldOptions="" Order="0210"/><Field DataSource="DT100.NRTORIHIKISAKI" FieldOptions="" Order="0080"/><Field DataSource="DT100.KBURIAGEUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0140"/><Field DataSource="DT100.DTNEND" FieldOptions="CAPTION(年月度),HORIZONTAL" Order="0060"/><Field DataSource="DT100.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Button Action="CALL(DF102)" Caption="元取引" Number="7" Position="4"/><Field DataSource="DT100.AMGENKA" FieldOptions="HORIZONTAL(74)" Order="0190"/><Field DataSource="DT100.AMARARI" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="DT100.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/></Function><Function DetailFunction="DF021" ID="DF020" InitialMsg="" KeyFields="" Name="掛率ランクの一覧・保守" OrderBy="DT020.CDKAKERITSURANK" PrimaryTable="DT020" Size="AUTO" SubsystemID="D" Type="XF100"><Filter DataSource="DT020.CDKAKERITSURANK" FieldOptions="GENERIC,CAPTION(ランクＣ上位桁)" Order="0"/><Column DataSource="DT020.CDKAKERITSURANK" FieldOptions="" Order="00"/><Column DataSource="DT020.TXKAKERITSURANK" FieldOptions="" Order="01"/><Column DataSource="DT020.VLKAKERITSU" FieldOptions="" Order="02"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(DF022)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function HeaderFunction="DF022" HeaderKeyFields="" HeaderTable="DT020" ID="DF021" Name="掛率ランクと関連情報の確認" Size="AUTO" SubsystemID="D" Type="XF300"><Field DataSource="DT020.CDKAKERITSURANK" FieldOptions="" Order="00"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="HORIZONTAL" Order="01"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="HORIZONTAL" Order="02"/><Detail Caption="顧客" DetailFunction="DF012" InitialMsg="" KeyFields="CDKAKERITSURANK;NRTORIHIKISAKI" Order="0" OrderBy="" Table="DT010"><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="01"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(担当営業)" Order="02"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="ランク情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Detail></Function><Function DataName="" ID="DF022" InitialMsg="" KeyFields="" Name="掛率ランクの保守" PrimaryTable="DT020" Size="AUTO" SubsystemID="D" Type="XF200"><Field DataSource="DT020.CDKAKERITSURANK" FieldOptions="" Order="00"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="" Order="01"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="" Order="02"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="複写" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailFunction="DF113" ID="DF110" InitialMsg="" KeyFields="" Name="請求データの一覧・保守" OrderBy="" PrimaryTable="DT110" Size="AUTO" SubsystemID="D" Type="XF100"><Column DataSource="DT110.NRSEIKYU" FieldOptions="" Order="0010"/><Column DataSource="DT110.DTSEIKYU" FieldOptions="" Order="0020"/><Column DataSource="DT110.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="DT110.AMSEIKYU" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(DF111)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="DT110.NRSEIKYU" FieldOptions="" Order="0020"/><Filter DataSource="DT110.DTSEIKYU" FieldOptions="GE,CAPTION(請求日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="DT110.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0040"/><Column DataSource="DT110.STSEIKYU" FieldOptions="" Order="0060"/></Function><Function BatchKeyFields="NRTORIHIKISAKI" BatchRecordFunction="DF115A" BatchRecordFunctionMsg="同時に請求書を発行する" BatchTable="DT110" BatchWithKeyFields="DT100.NRTORIHIKISAKI" FixedWhere="NRSEIKYU = '' and FGVALID = 'T' and KBURIAGE != '90'" ID="DF111" InitialMsg="" KeyFields="" Name="請求エントリー" OrderBy="" PrimaryTable="DT100" Size="AUTO" SubsystemID="D" Type="XF110"><Column DataSource="DT100.KBURIAGE" FieldOptions="WIDTH(150)" Order="0020"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="PREV" Caption="戻る" Number="4" Position="2"/><Button Action="NEXT" Caption="次へ" Number="5" Position="4"/><Button Action="UPDATE" Caption="更新" Number="5" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="DT100.NRJYUGYOIN" FieldOptions="VALUE(USER_ATTRIBUTE:EmployeeNo)" Order="0010"/><Column DataSource="DT100.AMURIAGE" FieldOptions="CAPTION(税抜売上額)" Order="0110"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0120"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名),WIDTH(250)" Order="0050"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0090"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0080"/><BatchField DataSource="DT110.DTSEIKYU" FieldOptions="" Order="0010"/><Column DataSource="DT100.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Column DataSource="DT010.TXSIMEBI" FieldOptions="WIDTH(100)" Order="0040"/><Filter DataSource="DT100.NRTORIHIKISAKI" FieldOptions="" Order="0020"/><Filter DataSource="DT010.TXSIMEBI" FieldOptions="SCAN,CAPTION(締め日SCAN)" Order="0030"/><Column DataSource="DT100.TXSYOHIN" FieldOptions="WIDTH(220)" Order="0060"/></Function><Function ID="DF112" Name="都度請求処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT100; var uDT100; var cDT110;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#//////////////////////#EOL#// パラメータの検査 //#EOL#//////////////////////#EOL#var nrSeikyu = instance.parmMap.get('NRSEIKYU') + '';#EOL#var nrTorihikisaki = instance.parmMap.get('NRTORIHIKISAKI') + '';#EOL#if (nrSeikyu != '' &amp;&amp; nrTorihikisaki != '') {#EOL##EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;// 有効未処理分の「受領」売上実績の更新 //#EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;rDT100.setSelectFields('NRURIAGE, NRSEIKYU, UPDCOUNTER');#EOL#&#x9;rDT100.addKeyValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;rDT100.addKeyValue('NRSEIKYU',&#x9;&#x9;&#x9;'       ');#EOL#&#x9;rDT100.addKeyValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;rDT100.addKeyValue('KBURIAGE',&#x9;&#x9;&#x9;'90');#EOL#&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;uDT100 = instance.createTableOperator('Update', 'DT100');#EOL#&#x9;&#x9;uDT100.addValue('NRSEIKYU',&#x9;&#x9;nrSeikyu);#EOL#&#x9;&#x9;uDT100.addValue('UPDCOUNTER',&#x9;Number(rDT100.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;uDT100.addKeyValue('NRURIAGE',&#x9;&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;uDT100.addKeyValue('UPDCOUNTER',&#x9;rDT100.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;count = uDT100.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '関連する売上実績(DT100)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 請求指示の追加 //#EOL#&#x9;////////////////////#EOL#&#x9;cDT110 = instance.createTableOperator('Insert', 'DT110');#EOL#&#x9;cDT110.addValue('NRSEIKYU',&#x9;&#x9;&#x9;nrSeikyu);#EOL#&#x9;cDT110.addValue('DTSEIKYU',&#x9;&#x9;&#x9;session.getToday());#EOL#&#x9;cDT110.addValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;cDT110.addValue('TXTEKIYO',&#x9;&#x9;&#x9;'');#EOL#&#x9;count = cDT110.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '請求指示(DT110)の作成に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 請求書の発行 //#EOL#&#x9;//////////////////#EOL#&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;instance.callFunction('DF115B');#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL#" SubsystemID="D" Type="XF000"/><Function HeaderFunction="DF114" HeaderKeyFields="" HeaderTable="DT110" ID="DF113" Name="請求指示と関連情報の確認" Size="AUTO" SubsystemID="D" Type="XF300"><Field DataSource="DT110.NRSEIKYU" FieldOptions="" Order="0010"/><Field DataSource="DT110.DTSEIKYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="DT110.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="DT110.AMSEIKYU" FieldOptions="CAPTION(今回請求額),HORIZONTAL" Order="0070"/><Detail Caption="請求明細" DetailFunction="DF116" InitialMsg="" KeyFields="NRSEIKYU;NRURIAGE" Order="0010" OrderBy="DT100.DTURIAGE" ParmAdditional="INSTANCE_MODE:EDIT" Table="DT100"><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0030"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="請求指示情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(DF115A)" Caption="請求書" Number="10" Position="5"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0090"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0070"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0100"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0110"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0080"/><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.TXSYOHIN" FieldOptions="" Order="0050"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="DT110.TXTEKIYO" FieldOptions="" Order="0080"/><Field DataSource="DT110.AMNYUKIN" FieldOptions="" Order="0060"/><Field DataSource="DT110.STSEIKYU" FieldOptions="HORIZONTAL" Order="0030"/></Function><Function ID="ZF100" Name="年次繰越確定処理の起動" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(java.lang, java.awt, javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数定義 //#EOL#&#x9;//////////////#EOL#&#x9;var uZT010;#EOL#&#x9;var count = 0; var errorMessage = ''; var reply; var numberOfErrors = 0;#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// ダイアログ上要素の設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;var panel = new JPanel();#EOL#&#x9;panel.setPreferredSize(new Dimension(310, 185));#EOL#&#x9;panel.setBorder(BorderFactory.createEtchedBorder());#EOL#&#x9;var labelCurNend = new JLabel();#EOL#&#x9;labelCurNend.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;labelCurNend.setHorizontalAlignment(SwingConstants.RIGHT);#EOL#&#x9;labelCurNend.setHorizontalTextPosition(SwingConstants.LEADING);#EOL#&#x9;labelCurNend.setText('現年度');#EOL#&#x9;labelCurNend.setBounds(new Rectangle(10, 10, 70, 15));#EOL#&#x9;var textFieldCurNend = new JTextField();#EOL#&#x9;textFieldCurNend.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;textFieldCurNend.setBounds(new Rectangle(90, 7, 60, 22));#EOL#&#x9;textFieldCurNend.setEditable(false);#EOL#&#x9;var labelNewNend = new JLabel();#EOL#&#x9;labelNewNend.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;labelNewNend.setHorizontalAlignment(SwingConstants.RIGHT);#EOL#&#x9;labelNewNend.setHorizontalTextPosition(SwingConstants.LEADING);#EOL#&#x9;labelNewNend.setText('新年度');#EOL#&#x9;labelNewNend.setBounds(new Rectangle(150, 10, 70, 15));#EOL#&#x9;var textFieldNewNend = new JTextField();#EOL#&#x9;textFieldNewNend.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;textFieldNewNend.setBounds(new Rectangle(230, 7, 60, 22));#EOL#&#x9;textFieldNewNend.setEditable(false);#EOL#&#x9;var textAreaMessage = new JTextArea();#EOL#&#x9;textAreaMessage.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;textAreaMessage.setEditable(false);#EOL#&#x9;textAreaMessage.setLineWrap(true);#EOL#&#x9;var scrollPaneMessage = new JScrollPane();#EOL#&#x9;scrollPaneMessage.getViewport().add(textAreaMessage);#EOL#&#x9;scrollPaneMessage.setBounds(new Rectangle(9, 35, 291, 139));#EOL#&#x9;panel.setLayout(null);#EOL#&#x9;panel.add(labelCurNend);#EOL#&#x9;panel.add(textFieldCurNend);#EOL#&#x9;panel.add(labelNewNend);#EOL#&#x9;panel.add(textFieldNewNend);#EOL#&#x9;panel.add(scrollPaneMessage);#EOL#&#x9;var btnArray = java.lang.reflect.Array.newInstance(java.lang.String, 2);#EOL#&#x9;btnArray[0] = ' 閉じる ';#EOL#&#x9;btnArray[1] = ' 実行 ';#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 現行年度設定 //#EOL#&#x9;//////////////////#EOL#&#x9;var wrkStr = session.getSystemVariantString('ALLOWED_FISCAL_MONTH') + '';#EOL#&#x9;var curNend = wrkStr.substring(0, 4);#EOL#&#x9;var newNend = Number(curNend) + Number(1);#EOL#&#x9;textFieldCurNend.setText(curNend);#EOL#&#x9;textFieldNewNend.setText(newNend);#EOL#&#x9;textAreaMessage.setText('＊新年度の期首残高（在庫・売掛・買掛）が取引実績にもとづいて計算され、更新されます。実行前にバックアップを取っておくことをお奨めします。処理後は旧年度(' + curNend + ')の会計データを変更できなくなります。');#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 実行確認ダイアログ表示 //#EOL#&#x9;////////////////////////////#EOL#&#x9;reply = JOptionPane.showOptionDialog(null, panel, '年次繰越確定処理', JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null, btnArray, btnArray[0]);#EOL#&#x9;if (reply == 1) {#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 残高繰越処理の実行 //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;instance.parmMap.put('CUR_NEND', curNend);#EOL#&#x9;&#x9;instance.parmMap.put('NEW_NEND', newNend);#EOL#&#x9;&#x9;instance.parmMap.put('CHECK_ONLY', 'false'); //検査結果にもとづく繰越高の更新を実施する//#EOL#&#x9;&#x9;instance.callFunction('CF900'); //買掛繰越//#EOL#&#x9;&#x9;instance.callFunction('DF900'); //売掛繰越//#EOL#&#x9;&#x9;instance.callFunction('EF900'); //在庫繰越//#EOL##EOL#&#x9;&#x9;////////////////////////////////////////#EOL#&#x9;&#x9;// 集計値の差異がなければ年度値を更新 //#EOL#&#x9;&#x9;////////////////////////////////////////#EOL#&#x9;&#x9;var numberOfErrorsCF900 =instance.parmMap.get('NUMBER_OF_ERRORS_CF900');#EOL#&#x9;&#x9;var numberOfErrorsDF900 =instance.parmMap.get('NUMBER_OF_ERRORS_DF900');#EOL#&#x9;&#x9;var numberOfErrorsEF900 =instance.parmMap.get('NUMBER_OF_ERRORS_EF900');#EOL#&#x9;&#x9;if (numberOfErrorsCF900 == 0 &amp;&amp; numberOfErrorsDF900 == 0 &amp;&amp; numberOfErrorsEF900 == 0) {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;// アプリ年度の更新 //#EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;uZT010 = instance.createTableOperator('Update', 'ZT010');#EOL#&#x9;&#x9;&#x9;uZT010.addValue('TXVALUE',&#x9;newNend + '01');#EOL#&#x9;&#x9;&#x9;uZT010.addKeyValue('IDVARIANT',&#x9;'ALLOWED_FISCAL_MONTH');#EOL#&#x9;&#x9;&#x9;count = uZT010.execute();#EOL#&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.commit();#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = 'システム変数(ZT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 集計値の差異に関するエラーメッセージの設定 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;wrkStr = '';#EOL#&#x9;&#x9;&#x9;if (numberOfErrorsCF900 > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;wrkStr = '買掛';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (numberOfErrorsDF900 > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;if (wrkStr == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = '売掛';#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = wrkStr + 'と売掛';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (numberOfErrorsEF900 > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;if (wrkStr == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = '在庫';#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = wrkStr + 'と在庫';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;numberOfErrors = Number(numberOfErrorsCF900) + Number(numberOfErrorsDF900) + Number(numberOfErrorsEF900);#EOL#&#x9;&#x9;&#x9;errorMessage = '＊' + wrkStr + 'に関して、' + numberOfErrors + '件の残高増減値の差異が見つかったため、処理は取り消されました。差異の詳細についてはセッションログを確認してください。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="Z" Type="XF000"/><Function ID="DF115A" Name="請求書発行更新処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var uDT110;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#//////////////////////#EOL#// パラメータの検査 //#EOL#//////////////////////#EOL#var nrSeikyu = instance.parmMap.get('NRSEIKYU');#EOL#if (nrSeikyu != '') {#EOL##EOL#&#x9;////////////////////////////////////#EOL#&#x9;// 請求書発行日の更新～請求書発行 //#EOL#&#x9;////////////////////////////////////#EOL#&#x9;uDT110 = instance.createTableOperator('Update', 'DT110');#EOL#&#x9;uDT110.addValue('DTHAKKOU',&#x9;session.getToday());#EOL#&#x9;uDT110.addKeyValue('NRSEIKYU',&#x9;nrSeikyu);#EOL#&#x9;count = uDT110.execute();#EOL#&#x9;if (count == 1) {#EOL#&#x9;&#x9;instance.callFunction('DF115B');#EOL#&#x9;} else {#EOL#&#x9;&#x9;errorMessage = '請求見出し(DT110)の更新に失敗しました。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#}" SubsystemID="D" Type="XF000"/><Function DetailFixedWhere="KBURIAGE != '90'" DetailKeyFields="NRSEIKYU;NRURIAGE" DetailOrderBy="DT100.DTURIAGE" DetailTable="DT100" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="DT110" ID="DF115B" Margins="50;50;50;50" Name="請求書の印刷" PageSize="A4" SubsystemID="D" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="3" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(請　求　書)"/><Column Alignment="CENTER" DataSource="DT100.KBURIAGE" FieldOptions="CAPTION(取引区分)" Order="0010" Width="10"/><Column Alignment="CENTER" DataSource="DT100.DTURIAGE" FieldOptions="CAPTION(お買上日)" Order="0020" Width="10"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(請求管理№ )&amp;DataSource(DT110.NRSEIKYU)&amp;Text(  請求日 )&amp;DataSource(DT110.DTSEIKYU)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="-18" Value="&amp;DataSource(AT030.TXKANJI)&amp;Text( 御中)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="-18" Value="&amp;Text(毎度お世話になっております。以下のとおり請求させていただきます。ご確認ください。)"/><Column Alignment="RIGHT" DataSource="DT100.PRURIAGE" FieldOptions="CAPTION(単価)" Order="0080" Width="6"/><Column Alignment="RIGHT" DataSource="DT100.QTURIAGE" FieldOptions="CAPTION(お買上数)" Order="0060" Width="7"/><Column Alignment="CENTER" DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0070" Width="4"/><Column Alignment="RIGHT" DataSource="DT100.AMURIAGE" FieldOptions="CAPTION(税抜お買上額),WITH_TOTAL" Order="0090" Width="9"/><Column Alignment="RIGHT" DataSource="DT100.AMTAX" FieldOptions="WITH_TOTAL" Order="0100" Width="5"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0030" Width="10"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="440" Order="0110" SpacingAfter="-18" Value="&amp;Text(前回以降ご入金額 )"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="UNDERLINE" MarginLeft="0" MarginRight="165" Order="0170" SpacingAfter="5" Value="&amp;Text(￥)&amp;DataSource(DT110.AMSEIKYU;a1)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="445" Order="0150" SpacingAfter="-18" Value="&amp;Text(￥)&amp;DataSource(DT110.AMNYUKIN;a1)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="160" Order="0130" SpacingAfter="0" Value="&amp;Text(今回請求額(税込) )"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0080" SpacingAfter="20" Value="&amp;Text(営業担当 )&amp;DataSource(AT020.TXKANJI)"/><Column Alignment="LEFT" DataSource="DT100.TXSYOHIN" FieldOptions="" Order="0050" Width="36"/></Function><Function ID="DF114" InitialMsg="" KeyFields="" Name="請求指示の保守" PrimaryTable="DT110" Size="AUTO" SubsystemID="D" Type="XF200"><Field DataSource="DT110.NRSEIKYU" FieldOptions="" Order="0010"/><Field DataSource="DT110.DTSEIKYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="DT110.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="DT110.AMSEIKYU" FieldOptions="CAPTION(今回請求額),HORIZONTAL" Order="0090"/><Field DataSource="DT110.TXTEKIYO" FieldOptions="" Order="0100"/><Field DataSource="DT110.DTHAKKOU" FieldOptions="" Order="0110"/><Field DataSource="DT110.DTNYUKIN" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="DT110.AMNYUKIN" FieldOptions="" Order="0070"/><Field DataSource="DT110.STSEIKYU" FieldOptions="HORIZONTAL" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/></Function><Function DetailFunction="DF122" ID="DF120" InitialMsg="" KeyFields="" Name="受領データの一覧・保守" OrderBy="DT120.DTJYURYOU" PrimaryTable="DT120" Size="AUTO" SubsystemID="D" Type="XF100"><Column DataSource="DT120.NRJYURYOU" FieldOptions="" Order="0020"/><Column DataSource="DT120.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="DT120.DTJYURYOU" FieldOptions="" Order="0010"/><Column DataSource="DT120.KBNYUKINHOUHOU" FieldOptions="CAPTION(入金方法)" Order="0050"/><Column DataSource="DT120.AMJYURYOU" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(DF121)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0040"/><Filter DataSource="DT120.DTJYURYOU" FieldOptions="GE,CAPTION(受領日≧),VALUE(SESSION_ATTRIBUTE:DateLastMonth)" Order="0010"/><Filter DataSource="DT120.NRTORIHIKISAKI" FieldOptions="" Order="0020"/></Function><Function ContinueAdd="T" ID="DF121" InitialMsg="" KeyFields="" Name="受領データの保守" PrimaryTable="DT120" Size="AUTO" SubsystemID="D" Type="XF200"><Field DataSource="DT120.NRJYURYOU" FieldOptions="" Order="0010"/><Field DataSource="DT120.NRTORIHIKISAKI" FieldOptions="PROMPT_CALL(DF200),PROMPT_CALL_TO_GET(DT010.NRTORIHIKISAKI;AT030.TXKANJI),PROMPT_CALL_TO_GET_TO(DT120.NRTORIHIKISAKI;AT030.TXKANJI)" Order="0040"/><Field DataSource="DT120.DTJYURYOU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="DT120.KBNYUKINHOUHOU" FieldOptions="CAPTION(入金方法),HORIZONTAL" Order="0030"/><Field DataSource="DT120.AMJYURYOU" FieldOptions="" Order="0060"/><Field DataSource="DT120.AMTESURYOU" FieldOptions="HORIZONTAL,COMMENT(*売掛を減額する要素です)" Order="0070"/><Field DataSource="DT120.TXTEKIYO" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/></Function><Function HeaderFunction="DF121" HeaderKeyFields="" HeaderTable="DT120" ID="DF122" Name="受領明細と関連情報の確認" Size="AUTO" SubsystemID="D" Type="XF300"><Field DataSource="DT120.NRJYURYOU" FieldOptions="" Order="0010"/><Field DataSource="DT120.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="DT120.DTJYURYOU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="DT120.KBNYUKINHOUHOU" FieldOptions="CAPTION(入金方法),HORIZONTAL" Order="0030"/><Field DataSource="DT120.AMJYURYOU" FieldOptions="" Order="0060"/><Field DataSource="DT120.AMTESURYOU" FieldOptions="HORIZONTAL,COMMENT(*売掛を減額する要素です)" Order="0070"/><Field DataSource="DT120.TXTEKIYO" FieldOptions="" Order="0080"/><Detail Caption="受領実績" DetailFunction="DF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRURIAGE" Order="0010" Table="DT100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.KBAKADEN" FieldOptions="" Order="0030"/><Column DataSource="DT100.FGVALID" FieldOptions="" Order="0040"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="受領明細情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0050"/><Column DataSource="DT100.AMURIAGE" FieldOptions="CAPTION(売掛増減額)" Order="0060"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/></Function><Function DetailFunction="KF012" ID="KF010" InitialMsg="" KeyFields="" Name="棚卸指示データの一覧・保守" OrderBy="" PrimaryTable="KT010" Size="AUTO" SubsystemID="K" Type="XF100"><Column DataSource="KT010.NRTANAOROSHI" FieldOptions="" Order="0020"/><Column DataSource="KT010.DTKIJYUN" FieldOptions="" Order="0010"/><Column DataSource="KT010.NRSOUKO" FieldOptions="" Order="0030"/><Column DataSource="KT010.NRLOCATION" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(KF011)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT030.TXSOUKO" FieldOptions="" Order="0040"/><Filter DataSource="KT010.NRSOUKO" FieldOptions="" Order="0020"/><Column DataSource="KT010.STTANAOROSHI" FieldOptions="" Order="0060"/><Filter DataSource="KT010.DTKIJYUN" FieldOptions="GENERIC,CAPTION(基準日時≧)" Order="0010"/></Function><Function ID="KF011" InitialMsg="" KeyFields="" Name="棚卸指示の保守" PrimaryTable="KT010" Size="AUTO" SubsystemID="K" Type="XF200"><Field DataSource="KT010.NRTANAOROSHI" FieldOptions="" Order="0010"/><Field DataSource="KT010.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL,COMMENT(上位桁が一致するロケが対象（ブランクならば全ロケ）)" Order="0030"/><Field DataSource="KT010.TXTEKIYO" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),WIDTH(250),HORIZONTAL,PROMPT_LIST" Order="0020"/><Field DataSource="KT010.DTKIJYUN" FieldOptions="" Order="0040"/><Field DataSource="KT010.DTKOUSHIN" FieldOptions="HORIZONTAL" Order="0050"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function HeaderFunction="KF011" HeaderKeyFields="" HeaderTable="KT010" ID="KF012" Name="棚卸指示と関連情報の検討" Size="AUTO" SubsystemID="K" Type="XF300"><Field DataSource="KT010.NRTANAOROSHI" FieldOptions="" Order="0010"/><Field DataSource="KT010.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL,COMMENT(上位桁が一致するロケが対象（ブランクならば全ロケ）)" Order="0040"/><Field DataSource="KT010.DTKIJYUN" FieldOptions="" Order="0050"/><Field DataSource="KT010.DTKOUSHIN" FieldOptions="HORIZONTAL" Order="0060"/><Field DataSource="KT010.TXTEKIYO" FieldOptions="" Order="0070"/><Detail Caption="棚卸指示明細" DetailFunction="KF015" HeaderKeyFields="NRTANAOROSHI" InitialMsg="" KeyFields="NRTANAOROSHI;NRSYOHIN" Order="0010" OrderBy="KT011.NRLOCATION;BT020.TXHINBAN" Table="KT011"><Column DataSource="KT011.NRLOCATION" FieldOptions="" Order="0010"/><Column DataSource="KT011.QTTYOUBO" FieldOptions="CAPTION(帳簿在庫)" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Button Action="CALL(KF013)" Caption="調査表" Number="10" Position="4"/><Button Action="CALL(KF014)" Caption="結果検討表" Number="11" Position="5"/><Column DataSource="KT011.QTJITSUTANA" FieldOptions="" Order="0070"/><Button Action="CALL(KF019)" Caption="編集ツール" Number="5" Position="2"/><Column DataSource="KT011.QTSASUU" FieldOptions="" Order="0080"/><Column DataSource="KT011.AMSAGAKU" FieldOptions="" Order="0100"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Detail><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),WIDTH(250),HORIZONTAL" Order="0030"/><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0020" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0080"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0100"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0070"/></Detail></Function><Function DetailKeyFields="NRTANAOROSHI;NRSYOHIN" DetailOrderBy="KT011.NRLOCATION;BT020.TXHINBAN" DetailTable="KT011" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="KT010" ID="KF013" Margins="50;50;50;50" Name="棚卸調査表の印刷" PageSize="A4" SubsystemID="K" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="5" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0000" SpacingAfter="0" Value="&amp;Text(棚卸調査表)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(棚卸№ )&amp;DataSource(KT010.NRTANAOROSHI)&amp;Text(　)&amp;DataSource(BT030.TXSOUKO)&amp;Text(　調査基準日時 )&amp;DataSource(KT010.DTKIJYUN)"/><Column Alignment="LEFT" DataSource="KT011.NRLOCATION" FieldOptions="" Order="0010" Width="10"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030" Width="42"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020" Width="24"/><Column Alignment="CENTER" DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070" Width="5"/><Column Alignment="RIGHT" DataSource="KT011.TXDUMMY" FieldOptions="CAPTION(実棚数量)" Order="0060" Width="14"/></Function><Function DetailFixedWhere="QTJITSUTANA != QTTYOUBO" DetailKeyFields="NRTANAOROSHI;NRSYOHIN" DetailOrderBy="KT011.NRLOCATION;BT020.TXHINBAN" DetailTable="KT011" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="KT010" ID="KF014" Margins="50;50;50;50" Name="棚卸結果検討表の印刷" PageSize="A4" SubsystemID="K" TableFontID="Font1" TableFontSize="8" TableRowNoWidth="5" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0000" SpacingAfter="0" Value="&amp;Text(棚卸結果検討表)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(棚卸№ )&amp;DataSource(KT010.NRTANAOROSHI)&amp;Text(　)&amp;DataSource(BT030.TXSOUKO)&amp;Text(　調査基準日時 )&amp;DataSource(KT010.DTKIJYUN)"/><Column Alignment="LEFT" DataSource="KT011.NRLOCATION" FieldOptions="" Order="0010" Width="6"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030" Width="29"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020" Width="11"/><Column Alignment="CENTER" DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0080" Width="5"/><Column Alignment="RIGHT" DataSource="KT011.QTTYOUBO" FieldOptions="CAPTION(帳簿在庫),EDIT_CODE(a1)" Order="0050" Width="11"/><Column Alignment="RIGHT" DataSource="KT011.QTJITSUTANA" FieldOptions="EDIT_CODE(a1)" Order="0060" Width="11"/><Column Alignment="RIGHT" DataSource="KT011.AMSAGAKU" FieldOptions="EDIT_CODE(a1)" Order="0090" Width="11"/><Column Alignment="RIGHT" DataSource="KT011.QTSASUU" FieldOptions="EDIT_CODE(a1)" Order="0070" Width="11"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0011" SpacingAfter="0" Value="&amp;Text(＊帳簿在庫数と実棚数で差のある明細のみが一覧されています。必要に応じて実棚数量を修正してください。)"/></Function><Function ID="KF015" InitialMsg="" KeyFields="NRTANAOROSHI;NRSYOHIN" Name="棚卸指示明細の保守" PrimaryTable="KT011" Size="AUTO" SubsystemID="K" Type="XF200"><Field DataSource="KT011.NRTANAOROSHI" FieldOptions="" Order="0010"/><Field DataSource="KT011.QTTYOUBO" FieldOptions="" Order="0060"/><Field DataSource="KT011.QTJITSUTANA" FieldOptions="HORIZONTAL" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN),PROMPT_CALL_TO_GET_TO(KT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN)" Order="0040"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),HORIZONTAL" Order="0020"/><Field DataSource="KT011.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL,PROMPT_CALL(BF110),PROMPT_CALL_TO_PUT(KT010.NRSOUKO),PROMPT_CALL_TO_PUT_TO(BT030.NRSOUKO),PROMPT_CALL_TO_GET(BT031.NRLOCATION),PROMPT_CALL_TO_GET_TO(KT011.NRLOCATION)" Order="0030"/><Field DataSource="KT011.PRUKEBARAI" FieldOptions="HORIZONTAL" Order="0090"/></Function><Function DetailFunction="KF023" ID="KF020" InitialMsg="" KeyFields="" Name="在庫移動指示データの一覧・保守" OrderBy="" PrimaryTable="KT020" Size="AUTO" SubsystemID="K" Type="XF100"><Column DataSource="KT020.NRZAIKOIDOU" FieldOptions="" Order="0020"/><Column DataSource="KT020.DTSHIJI" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(KF021)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="KT020.STZAIKOIDOU" FieldOptions="" Order="0070"/><Filter DataSource="KT020.NRZAIKOIDOU" FieldOptions="" Order="0020"/><Filter DataSource="KT020.STZAIKOIDOU" FieldOptions="PROMPT_LIST1" Order="0030"/><Filter DataSource="KT020.DTSHIJI" FieldOptions="GE,CAPTION(指示日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Column DataSource="BT030FROM.TXSOUKO" FieldOptions="CAPTION(元倉庫)" Order="0040"/><Column DataSource="BT030TO.TXSOUKO" FieldOptions="CAPTION(先倉庫)" Order="0060"/></Function><Function FunctionAfterInsert="KF022" ID="KF021" InitialMsg="" KeyFields="" Name="在庫移動指示の保守" PrimaryTable="KT020" Size="AUTO" SubsystemID="K" Type="XF200"><Field DataSource="KT020.NRZAIKOIDOU" FieldOptions="" Order="0010"/><Field DataSource="KT020.DTSHIJI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="KT020.DTKANRYOYOTEI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="KT020.TXTEKIYO" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT030FROM.TXSOUKO" FieldOptions="CAPTION(移動元／先倉庫),PROMPT_LIST" Order="0040"/><Field DataSource="BT030TO.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL,PROMPT_LIST" Order="0050"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="KT020" ID="KF023" Name="在庫移動指示見出し明細の検討" Size="AUTO" SubsystemID="K" Type="XF300"><Field DataSource="KT020.NRZAIKOIDOU" FieldOptions="" Order="0010"/><Field DataSource="KT020.DTSHIJI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0020"/><Field DataSource="KT020.DTKANRYOYOTEI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0030"/><Field DataSource="KT020.TXTEKIYO" FieldOptions="WIDTH(900)" Order="0090"/><Detail Caption="商品明細" DetailFunction="KF025" InitialMsg="" KeyFields="" Order="0010" Table="KT021"><Column DataSource="KT021.NRLOCATIONTO" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(KF029)" Caption="編集ツール" Number="5" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(KF024A)" Caption="指示書" Number="10" Position="5"/><Column DataSource="KT021.QTIDOU" FieldOptions="WIDTH(100)" Order="0050"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(300)" Order="0030"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(200)" Order="0020"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0060"/><Column DataSource="KT021.TXLOTNUMBER" FieldOptions="WIDTH(300)" Order="0040"/><Column DataSource="ET010FROM.NRLOCATION" FieldOptions="CAPTION(元ロケ№)" Order="0010"/></Detail><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0020" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0070"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0110"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0130"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0090"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0100"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0120"/><Column DataSource="BT030A.TXSOUKO" FieldOptions="" Order="0060"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="" Order="0080"/></Detail><Field DataSource="BT030FROM.TXSOUKO" FieldOptions="CAPTION(移動元／先倉庫)" Order="0050"/><Field DataSource="BT030TO.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="KT020.STZAIKOIDOU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0040"/><Field DataSource="KT020.TMHAKKOU" FieldOptions="" Order="0070"/><Field DataSource="KT020.TMKANRYO" FieldOptions="HORIZONTAL" Order="0080"/></Function><Function ID="KF025" InitialMsg="" KeyFields="" Name="在庫移動指示明細の保守" PrimaryTable="KT021" Size="AUTO" SubsystemID="K" Type="XF200"><Field DataSource="KT021.NRZAIKOIDOU" FieldOptions="" Order="0010"/><Field DataSource="KT021.SQZAIKOIDOU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0020"/><Field DataSource="KT021.NRLOCATIONTO" FieldOptions="HORIZONTAL,PROMPT_CALL(BF110),PROMPT_CALL_TO_PUT(KT020.NRSOUKOTO),PROMPT_CALL_TO_PUT_TO(BT030.NRSOUKO),PROMPT_CALL_TO_GET(BT031.NRLOCATION),PROMPT_CALL_TO_GET_TO(KT021.NRLOCATIONTO)" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="KT021.QTIDOU" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0030"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="ET010FROM.NRLOCATION" FieldOptions="CAPTION(元ロケ№)" Order="0060"/></Function><Function AddBlankRowAllowed="T" DetailKeyFields="" DetailRowNo="SQZAIKOIDOU" DetailTable="KT021" HeaderKeyFields="" HeaderTable="KT020" ID="KF026" InitialMsg="＊更新ボタンを押せば、入力された移動数量にもとづく移動元からの出庫処理と移動先への入庫処理とがなされます。" Name="在庫移動完了エントリー" Size="AUTO" SubsystemID="K" Type="XF310"><Field DataSource="KT020.NRZAIKOIDOU" FieldOptions="" Order="0010"/><Field DataSource="KT020.DTSHIJI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0020"/><Field DataSource="KT020.DTKANRYOYOTEI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0030"/><Field DataSource="KT020.TXTEKIYO" FieldOptions="WIDTH(900)" Order="0090"/><Column DataSource="KT021.NRLOCATIONTO" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="KT020.STZAIKOIDOU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0040"/><Field DataSource="BT030FROM.TXSOUKO" FieldOptions="CAPTION(移動元／先倉庫)" Order="0050"/><Field DataSource="BT030TO.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Column DataSource="KT021.QTIDOU" FieldOptions="WIDTH(100)" Order="0030"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(300)" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(200)" Order="0010"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0040"/><Field DataSource="KT020.TMHAKKOU" FieldOptions="" Order="0070"/><Field DataSource="KT020.TMKANRYO" FieldOptions="HORIZONTAL" Order="0080"/><Column DataSource="KT021.TXLOTNUMBER" FieldOptions="WIDTH(300)" Order="0050"/></Function><Function AddBlankRowAllowed="F" DetailKeyFields="NRTANAOROSHI;NRSYOHIN" DetailOrderBy="KT011.NRLOCATION;BT020.TXHINBAN" DetailRowNo="" DetailTable="KT011" HeaderKeyFields="" HeaderTable="KT010" ID="KF016B" Name="棚卸結果エントリー" Size="AUTO" SubsystemID="K" Type="XF310"><Field DataSource="KT010.NRTANAOROSHI" FieldOptions="" Order="0010"/><Field DataSource="KT010.NRSOUKO" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0020"/><Field DataSource="KT010.DTKIJYUN" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0050"/><Field DataSource="KT010.TXTEKIYO" FieldOptions="WIDTH(1042)" Order="0070"/><Column DataSource="KT011.NRLOCATION" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="KT011.QTJITSUTANA" FieldOptions="" Order="0050"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0030"/></Function><Function ID="KF016A" Name="棚卸結果エントリー(メニュー起動)" Script="instance.callFunction('KF016B'); //棚卸結果エントリー//#EOL#if (instance.returnMap.get('RETURN_CODE') == '20') {#EOL#&#x9;instance.parmMap.put('NRTANAOROSHI', instance.returnMap.get('NRTANAOROSHI'));#EOL#&#x9;instance.parmMap.put('INITIAL_MESSAGE', '＊データは正常に更新されました。');#EOL#&#x9;instance.callFunction('KF012'); //棚卸指示明細の検討//#EOL#} else {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}#EOL#" SubsystemID="K" Type="XF000"/><Function ID="KF018" Name="棚卸指示の削除" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数定義 //#EOL#&#x9;//////////////#EOL#&#x9;var dKT011; var dKT010;#EOL#&#x9;var errorMessage = ''; var count = 0;#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 実行確認 //#EOL#&#x9;//////////////#EOL#&#x9;var answer = JOptionPane.showConfirmDialog(null, '棚卸指示データを削除します。実行しますか？', '棚卸指示の削除', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;if (answer == JOptionPane.OK_OPTION) {#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// 棚卸指示の削除 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dKT011 = instance.createTableOperator('Delete', 'KT011');#EOL#&#x9;&#x9;dKT011.addKeyValue('NRTANAOROSHI',&#x9;instance.parmMap.get('NRTANAOROSHI'));#EOL#&#x9;&#x9;dKT011.execute();#EOL#&#x9;&#x9;dKT010 = instance.createTableOperator('Delete', 'KT010');#EOL#&#x9;&#x9;dKT010.addKeyValue('NRTANAOROSHI',&#x9;instance.parmMap.get('NRTANAOROSHI'));#EOL#&#x9;&#x9;count = dKT010.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '30');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;errorMessage = '＊棚卸指示の削除に失敗しました。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;}#EOL#}" SubsystemID="K" Type="XF000"/><Function ID="KF028" Name="在庫移動指示の削除" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数定義 //#EOL#&#x9;//////////////#EOL#&#x9;var rKT021; var dET200; var dKT021; var dKT020;#EOL#&#x9;var count = 0; var detailCount = 0; var errorMessage = '';#EOL##EOL#&#x9;////////////////////////////////////////#EOL#&#x9;// 実行確認されたら移動指示を削除する //#EOL#&#x9;////////////////////////////////////////#EOL#&#x9;var answer = JOptionPane.showConfirmDialog(null, '在庫移動指示データを削除します。実行しますか？', '在庫移動指示の削除', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;if (answer == JOptionPane.OK_OPTION) {#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 移動指示明細の検索 //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;rKT021 = instance.createTableOperator('Select', 'KT021');#EOL#&#x9;&#x9;rKT021.setSelectFields('NRTORIHIKIKANRIFROM, NRTORIHIKIKANRITO');#EOL#&#x9;&#x9;rKT021.addKeyValue('NRZAIKOIDOU',&#x9;instance.parmMap.get('NRZAIKOIDOU'));#EOL#&#x9;&#x9;while (rKT021.next()) {#EOL#&#x9;&#x9;&#x9;detailCount++;#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;// 入出庫予定の削除 //#EOL#&#x9;&#x9;&#x9;//////////////////////#EOL#&#x9;&#x9;&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;&#x9;&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;rKT021.getValueOf('NRTORIHIKIKANRIFROM'));#EOL#&#x9;&#x9;&#x9;dET200.execute();#EOL#&#x9;&#x9;&#x9;dET200 = instance.createTableOperator('Delete', 'ET200');#EOL#&#x9;&#x9;&#x9;dET200.addKeyValue('NRTORIHIKIKANRI',&#x9;rKT021.getValueOf('NRTORIHIKIKANRITO'));#EOL#&#x9;&#x9;&#x9;dET200.execute();#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 移動指示明細の削除 //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;dKT021 = instance.createTableOperator('Delete', 'KT021');#EOL#&#x9;&#x9;dKT021.addKeyValue('NRZAIKOIDOU',&#x9;instance.parmMap.get('NRZAIKOIDOU'));#EOL#&#x9;&#x9;count = dKT021.execute();#EOL#&#x9;&#x9;if (count != detailCount) {#EOL#&#x9;&#x9;&#x9;errorMessage = '＊在庫移動指示明細の削除に失敗しました。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// 移動指示の削除 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;if (errorMessage == '') {#EOL#&#x9;&#x9;&#x9;dKT020 = instance.createTableOperator('Delete', 'KT020');#EOL#&#x9;&#x9;&#x9;dKT020.addKeyValue('NRZAIKOIDOU',&#x9;instance.parmMap.get('NRZAIKOIDOU'));#EOL#&#x9;&#x9;&#x9;count = dKT020.execute();#EOL#&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '30');#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '＊在庫移動指示の削除に失敗しました。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;// エラー処理 //#EOL#&#x9;&#x9;////////////////#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '31');#EOL#&#x9;}#EOL#}" SubsystemID="K" Type="XF000"/><Function DetailKeyFields="" DetailTable="KT021" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="KT020" ID="KF024B" Margins="50;50;50;50" Name="在庫移動指示書の印刷" PageSize="A4" SubsystemID="K" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="3" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(在庫移動指示書)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(　指示№ )&amp;DataSource(KT020.NRZAIKOIDOU)&amp;Text(　　指示日 )&amp;DataSource(KT020.DTSHIJI)&amp;Text(　　完了予定日 )&amp;DataSource(KT020.DTKANRYOYOTEI)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;Text(　＊以下の商品を  )&amp;DataSource(BT030FROM.TXSOUKO)&amp;Text( から )&amp;DataSource(BT030TO.TXSOUKO)&amp;Text( へ移動してください。 )"/><Column Alignment="LEFT" DataSource="KT021.NRLOCATIONTO" FieldOptions="" Order="0080" Width="8"/><Column Alignment="RIGHT" DataSource="KT021.QTIDOU" FieldOptions="" Order="0060" Width="8"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0040" Width="33"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0030" Width="20"/><Column Alignment="CENTER" DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070" Width="5"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;DataSource(KT020.TXTEKIYO)"/><Column Alignment="LEFT" DataSource="KT021.TXLOTNUMBER" FieldOptions="" Order="0050" Width="15"/><Column Alignment="LEFT" DataSource="ET010FROM.NRLOCATION" FieldOptions="CAPTION(元ロケ№)" Order="0020" Width="8"/></Function><Function AddBlankRowAllowed="T" DetailKeyFields="" DetailRowNo="SQZAIKOIDOU" DetailTable="KT021" HeaderKeyFields="" HeaderTable="KT020" ID="KF027" Name="在庫移動完了取消処理" Size="AUTO" SubsystemID="K" Type="XF310"><Field DataSource="KT020.NRZAIKOIDOU" FieldOptions="" Order="0010"/><Field DataSource="KT020.DTSHIJI" FieldOptions="HORIZONTAL" Order="0020"/><Column DataSource="KT021.NRLOCATIONTO" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="完了取消" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="KT020.STZAIKOIDOU" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="BT030FROM.TXSOUKO" FieldOptions="CAPTION(移動元／先倉庫)" Order="0050"/><Field DataSource="BT030TO.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Column DataSource="KT021.QTIDOU" FieldOptions="WIDTH(100)" Order="0030"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(300)" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(200)" Order="0010"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0040"/><Field DataSource="KT020.DTKANRYOYOTEI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="KT020.TMHAKKOU" FieldOptions="" Order="0070"/><Field DataSource="KT020.TMKANRYO" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="KT020.TXTEKIYO" FieldOptions="" Order="0090"/><Column DataSource="KT021.TXLOTNUMBER" FieldOptions="WIDTH(300)" Order="0050"/></Function><Function DetailFunction="YF011" ID="YF010" InitialMsg="" KeyFields="" Name="年次取引サマリの一覧" OrderBy="" PrimaryTable="YT010" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="YT010.DTNEND" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="YT010.DTNEND" FieldOptions="GE,CAPTION(年度≧)" Order="0010"/><Column DataSource="YT010.AMURIKISYUZAN" FieldOptions="" Order="0020"/><Column DataSource="YT010.AMURISYUK" FieldOptions="" Order="0030"/><Column DataSource="YT010.AMURITYOK" FieldOptions="" Order="0040"/><Column DataSource="YT010.AMURIHENPIN" FieldOptions="" Order="0050"/><Column DataSource="YT010.AMURIZATSUEKI" FieldOptions="" Order="0060"/><Column DataSource="YT010.AMURIZATSUSON" FieldOptions="" Order="0070"/><Column DataSource="YT010.AMURISOUSAI" FieldOptions="" Order="0080"/><Column DataSource="YT010.AMURINEBIKI" FieldOptions="" Order="0130"/><Column DataSource="YT010.AMURIJYURYO" FieldOptions="" Order="0110"/><Column DataSource="YT010.AMURIGENKA" FieldOptions="" Order="0140"/><Column DataSource="YT010.AMURITAX" FieldOptions="" Order="0100"/><Column DataSource="YT010.AMKAIKISYUZAN" FieldOptions="" Order="0160"/><Column DataSource="YT010.AMKAINYUK" FieldOptions="" Order="0170"/><Column DataSource="YT010.AMKAITYOK" FieldOptions="" Order="0180"/><Column DataSource="YT010.AMKAIHENPIN" FieldOptions="" Order="0190"/><Column DataSource="YT010.AMKAIZATSUEKI" FieldOptions="" Order="0200"/><Column DataSource="YT010.AMKAIZATSUSON" FieldOptions="" Order="0210"/><Column DataSource="YT010.AMKAISOUSAI" FieldOptions="" Order="0220"/><Column DataSource="YT010.AMKAIGENKA" FieldOptions="" Order="0230"/><Column DataSource="YT010.AMKAISIHARAI" FieldOptions="" Order="0240"/><Column DataSource="YT010.AMKAITAX" FieldOptions="" Order="0250"/><Column DataSource="YT010.AMZAIKISYUZAN" FieldOptions="" Order="0270"/><Column DataSource="YT010.AMZAINYUK" FieldOptions="" Order="0280"/><Column DataSource="YT010.AMZAINYUKHEN" FieldOptions="" Order="0290"/><Column DataSource="YT010.AMZAISYUK" FieldOptions="" Order="0300"/><Column DataSource="YT010.AMZAISYUKHEN" FieldOptions="" Order="0310"/><Column DataSource="YT010.AMZAIIDOU" FieldOptions="" Order="0320"/><Column DataSource="YT010.AMZAIGENMOU" FieldOptions="" Order="0330"/><Column DataSource="YT010.AMZAIHYOKAZON" FieldOptions="" Order="0340"/><Column DataSource="YT010.AMZAIHYOKAEKI" FieldOptions="" Order="0350"/><Column DataSource="YT010.AMZAISIKAKARI" FieldOptions="" Order="0360"/><Column DataSource="YT010.AMZAIZATSUSON" FieldOptions="" Order="0370"/><Column DataSource="YT010.AMZAIZATSUEKI" FieldOptions="" Order="0380"/><Column DataSource="YT010.AMZAIKANSEI" FieldOptions="" Order="0390"/><Column DataSource="YT010.AMZAIKAKOUHI" FieldOptions="" Order="0400"/><Column DataSource="YT010.AMZAIZOUGEN" FieldOptions="" Order="0410"/><Column DataSource="YT010.AMURIKIMATSUZAN" FieldOptions="" Order="0120"/><Column DataSource="YT010.AMKAIKIMATSUZAN" FieldOptions="" Order="0260"/><Column DataSource="YT010.AMZAIKIMATSUZAN" FieldOptions="" Order="0420"/><Column DataSource="YT010.AMURIHANHURI" FieldOptions="" Order="0090"/><Column DataSource="YT010.AMURIARARI" FieldOptions="" Order="0150"/></Function><Function DetailFunction="YF021" ID="YF020" InitialMsg="" KeyFields="" Name="月次取引サマリの一覧" OrderBy="" PrimaryTable="YT020" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="YT020.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT020.DTMSEQ" FieldOptions="" Order="0020"/><Column DataSource="YT020.AMURIKISYUZAN" FieldOptions="" Order="0030"/><Column DataSource="YT020.AMURISYUK" FieldOptions="" Order="0040"/><Column DataSource="YT020.AMURITYOK" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="YT020.AMURIHENPIN" FieldOptions="" Order="0060"/><Column DataSource="YT020.AMURIZATSUEKI" FieldOptions="" Order="0070"/><Column DataSource="YT020.AMURIZATSUSON" FieldOptions="" Order="0080"/><Column DataSource="YT020.AMURISOUSAI" FieldOptions="" Order="0090"/><Column DataSource="YT020.AMURINEBIKI" FieldOptions="" Order="0140"/><Column DataSource="YT020.AMURIJYURYO" FieldOptions="" Order="0120"/><Column DataSource="YT020.AMURIGENKA" FieldOptions="" Order="0150"/><Column DataSource="YT020.AMURITAX" FieldOptions="" Order="0110"/><Column DataSource="YT020.AMURIKIMATSUZAN" FieldOptions="" Order="0130"/><Column DataSource="YT020.AMKAIKISYUZAN" FieldOptions="" Order="0170"/><Column DataSource="YT020.AMKAINYUK" FieldOptions="" Order="0180"/><Column DataSource="YT020.AMKAITYOK" FieldOptions="" Order="0190"/><Column DataSource="YT020.AMKAIHENPIN" FieldOptions="" Order="0200"/><Column DataSource="YT020.AMKAIZATSUEKI" FieldOptions="" Order="0210"/><Column DataSource="YT020.AMKAIZATSUSON" FieldOptions="" Order="0220"/><Column DataSource="YT020.AMKAISOUSAI" FieldOptions="" Order="0230"/><Column DataSource="YT020.AMKAIGENKA" FieldOptions="" Order="0240"/><Column DataSource="YT020.AMKAISIHARAI" FieldOptions="" Order="0250"/><Column DataSource="YT020.AMKAITAX" FieldOptions="" Order="0260"/><Column DataSource="YT020.AMKAIKIMATSUZAN" FieldOptions="" Order="0270"/><Column DataSource="YT020.AMZAIKISYUZAN" FieldOptions="" Order="0280"/><Column DataSource="YT020.AMZAINYUK" FieldOptions="" Order="0290"/><Column DataSource="YT020.AMZAINYUKHEN" FieldOptions="" Order="0300"/><Column DataSource="YT020.AMZAISYUK" FieldOptions="" Order="0310"/><Column DataSource="YT020.AMZAISYUKHEN" FieldOptions="" Order="0320"/><Column DataSource="YT020.AMZAIIDOU" FieldOptions="" Order="0330"/><Column DataSource="YT020.AMZAIGENMOU" FieldOptions="" Order="0340"/><Column DataSource="YT020.AMZAIHYOKAZON" FieldOptions="" Order="0350"/><Column DataSource="YT020.AMZAIHYOKAEKI" FieldOptions="" Order="0360"/><Column DataSource="YT020.AMZAISIKAKARI" FieldOptions="" Order="0370"/><Column DataSource="YT020.AMZAIZATSUSON" FieldOptions="" Order="0380"/><Column DataSource="YT020.AMZAIZATSUEKI" FieldOptions="" Order="0390"/><Column DataSource="YT020.AMZAIKANSEI" FieldOptions="" Order="0400"/><Column DataSource="YT020.AMZAIKAKOUHI" FieldOptions="" Order="0410"/><Column DataSource="YT020.AMZAIZOUGEN" FieldOptions="" Order="0420"/><Column DataSource="YT020.AMZAIKIMATSUZAN" FieldOptions="" Order="0430"/><Filter DataSource="YT020.DTNEND" FieldOptions="GE,CAPTION(年度≧)" Order="0010"/><Filter DataSource="YT020.DTMSEQ" FieldOptions="" Order="0020"/><Column DataSource="YT020.AMURIHANHURI" FieldOptions="" Order="0100"/><Column DataSource="YT020.AMURIARARI" FieldOptions="" Order="0160"/></Function><Function ID="YF100" Name="実績集計処理の起動" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var dYT010; var dYT020; var rYT020; var cYT020; var dYT030; var dYT031;#EOL#var dYT040; var dYT041; var dYT050; var dYT051; var dYT060;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var wrkStr = session.getSystemVariantString('ALLOWED_FISCAL_MONTH') + '';#EOL#var limitNend = wrkStr.substring(0, 4);#EOL#var limitMSeq = wrkStr.substring(4, 6);#EOL#var today = session.today + '';#EOL#var futureLimitNend = session.getFYearOfDate(today);#EOL#var futureLimitMSeq = session.getMSeqOfDate(today);#EOL#instance.parmMap.put('LIMIT_NEND', limitNend);#EOL#instance.parmMap.put('LIMIT_MSEQ', limitMSeq);#EOL##EOL#//////////////////////////////////////////#EOL#// 各取引サマリの対象期間データのクリア //#EOL#//////////////////////////////////////////#EOL#clearData();#EOL##EOL#///////////////////////////////////////////////////#EOL#// 月次取引サマリ(YT020)の対象期間データの初期化 //#EOL#///////////////////////////////////////////////////#EOL#initializeData();#EOL##EOL#////////////////////////#EOL#// 取引実績の集計処理 //#EOL#////////////////////////#EOL#instance.callFunction('YF110'); // 受払実績集計 //#EOL#instance.callFunction('YF111'); // 仕入実績集計 //#EOL#instance.callFunction('YF112'); // 売上実績集計(顧客別) //#EOL#instance.callFunction('YF113'); // 売上実績集計(営業担当別) //#EOL##EOL#//////////////////////#EOL#// 期首残高設定処理 //#EOL#//////////////////////#EOL#instance.callFunction('YF120'); //倉庫別在庫残高//#EOL#instance.callFunction('YF121'); //商品別在庫残高//#EOL#instance.callFunction('YF122'); //買掛残高//#EOL#instance.callFunction('YF123'); //売掛残高//#EOL##EOL#///////////////////////#EOL#// 月次･年次集計処理 //#EOL#///////////////////////#EOL#instance.callFunction('YF130'); //月次集計//#EOL#instance.callFunction('YF131'); //年次集計//#EOL##EOL#//////////////////////////////////////#EOL#// サマリテーブルのCOMPRESSとCOMMIT //#EOL#//////////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;session.compressTable('YT');#EOL#&#x9;instance.commit();#EOL#} else {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#//////////////////////////////////////////#EOL#// 各取引サマリの対象期間データのクリア //#EOL#//////////////////////////////////////////#EOL#function clearData() {#EOL#&#x9;dYT010 = instance.createTableOperator('Delete', 'YT010');#EOL#&#x9;dYT010.addKeyValue('DTNEND >=',&#x9;limitNend);#EOL#&#x9;dYT010.execute();#EOL##EOL#&#x9;dYT020 = instance.createTableOperator('Delete', 'YT020');#EOL#&#x9;dYT020.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT020.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT020.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT020.execute();#EOL##EOL#&#x9;dYT030 = instance.createTableOperator('Delete', 'YT030');#EOL#&#x9;dYT030.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT030.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT030.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT030.execute();#EOL##EOL#&#x9;dYT031 = instance.createTableOperator('Delete', 'YT031');#EOL#&#x9;dYT031.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT031.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT031.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT031.execute();#EOL##EOL#&#x9;dYT040 = instance.createTableOperator('Delete', 'YT040');#EOL#&#x9;dYT040.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT040.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT040.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT040.execute();#EOL##EOL#&#x9;dYT041 = instance.createTableOperator('Delete', 'YT041');#EOL#&#x9;dYT041.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT041.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT041.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT041.execute();#EOL##EOL#&#x9;dYT050 = instance.createTableOperator('Delete', 'YT050');#EOL#&#x9;dYT050.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT050.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT050.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT050.execute();#EOL##EOL#&#x9;dYT051 = instance.createTableOperator('Delete', 'YT051');#EOL#&#x9;dYT051.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT051.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT051.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT051.execute();#EOL##EOL#&#x9;dYT060 = instance.createTableOperator('Delete', 'YT060');#EOL#&#x9;dYT060.addKeyValue('(', 'DTNEND >',  limitNend, ') or');#EOL#&#x9;dYT060.addKeyValue('(', 'DTNEND =',  limitNend, ' and');#EOL#&#x9;dYT060.addKeyValue('',  'DTMSEQ >=', limitMSeq, ')');#EOL#&#x9;dYT060.execute();#EOL#}#EOL##EOL#///////////////////////////////////////////////////#EOL#// 月次取引サマリ(YT020)の対象期間データの初期化 //#EOL#///////////////////////////////////////////////////#EOL#function initializeData() {#EOL##EOL#&#x9;////////////////#EOL#&#x9;// 年月初期化 //#EOL#&#x9;////////////////#EOL#&#x9;var workNend = limitNend;#EOL#&#x9;var workMSeq = 1;#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 期間内の年月向けに繰り返す //#EOL#&#x9;////////////////////////////////#EOL#&#x9;while (workNend &lt; futureLimitNend || (workNend == futureLimitNend &amp;&amp; workMSeq &lt;= futureLimitMSeq)) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 指定年月向けレコードがなければ追加する //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;rYT020 = instance.createTableOperator('Count', 'YT020');#EOL#&#x9;&#x9;rYT020.addKeyValue('DTNEND',&#x9;workNend);#EOL#&#x9;&#x9;rYT020.addKeyValue('DTMSEQ',&#x9;workMSeq);#EOL#&#x9;&#x9;if (rYT020.execute() == 0) {#EOL#&#x9;&#x9;&#x9;cYT020 = instance.createTableOperator('Insert', 'YT020');#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTNEND',&#x9;workNend);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTMSEQ',&#x9;workMSeq);#EOL#&#x9;&#x9;&#x9;count = cYT020.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 年月のカウントアップ //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;if (workMSeq == 12) {#EOL#&#x9;&#x9;&#x9;workNend++;#EOL#&#x9;&#x9;&#x9;workMSeq = 1;#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;workMSeq++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="Y" TimerMessage="＊規定範囲の取引実績にもとづく年次･月次集計がなされます。一般ユーザのセッションが立ち上がっていないことを確認したうえで、実行してください。" TimerOption="0:0" Type="XF000"/><Function DetailFunction="YF031" ID="YF030" InitialMsg="" KeyFields="" Name="商品別月次取引サマリの一覧" OrderBy="" PrimaryTable="YT030" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="YT030.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT030.DTMSEQ" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0040"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0030"/><Column DataSource="BT020.PRHANBAI" FieldOptions="" Order="0060"/><Column DataSource="BT020.PRSIIRE" FieldOptions="" Order="0070"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0050"/><Column DataSource="YT030.AMZAIKISYUZAN" FieldOptions="" Order="0080"/><Column DataSource="YT030.QTZAIKISYUZAN" FieldOptions="" Order="0090"/><Column DataSource="YT030.AMZAINYUK" FieldOptions="" Order="0100"/><Column DataSource="YT030.QTZAINYUK" FieldOptions="" Order="0110"/><Column DataSource="YT030.AMZAINYUKHEN" FieldOptions="" Order="0120"/><Column DataSource="YT030.QTZAINYUKHEN" FieldOptions="" Order="0130"/><Column DataSource="YT030.AMZAISYUK" FieldOptions="" Order="0140"/><Column DataSource="YT030.QTZAISYUK" FieldOptions="" Order="0150"/><Column DataSource="YT030.AMZAISYUKHEN" FieldOptions="" Order="0160"/><Column DataSource="YT030.QTZAISYUKHEN" FieldOptions="" Order="0170"/><Column DataSource="YT030.AMZAIIDOU" FieldOptions="" Order="0190"/><Column DataSource="YT030.QTZAIIDOU" FieldOptions="" Order="0200"/><Column DataSource="YT030.AMZAIGENMOU" FieldOptions="" Order="0210"/><Column DataSource="YT030.QTZAIGENMOU" FieldOptions="" Order="0220"/><Column DataSource="YT030.AMZAIHYOKAZON" FieldOptions="" Order="0230"/><Column DataSource="YT030.AMZAIHYOKAEKI" FieldOptions="" Order="0240"/><Column DataSource="YT030.AMZAISIKAKARI" FieldOptions="" Order="0250"/><Column DataSource="YT030.QTZAISIKAKARI" FieldOptions="" Order="0260"/><Column DataSource="YT030.AMZAIZATSUSON" FieldOptions="" Order="0270"/><Column DataSource="YT030.QTZAIZATSUSON" FieldOptions="" Order="0280"/><Column DataSource="YT030.AMZAIZATSUEKI" FieldOptions="" Order="0290"/><Column DataSource="YT030.QTZAIZATSUEKI" FieldOptions="" Order="0300"/><Column DataSource="YT030.AMZAIKANSEI" FieldOptions="" Order="0310"/><Column DataSource="YT030.QTZAIKANSEI" FieldOptions="" Order="0320"/><Column DataSource="YT030.AMZAIKAKOUHI" FieldOptions="" Order="0330"/><Column DataSource="YT030.AMZAIZOUGEN" FieldOptions="" Order="0340"/><Column DataSource="YT030.QTZAIZOUGEN" FieldOptions="" Order="0350"/><Column DataSource="YT030.AMZAIKIMATSUZAN" FieldOptions="" Order="0360"/><Column DataSource="YT030.QTZAIKIMATSUZAN" FieldOptions="" Order="0370"/><Filter DataSource="YT030.DTNEND" FieldOptions="GE,CAPTION(年度≧)" Order="0010"/><Filter DataSource="YT030.DTMSEQ" FieldOptions="" Order="0020"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番Scan)" Order="0030"/><Column DataSource="YT030.AMZAIARARI" FieldOptions="" Order="0180"/><Filter DataSource="BT020.KBSYOHIN" FieldOptions="PROMPT_LIST1" Order="0040"/></Function><Function DetailFunction="YF041" ID="YF040" InitialMsg="" KeyFields="" Name="仕入先別月次取引サマリの一覧" OrderBy="" PrimaryTable="YT040" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="YT040.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT040.DTMSEQ" FieldOptions="" Order="0020"/><Column DataSource="YT040.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="YT040.AMKAIKISYUZAN" FieldOptions="" Order="0060"/><Column DataSource="YT040.AMKAINYUK" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0040"/><Column DataSource="AT030.KBCOUNTRY" FieldOptions="" Order="0050"/><Column DataSource="YT040.AMKAITYOK" FieldOptions="" Order="0080"/><Column DataSource="YT040.AMKAIHENPIN" FieldOptions="" Order="0090"/><Column DataSource="YT040.AMKAIZATSUEKI" FieldOptions="" Order="0100"/><Column DataSource="YT040.AMKAIZATSUSON" FieldOptions="" Order="0110"/><Column DataSource="YT040.AMKAISOUSAI" FieldOptions="" Order="0120"/><Column DataSource="YT040.AMKAIGENKA" FieldOptions="" Order="0130"/><Column DataSource="YT040.AMKAISIHARAI" FieldOptions="" Order="0140"/><Column DataSource="YT040.AMKAITAX" FieldOptions="" Order="0150"/><Column DataSource="YT040.AMKAIKIMATSUZAN" FieldOptions="" Order="0160"/><Filter DataSource="YT040.DTNEND" FieldOptions="GE,CAPTION(年度≧)" Order="0010"/><Filter DataSource="YT040.DTMSEQ" FieldOptions="" Order="0020"/><Filter DataSource="YT040.NRTORIHIKISAKI" FieldOptions="" Order="0030"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT010" ID="YF011" Name="年次取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT010.DTNEND" FieldOptions="" Order="0010"/><Detail Caption="月度別" DetailFunction="YF021" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" Table="YT020"><Column DataSource="YT020.DTMSEQ" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="YT020.AMURIKISYUZAN" FieldOptions="" Order="0020"/><Column DataSource="YT020.AMURISYUK" FieldOptions="" Order="0030"/><Column DataSource="YT020.AMURITYOK" FieldOptions="" Order="0040"/><Column DataSource="YT020.AMURIHENPIN" FieldOptions="" Order="0050"/><Column DataSource="YT020.AMURIZATSUEKI" FieldOptions="" Order="0060"/><Column DataSource="YT020.AMURIZATSUSON" FieldOptions="" Order="0070"/><Column DataSource="YT020.AMURISOUSAI" FieldOptions="" Order="0080"/><Column DataSource="YT020.AMURINEBIKI" FieldOptions="" Order="0130"/><Column DataSource="YT020.AMURIJYURYO" FieldOptions="" Order="0110"/><Column DataSource="YT020.AMURIGENKA" FieldOptions="" Order="0140"/><Column DataSource="YT020.AMURITAX" FieldOptions="" Order="0100"/><Column DataSource="YT020.AMKAIKISYUZAN" FieldOptions="" Order="0160"/><Column DataSource="YT020.AMKAINYUK" FieldOptions="" Order="0170"/><Column DataSource="YT020.AMKAITYOK" FieldOptions="" Order="0180"/><Column DataSource="YT020.AMKAIHENPIN" FieldOptions="" Order="0190"/><Column DataSource="YT020.AMKAIZATSUEKI" FieldOptions="" Order="0200"/><Column DataSource="YT020.AMKAIZATSUSON" FieldOptions="" Order="0210"/><Column DataSource="YT020.AMKAISOUSAI" FieldOptions="" Order="0220"/><Column DataSource="YT020.AMKAIGENKA" FieldOptions="" Order="0230"/><Column DataSource="YT020.AMKAISIHARAI" FieldOptions="" Order="0240"/><Column DataSource="YT020.AMKAITAX" FieldOptions="" Order="0250"/><Column DataSource="YT020.AMZAIKISYUZAN" FieldOptions="" Order="0270"/><Column DataSource="YT020.AMZAINYUK" FieldOptions="" Order="0280"/><Column DataSource="YT020.AMZAINYUKHEN" FieldOptions="" Order="0290"/><Column DataSource="YT020.AMZAISYUK" FieldOptions="" Order="0300"/><Column DataSource="YT020.AMZAISYUKHEN" FieldOptions="" Order="0310"/><Column DataSource="YT020.AMZAIIDOU" FieldOptions="" Order="0320"/><Column DataSource="YT020.AMZAIGENMOU" FieldOptions="" Order="0330"/><Column DataSource="YT020.AMZAIHYOKAZON" FieldOptions="" Order="0340"/><Column DataSource="YT020.AMZAIHYOKAEKI" FieldOptions="" Order="0350"/><Column DataSource="YT020.AMZAISIKAKARI" FieldOptions="" Order="0360"/><Column DataSource="YT020.AMZAIZATSUSON" FieldOptions="" Order="0370"/><Column DataSource="YT020.AMZAIZATSUEKI" FieldOptions="" Order="0380"/><Column DataSource="YT020.AMZAIKANSEI" FieldOptions="" Order="0390"/><Column DataSource="YT020.AMZAIKAKOUHI" FieldOptions="" Order="0400"/><Column DataSource="YT020.AMZAIZOUGEN" FieldOptions="" Order="0410"/><Column DataSource="YT020.AMZAIKIMATSUZAN" FieldOptions="" Order="0420"/><Column DataSource="YT020.AMURIKIMATSUZAN" FieldOptions="" Order="0120"/><Column DataSource="YT020.AMKAIKIMATSUZAN" FieldOptions="" Order="0260"/><Column DataSource="YT020.AMURIHANHURI" FieldOptions="" Order="0090"/><Column DataSource="YT020.AMURIARARI" FieldOptions="" Order="0150"/></Detail><Field DataSource="YT010.AMURIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0020"/><Field DataSource="YT010.AMURISYUK" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="YT010.AMURITYOK" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="YT010.AMURIHENPIN" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="YT010.AMURIZATSUEKI" FieldOptions="" Order="0060"/><Field DataSource="YT010.AMURIZATSUSON" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="YT010.AMURISOUSAI" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="YT010.AMURINEBIKI" FieldOptions="" Order="0130"/><Field DataSource="YT010.AMURIJYURYO" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="YT010.AMURIGENKA" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="YT010.AMURITAX" FieldOptions="" Order="0100"/><Field DataSource="YT010.AMKAIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0160"/><Field DataSource="YT010.AMKAINYUK" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="YT010.AMKAITYOK" FieldOptions="HORIZONTAL" Order="0180"/><Field DataSource="YT010.AMKAIHENPIN" FieldOptions="HORIZONTAL" Order="0190"/><Field DataSource="YT010.AMKAIZATSUEKI" FieldOptions="" Order="0200"/><Field DataSource="YT010.AMKAIZATSUSON" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="YT010.AMKAISOUSAI" FieldOptions="HORIZONTAL" Order="0220"/><Field DataSource="YT010.AMKAIGENKA" FieldOptions="HORIZONTAL" Order="0230"/><Field DataSource="YT010.AMKAISIHARAI" FieldOptions="" Order="0240"/><Field DataSource="YT010.AMKAITAX" FieldOptions="HORIZONTAL" Order="0250"/><Field DataSource="YT010.AMZAIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0270"/><Field DataSource="YT010.AMZAINYUK" FieldOptions="HORIZONTAL" Order="0280"/><Field DataSource="YT010.AMZAINYUKHEN" FieldOptions="HORIZONTAL" Order="0290"/><Field DataSource="YT010.AMZAISYUK" FieldOptions="HORIZONTAL" Order="0300"/><Field DataSource="YT010.AMZAISYUKHEN" FieldOptions="" Order="0310"/><Field DataSource="YT010.AMZAIIDOU" FieldOptions="HORIZONTAL" Order="0320"/><Field DataSource="YT010.AMZAIGENMOU" FieldOptions="HORIZONTAL" Order="0330"/><Field DataSource="YT010.AMZAIHYOKAZON" FieldOptions="HORIZONTAL" Order="0340"/><Field DataSource="YT010.AMZAIHYOKAEKI" FieldOptions="" Order="0350"/><Field DataSource="YT010.AMZAISIKAKARI" FieldOptions="HORIZONTAL" Order="0360"/><Field DataSource="YT010.AMZAIZATSUSON" FieldOptions="HORIZONTAL" Order="0370"/><Field DataSource="YT010.AMZAIZATSUEKI" FieldOptions="HORIZONTAL" Order="0380"/><Field DataSource="YT010.AMZAIKANSEI" FieldOptions="" Order="0390"/><Field DataSource="YT010.AMZAIKAKOUHI" FieldOptions="HORIZONTAL" Order="0400"/><Field DataSource="YT010.AMZAIZOUGEN" FieldOptions="HORIZONTAL" Order="0410"/><Field DataSource="YT010.AMURIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="YT010.AMKAIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0260"/><Field DataSource="YT010.AMZAIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0420"/><Field DataSource="YT010.AMURIHANHURI" FieldOptions="HORIZONTAL" Order="0090"/><Field DataSource="YT010.AMURIARARI" FieldOptions="HORIZONTAL" Order="0150"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT020" ID="YF021" Name="月次取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT020.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT020.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Detail Caption="仕入先別仕入サマリ" DetailFunction="YF041" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0020" Table="YT040"><Column DataSource="YT040.AMKAIKISYUZAN" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020"/><Column DataSource="YT040.AMKAINYUK" FieldOptions="" Order="0060"/><Column DataSource="YT040.AMKAITYOK" FieldOptions="" Order="0070"/><Column DataSource="YT040.AMKAIHENPIN" FieldOptions="" Order="0080"/><Column DataSource="YT040.AMKAIZATSUEKI" FieldOptions="" Order="0090"/><Column DataSource="YT040.AMKAIZATSUSON" FieldOptions="" Order="0100"/><Column DataSource="YT040.AMKAISOUSAI" FieldOptions="" Order="0110"/><Column DataSource="YT040.AMKAIGENKA" FieldOptions="" Order="0120"/><Column DataSource="YT040.AMKAISIHARAI" FieldOptions="" Order="0130"/><Column DataSource="YT040.AMKAITAX" FieldOptions="" Order="0140"/><Column DataSource="YT040.AMKAIKIMATSUZAN" FieldOptions="" Order="0150"/><Column DataSource="AT030.KBCOUNTRY" FieldOptions="" Order="0030"/><Column DataSource="YT040.NRTORIHIKISAKI" FieldOptions="" Order="0010"/></Detail><Detail Caption="商品別受払サマリ" DetailFunction="YF031" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" Table="YT030"><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0010"/><Column DataSource="YT030.AMZAIKISYUZAN" FieldOptions="" Order="0060"/><Column DataSource="YT030.AMZAINYUK" FieldOptions="" Order="0080"/><Column DataSource="YT030.QTZAINYUK" FieldOptions="" Order="0090"/><Column DataSource="YT030.AMZAINYUKHEN" FieldOptions="" Order="0100"/><Column DataSource="YT030.QTZAINYUKHEN" FieldOptions="" Order="0110"/><Column DataSource="YT030.AMZAISYUK" FieldOptions="" Order="0120"/><Column DataSource="YT030.QTZAISYUK" FieldOptions="" Order="0130"/><Column DataSource="YT030.AMZAISYUKHEN" FieldOptions="" Order="0140"/><Column DataSource="YT030.QTZAISYUKHEN" FieldOptions="" Order="0150"/><Column DataSource="YT030.AMZAIIDOU" FieldOptions="" Order="0170"/><Column DataSource="YT030.QTZAIIDOU" FieldOptions="" Order="0180"/><Column DataSource="YT030.AMZAIGENMOU" FieldOptions="" Order="0190"/><Column DataSource="YT030.QTZAIGENMOU" FieldOptions="" Order="0200"/><Column DataSource="YT030.AMZAIHYOKAZON" FieldOptions="" Order="0210"/><Column DataSource="YT030.AMZAIHYOKAEKI" FieldOptions="" Order="0220"/><Column DataSource="YT030.AMZAISIKAKARI" FieldOptions="" Order="0230"/><Column DataSource="YT030.QTZAISIKAKARI" FieldOptions="" Order="0240"/><Column DataSource="YT030.AMZAIZATSUSON" FieldOptions="" Order="0250"/><Column DataSource="YT030.QTZAIZATSUSON" FieldOptions="" Order="0260"/><Column DataSource="YT030.AMZAIZATSUEKI" FieldOptions="" Order="0270"/><Column DataSource="YT030.QTZAIZATSUEKI" FieldOptions="" Order="0280"/><Column DataSource="YT030.AMZAIKANSEI" FieldOptions="" Order="0290"/><Column DataSource="YT030.QTZAIKANSEI" FieldOptions="" Order="0300"/><Column DataSource="YT030.AMZAIKAKOUHI" FieldOptions="" Order="0310"/><Column DataSource="YT030.AMZAIZOUGEN" FieldOptions="" Order="0320"/><Column DataSource="YT030.QTZAIZOUGEN" FieldOptions="" Order="0330"/><Column DataSource="YT030.AMZAIKIMATSUZAN" FieldOptions="" Order="0340"/><Column DataSource="YT030.QTZAIKISYUZAN" FieldOptions="" Order="0070"/><Column DataSource="YT030.QTZAIKIMATSUZAN" FieldOptions="" Order="0350"/><Column DataSource="BT020.PRHANBAI" FieldOptions="" Order="0040"/><Column DataSource="BT020.PRSIIRE" FieldOptions="" Order="0050"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0030"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番Scan)" Order="0020"/><Column DataSource="YT030.AMZAIARARI" FieldOptions="" Order="0160"/><Filter DataSource="BT020.KBSYOHIN" FieldOptions="PROMPT_LIST1" Order="0010"/></Detail><Detail Caption="顧客別売上サマリ" DetailFunction="YF051" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0030" Table="YT050"><Column DataSource="YT050.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Column DataSource="YT050.AMURIKISYUZAN" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0020"/><Column DataSource="YT050.AMURISYUK" FieldOptions="" Order="0040"/><Column DataSource="YT050.AMURITYOK" FieldOptions="" Order="0050"/><Column DataSource="YT050.AMURIHENPIN" FieldOptions="" Order="0060"/><Column DataSource="YT050.AMURIZATSUEKI" FieldOptions="" Order="0070"/><Column DataSource="YT050.AMURIZATSUSON" FieldOptions="" Order="0080"/><Column DataSource="YT050.AMURISOUSAI" FieldOptions="" Order="0090"/><Column DataSource="YT050.AMURINEBIKI" FieldOptions="" Order="0140"/><Column DataSource="YT050.AMURIJYURYO" FieldOptions="" Order="0120"/><Column DataSource="YT050.AMURIGENKA" FieldOptions="" Order="0150"/><Column DataSource="YT050.AMURITAX" FieldOptions="" Order="0110"/><Column DataSource="YT050.AMURIKIMATSUZAN" FieldOptions="" Order="0130"/><Column DataSource="YT050.AMURIARARI" FieldOptions="" Order="0160"/><Column DataSource="YT050.AMURIHANHURI" FieldOptions="" Order="0100"/></Detail><Detail Caption="営業担当別売上サマリ" DetailFunction="YF061" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0040" Table="YT060"><Column DataSource="YT060.NRTANTOUJYUGYOIN" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(担当者名)" Order="0020"/><Column DataSource="YT060.AMURISYUK" FieldOptions="" Order="0030"/><Column DataSource="YT060.AMURITYOK" FieldOptions="" Order="0040"/><Column DataSource="YT060.AMURIHENPIN" FieldOptions="" Order="0050"/><Column DataSource="YT060.AMURIZATSUEKI" FieldOptions="" Order="0060"/><Column DataSource="YT060.AMURIZATSUSON" FieldOptions="" Order="0070"/><Column DataSource="YT060.AMURINEBIKI" FieldOptions="" Order="0080"/><Column DataSource="YT060.AMURIGENKA" FieldOptions="" Order="0100"/><Column DataSource="YT060.AMURITAX" FieldOptions="" Order="0120"/><Column DataSource="YT060.AMURIARARI" FieldOptions="" Order="0110"/><Column DataSource="YT060.AMURIHANHURI" FieldOptions="" Order="0090"/></Detail><Field DataSource="YT020.AMURIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0030"/><Field DataSource="YT020.AMURISYUK" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="YT020.AMURITYOK" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="YT020.AMURIHENPIN" FieldOptions="HORIZONTAL" Order="0060"/><Field DataSource="YT020.AMURIZATSUEKI" FieldOptions="" Order="0070"/><Field DataSource="YT020.AMURIZATSUSON" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="YT020.AMURISOUSAI" FieldOptions="HORIZONTAL" Order="0090"/><Field DataSource="YT020.AMURINEBIKI" FieldOptions="" Order="0140"/><Field DataSource="YT020.AMURIJYURYO" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="YT020.AMURIGENKA" FieldOptions="HORIZONTAL" Order="0150"/><Field DataSource="YT020.AMURITAX" FieldOptions="" Order="0110"/><Field DataSource="YT020.AMURIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="YT020.AMKAIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0170"/><Field DataSource="YT020.AMKAINYUK" FieldOptions="HORIZONTAL" Order="0180"/><Field DataSource="YT020.AMKAITYOK" FieldOptions="HORIZONTAL" Order="0190"/><Field DataSource="YT020.AMKAIHENPIN" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="YT020.AMKAIZATSUEKI" FieldOptions="" Order="0210"/><Field DataSource="YT020.AMKAIZATSUSON" FieldOptions="HORIZONTAL" Order="0220"/><Field DataSource="YT020.AMKAISOUSAI" FieldOptions="HORIZONTAL" Order="0230"/><Field DataSource="YT020.AMKAIGENKA" FieldOptions="HORIZONTAL" Order="0240"/><Field DataSource="YT020.AMKAISIHARAI" FieldOptions="" Order="0250"/><Field DataSource="YT020.AMKAITAX" FieldOptions="HORIZONTAL" Order="0260"/><Field DataSource="YT020.AMKAIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0270"/><Field DataSource="YT020.AMZAIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0280"/><Field DataSource="YT020.AMZAINYUK" FieldOptions="HORIZONTAL" Order="0290"/><Field DataSource="YT020.AMZAINYUKHEN" FieldOptions="HORIZONTAL" Order="0300"/><Field DataSource="YT020.AMZAISYUK" FieldOptions="HORIZONTAL" Order="0310"/><Field DataSource="YT020.AMZAISYUKHEN" FieldOptions="" Order="0320"/><Field DataSource="YT020.AMZAIIDOU" FieldOptions="HORIZONTAL" Order="0330"/><Field DataSource="YT020.AMZAIGENMOU" FieldOptions="HORIZONTAL" Order="0340"/><Field DataSource="YT020.AMZAIHYOKAZON" FieldOptions="HORIZONTAL" Order="0350"/><Field DataSource="YT020.AMZAIHYOKAEKI" FieldOptions="" Order="0360"/><Field DataSource="YT020.AMZAISIKAKARI" FieldOptions="HORIZONTAL" Order="0370"/><Field DataSource="YT020.AMZAIZATSUSON" FieldOptions="HORIZONTAL" Order="0380"/><Field DataSource="YT020.AMZAIZATSUEKI" FieldOptions="HORIZONTAL" Order="0390"/><Field DataSource="YT020.AMZAIKANSEI" FieldOptions="" Order="0400"/><Field DataSource="YT020.AMZAIKAKOUHI" FieldOptions="HORIZONTAL" Order="0410"/><Field DataSource="YT020.AMZAIZOUGEN" FieldOptions="HORIZONTAL" Order="0420"/><Field DataSource="YT020.AMZAIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0430"/><Field DataSource="YT020.AMURIHANHURI" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="YT020.AMURIARARI" FieldOptions="HORIZONTAL" Order="0160"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT030" ID="YF031" Name="商品別取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT030.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT030.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Detail Caption="仕入先別仕入サマリ" DetailFunction="YF042" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRSYOHIN;NRTORIHIKISAKI" Order="0020" Table="YT041"><Column DataSource="YT041.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020"/><Column DataSource="AT030.KBCOUNTRY" FieldOptions="" Order="0030"/><Column DataSource="YT041.AMKAINYUK" FieldOptions="" Order="0040"/><Column DataSource="YT041.QTKAINYUK" FieldOptions="" Order="0050"/><Column DataSource="YT041.AMKAITYOK" FieldOptions="" Order="0060"/><Column DataSource="YT041.QTKAITYOK" FieldOptions="" Order="0070"/><Column DataSource="YT041.AMKAIHENPIN" FieldOptions="" Order="0080"/><Column DataSource="YT041.QTKAIHENPIN" FieldOptions="" Order="0090"/><Column DataSource="YT041.AMKAIGENKA" FieldOptions="" Order="0100"/><Column DataSource="YT041.AMKAITAX" FieldOptions="" Order="0120"/></Detail><Detail Caption="顧客別売上サマリ" DetailFunction="YF052" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRSYOHIN;NRTORIHIKISAKI" Order="0030" Table="YT051"><Column DataSource="YT051.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0020"/><Column DataSource="YT051.AMURISYUK" FieldOptions="" Order="0030"/><Column DataSource="YT051.QTURISYUK" FieldOptions="" Order="0040"/><Column DataSource="YT051.AMURITYOK" FieldOptions="" Order="0050"/><Column DataSource="YT051.QTURITYOK" FieldOptions="" Order="0060"/><Column DataSource="YT051.AMURIHENPIN" FieldOptions="" Order="0070"/><Column DataSource="YT051.QTURIHENPIN" FieldOptions="" Order="0080"/><Column DataSource="YT051.AMURINEBIKI" FieldOptions="" Order="0090"/><Column DataSource="YT051.AMURIGENKA" FieldOptions="" Order="0110"/><Column DataSource="YT051.AMURITAX" FieldOptions="" Order="0120"/><Column DataSource="YT051.AMURIARARI" FieldOptions="" Order="0130"/><Column DataSource="YT051.AMURIHANHURI" FieldOptions="" Order="0100"/></Detail><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0030"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL(18)" Order="0060"/><Field DataSource="BT020.PRSIIRE" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="YT030.AMZAIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0090"/><Field DataSource="YT030.QTZAIKISYUZAN" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="YT030.AMZAINYUK" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="YT030.QTZAINYUK" FieldOptions="" Order="0110"/><Field DataSource="YT030.AMZAINYUKHEN" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="YT030.QTZAINYUKHEN" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="YT030.AMZAISYUK" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="YT030.QTZAISYUK" FieldOptions="" Order="0150"/><Field DataSource="YT030.AMZAISYUKHEN" FieldOptions="HORIZONTAL" Order="0180"/><Field DataSource="YT030.QTZAISYUKHEN" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="YT030.AMZAIIDOU" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="YT030.QTZAIIDOU" FieldOptions="" Order="0190"/><Field DataSource="YT030.AMZAIGENMOU" FieldOptions="HORIZONTAL" Order="0220"/><Field DataSource="YT030.QTZAIGENMOU" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="YT030.AMZAIHYOKAZON" FieldOptions="" Order="0330"/><Field DataSource="YT030.AMZAIHYOKAEKI" FieldOptions="HORIZONTAL" Order="0340"/><Field DataSource="YT030.AMZAISIKAKARI" FieldOptions="" Order="0260"/><Field DataSource="YT030.QTZAISIKAKARI" FieldOptions="" Order="0230"/><Field DataSource="YT030.AMZAIZATSUSON" FieldOptions="HORIZONTAL" Order="0270"/><Field DataSource="YT030.QTZAIZATSUSON" FieldOptions="HORIZONTAL" Order="0240"/><Field DataSource="YT030.AMZAIZATSUEKI" FieldOptions="HORIZONTAL" Order="0280"/><Field DataSource="YT030.QTZAIZATSUEKI" FieldOptions="HORIZONTAL" Order="0250"/><Field DataSource="YT030.AMZAIKANSEI" FieldOptions="HORIZONTAL" Order="0310"/><Field DataSource="YT030.QTZAIKANSEI" FieldOptions="" Order="0290"/><Field DataSource="YT030.AMZAIKAKOUHI" FieldOptions="HORIZONTAL" Order="0350"/><Field DataSource="YT030.AMZAIZOUGEN" FieldOptions="HORIZONTAL" Order="0320"/><Field DataSource="YT030.QTZAIZOUGEN" FieldOptions="HORIZONTAL" Order="0300"/><Field DataSource="YT030.AMZAIKIMATSUZAN" FieldOptions="" Order="0360"/><Field DataSource="YT030.QTZAIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0370"/><Field DataSource="YT030.AMZAIARARI" FieldOptions="HORIZONTAL" Order="0380"/><Field DataSource="BT020.KBSYOHIN" FieldOptions="" Order="0050"/><Detail Caption="倉庫別受払サマリ" DetailFunction="YF032" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" Table="YT031"><Column DataSource="YT031.NRSOUKO" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="YT031.AMZAIKISYUZAN" FieldOptions="" Order="0030"/><Column DataSource="YT031.QTZAIKISYUZAN" FieldOptions="" Order="0040"/><Column DataSource="YT031.AMZAINYUK" FieldOptions="" Order="0050"/><Column DataSource="YT031.QTZAINYUK" FieldOptions="" Order="0060"/><Column DataSource="YT031.AMZAINYUKHEN" FieldOptions="" Order="0070"/><Column DataSource="YT031.QTZAINYUKHEN" FieldOptions="" Order="0080"/><Column DataSource="YT031.AMZAISYUK" FieldOptions="" Order="0090"/><Column DataSource="YT031.QTZAISYUK" FieldOptions="" Order="0100"/><Column DataSource="YT031.AMZAISYUKHEN" FieldOptions="" Order="0110"/><Column DataSource="YT031.QTZAISYUKHEN" FieldOptions="" Order="0120"/><Column DataSource="YT031.AMZAIIDOU" FieldOptions="" Order="0130"/><Column DataSource="YT031.QTZAIIDOU" FieldOptions="" Order="0140"/><Column DataSource="YT031.AMZAIGENMOU" FieldOptions="" Order="0150"/><Column DataSource="YT031.QTZAIGENMOU" FieldOptions="" Order="0160"/><Column DataSource="YT031.AMZAIHYOKAZON" FieldOptions="" Order="0170"/><Column DataSource="YT031.AMZAIHYOKAEKI" FieldOptions="" Order="0180"/><Column DataSource="YT031.AMZAISIKAKARI" FieldOptions="" Order="0190"/><Column DataSource="YT031.QTZAISIKAKARI" FieldOptions="" Order="0200"/><Column DataSource="YT031.AMZAIZATSUSON" FieldOptions="" Order="0210"/><Column DataSource="YT031.QTZAIZATSUSON" FieldOptions="" Order="0220"/><Column DataSource="YT031.AMZAIZATSUEKI" FieldOptions="" Order="0230"/><Column DataSource="YT031.QTZAIZATSUEKI" FieldOptions="" Order="0240"/><Column DataSource="YT031.AMZAIKANSEI" FieldOptions="" Order="0250"/><Column DataSource="YT031.QTZAIKANSEI" FieldOptions="" Order="0260"/><Column DataSource="YT031.AMZAIKAKOUHI" FieldOptions="" Order="0270"/><Column DataSource="YT031.AMZAIZOUGEN" FieldOptions="" Order="0280"/><Column DataSource="YT031.QTZAIZOUGEN" FieldOptions="" Order="0290"/><Column DataSource="YT031.AMZAIARARI" FieldOptions="" Order="0300"/><Column DataSource="YT031.AMZAIKIMATSUZAN" FieldOptions="" Order="0310"/><Column DataSource="YT031.QTZAIKIMATSUZAN" FieldOptions="" Order="0320"/><Column DataSource="BT030.TXSOUKO" FieldOptions="" Order="0020"/></Detail></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT040" ID="YF041" Name="仕入先別取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT040.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT040.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="YT040.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="YT040.AMKAIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0060"/><Field DataSource="YT040.AMKAINYUK" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="YT040.AMKAITYOK" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="YT040.AMKAIHENPIN" FieldOptions="HORIZONTAL" Order="0090"/><Detail Caption="商品別サマリ" DetailFunction="YF042" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" Table="YT041"><Column DataSource="YT041.AMKAINYUK" FieldOptions="" Order="0050"/><Column DataSource="YT041.QTKAINYUK" FieldOptions="" Order="0060"/><Column DataSource="YT041.AMKAITYOK" FieldOptions="" Order="0070"/><Column DataSource="YT041.QTKAITYOK" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番Scan)" Order="0020"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0010"/><Column DataSource="BT020.PRSIIRE" FieldOptions="" Order="0040"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0030"/><Column DataSource="YT041.AMKAIHENPIN" FieldOptions="" Order="0090"/><Column DataSource="YT041.QTKAIHENPIN" FieldOptions="" Order="0100"/><Column DataSource="YT041.AMKAIGENKA" FieldOptions="" Order="0110"/><Column DataSource="YT041.AMKAITAX" FieldOptions="" Order="0130"/><Filter DataSource="BT020.KBSYOHIN" FieldOptions="PROMPT_LIST1" Order="0010"/></Detail><Detail Caption="買掛増減履歴" DetailFunction="CF101" FixedWhere="FGVALID = 'T'" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRTORIHIKISAKI;NRSIIRE" Order="0020" Table="CT100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0020"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="CT100.KBSIIRE" FieldOptions="PROMPT_LIST1" Order="0010"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0080"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Column DataSource="CT100.AMSIIRE" FieldOptions="CAPTION(仕入額)" Order="0100"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0130"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0110"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="" Order="0050"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="AT030.KBCOUNTRY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="YT040.AMKAIZATSUEKI" FieldOptions="" Order="0100"/><Field DataSource="YT040.AMKAIZATSUSON" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="YT040.AMKAISOUSAI" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="YT040.AMKAIGENKA" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="YT040.AMKAISIHARAI" FieldOptions="" Order="0140"/><Field DataSource="YT040.AMKAITAX" FieldOptions="HORIZONTAL" Order="0150"/><Field DataSource="YT040.AMKAIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0160"/></Function><Function ID="YF110" Name="受払履歴集計処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET100; var rYT020; var uYT020; var cYT020; var cYT030; var cYT031;#EOL#var dtNend = 0; var dtMSeq = 0; var nrSouko = ''; var nrSyohin = '';#EOL#var errorMessage = ''; var count = 0;#EOL##EOL#////////////////////#EOL#// 集計用変数定義 //#EOL#////////////////////#EOL#var amZaiKisyuzan020 = 0; var amZaiNyuk020 = 0; var amZaiNyukHen020 = 0; var amZaiSyuk020 = 0; var amZaiSyukHen020 = 0;#EOL#var amZaiIdou020 = 0; var amZaiGenmou020 = 0; var amZaiHyokazon020 = 0; var amZaiHyokaeki020 = 0; var amZaiSikakari020 = 0;#EOL#var amZaiZatsuson020 = 0; var amZaiZatsueki020 = 0; var amZaiKansei020 = 0; var amZaiKakouhi020 = 0; var amZaiZougen020 = 0;#EOL#var amZaiKisyuzan030 = 0; var qtZaiKisyuzan030 = 0; var amZaiNyuk030 = 0; var qtZaiNyuk030 = 0; var amZaiNyukHen030 = 0;#EOL#var qtZaiNyukHen030 = 0; var amZaiSyuk030 = 0; var qtZaiSyuk030 = 0; var amZaiSyukHen030 = 0; var qtZaiSyukHen030 = 0;#EOL#var amZaiIdou030 = 0; var qtZaiIdou030 = 0; var amZaiGenmou030 = 0; var qtZaiGenmou030 = 0; var amZaiHyokazon030 = 0;#EOL#var amZaiHyokaeki030 = 0; var amZaiSikakari030 = 0; var qtZaiSikakari030 = 0; var amZaiZatsuson030 = 0; var qtZaiZatsuson030 = 0;#EOL#var amZaiZatsueki030 = 0; var qtZaiZatsueki030 = 0; var amZaiKansei030 = 0; var qtZaiKansei030 = 0; var amZaiKakouhi030 = 0;#EOL#var amZaiZougen030 = 0; var qtZaiZougen030 = 0; var amZaiArari030 = 0;#EOL#var amZaiKisyuzan031 = 0; var qtZaiKisyuzan031 = 0; var amZaiNyuk031 = 0; var qtZaiNyuk031 = 0; var amZaiNyukHen031 = 0;#EOL#var qtZaiNyukHen031 = 0; var amZaiSyuk031 = 0; var qtZaiSyuk031 = 0; var amZaiSyukHen031 = 0; var qtZaiSyukHen031 = 0;#EOL#var amZaiIdou031 = 0; var qtZaiIdou031 = 0; var amZaiGenmou031 = 0; var qtZaiGenmou031 = 0; var amZaiHyokazon031 = 0;#EOL#var amZaiHyokaeki031 = 0; var amZaiSikakari031 = 0; var qtZaiSikakari031 = 0; var amZaiZatsuson031 = 0; var qtZaiZatsuson031 = 0;#EOL#var amZaiZatsueki031 = 0; var qtZaiZatsueki031 = 0; var amZaiKansei031 = 0; var qtZaiKansei031 = 0; var amZaiKakouhi031 = 0;#EOL#var amZaiZougen031 = 0; var qtZaiZougen031 = 0; var amZaiArari031 = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var limitMSeq = instance.parmMap.get('LIMIT_MSEQ');#EOL##EOL#//////////////////////////////////////////////////////////////////////////#EOL#// 対象期間の受払実績(ET100)の読取と取引サマリ(YT020,YT030,YT031)の更新 //#EOL#//////////////////////////////////////////////////////////////////////////#EOL#rET100 = instance.createTableOperator('Select', 'ET100');#EOL#rET100.addKeyValue('FGVALID', 'T');#EOL#rET100.addKeyValue('and ((', 'DTNEND >',  limitNend, ') or');#EOL#rET100.addKeyValue('(',      'DTNEND =',  limitNend, ' and');#EOL#rET100.addKeyValue('',       'DTMSEQ >=', limitMSeq, '))');#EOL#rET100.setOrderBy('DTNEND, DTMSEQ, NRSYOHIN, NRSOUKO');#EOL#while (rET100.next()) {#EOL##EOL#&#x9;/////////////////////////////////////#EOL#&#x9;// 年月BREAKなら集計レコードの追加 //#EOL#&#x9;/////////////////////////////////////#EOL#&#x9;if (Number(rET100.getValueOf('DTNEND')) != dtNend || Number(rET100.getValueOf('DTMSEQ')) != dtMSeq) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 商品･倉庫別月次取引サマリ(YT031)の追加 //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;insertYT031();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 商品別月次取引サマリ(YT030)の追加 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;insertYT030();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;// 月次取引サマリ(YT020)の追加 //#EOL#&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;processYT020();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL##EOL#&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;// 商品BREAKなら集計レコードの追加 //#EOL#&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;if (rET100.getValueOf('NRSYOHIN').trim() != nrSyohin) {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 商品･倉庫別月次取引サマリ(YT031)の追加 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;insertYT031();#EOL#&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 商品別月次取引サマリ(YT030)の追加 //#EOL#&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;insertYT030();#EOL#&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 倉庫BREAKなら集計レコードの追加 //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rET100.getValueOf('NRSOUKO').trim() != nrSouko) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 商品･倉庫別月次取引サマリ(YT031)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;insertYT031();#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////#EOL#&#x9;// BREAK検査フィールドの設定 //#EOL#&#x9;///////////////////////////////#EOL#&#x9;dtNend = rET100.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rET100.getValueOf('DTMSEQ');#EOL#&#x9;nrSyohin = rET100.getValueOf('NRSYOHIN').trim() + '';#EOL#&#x9;nrSouko = rET100.getValueOf('NRSOUKO').trim() + '';#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 項目値の集計処理 //#EOL#&#x9;//////////////////////#EOL#&#x9;summarizeFields();#EOL#}#EOL##EOL#////////////////////////////////////////////#EOL#// 商品･倉庫別月次取引サマリ(YT031)の追加 //#EOL#////////////////////////////////////////////#EOL#insertYT031();#EOL##EOL#///////////////////////////////////////#EOL#// 商品別月次取引サマリ(YT030)の追加 //#EOL#///////////////////////////////////////#EOL#insertYT030();#EOL##EOL#/////////////////////////////////#EOL#// 月次取引サマリ(YT020)の追加 //#EOL#/////////////////////////////////#EOL#processYT020();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#/////////////////////////////////#EOL#// 月次取引サマリ(YT020)の追加 //#EOL#/////////////////////////////////#EOL#function processYT020() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;rYT020 = instance.createTableOperator('Count', 'YT020');#EOL#&#x9;&#x9;rYT020.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;rYT020.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;if (rYT020.execute() == 1) {#EOL#&#x9;&#x9;&#x9;uYT020 = instance.createTableOperator('Update', 'YT020');#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAINYUK',&#x9;&#x9;amZaiNyuk020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAINYUKHEN',&#x9;&#x9;amZaiNyukHen020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAISYUK',&#x9;&#x9;amZaiSyuk020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAISYUKHEN',&#x9;&#x9;amZaiSyukHen020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIIDOU',&#x9;&#x9;amZaiIdou020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIGENMOU',&#x9;&#x9;amZaiGenmou020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIHYOKAZON',&#x9;amZaiHyokazon020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIHYOKAEKI',&#x9;amZaiHyokaeki020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAISIKAKARI',&#x9;amZaiSikakari020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIZATSUSON',&#x9;amZaiZatsuson020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIZATSUEKI',&#x9;amZaiZatsueki020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIKANSEI',&#x9;&#x9;amZaiKansei020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIKAKOUHI',&#x9;&#x9;amZaiKakouhi020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMZAIZOUGEN',&#x9;&#x9;amZaiZougen020);#EOL#&#x9;&#x9;&#x9;uYT020.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;uYT020.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;count = uYT020.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cYT020 = instance.createTableOperator('Insert', 'YT020');#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAINYUK',&#x9;&#x9;amZaiNyuk020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAINYUKHEN',&#x9;&#x9;amZaiNyukHen020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAISYUK',&#x9;&#x9;amZaiSyuk020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAISYUKHEN',&#x9;&#x9;amZaiSyukHen020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIIDOU',&#x9;&#x9;amZaiIdou020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIGENMOU',&#x9;&#x9;amZaiGenmou020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIHYOKAZON',&#x9;amZaiHyokazon020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIHYOKAEKI',&#x9;amZaiHyokaeki020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAISIKAKARI',&#x9;amZaiSikakari020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIZATSUSON',&#x9;amZaiZatsuson020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIZATSUEKI',&#x9;amZaiZatsueki020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIKANSEI',&#x9;&#x9;amZaiKansei020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIKAKOUHI',&#x9;&#x9;amZaiKakouhi020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMZAIZOUGEN',&#x9;&#x9;amZaiZougen020);#EOL#&#x9;&#x9;&#x9;count = cYT020.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amZaiKisyuzan020 = 0; amZaiNyuk020 = 0; amZaiNyukHen020 = 0; amZaiSyuk020 = 0; amZaiSyukHen020 = 0;#EOL#&#x9;&#x9;amZaiIdou020 = 0; amZaiGenmou020 = 0; amZaiHyokazon020 = 0; amZaiHyokaeki020 = 0; amZaiSikakari020 = 0;#EOL#&#x9;&#x9;amZaiZatsuson020 = 0; amZaiZatsueki020 = 0; amZaiKansei020 = 0; amZaiKakouhi020 = 0; amZaiZougen020 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#///////////////////////////////////////#EOL#// 商品別月次取引サマリ(YT030)の追加 //#EOL#///////////////////////////////////////#EOL#function insertYT030() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;cYT030 = instance.createTableOperator('Insert', 'YT030');#EOL#&#x9;&#x9;cYT030.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT030.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cYT030.addValue('NRSYOHIN',&#x9;&#x9;&#x9;nrSyohin);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAIKISYUZAN',&#x9;qtZaiKisyuzan030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAINYUK',&#x9;&#x9;amZaiNyuk030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAINYUK',&#x9;&#x9;qtZaiNyuk030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAINYUKHEN',&#x9;&#x9;amZaiNyukHen030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAINYUKHEN',&#x9;&#x9;qtZaiNyukHen030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAISYUK',&#x9;&#x9;amZaiSyuk030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAISYUK',&#x9;&#x9;qtZaiSyuk030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAISYUKHEN',&#x9;&#x9;amZaiSyukHen030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAISYUKHEN',&#x9;&#x9;qtZaiSyukHen030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIIDOU',&#x9;&#x9;amZaiIdou030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAIIDOU',&#x9;&#x9;qtZaiIdou030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIGENMOU',&#x9;&#x9;amZaiGenmou030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAIGENMOU',&#x9;&#x9;qtZaiGenmou030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIHYOKAZON',&#x9;amZaiHyokazon030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIHYOKAEKI',&#x9;amZaiHyokaeki030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAISIKAKARI',&#x9;amZaiSikakari030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAISIKAKARI',&#x9;qtZaiSikakari030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIZATSUSON',&#x9;amZaiZatsuson030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAIZATSUSON',&#x9;qtZaiZatsuson030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIZATSUEKI',&#x9;amZaiZatsueki030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAIZATSUEKI',&#x9;qtZaiZatsueki030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIKANSEI',&#x9;&#x9;amZaiKansei030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAIKANSEI',&#x9;&#x9;qtZaiKansei030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIKAKOUHI',&#x9;&#x9;amZaiKakouhi030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIZOUGEN',&#x9;&#x9;amZaiZougen030);#EOL#&#x9;&#x9;cYT030.addValue('QTZAIZOUGEN',&#x9;&#x9;qtZaiZougen030);#EOL#&#x9;&#x9;cYT030.addValue('AMZAIARARI',&#x9;&#x9;amZaiArari030);#EOL#&#x9;&#x9;count = cYT030.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '商品別月次取引サマリ(YT030)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amZaiKisyuzan030 = 0; qtZaiKisyuzan030 = 0; amZaiNyuk030 = 0; qtZaiNyuk030 = 0; amZaiNyukHen030 = 0;#EOL#&#x9;&#x9;qtZaiNyukHen030 = 0; amZaiSyuk030 = 0; qtZaiSyuk030 = 0; amZaiSyukHen030 = 0; qtZaiSyukHen030 = 0;#EOL#&#x9;&#x9;amZaiIdou030 = 0; qtZaiIdou030 = 0; amZaiGenmou030 = 0; qtZaiGenmou030 = 0; amZaiHyokazon030 = 0;#EOL#&#x9;&#x9;amZaiHyokaeki030 = 0; amZaiSikakari030 = 0; qtZaiSikakari030 = 0; amZaiZatsuson030 = 0; qtZaiZatsuson030 = 0;#EOL#&#x9;&#x9;amZaiZatsueki030 = 0; qtZaiZatsueki030 = 0; amZaiKansei030 = 0; qtZaiKansei030 = 0; amZaiKakouhi030 = 0;#EOL#&#x9;&#x9;amZaiZougen030 = 0; qtZaiZougen030 = 0; amZaiArari030 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////////////////#EOL#// 商品･倉庫別月次取引サマリ(YT031)の追加 //#EOL#////////////////////////////////////////////#EOL#function insertYT031() {#EOL#&#x9;if (dtNend != 0 &amp;&amp; nrSouko != '') {#EOL#&#x9;&#x9;cYT031 = instance.createTableOperator('Insert', 'YT031');#EOL#&#x9;&#x9;cYT031.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT031.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cYT031.addValue('NRSYOHIN',&#x9;&#x9;&#x9;nrSyohin);#EOL#&#x9;&#x9;cYT031.addValue('NRSOUKO',&#x9;&#x9;&#x9;nrSouko);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAIKISYUZAN',&#x9;qtZaiKisyuzan031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAINYUK',&#x9;&#x9;amZaiNyuk031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAINYUK',&#x9;&#x9;qtZaiNyuk031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAINYUKHEN',&#x9;&#x9;amZaiNyukHen031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAINYUKHEN',&#x9;&#x9;qtZaiNyukHen031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAISYUK',&#x9;&#x9;amZaiSyuk031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAISYUK',&#x9;&#x9;qtZaiSyuk031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAISYUKHEN',&#x9;&#x9;amZaiSyukHen031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAISYUKHEN',&#x9;&#x9;qtZaiSyukHen031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIIDOU',&#x9;&#x9;amZaiIdou031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAIIDOU',&#x9;&#x9;qtZaiIdou031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIGENMOU',&#x9;&#x9;amZaiGenmou031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAIGENMOU',&#x9;&#x9;qtZaiGenmou031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIHYOKAZON',&#x9;amZaiHyokazon031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIHYOKAEKI',&#x9;amZaiHyokaeki031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAISIKAKARI',&#x9;amZaiSikakari031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAISIKAKARI',&#x9;qtZaiSikakari031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIZATSUSON',&#x9;amZaiZatsuson031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAIZATSUSON',&#x9;qtZaiZatsuson031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIZATSUEKI',&#x9;amZaiZatsueki031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAIZATSUEKI',&#x9;qtZaiZatsueki031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIKANSEI',&#x9;&#x9;amZaiKansei031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAIKANSEI',&#x9;&#x9;qtZaiKansei031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIKAKOUHI',&#x9;&#x9;amZaiKakouhi031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIZOUGEN',&#x9;&#x9;amZaiZougen031);#EOL#&#x9;&#x9;cYT031.addValue('QTZAIZOUGEN',&#x9;&#x9;qtZaiZougen031);#EOL#&#x9;&#x9;cYT031.addValue('AMZAIARARI',&#x9;&#x9;amZaiArari031);#EOL#&#x9;&#x9;count = cYT031.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '商品･倉庫別月次取引サマリ(YT031)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amZaiKisyuzan031 = 0; qtZaiKisyuzan031 = 0; amZaiNyuk031 = 0; qtZaiNyuk031 = 0; amZaiNyukHen031 = 0;#EOL#&#x9;&#x9;qtZaiNyukHen031 = 0; amZaiSyuk031 = 0; qtZaiSyuk031 = 0; amZaiSyukHen031 = 0; qtZaiSyukHen031 = 0;#EOL#&#x9;&#x9;amZaiIdou031 = 0; qtZaiIdou031 = 0; amZaiGenmou031 = 0; qtZaiGenmou031 = 0; amZaiHyokazon031 = 0;#EOL#&#x9;&#x9;amZaiHyokaeki031 = 0; amZaiSikakari031 = 0; qtZaiSikakari031 = 0; amZaiZatsuson031 = 0; qtZaiZatsuson031 = 0;#EOL#&#x9;&#x9;amZaiZatsueki031 = 0; qtZaiZatsueki031 = 0; amZaiKansei031 = 0; qtZaiKansei031 = 0; amZaiKakouhi031 = 0;#EOL#&#x9;&#x9;amZaiZougen031 = 0; qtZaiZougen031 = 0; amZaiArari031 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////#EOL#// 項目値の集計処理 //#EOL#//////////////////////#EOL#function summarizeFields() {#EOL##EOL#&#x9;// 10 発注入荷, 11 直入荷 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '10' || rET100.getValueOf('KBUKEBARAI') == '11') {#EOL#&#x9;&#x9;amZaiNyuk020 = Number(amZaiNyuk020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiNyuk030 = Number(amZaiNyuk030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiNyuk030 = Number(qtZaiNyuk030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiNyuk031 = Number(amZaiNyuk031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiNyuk031 = Number(qtZaiNyuk031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 12 仕入返品 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '12') {#EOL#&#x9;&#x9;amZaiNyukHen020 = Number(amZaiNyukHen020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiNyukHen030 = Number(amZaiNyukHen030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiNyukHen030 = Number(qtZaiNyukHen030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiNyukHen031 = Number(amZaiNyukHen031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiNyukHen031 = Number(qtZaiNyukHen031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 20 受注出荷, 21 直出荷 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '20' || rET100.getValueOf('KBUKEBARAI') == '21') {#EOL#&#x9;&#x9;amZaiSyuk020 = Number(amZaiSyuk020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiSyuk030 = Number(amZaiSyuk030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiSyuk030 = Number(qtZaiSyuk030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiSyuk031 = Number(amZaiSyuk031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiSyuk031 = Number(qtZaiSyuk031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 22 売上返品 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '22') {#EOL#&#x9;&#x9;amZaiSyukHen020 = Number(amZaiSyukHen020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiSyukHen030 = Number(amZaiSyukHen030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiSyukHen030 = Number(qtZaiSyukHen030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiSyukHen031 = Number(amZaiSyukHen031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiSyukHen031 = Number(qtZaiSyukHen031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 30 移動出庫, 31 移動入庫 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '30' || rET100.getValueOf('KBUKEBARAI') == '31') {#EOL#&#x9;&#x9;amZaiIdou020 = Number(amZaiIdou020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiIdou030 = Number(amZaiIdou030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiIdou030 = Number(qtZaiIdou030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiIdou031 = Number(amZaiIdou031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiIdou031 = Number(qtZaiIdou031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 40 減耗 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '40') {#EOL#&#x9;&#x9;amZaiGenmou020 = Number(amZaiGenmou020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiGenmou030 = Number(amZaiGenmou030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiGenmou030 = Number(qtZaiGenmou030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiGenmou031 = Number(amZaiGenmou031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiGenmou031 = Number(qtZaiGenmou031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 41 評価損 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '41') {#EOL#&#x9;&#x9;amZaiHyokazon020 = Number(amZaiHyokazon020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiHyokazon030 = Number(amZaiHyokazon030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiHyokazon031 = Number(amZaiHyokazon031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 42 仕掛材料出庫 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '42') {#EOL#&#x9;&#x9;amZaiSikakari020 = Number(amZaiSikakari020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiSikakari030 = Number(amZaiSikakari030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiSikakari030 = Number(qtZaiSikakari030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiSikakari031 = Number(amZaiSikakari031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiSikakari031 = Number(qtZaiSikakari031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 43 雑損 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '43') {#EOL#&#x9;&#x9;amZaiZatsuson020 = Number(amZaiZatsuson020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiZatsuson030 = Number(amZaiZatsuson030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiZatsuson030 = Number(qtZaiZatsuson030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiZatsuson031 = Number(amZaiZatsuson031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiZatsuson031 = Number(qtZaiZatsuson031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 50 雑益 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '50') {#EOL#&#x9;&#x9;amZaiZatsueki020 = Number(amZaiZatsueki020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiZatsueki030 = Number(amZaiZatsueki030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiZatsueki030 = Number(qtZaiZatsueki030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiZatsueki031 = Number(amZaiZatsueki031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiZatsueki031 = Number(qtZaiZatsueki031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 51 評価益 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '51') {#EOL#&#x9;&#x9;amZaiHyokaeki020 = Number(amZaiHyokaeki020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiHyokaeki030 = Number(amZaiHyokaeki030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiHyokaeki031 = Number(amZaiHyokaeki031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 52 仕掛完成入庫 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '52') {#EOL#&#x9;&#x9;amZaiKansei020 = Number(amZaiKansei020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiKansei030 = Number(amZaiKansei030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiKansei030 = Number(qtZaiKansei030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiKansei031 = Number(amZaiKansei031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiKansei031 = Number(qtZaiKansei031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 53 加工費繰入 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '53') {#EOL#&#x9;&#x9;amZaiKakouhi020 = Number(amZaiKakouhi020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiKakouhi030 = Number(amZaiKakouhi030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiKakouhi031 = Number(amZaiKakouhi031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 90 棚増棚減 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '90') {#EOL#&#x9;&#x9;amZaiZougen020 = Number(amZaiZougen020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;amZaiZougen030 = Number(amZaiZougen030) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiZougen030 = Number(qtZaiZougen030) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;amZaiZougen031 = Number(amZaiZougen031) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;qtZaiZougen031 = Number(qtZaiZougen031) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;}#EOL##EOL#&#x9;// 粗利 //#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '20'#EOL#&#x9;&#x9; || rET100.getValueOf('KBUKEBARAI') == '21'#EOL#&#x9;&#x9; || rET100.getValueOf('KBUKEBARAI') == '22') {#EOL#&#x9;&#x9;amZaiArari030 = Number(amZaiArari030) + Number(rET100.getValueOf('AMSAGAKU'));#EOL#&#x9;&#x9;amZaiArari031 = Number(amZaiArari031) + Number(rET100.getValueOf('AMSAGAKU'));#EOL#&#x9;}#EOL#}#EOL#" SubsystemID="Y" Type="XF000"/><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT031" ID="YF032" Name="商品倉庫別取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT031.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT031.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="YT031.NRSOUKO" FieldOptions="" Order="0060"/><Field DataSource="YT031.AMZAIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0080"/><Field DataSource="YT031.QTZAIKISYUZAN" FieldOptions="HORIZONTAL" Order="0090"/><Field DataSource="YT031.AMZAINYUK" FieldOptions="HORIZONTAL" Order="0120"/><Detail Caption="受払履歴" DetailFunction="EF101" FixedWhere="FGVALID = 'T'" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRSYOHIN;NRSOUKO;NRUKEBARAI" Order="0010" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0020"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0030"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ET100.KBUKEBARAI" FieldOptions="PROMPT_LIST1" Order="0010"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0040"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0060"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0080"/><Column DataSource="ET100.AMSAGAKU" FieldOptions="" Order="0090"/><Column DataSource="ET100.TXAITESAKI" FieldOptions="" Order="0050"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/></Detail><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／品名)" Order="0030"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="YT031.QTZAINYUK" FieldOptions="" Order="0100"/><Field DataSource="YT031.AMZAINYUKHEN" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="YT031.QTZAINYUKHEN" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="YT031.AMZAISYUK" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="YT031.QTZAISYUK" FieldOptions="" Order="0140"/><Field DataSource="YT031.AMZAISYUKHEN" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="YT031.QTZAISYUKHEN" FieldOptions="HORIZONTAL" Order="0150"/><Field DataSource="YT031.AMZAIIDOU" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="YT031.QTZAIIDOU" FieldOptions="" Order="0180"/><Field DataSource="YT031.AMZAIGENMOU" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="YT031.QTZAIGENMOU" FieldOptions="HORIZONTAL" Order="0190"/><Field DataSource="YT031.AMZAIHYOKAZON" FieldOptions="HORIZONTAL" Order="0330"/><Field DataSource="YT031.AMZAIHYOKAEKI" FieldOptions="" Order="0320"/><Field DataSource="YT031.AMZAISIKAKARI" FieldOptions="" Order="0250"/><Field DataSource="YT031.QTZAISIKAKARI" FieldOptions="" Order="0220"/><Field DataSource="YT031.AMZAIZATSUSON" FieldOptions="HORIZONTAL" Order="0260"/><Field DataSource="YT031.QTZAIZATSUSON" FieldOptions="HORIZONTAL" Order="0230"/><Field DataSource="YT031.AMZAIZATSUEKI" FieldOptions="HORIZONTAL" Order="0270"/><Field DataSource="YT031.QTZAIZATSUEKI" FieldOptions="HORIZONTAL" Order="0240"/><Field DataSource="YT031.AMZAIKANSEI" FieldOptions="HORIZONTAL" Order="0300"/><Field DataSource="YT031.QTZAIKANSEI" FieldOptions="" Order="0280"/><Field DataSource="YT031.AMZAIKAKOUHI" FieldOptions="HORIZONTAL" Order="0340"/><Field DataSource="YT031.AMZAIZOUGEN" FieldOptions="HORIZONTAL" Order="0310"/><Field DataSource="YT031.QTZAIZOUGEN" FieldOptions="HORIZONTAL" Order="0290"/><Field DataSource="YT031.AMZAIARARI" FieldOptions="HORIZONTAL" Order="0370"/><Field DataSource="YT031.AMZAIKIMATSUZAN" FieldOptions="" Order="0350"/><Field DataSource="YT031.QTZAIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0360"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT041" ID="YF042" Name="仕入商品別取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT041.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT041.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="YT041.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="YT041.AMKAINYUK" FieldOptions="VERTICAL(10)" Order="0120"/><Field DataSource="YT041.QTKAINYUK" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="YT041.AMKAITYOK" FieldOptions="HORIZONTAL" Order="0140"/><Detail Caption="買掛増減履歴" DetailFunction="CF101" FixedWhere="FGVALID = 'T'" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRTORIHIKISAKI;NRSYOHIN;NRSIIRE" Order="0010" Table="CT100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0020"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0030"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="CT100.KBSIIRE" FieldOptions="PROMPT_LIST1" Order="0010"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0050"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0060"/><Column DataSource="CT100.AMSIIRE" FieldOptions="CAPTION(仕入額)" Order="0070"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0090"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0080"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="AT030.KBCOUNTRY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0060"/><Field DataSource="BT020.PRSIIRE" FieldOptions="" Order="0090"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(在庫単位),HORIZONTAL" Order="0080"/><Field DataSource="YT041.QTKAITYOK" FieldOptions="HORIZONTAL" Order="0150"/><Field DataSource="YT041.AMKAIHENPIN" FieldOptions="" Order="0160"/><Field DataSource="YT041.QTKAIHENPIN" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="YT041.AMKAIGENKA" FieldOptions="HORIZONTAL" Order="0180"/><Field DataSource="YT041.AMKAITAX" FieldOptions="HORIZONTAL" Order="0190"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="BT020.PRARARI" FieldOptions="HORIZONTAL" Order="0110"/></Function><Function DetailFunction="YF051" ID="YF050" InitialMsg="" KeyFields="" Name="顧客別月次取引サマリの一覧" OrderBy="" PrimaryTable="YT050" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="YT050.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT050.DTMSEQ" FieldOptions="" Order="0020"/><Column DataSource="YT050.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Column DataSource="YT050.AMURIKISYUZAN" FieldOptions="" Order="0070"/><Column DataSource="YT050.AMURISYUK" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="YT050.DTNEND" FieldOptions="GE,CAPTION(年度≧)" Order="0010"/><Filter DataSource="YT050.DTMSEQ" FieldOptions="" Order="0020"/><Filter DataSource="YT050.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Filter DataSource="DT010.NRTANTOUJYUGYOIN" FieldOptions="" Order="0040"/><Column DataSource="YT050.AMURITYOK" FieldOptions="" Order="0090"/><Column DataSource="YT050.AMURIHENPIN" FieldOptions="" Order="0100"/><Column DataSource="YT050.AMURIZATSUEKI" FieldOptions="" Order="0110"/><Column DataSource="YT050.AMURIZATSUSON" FieldOptions="" Order="0120"/><Column DataSource="YT050.AMURISOUSAI" FieldOptions="" Order="0130"/><Column DataSource="YT050.AMURINEBIKI" FieldOptions="" Order="0180"/><Column DataSource="YT050.AMURIHANHURI" FieldOptions="" Order="0140"/><Column DataSource="YT050.AMURIJYURYO" FieldOptions="" Order="0160"/><Column DataSource="YT050.AMURIGENKA" FieldOptions="" Order="0190"/><Column DataSource="YT050.AMURITAX" FieldOptions="" Order="0150"/><Column DataSource="YT050.AMURIARARI" FieldOptions="" Order="0200"/><Column DataSource="YT050.AMURIKIMATSUZAN" FieldOptions="" Order="0170"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0040"/><Column DataSource="DT010.NRTANTOUJYUGYOIN" FieldOptions="" Order="0050"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(担当営業名)" Order="0060"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT050" ID="YF051" Name="顧客別取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT050.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT050.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="YT050.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="YT050.AMURIKISYUZAN" FieldOptions="VERTICAL(10)" Order="0070"/><Field DataSource="YT050.AMURISYUK" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="YT050.AMURITYOK" FieldOptions="HORIZONTAL" Order="0090"/><Field DataSource="YT050.AMURIHENPIN" FieldOptions="HORIZONTAL" Order="0100"/><Detail Caption="商品別サマリ" DetailFunction="YF052" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" Table="YT051"><Column DataSource="YT051.AMURISYUK" FieldOptions="" Order="0040"/><Column DataSource="YT051.QTURISYUK" FieldOptions="" Order="0050"/><Column DataSource="YT051.AMURITYOK" FieldOptions="" Order="0060"/><Column DataSource="YT051.QTURITYOK" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番Scan)" Order="0020"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0010"/><Column DataSource="BT020.PRHANBAI" FieldOptions="" Order="0030"/><Column DataSource="YT051.AMURIHENPIN" FieldOptions="" Order="0080"/><Column DataSource="YT051.QTURIHENPIN" FieldOptions="" Order="0090"/><Column DataSource="YT051.AMURINEBIKI" FieldOptions="" Order="0120"/><Column DataSource="YT051.AMURIGENKA" FieldOptions="" Order="0130"/><Column DataSource="YT051.AMURITAX" FieldOptions="" Order="0110"/><Column DataSource="YT051.AMURIARARI" FieldOptions="" Order="0140"/><Column DataSource="YT051.AMURIHANHURI" FieldOptions="" Order="0100"/><Filter DataSource="BT020.KBSYOHIN" FieldOptions="PROMPT_LIST1" Order="0010"/></Detail><Detail Caption="売掛増減履歴" DetailFunction="DF101" FixedWhere="FGVALID = 'T'" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRTORIHIKISAKI;NRURIAGE" Order="0020" Table="DT100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0020"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="DT100.KBURIAGE" FieldOptions="PROMPT_LIST1" Order="0010"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0080"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0100"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Column DataSource="DT100.TXSYOHIN" FieldOptions="" Order="0050"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="YT050.AMURIZATSUEKI" FieldOptions="" Order="0110"/><Field DataSource="YT050.AMURIZATSUSON" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="YT050.AMURISOUSAI" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="YT050.AMURINEBIKI" FieldOptions="" Order="0180"/><Field DataSource="YT050.AMURIJYURYO" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="YT050.AMURIGENKA" FieldOptions="HORIZONTAL" Order="0190"/><Field DataSource="YT050.AMURITAX" FieldOptions="" Order="0150"/><Field DataSource="YT050.AMURIARARI" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="YT050.AMURIKIMATSUZAN" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="DT010.NRTANTOUJYUGYOIN" FieldOptions="CAPTION(担当営業)" Order="0050"/><Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="YT050.AMURIHANHURI" FieldOptions="HORIZONTAL" Order="0140"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT051" ID="YF052" Name="顧客商品別取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT051.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT051.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="YT051.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="YT051.AMURISYUK" FieldOptions="VERTICAL(10)" Order="0110"/><Field DataSource="YT051.QTURISYUK" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="YT051.AMURITYOK" FieldOptions="HORIZONTAL" Order="0130"/><Detail Caption="売掛増減履歴" DetailFunction="DF101" FixedWhere="FGVALID = 'T'" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRTORIHIKISAKI;NRSYOHIN;NRURIAGE" Order="0010" Table="DT100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0020"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0030"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="DT100.KBURIAGE" FieldOptions="PROMPT_LIST1" Order="0010"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0080"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0060"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0070"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0090"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0100"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0050"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL" Order="0090"/><Field DataSource="YT051.QTURITYOK" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="YT051.AMURIHENPIN" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="YT051.QTURIHENPIN" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="YT051.AMURINEBIKI" FieldOptions="" Order="0190"/><Field DataSource="YT051.AMURIGENKA" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="YT051.AMURITAX" FieldOptions="HORIZONTAL" Order="0180"/><Field DataSource="YT051.AMURIARARI" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="YT051.AMURIHANHURI" FieldOptions="" Order="0150"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(在庫単位),HORIZONTAL" Order="0070"/><Field DataSource="BT020.PRSIIRE" FieldOptions="" Order="0080"/><Field DataSource="BT020.PRARARI" FieldOptions="HORIZONTAL" Order="0100"/></Function><Function DetailFunction="YF061" ID="YF060" InitialMsg="" KeyFields="" Name="営業担当別月次取引サマリの一覧" OrderBy="" PrimaryTable="YT060" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="YT060.DTNEND" FieldOptions="" Order="0010"/><Column DataSource="YT060.DTMSEQ" FieldOptions="" Order="0020"/><Column DataSource="YT060.NRTANTOUJYUGYOIN" FieldOptions="" Order="0030"/><Column DataSource="YT060.AMURISYUK" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="YT060.DTNEND" FieldOptions="GE,CAPTION(年度≧)" Order="0010"/><Filter DataSource="YT060.DTMSEQ" FieldOptions="" Order="0020"/><Filter DataSource="YT060.NRTANTOUJYUGYOIN" FieldOptions="" Order="0030"/><Column DataSource="YT060.AMURITYOK" FieldOptions="" Order="0060"/><Column DataSource="YT060.AMURIHENPIN" FieldOptions="" Order="0070"/><Column DataSource="YT060.AMURIZATSUEKI" FieldOptions="" Order="0080"/><Column DataSource="YT060.AMURIZATSUSON" FieldOptions="" Order="0090"/><Column DataSource="YT060.AMURINEBIKI" FieldOptions="" Order="0100"/><Column DataSource="YT060.AMURIGENKA" FieldOptions="" Order="0130"/><Column DataSource="YT060.AMURITAX" FieldOptions="" Order="0120"/><Column DataSource="YT060.AMURIARARI" FieldOptions="" Order="0140"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(担当者名)" Order="0040"/><Column DataSource="YT060.AMURIHANHURI" FieldOptions="" Order="0110"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="YT060" ID="YF061" Name="営業担当別取引内訳の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="YT060.DTNEND" FieldOptions="CAPTION(年月度)" Order="0010"/><Field DataSource="YT060.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/><Field DataSource="YT060.NRTANTOUJYUGYOIN" FieldOptions="" Order="0030"/><Field DataSource="YT060.AMURISYUK" FieldOptions="" Order="0050"/><Field DataSource="YT060.AMURITYOK" FieldOptions="HORIZONTAL" Order="0060"/><Field DataSource="YT060.AMURIHENPIN" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="YT060.AMURIZATSUEKI" FieldOptions="" Order="0080"/><Field DataSource="YT060.AMURIZATSUSON" FieldOptions="HORIZONTAL" Order="0090"/><Field DataSource="YT060.AMURINEBIKI" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="YT060.AMURIGENKA" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="YT060.AMURITAX" FieldOptions="" Order="0120"/><Field DataSource="YT060.AMURIARARI" FieldOptions="HORIZONTAL" Order="0140"/><Detail Caption="売掛増減履歴" DetailFunction="DF101" FixedWhere="FGVALID = 'T'" HeaderKeyFields="" InitialMsg="" KeyFields="DTNEND;DTMSEQ;NRJYUGYOIN;NRURIAGE" Order="0020" Table="DT100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0020"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.PRHANBAI" FieldOptions="" Order="0090"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0100"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0110"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0120"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0130"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0140"/><Column DataSource="DT100.AMGENKA" FieldOptions="" Order="0150"/><Column DataSource="DT100.AMNEBIKI" FieldOptions="" Order="0160"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名)" Order="0040"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0050"/><Column DataSource="DT100.TXSYOHIN" FieldOptions="" Order="0060"/></Detail><Field DataSource="YT060.AMURIHANHURI" FieldOptions="HORIZONTAL" Order="0110"/></Function><Function ID="YF111" Name="買掛増減履歴集計処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT100; var rYT020; var uYT020; var cYT020; var cYT040; var cYT041;#EOL#var dtNend = 0; var dtMSeq = 0; var nrTorihikisaki = ''; var nrSyohin = '';#EOL#var errorMessage = ''; var amSiire = 0; var count = 0;#EOL##EOL#////////////////////#EOL#// 集計用変数定義 //#EOL#////////////////////#EOL#var amKaiKisyuzan020 = 0; var amKaiNyuk020 = 0; var amKaiTyok020 = 0; var amKaiHenpin020 = 0; var amKaiZatsueki020 = 0;#EOL#var amKaiZatsuson020 = 0; var amKaiSousai020 = 0; var amKaiGenka020 = 0; var amKaiSiharai020 = 0; var amKaiTax020 = 0;#EOL#var amKaiKisyuzan040 = 0; var amKaiNyuk040 = 0; var amKaiTyok040 = 0; var amKaiHenpin040 = 0; var amKaiZatsueki040 = 0;#EOL#var amKaiZatsuson040 = 0; var amKaiSousai040 = 0; var amKaiGenka040 = 0; var amKaiSiharai040 = 0; var amKaiTax040 = 0;#EOL#var amKaiNyuk041 = 0; var qtKaiNyuk041 = 0; var amKaiTyok041 = 0; var qtKaiTyok041 = 0;#EOL#var amKaiHenpin041 = 0; var qtKaiHenpin041 = 0; var amKaiGenka041 = 0; var amKaiTax041 = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var limitMSeq = instance.parmMap.get('LIMIT_MSEQ');#EOL##EOL#//////////////////////////////////////////////////////////////////////////#EOL#// 対象期間の仕入実績(CT100)の読取と取引サマリ(YT020,YT040,YT041)の更新 //#EOL#//////////////////////////////////////////////////////////////////////////#EOL#rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#rCT100.addKeyValue('FGVALID', 'T');#EOL#rCT100.addKeyValue('and ((', 'DTNEND >',  limitNend, ') or');#EOL#rCT100.addKeyValue('(',      'DTNEND =',  limitNend, ' and');#EOL#rCT100.addKeyValue('',       'DTMSEQ >=', limitMSeq, '))');#EOL#rCT100.setOrderBy('DTNEND, DTMSEQ, NRTORIHIKISAKI, NRSYOHIN');#EOL#while (rCT100.next()) {#EOL##EOL#&#x9;/////////////////////////////////////#EOL#&#x9;// 年月BREAKなら集計レコードの追加 //#EOL#&#x9;/////////////////////////////////////#EOL#&#x9;if (Number(rCT100.getValueOf('DTNEND')) != dtNend || Number(rCT100.getValueOf('DTMSEQ')) != dtMSeq) {#EOL##EOL#&#x9;&#x9;//////////////////////////////////////////////#EOL#&#x9;&#x9;// 仕入先･商品別月次取引サマリ(YT041)の追加 //#EOL#&#x9;&#x9;//////////////////////////////////////////////#EOL#&#x9;&#x9;insertYT041();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;// 仕入先別月次取引サマリ(YT040)の追加 //#EOL#&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;insertYT040();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;// 月次取引サマリ(YT020)の追加 //#EOL#&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;processYT020();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 仕入先BREAKなら集計レコードの追加 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (rCT100.getValueOf('NRTORIHIKISAKI').trim() != nrTorihikisaki) {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 仕入先･商品別月次取引サマリ(YT041)の追加 //#EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;insertYT041();#EOL#&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 仕入先別月次取引サマリ(YT040)の追加 //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;insertYT040();#EOL#&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 商品BREAKなら集計レコードの追加 //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rCT100.getValueOf('NRSYOHIN').trim() != nrSyohin) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 仕入先･商品別月次取引サマリ(YT041)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;//////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;insertYT041();#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////#EOL#&#x9;// BREAK検査フィールドの設定 //#EOL#&#x9;///////////////////////////////#EOL#&#x9;dtNend = rCT100.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rCT100.getValueOf('DTMSEQ');#EOL#&#x9;nrTorihikisaki = rCT100.getValueOf('NRTORIHIKISAKI').trim() + '';#EOL#&#x9;nrSyohin = rCT100.getValueOf('NRSYOHIN').trim() + '';#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 項目値の集計処理 //#EOL#&#x9;//////////////////////#EOL#&#x9;summarizeFields();#EOL#}#EOL##EOL#//////////////////////////////////////////////#EOL#// 仕入先･商品別月次取引サマリ(YT041)の追加 //#EOL#//////////////////////////////////////////////#EOL#insertYT041();#EOL##EOL#/////////////////////////////////////////#EOL#// 仕入先別月次取引サマリ(YT040)の追加 //#EOL#/////////////////////////////////////////#EOL#insertYT040();#EOL##EOL#/////////////////////////////////#EOL#// 月次取引サマリ(YT020)の追加 //#EOL#/////////////////////////////////#EOL#processYT020();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#/////////////////////////////////#EOL#// 月次取引サマリ(YT020)の追加 //#EOL#/////////////////////////////////#EOL#function processYT020() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;rYT020 = instance.createTableOperator('Count', 'YT020');#EOL#&#x9;&#x9;rYT020.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;rYT020.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;if (rYT020.execute() == 1) {#EOL#&#x9;&#x9;&#x9;uYT020 = instance.createTableOperator('Update', 'YT020');#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAIKISYUZAN',&#x9;amKaiKisyuzan020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAINYUK',&#x9;&#x9;amKaiNyuk020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAITYOK',&#x9;&#x9;amKaiTyok020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAIHENPIN',&#x9;&#x9;amKaiHenpin020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAIZATSUEKI',&#x9;amKaiZatsueki020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAIZATSUSON',&#x9;amKaiZatsuson020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAISOUSAI',&#x9;&#x9;amKaiSousai020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAIGENKA',&#x9;&#x9;amKaiGenka020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAISIHARAI',&#x9;&#x9;amKaiSiharai020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMKAITAX',&#x9;&#x9;&#x9;amKaiTax020);#EOL#&#x9;&#x9;&#x9;uYT020.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;uYT020.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;count = uYT020.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cYT020 = instance.createTableOperator('Insert', 'YT020');#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAIKISYUZAN',&#x9;amKaiKisyuzan020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAINYUK',&#x9;&#x9;amKaiNyuk020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAITYOK',&#x9;&#x9;amKaiTyok020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAIHENPIN',&#x9;&#x9;amKaiHenpin020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAIZATSUEKI',&#x9;amKaiZatsueki020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAIZATSUSON',&#x9;amKaiZatsuson020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAISOUSAI',&#x9;&#x9;amKaiSousai020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAIGENKA',&#x9;&#x9;amKaiGenka020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAISIHARAI',&#x9;&#x9;amKaiSiharai020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMKAITAX',&#x9;&#x9;&#x9;amKaiTax020);#EOL#&#x9;&#x9;&#x9;count = cYT020.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amKaiKisyuzan020 = 0; amKaiNyuk020 = 0; amKaiTyok020 = 0; amKaiHenpin020 = 0; amKaiZatsueki020 = 0;#EOL#&#x9;&#x9;amKaiZatsuson020 = 0; amKaiSousai020 = 0; amKaiGenka020 = 0; amKaiSiharai020 = 0; amKaiTax020 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#/////////////////////////////////////////#EOL#// 仕入先別月次取引サマリ(YT040)の追加 //#EOL#/////////////////////////////////////////#EOL#function insertYT040() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;cYT040 = instance.createTableOperator('Insert', 'YT040');#EOL#&#x9;&#x9;cYT040.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT040.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cYT040.addValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;&#x9;cYT040.addValue('AMKAIKISYUZAN',&#x9;amKaiKisyuzan040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAINYUK',&#x9;&#x9;amKaiNyuk040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAITYOK',&#x9;&#x9;amKaiTyok040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAIHENPIN',&#x9;&#x9;amKaiHenpin040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAIZATSUEKI',&#x9;amKaiZatsueki040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAIZATSUSON',&#x9;amKaiZatsuson040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAISOUSAI',&#x9;&#x9;amKaiSousai040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAIGENKA',&#x9;&#x9;amKaiGenka040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAISIHARAI',&#x9;&#x9;amKaiSiharai040);#EOL#&#x9;&#x9;cYT040.addValue('AMKAITAX',&#x9;&#x9;&#x9;amKaiTax040);#EOL#&#x9;&#x9;count = cYT040.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先別月次取引サマリ(YT040)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amKaiKisyuzan040 = 0; amKaiNyuk040 = 0; amKaiTyok040 = 0; amKaiHenpin040 = 0; amKaiZatsueki040 = 0;#EOL#&#x9;&#x9;amKaiZatsuson040 = 0; amKaiSousai040 = 0; amKaiGenka040 = 0; amKaiSiharai040 = 0; amKaiTax040 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////////////////////////////#EOL#// 仕入先･商品別月次取引サマリ(YT041)の追加 //#EOL#//////////////////////////////////////////////#EOL#function insertYT041() {#EOL#&#x9;if (dtNend != 0 &amp;&amp; nrSyohin != '') {#EOL#&#x9;&#x9;cYT041 = instance.createTableOperator('Insert', 'YT041');#EOL#&#x9;&#x9;cYT041.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT041.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cYT041.addValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;&#x9;cYT041.addValue('NRSYOHIN',&#x9;&#x9;&#x9;nrSyohin);#EOL#&#x9;&#x9;cYT041.addValue('AMKAINYUK',&#x9;&#x9;amKaiNyuk041);#EOL#&#x9;&#x9;cYT041.addValue('QTKAINYUK',&#x9;&#x9;qtKaiNyuk041);#EOL#&#x9;&#x9;cYT041.addValue('AMKAITYOK',&#x9;&#x9;amKaiTyok041);#EOL#&#x9;&#x9;cYT041.addValue('QTKAITYOK',&#x9;&#x9;qtKaiTyok041);#EOL#&#x9;&#x9;cYT041.addValue('AMKAIHENPIN',&#x9;&#x9;amKaiHenpin041);#EOL#&#x9;&#x9;cYT041.addValue('QTKAIHENPIN',&#x9;&#x9;qtKaiHenpin041);#EOL#&#x9;&#x9;cYT041.addValue('AMKAIGENKA',&#x9;&#x9;amKaiGenka041);#EOL#&#x9;&#x9;cYT041.addValue('AMKAITAX',&#x9;&#x9;&#x9;amKaiTax041);#EOL#&#x9;&#x9;count = cYT041.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先･商品別月次取引サマリ(YT041)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;//#EOL#&#x9;amKaiNyuk041 = 0; qtKaiNyuk041 = 0; amKaiTyok041 = 0; qtKaiTyok041 = 0;#EOL#&#x9;amKaiHenpin041 = 0; qtKaiHenpin041 = 0; amKaiGenka041 = 0; amKaiTax041 = 0;#EOL#}#EOL##EOL#//////////////////////#EOL#// 項目値の集計処理 //#EOL#//////////////////////#EOL#function summarizeFields() {#EOL##EOL#&#x9;////////////////////////////////////////#EOL#&#x9;//月次為替レートによる仕入額の内貨換算//#EOL#&#x9;////////////////////////////////////////#EOL#&#x9;rtRate = session.getMonthlyExchangeRate(rCT100.getValueOf('KBCURRENCY'), dtNend, dtMSeq, 'TTS');#EOL#&#x9;amSiire = Number(rCT100.getValueOf('AMSIIRE')) * rtRate; #EOL##EOL#&#x9;// 00 入荷仕入 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '00') {#EOL#&#x9;&#x9;amKaiNyuk020 = Number(amKaiNyuk020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiNyuk040 = Number(amKaiNyuk040) + Number(amSiire);#EOL#&#x9;&#x9;amKaiNyuk041 = Number(amKaiNyuk041) + Number(amSiire);#EOL#&#x9;&#x9;qtKaiNyuk041 = Number(qtKaiNyuk041) + Number(rCT100.getValueOf('QTSIIRE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 01 直入荷仕入 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '01') {#EOL#&#x9;&#x9;amKaiTyok020 = Number(amKaiTyok020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiTyok040 = Number(amKaiTyok040) + Number(amSiire);#EOL#&#x9;&#x9;amKaiTyok041 = Number(amKaiTyok041) + Number(amSiire);#EOL#&#x9;&#x9;qtKaiTyok041 = Number(qtKaiTyok041) + Number(rCT100.getValueOf('QTSIIRE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 02 仕入返品 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '02') {#EOL#&#x9;&#x9;amKaiHenpin020 = Number(amKaiHenpin020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiHenpin040 = Number(amKaiHenpin040) + Number(amSiire);#EOL#&#x9;&#x9;amKaiHenpin041 = Number(amKaiHenpin041) + Number(amSiire);#EOL#&#x9;&#x9;qtKaiHenpin041 = Number(qtKaiHenpin041) + Number(rCT100.getValueOf('QTSIIRE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 10 雑益振替 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '10') {#EOL#&#x9;&#x9;amKaiZatsueki020 = Number(amKaiZatsueki020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiZatsueki040 = Number(amKaiZatsueki040) + Number(amSiire);#EOL#&#x9;}#EOL##EOL#&#x9;// 11 雑損仕入 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '11') {#EOL#&#x9;&#x9;amKaiZatsuson020 = Number(amKaiZatsuson020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiZatsuson040 = Number(amKaiZatsuson040) + Number(amSiire);#EOL#&#x9;}#EOL##EOL#&#x9;// 20 相殺 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '20') {#EOL#&#x9;&#x9;amKaiSousai020 = Number(amKaiSousai020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiSousai040 = Number(amKaiSousai040) + Number(amSiire);#EOL#&#x9;}#EOL##EOL#&#x9;// 30 売上原価振替 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '30') {#EOL#&#x9;&#x9;amKaiGenka020 = Number(amKaiGenka020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiGenka040 = Number(amKaiGenka040) + Number(amSiire);#EOL#&#x9;&#x9;amKaiGenka041 = Number(amKaiGenka041) + Number(amSiire);#EOL#&#x9;}#EOL##EOL#&#x9;// 90 支払 //#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '90') {#EOL#&#x9;&#x9;amKaiSiharai020 = Number(amKaiSiharai020) + Number(amSiire);#EOL#&#x9;&#x9;amKaiSiharai040 = Number(amKaiSiharai040) + Number(amSiire);#EOL#&#x9;}#EOL##EOL#&#x9;// 消費税 //#EOL#&#x9;amKaiTax020 = Number(amKaiTax020) + Number(rCT100.getValueOf('AMTAX'));#EOL#&#x9;amKaiTax040 = Number(amKaiTax040) + Number(rCT100.getValueOf('AMTAX'));#EOL#&#x9;amKaiTax041 = Number(amKaiTax041) + Number(rCT100.getValueOf('AMTAX'));#EOL#}" SubsystemID="Y" Type="XF000"/><Function ID="YF112" Name="売掛増減履歴集計処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT100; var rYT020; var uYT020; var cYT020; var cYT050; var cYT051;#EOL#var dtNend = 0; var dtMSeq = 0; var nrTorihikisaki = ''; var nrSyohin = '';#EOL#var errorMessage = ''; var amNebiki = 0; var count = 0;#EOL##EOL#////////////////////#EOL#// 集計用変数定義 //#EOL#////////////////////#EOL#var amUriKisyuzan020 = 0; var amUriSyuk020 = 0; var amUriTyok020 = 0; var amUriHenpin020 = 0; var amUriZatsueki020 = 0; var amUriZatsuson020 = 0;#EOL#var amUriSousai020 = 0; var amUriNebiki020 = 0; var amUriHanhuri020 = 0; var amUriJyuryo020 = 0; var amUriGenka020 = 0; var amUriTax020 = 0;#EOL#var amUriKisyuzan050 = 0; var amUriSyuk050 = 0; var amUriTyok050 = 0; var amUriHenpin050 = 0; var amUriZatsueki050 = 0; var amUriZatsuson050 = 0;#EOL#var amUriSousai050 = 0; var amUriNebiki050 = 0; var amUriHanhuri050 = 0; var amUriJyuryo050 = 0; var amUriGenka050 = 0; var amUriTax050 = 0;#EOL#var amUriSyuk051 = 0; var amUriTyok051 = 0; var amUriHenpin051 = 0; var amUriNebiki051 = 0; var amUriHanhuri051 = 0; var amUriGenka051 = 0;#EOL#var amUriTax051 = 0; var qtUriSyuk051 = 0; var qtUriTyok051 = 0; var qtUriHenpin051 = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var limitMSeq = instance.parmMap.get('LIMIT_MSEQ');#EOL##EOL#//////////////////////////////////////////////////////////////////////////#EOL#// 対象期間の売上実績(DT100)の読取と取引サマリ(YT020,YT050,YT051)の更新 //#EOL#//////////////////////////////////////////////////////////////////////////#EOL#rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#rDT100.addKeyValue('FGVALID', 'T');#EOL#rDT100.addKeyValue('and ((', 'DTNEND >',  limitNend, ') or');#EOL#rDT100.addKeyValue('(',      'DTNEND =',  limitNend, ' and');#EOL#rDT100.addKeyValue('',       'DTMSEQ >=', limitMSeq, '))');#EOL#rDT100.setOrderBy('DTNEND, DTMSEQ, NRTORIHIKISAKI, NRSYOHIN');#EOL#while (rDT100.next()) {#EOL##EOL#&#x9;/////////////////////////////////////#EOL#&#x9;// 年月BREAKなら集計レコードの追加 //#EOL#&#x9;/////////////////////////////////////#EOL#&#x9;if (Number(rDT100.getValueOf('DTNEND')) != dtNend || Number(rDT100.getValueOf('DTMSEQ')) != dtMSeq) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 顧客･商品別月次取引サマリ(YT051)の追加 //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;insertYT051();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 顧客別月次取引サマリ(YT050)の追加 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;insertYT050();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;// 月次取引サマリ(YT020)の追加 //#EOL#&#x9;&#x9;/////////////////////////////////#EOL#&#x9;&#x9;processYT020();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 得意先BREAKなら集計レコードの追加 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;if (rDT100.getValueOf('NRTORIHIKISAKI').trim() != nrTorihikisaki) {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 顧客･商品別月次取引サマリ(YT051)の追加 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;insertYT051();#EOL#&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 顧客別月次取引サマリ(YT050)の追加 //#EOL#&#x9;&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;&#x9;insertYT050();#EOL#&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 商品BREAKなら集計レコードの追加 //#EOL#&#x9;&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rDT100.getValueOf('NRSYOHIN').trim() != nrSyohin) {#EOL##EOL#&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;// 顧客･商品別月次取引サマリ(YT051)の追加 //#EOL#&#x9;&#x9;&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;&#x9;insertYT051();#EOL#&#x9;&#x9;&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////#EOL#&#x9;// BREAK検査フィールドの設定 //#EOL#&#x9;///////////////////////////////#EOL#&#x9;dtNend = rDT100.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rDT100.getValueOf('DTMSEQ');#EOL#&#x9;nrTorihikisaki = rDT100.getValueOf('NRTORIHIKISAKI').trim() + '';#EOL#&#x9;nrSyohin = rDT100.getValueOf('NRSYOHIN').trim() + '';#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 項目値の集計処理 //#EOL#&#x9;//////////////////////#EOL#&#x9;summarizeFields();#EOL#}#EOL##EOL#////////////////////////////////////////////#EOL#// 顧客･商品別月次取引サマリ(YT051)の追加 //#EOL#////////////////////////////////////////////#EOL#insertYT051();#EOL##EOL#///////////////////////////////////////#EOL#// 顧客別月次取引サマリ(YT050)の追加 //#EOL#///////////////////////////////////////#EOL#insertYT050();#EOL##EOL#/////////////////////////////////#EOL#// 月次取引サマリ(YT020)の追加 //#EOL#/////////////////////////////////#EOL#processYT020();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#/////////////////////////////////#EOL#// 月次取引サマリ(YT020)の追加 //#EOL#/////////////////////////////////#EOL#function processYT020() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;rYT020 = instance.createTableOperator('Select', 'YT020');#EOL#&#x9;&#x9;rYT020.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;rYT020.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;if (rYT020.execute() == 1) {#EOL#&#x9;&#x9;&#x9;uYT020 = instance.createTableOperator('Update', 'YT020');#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURIKISYUZAN',&#x9;amUriKisyuzan020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURISYUK',&#x9;&#x9;amUriSyuk020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURITYOK',&#x9;&#x9;amUriTyok020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURIHENPIN',&#x9;&#x9;amUriHenpin020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURIZATSUEKI',&#x9;amUriZatsueki020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURIZATSUSON',&#x9;amUriZatsuson020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURISOUSAI',&#x9;&#x9;amUriSousai020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURINEBIKI',&#x9;&#x9;amUriNebiki020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURIHANHURI',&#x9;&#x9;amUriHanhuri020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURIJYURYO',&#x9;&#x9;amUriJyuryo020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURIGENKA',&#x9;&#x9;amUriGenka020);#EOL#&#x9;&#x9;&#x9;uYT020.addValue('AMURITAX',&#x9;&#x9;&#x9;amUriTax020);#EOL#&#x9;&#x9;&#x9;uYT020.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;uYT020.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;count = uYT020.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;cYT020 = instance.createTableOperator('Insert', 'YT020');#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURIKISYUZAN',&#x9;amUriKisyuzan020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURISYUK',&#x9;&#x9;amUriSyuk020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURITYOK',&#x9;&#x9;amUriTyok020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURIHENPIN',&#x9;&#x9;amUriHenpin020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURIZATSUEKI',&#x9;amUriZatsueki020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURIZATSUSON',&#x9;amUriZatsuson020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURISOUSAI',&#x9;&#x9;amUriSousai020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURINEBIKI',&#x9;&#x9;amUriNebiki020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURIHANHURI',&#x9;&#x9;amUriHanhuri020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURIJYURYO',&#x9;&#x9;amUriJyuryo020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURIGENKA',&#x9;&#x9;amUriGenka020);#EOL#&#x9;&#x9;&#x9;cYT020.addValue('AMURITAX',&#x9;&#x9;amUriTax020);#EOL#&#x9;&#x9;&#x9;count = cYT020.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amUriKisyuzan020 = 0; amUriSyuk020 = 0; amUriTyok020 = 0; amUriHenpin020 = 0; amUriZatsueki020 = 0; amUriZatsuson020 = 0;#EOL#&#x9;&#x9;amUriSousai020 = 0; amUriNebiki020 = 0; amUriHanhuri020 = 0; amUriJyuryo020 = 0; amUriGenka020 = 0; amUriTax020 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#///////////////////////////////////////#EOL#// 顧客別月次取引サマリ(YT050)の追加 //#EOL#///////////////////////////////////////#EOL#function insertYT050() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;cYT050 = instance.createTableOperator('Insert', 'YT050');#EOL#&#x9;&#x9;cYT050.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT050.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cYT050.addValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;&#x9;cYT050.addValue('AMURIKISYUZAN',&#x9;amUriKisyuzan050);#EOL#&#x9;&#x9;cYT050.addValue('AMURISYUK',&#x9;&#x9;amUriSyuk050);#EOL#&#x9;&#x9;cYT050.addValue('AMURITYOK',&#x9;&#x9;amUriTyok050);#EOL#&#x9;&#x9;cYT050.addValue('AMURIHENPIN',&#x9;&#x9;amUriHenpin050);#EOL#&#x9;&#x9;cYT050.addValue('AMURIZATSUEKI',&#x9;amUriZatsueki050);#EOL#&#x9;&#x9;cYT050.addValue('AMURIZATSUSON',&#x9;amUriZatsuson050);#EOL#&#x9;&#x9;cYT050.addValue('AMURISOUSAI',&#x9;&#x9;amUriSousai050);#EOL#&#x9;&#x9;cYT050.addValue('AMURINEBIKI',&#x9;&#x9;amUriNebiki050);#EOL#&#x9;&#x9;cYT050.addValue('AMURIHANHURI',&#x9;&#x9;amUriHanhuri050);#EOL#&#x9;&#x9;cYT050.addValue('AMURIJYURYO',&#x9;&#x9;amUriJyuryo050);#EOL#&#x9;&#x9;cYT050.addValue('AMURIGENKA',&#x9;&#x9;amUriGenka050);#EOL#&#x9;&#x9;cYT050.addValue('AMURITAX',&#x9;&#x9;&#x9;amUriTax050);#EOL#&#x9;&#x9;count = cYT050.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客別月次取引サマリ(YT050)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amUriKisyuzan050 = 0; amUriSyuk050 = 0; amUriTyok050 = 0; amUriHenpin050 = 0; amUriZatsueki050 = 0; amUriZatsuson050 = 0;#EOL#&#x9;&#x9;amUriSousai050 = 0; amUriNebiki050 = 0; amUriHanhuri050 = 0; amUriJyuryo050 = 0; amUriGenka050 = 0; amUriTax050 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////////////////#EOL#// 顧客･商品別月次取引サマリ(YT051)の追加 //#EOL#////////////////////////////////////////////#EOL#function insertYT051() {#EOL#&#x9;if (dtNend != 0 &amp;&amp; nrSyohin != '') {#EOL#&#x9;&#x9;cYT051 = instance.createTableOperator('Insert', 'YT051');#EOL#&#x9;&#x9;cYT051.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT051.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cYT051.addValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;&#x9;cYT051.addValue('NRSYOHIN',&#x9;&#x9;&#x9;nrSyohin);#EOL#&#x9;&#x9;cYT051.addValue('AMURISYUK',&#x9;&#x9;amUriSyuk051);#EOL#&#x9;&#x9;cYT051.addValue('QTURISYUK',&#x9;&#x9;qtUriSyuk051);#EOL#&#x9;&#x9;cYT051.addValue('AMURITYOK',&#x9;&#x9;amUriTyok051);#EOL#&#x9;&#x9;cYT051.addValue('QTURITYOK',&#x9;&#x9;qtUriTyok051);#EOL#&#x9;&#x9;cYT051.addValue('AMURIHENPIN',&#x9;&#x9;amUriHenpin051);#EOL#&#x9;&#x9;cYT051.addValue('QTURIHENPIN',&#x9;&#x9;qtUriHenpin051);#EOL#&#x9;&#x9;cYT051.addValue('AMURINEBIKI',&#x9;&#x9;amUriNebiki051);#EOL#&#x9;&#x9;cYT051.addValue('AMURIHANHURI',&#x9;&#x9;amUriHanhuri051);#EOL#&#x9;&#x9;cYT051.addValue('AMURIGENKA',&#x9;&#x9;amUriGenka051);#EOL#&#x9;&#x9;cYT051.addValue('AMURITAX',&#x9;&#x9;&#x9;amUriTax051);#EOL#&#x9;&#x9;count = cYT051.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客･商品別月次取引サマリ(YT051)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;//#EOL#&#x9;amUriSyuk051 = 0; amUriTyok051 = 0; amUriHenpin051 = 0; amUriNebiki051 = 0; amUriHanhuri051 = 0;#EOL#&#x9;amUriGenka051 = 0; amUriTax051 = 0; qtUriSyuk051 = 0; qtUriTyok051 = 0; qtUriHenpin051 = 0;#EOL#}#EOL##EOL#//////////////////////#EOL#// 項目値の集計処理 //#EOL#//////////////////////#EOL#function summarizeFields() {#EOL##EOL#&#x9;// 00 出荷売上 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '00') {#EOL#&#x9;&#x9;amUriSyuk020 = Number(amUriSyuk020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriSyuk050 = Number(amUriSyuk050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriSyuk051 = Number(amUriSyuk051) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;qtUriSyuk051 = Number(qtUriSyuk051) + Number(rDT100.getValueOf('QTURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 01 直出荷売上 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '01') {#EOL#&#x9;&#x9;amUriTyok020 = Number(amUriTyok020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriTyok050 = Number(amUriTyok050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriTyok051 = Number(amUriTyok051) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;qtUriTyok051 = Number(qtUriTyok051) + Number(rDT100.getValueOf('QTURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 02 出荷返品 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '02') {#EOL#&#x9;&#x9;amUriHenpin020 = Number(amUriHenpin020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriHenpin050 = Number(amUriHenpin050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriHenpin051 = Number(amUriHenpin051) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;qtUriHenpin051 = Number(qtUriHenpin051) + Number(rDT100.getValueOf('QTURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 10 雑益売上 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '10') {#EOL#&#x9;&#x9;amUriZatsueki020 = Number(amUriZatsueki020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriZatsueki050 = Number(amUriZatsueki050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 11 雑損振替 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '11') {#EOL#&#x9;&#x9;amUriZatsuson020 = Number(amUriZatsuson020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriZatsuson050 = Number(amUriZatsuson050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 20 相殺(買掛金振替) //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '20') {#EOL#&#x9;&#x9;amUriSousai020 = Number(amUriSousai020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriSousai050 = Number(amUriSousai050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 30 値引(販売費振替) //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '30') {#EOL#&#x9;&#x9;amUriHanhuri020 = Number(amUriHanhuri020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriHanhuri050 = Number(amUriHanhuri050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriHanhuri051 = Number(amUriHanhuri051) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 90 受領 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '90') {#EOL#&#x9;&#x9;amUriJyuryo020 = Number(amUriJyuryo020) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;&#x9;amUriJyuryo050 = Number(amUriJyuryo050) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 営業値引 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '00' || rDT100.getValueOf('KBURIAGE') == '01') {#EOL#&#x9;&#x9;amNebiki = (rDT100.getValueOf('PRHANBAI') - rDT100.getValueOf('PRURIAGE')) * rDT100.getValueOf('QTURIAGE');#EOL#&#x9;&#x9;amUriNebiki020 = Number(amUriNebiki020) + Number(amNebiki);#EOL#&#x9;&#x9;amUriNebiki050 = Number(amUriNebiki050) + Number(amNebiki);#EOL#&#x9;&#x9;amUriNebiki051 = Number(amUriNebiki051) + Number(amNebiki);#EOL#&#x9;}#EOL##EOL#&#x9;// 売上原価 //#EOL#&#x9;amUriGenka020 = Number(amUriGenka020) + Number(rDT100.getValueOf('AMGENKA'));#EOL#&#x9;amUriGenka050 = Number(amUriGenka050) + Number(rDT100.getValueOf('AMGENKA'));#EOL#&#x9;amUriGenka051 = Number(amUriGenka051) + Number(rDT100.getValueOf('AMGENKA'));#EOL##EOL#&#x9;// 消費税 //#EOL#&#x9;amUriTax020 = Number(amUriTax020) + Number(rDT100.getValueOf('AMTAX'));#EOL#&#x9;amUriTax050 = Number(amUriTax050) + Number(rDT100.getValueOf('AMTAX'));#EOL#&#x9;amUriTax051 = Number(amUriTax051) + Number(rDT100.getValueOf('AMTAX'));#EOL#}" SubsystemID="Y" Type="XF000"/><Function ID="YF113" Name="営業実績集計処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT100; var cYT060;#EOL#var dtNend = 0; var dtMSeq = 0; var nrJyugyoin = ''; var amNebiki = 0;#EOL#var errorMessage = ''; var count = 0;#EOL##EOL#////////////////////#EOL#// 集計用変数定義 //#EOL#////////////////////#EOL#var amUriSyuk060 = 0; var amUriTyok060 = 0; var amUriHenpin060 = 0; var amUriZatsueki060 = 0;#EOL#var amUriZatsuson060 = 0; var amUriNebiki060 = 0; var amUriHanhuri060 = 0; var amUriGenka060 = 0; var amUriTax060 = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var limitMSeq = instance.parmMap.get('LIMIT_MSEQ');#EOL##EOL#//////////////////////////////////////////////////////////////#EOL#// 対象期間の売上実績(DT100)の読取と取引サマリ(YT060)の更新 //#EOL#//////////////////////////////////////////////////////////////#EOL#rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#rDT100.addKeyValue('FGVALID', 'T');#EOL#rDT100.addKeyValue('and ((', 'DTNEND >',  limitNend, ') or');#EOL#rDT100.addKeyValue('(',      'DTNEND =',  limitNend, ' and');#EOL#rDT100.addKeyValue('',       'DTMSEQ >=', limitMSeq, '))');#EOL#rDT100.setOrderBy('DTNEND, DTMSEQ, NRJYUGYOIN');#EOL#while (rDT100.next()) {#EOL##EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;// 年月/従業員BREAKなら集計レコードの追加 //#EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;if (Number(rDT100.getValueOf('DTNEND')) != dtNend#EOL#&#x9;&#x9; || Number(rDT100.getValueOf('DTMSEQ')) != dtMSeq#EOL#&#x9;&#x9; || rDT100.getValueOf('NRJYUGYOIN').trim() != nrJyugyoin) {#EOL##EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;// 担当別月次取引サマリ(YT060)の追加 //#EOL#&#x9;&#x9;///////////////////////////////////////#EOL#&#x9;&#x9;insertYT060();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////#EOL#&#x9;// BREAK検査フィールドの設定 //#EOL#&#x9;///////////////////////////////#EOL#&#x9;dtNend = rDT100.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rDT100.getValueOf('DTMSEQ');#EOL#&#x9;nrJyugyoin = rDT100.getValueOf('NRJYUGYOIN').trim() + '';#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 項目値の集計処理 //#EOL#&#x9;//////////////////////#EOL#&#x9;summarizeFields();#EOL#}#EOL##EOL#///////////////////////////////////////#EOL#// 顧客別月次取引サマリ(YT060)の追加 //#EOL#///////////////////////////////////////#EOL#insertYT060();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#///////////////////////////////////////#EOL#// 担当別月次取引サマリ(YT060)の追加 //#EOL#///////////////////////////////////////#EOL#function insertYT060() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;cYT060 = instance.createTableOperator('Insert', 'YT060');#EOL#&#x9;&#x9;cYT060.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT060.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;cYT060.addValue('NRTANTOUJYUGYOIN',&#x9;nrJyugyoin);#EOL#&#x9;&#x9;cYT060.addValue('AMURISYUK',&#x9;&#x9;amUriSyuk060);#EOL#&#x9;&#x9;cYT060.addValue('AMURITYOK',&#x9;&#x9;amUriTyok060);#EOL#&#x9;&#x9;cYT060.addValue('AMURIHENPIN',&#x9;&#x9;amUriHenpin060);#EOL#&#x9;&#x9;cYT060.addValue('AMURIZATSUEKI',&#x9;amUriZatsueki060);#EOL#&#x9;&#x9;cYT060.addValue('AMURIZATSUSON',&#x9;amUriZatsuson060);#EOL#&#x9;&#x9;cYT060.addValue('AMURINEBIKI',&#x9;&#x9;amUriNebiki060);#EOL#&#x9;&#x9;cYT060.addValue('AMURIHANHURI',&#x9;&#x9;amUriHanhuri060);#EOL#&#x9;&#x9;cYT060.addValue('AMURIGENKA',&#x9;&#x9;amUriGenka060);#EOL#&#x9;&#x9;cYT060.addValue('AMURITAX',&#x9;&#x9;&#x9;amUriTax060);#EOL#&#x9;&#x9;count = cYT060.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '担当別月次取引サマリ(YT060)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;//#EOL#&#x9;&#x9;amUriSyuk060 = 0; amUriTyok060 = 0; amUriHenpin060 = 0; amUriZatsueki060 = 0;#EOL#&#x9;&#x9;amUriZatsuson060 = 0; amUriNebiki060 = 0; amUriHanhuri060 = 0; amUriGenka060 = 0; amUriTax060 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////#EOL#// 項目値の集計処理 //#EOL#//////////////////////#EOL#function summarizeFields() {#EOL##EOL#&#x9;// 00 出荷売上 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '00') {#EOL#&#x9;&#x9;amUriSyuk060 = Number(amUriSyuk060) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 01 直出荷売上 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '01') {#EOL#&#x9;&#x9;amUriTyok060 = Number(amUriTyok060) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 02 出荷返品 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '02') {#EOL#&#x9;&#x9;amUriHenpin060 = Number(amUriHenpin060) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 10 雑益売上 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '10') {#EOL#&#x9;&#x9;amUriZatsueki060 = Number(amUriZatsueki060) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 11 雑損振替 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '11') {#EOL#&#x9;&#x9;amUriZatsuson060 = Number(amUriZatsuson060) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 30 値引(販売費振替) //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '30') {#EOL#&#x9;&#x9;amUriHanhuri060 = Number(amUriHanhuri060) + Number(rDT100.getValueOf('AMURIAGE'));#EOL#&#x9;}#EOL##EOL#&#x9;// 営業値引 //#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '00' || rDT100.getValueOf('KBURIAGE') == '01') {#EOL#&#x9;&#x9;amNebiki = (rDT100.getValueOf('PRHANBAI') - rDT100.getValueOf('PRURIAGE')) * rDT100.getValueOf('QTURIAGE');#EOL#&#x9;&#x9;amUriNebiki060 = Number(amUriNebiki060) + Number(amNebiki);#EOL#&#x9;}#EOL##EOL#&#x9;// 売上原価 //#EOL#&#x9;amUriGenka060 = Number(amUriGenka060) + Number(rDT100.getValueOf('AMGENKA'));#EOL##EOL#&#x9;// 消費税 //#EOL#&#x9;amUriTax060 = Number(amUriTax060) + Number(rDT100.getValueOf('AMTAX'));#EOL#}" SubsystemID="Y" Type="XF000"/><Function ID="YF120" Name="月次倉庫在庫残高繰越処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET010; var rYT031; var cYT031; var uYT031; #EOL#var dtNend = 0; var dtMSeq = 0; var nrSouko = ''; var nrSyohin = ''; var errorMessage = '';#EOL#var amZaiKisyuzan = 0; var qtZaiKisyuzan = 0; var amZaiKimatsuzan = 0; var qtZaiKimatsuzan = 0;#EOL#var workNend = 0; var workMSeq = 0; var count = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var today = session.today + '';#EOL#var futureLimitNend = session.getFYearOfDate(today);#EOL#var futureLimitMSeq = session.getMSeqOfDate(today);#EOL##EOL#///////////////////////////#EOL#// 倉庫在庫(ET010)の読取 //#EOL#///////////////////////////#EOL#rET010 = instance.createTableOperator('Select', 'ET010');#EOL#rET010.setSelectFields('NRSYOHIN, NRSOUKO, AMKISYUZAIKO, QTKISYUZAIKO');#EOL#while (rET010.next()) {#EOL##EOL#&#x9;//////////////////////////////////////////////////#EOL#&#x9;// 商品･倉庫別月次取引サマリ(YT031)の検索と更新 //#EOL#&#x9;//////////////////////////////////////////////////#EOL#&#x9;rYT031 = instance.createTableOperator('Count', 'YT031');#EOL#&#x9;rYT031.addKeyValue('DTNEND',&#x9;limitNend);#EOL#&#x9;rYT031.addKeyValue('DTMSEQ',&#x9;1);#EOL#&#x9;rYT031.addKeyValue('NRSYOHIN',&#x9;rET010.getValueOf('NRSYOHIN'));#EOL#&#x9;rYT031.addKeyValue('NRSOUKO',&#x9;rET010.getValueOf('NRSOUKO'));#EOL#&#x9;if (rYT031.execute() == 1) {#EOL##EOL#&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;// 期首残高更新 //#EOL#&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;uYT031 = instance.createTableOperator('Update', 'YT031');#EOL#&#x9;&#x9;uYT031.addValue('AMZAIKISYUZAN',&#x9;rET010.getValueOf('AMKISYUZAIKO'));#EOL#&#x9;&#x9;uYT031.addValue('QTZAIKISYUZAN',&#x9;rET010.getValueOf('QTKISYUZAIKO'));#EOL#&#x9;&#x9;uYT031.addKeyValue('DTNEND',&#x9;limitNend);#EOL#&#x9;&#x9;uYT031.addKeyValue('DTMSEQ',&#x9;1);#EOL#&#x9;&#x9;uYT031.addKeyValue('NRSYOHIN',&#x9;rET010.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;uYT031.addKeyValue('NRSOUKO',&#x9;rET010.getValueOf('NRSOUKO'));#EOL#&#x9;&#x9;count = uYT031.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '商品･倉庫別月次取引サマリ(YT031)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL##EOL#&#x9;&#x9;////////////////////////////////////#EOL#&#x9;&#x9;// 期首残高を設定してレコード追加 //#EOL#&#x9;&#x9;////////////////////////////////////#EOL#&#x9;&#x9;cYT031 = instance.createTableOperator('Insert', 'YT031');#EOL#&#x9;&#x9;cYT031.addValue('DTNEND',&#x9;&#x9;&#x9;limitNend);#EOL#&#x9;&#x9;cYT031.addValue('DTMSEQ',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;cYT031.addValue('NRSYOHIN',&#x9;&#x9;&#x9;rET010.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;cYT031.addValue('NRSOUKO',&#x9;&#x9;&#x9;rET010.getValueOf('NRSOUKO'));#EOL#&#x9;&#x9;cYT031.addValue('AMZAIKISYUZAN',&#x9;rET010.getValueOf('AMKISYUZAIKO'));#EOL#&#x9;&#x9;cYT031.addValue('QTZAIKISYUZAN',&#x9;rET010.getValueOf('QTKISYUZAIKO'));#EOL#&#x9;&#x9;count = cYT031.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '商品･倉庫別月次取引サマリ(YT031)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////////////////////#EOL#&#x9;// 商品･倉庫別月次取引サマリ(YT031)の期間初期化 //#EOL#&#x9;//////////////////////////////////////////////////#EOL#&#x9;initializeKikanRecordsOfYT031(rET010.getValueOf('NRSYOHIN'), rET010.getValueOf('NRSOUKO'));#EOL#}#EOL##EOL#////////////////////////////////////////////////////////////////////#EOL#// 対象期間の商品･倉庫別月次取引サマリ(YT031)の読取と繰越残高更新 //#EOL#////////////////////////////////////////////////////////////////////#EOL#rYT031 = instance.createTableOperator('Select', 'YT031');#EOL#rYT031.addKeyValue('DTNEND >=',&#x9;limitNend);#EOL#rYT031.setOrderBy('NRSYOHIN, NRSOUKO, DTNEND, DTMSEQ');#EOL#while (rYT031.next()) {#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 繰越残高の更新 //#EOL#&#x9;////////////////////#EOL#&#x9;updateYT031();#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;// 商品/倉庫BREAKにもとづく期首残高の設定 //#EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;if (rYT031.getValueOf('NRSYOHIN') != nrSyohin || rYT031.getValueOf('NRSOUKO') != nrSouko) {#EOL#&#x9;&#x9;amZaiKisyuzan = rYT031.getValueOf('AMZAIKISYUZAN');#EOL#&#x9;&#x9;qtZaiKisyuzan = rYT031.getValueOf('QTZAIKISYUZAN');#EOL#&#x9;} else {#EOL#&#x9;&#x9;amZaiKisyuzan = amZaiKimatsuzan;#EOL#&#x9;&#x9;qtZaiKisyuzan = qtZaiKimatsuzan;#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////#EOL#&#x9;// BREAKキーの設定 //#EOL#&#x9;/////////////////////#EOL#&#x9;dtNend = rYT031.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rYT031.getValueOf('DTMSEQ');#EOL#&#x9;nrSyohin = rYT031.getValueOf('NRSYOHIN') + '';#EOL#&#x9;nrSouko = rYT031.getValueOf('NRSOUKO') + '';#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 繰越残高の計算 //#EOL#&#x9;////////////////////#EOL#&#x9;amZaiKimatsuzan = Number(amZaiKisyuzan) + Number(rYT031.getValueOf('AMZAINYUK'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('AMZAINYUKHEN')) + Number(rYT031.getValueOf('AMZAISYUK')) + Number(rYT031.getValueOf('AMZAISYUKHEN'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('AMZAIIDOU')) + Number(rYT031.getValueOf('AMZAIGENMOU')) + Number(rYT031.getValueOf('AMZAIHYOKAZON'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('AMZAIHYOKAEKI')) + Number(rYT031.getValueOf('AMZAISIKAKARI')) + Number(rYT031.getValueOf('AMZAIZATSUSON'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('AMZAIZATSUEKI')) + Number(rYT031.getValueOf('AMZAIKANSEI'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('AMZAIKAKOUHI')) + Number(rYT031.getValueOf('AMZAIZOUGEN'));#EOL#&#x9;qtZaiKimatsuzan = Number(qtZaiKisyuzan) + Number(rYT031.getValueOf('QTZAINYUK'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('QTZAINYUKHEN')) + Number(rYT031.getValueOf('QTZAISYUK')) + Number(rYT031.getValueOf('QTZAISYUKHEN'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('QTZAIIDOU')) + Number(rYT031.getValueOf('QTZAIGENMOU')) + Number(rYT031.getValueOf('QTZAISIKAKARI'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('QTZAIZATSUSON')) + Number(rYT031.getValueOf('QTZAIZATSUEKI'))#EOL#&#x9;&#x9; + Number(rYT031.getValueOf('QTZAIKANSEI')) + Number(rYT031.getValueOf('QTZAIZOUGEN'));#EOL#}#EOL##EOL#////////////////////#EOL#// 繰越残高の更新 //#EOL#////////////////////#EOL#updateYT031();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#//////////////////////////////////////////////////#EOL#// 商品･倉庫別月次取引サマリ(YT031)の期間初期化 //#EOL#//////////////////////////////////////////////////#EOL#function initializeKikanRecordsOfYT031(workSyohin, workSouko) {#EOL##EOL#&#x9;////////////////#EOL#&#x9;// 年月初期化 //#EOL#&#x9;////////////////#EOL#&#x9;workNend = limitNend;#EOL#&#x9;workMSeq = 1;#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 期間内の年月向けに繰り返す //#EOL#&#x9;////////////////////////////////#EOL#&#x9;while (workNend &lt; futureLimitNend || (workNend == futureLimitNend &amp;&amp; workMSeq &lt;= futureLimitMSeq)) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 指定年月向けレコードがなければ追加する //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;rYT031 = instance.createTableOperator('Count', 'YT031');#EOL#&#x9;&#x9;rYT031.addKeyValue('DTNEND',&#x9;workNend);#EOL#&#x9;&#x9;rYT031.addKeyValue('DTMSEQ',&#x9;workMSeq);#EOL#&#x9;&#x9;rYT031.addKeyValue('NRSYOHIN',&#x9;workSyohin);#EOL#&#x9;&#x9;rYT031.addKeyValue('NRSOUKO',&#x9;workSouko);#EOL#&#x9;&#x9;if (rYT031.execute() == 0) {#EOL#&#x9;&#x9;&#x9;cYT031 = instance.createTableOperator('Insert', 'YT031');#EOL#&#x9;&#x9;&#x9;cYT031.addValue('DTNEND',&#x9;workNend);#EOL#&#x9;&#x9;&#x9;cYT031.addValue('DTMSEQ',&#x9;workMSeq);#EOL#&#x9;&#x9;&#x9;cYT031.addValue('NRSYOHIN',&#x9;workSyohin);#EOL#&#x9;&#x9;&#x9;cYT031.addValue('NRSOUKO',&#x9;workSouko);#EOL#&#x9;&#x9;&#x9;count = cYT031.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '商品･倉庫別月次取引サマリ(YT031)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 年月のカウントアップ //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;if (workMSeq == 12) {#EOL#&#x9;&#x9;&#x9;workNend++;#EOL#&#x9;&#x9;&#x9;workMSeq = 1;#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;workMSeq++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 繰越残高の更新 //#EOL#////////////////////#EOL#function updateYT031() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;uYT031 = instance.createTableOperator('Update', 'YT031');#EOL#&#x9;&#x9;uYT031.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan);#EOL#&#x9;&#x9;uYT031.addValue('QTZAIKISYUZAN',&#x9;qtZaiKisyuzan);#EOL#&#x9;&#x9;uYT031.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;uYT031.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;uYT031.addKeyValue('NRSYOHIN',&#x9;nrSyohin);#EOL#&#x9;&#x9;uYT031.addKeyValue('NRSOUKO',&#x9;nrSouko);#EOL#&#x9;&#x9;count = uYT031.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '商品･倉庫別月次取引サマリ(YT031)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="Y" Type="XF000"/><Function ID="YF121" Name="月次期首商品残高設定処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rYT031; var rYT030; var cYT030; var uYT030; #EOL#var dtNend = 0; var dtMSeq = 0; var nrSyohin = ''; var errorMessage = '';#EOL#var amZaiKisyuzan = 0; var qtZaiKisyuzan = 0; var count = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL##EOL#/////////////////////////////////////////////////////////////////////////////////////////#EOL#// 対象期間の商品･倉庫別月次取引サマリ(YT031)の読取と商品別月次取引サマリ(YT030)の更新 //#EOL#/////////////////////////////////////////////////////////////////////////////////////////#EOL#rYT031 = instance.createTableOperator('Select', 'YT031');#EOL#rYT031.addKeyValue('DTNEND >=',&#x9;limitNend);#EOL#rYT031.setOrderBy('DTNEND, DTMSEQ, NRSYOHIN, NRSOUKO');#EOL#while (rYT031.next()) {#EOL##EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL#&#x9;// 年月/商品BREAKなら、商品別月次取引サマリ(YT030)の更新／追加 //#EOL#&#x9;/////////////////////////////////////////////////////////////////#EOL#&#x9;if (Number(rYT031.getValueOf('DTNEND')) != dtNend#EOL#&#x9; || Number(rYT031.getValueOf('DTMSEQ')) != dtMSeq#EOL#&#x9; || rYT031.getValueOf('NRSYOHIN').trim() != nrSyohin) {#EOL#&#x9;&#x9;processYT030();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////#EOL#&#x9;// BREAK検査フィールドの設定 //#EOL#&#x9;///////////////////////////////#EOL#&#x9;dtNend = rYT031.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rYT031.getValueOf('DTMSEQ');#EOL#&#x9;nrSyohin = rYT031.getValueOf('NRSYOHIN').trim() + '';#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 繰越残高の合算 //#EOL#&#x9;////////////////////#EOL#&#x9;amZaiKisyuzan = Number(amZaiKisyuzan) + Number(rYT031.getValueOf('AMZAIKISYUZAN'));#EOL#&#x9;qtZaiKisyuzan = Number(qtZaiKisyuzan) + Number(rYT031.getValueOf('QTZAIKISYUZAN'));#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////#EOL#// 最終BREAKでの商品別月次取引サマリ(YT030)の更新／追加 //#EOL#//////////////////////////////////////////////////////////#EOL#processYT030();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#/////////////////////////////////////////////#EOL#// 商品別月次取引サマリ(YT030)の更新／追加 //#EOL#/////////////////////////////////////////////#EOL#function processYT030() {#EOL#&#x9;if (dtNend != 0) {#EOL##EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;// 指定キーを持つレコードの検索 //#EOL#&#x9;&#x9;//////////////////////////////////#EOL#&#x9;&#x9;rYT030 = instance.createTableOperator('Count', 'YT030');#EOL#&#x9;&#x9;rYT030.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;rYT030.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;rYT030.addKeyValue('NRSYOHIN',&#x9;nrSyohin);#EOL#&#x9;&#x9;if (rYT030.execute() == 1) {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;&#x9;// レコードがあれば更新 //#EOL#&#x9;&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;&#x9;uYT030 = instance.createTableOperator('Update', 'YT030');#EOL#&#x9;&#x9;&#x9;uYT030.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan);#EOL#&#x9;&#x9;&#x9;uYT030.addValue('QTZAIKISYUZAN',&#x9;qtZaiKisyuzan);#EOL#&#x9;&#x9;&#x9;uYT030.addKeyValue('DTNEND',&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;uYT030.addKeyValue('DTMSEQ',&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;uYT030.addKeyValue('NRSYOHIN',&#x9;nrSyohin);#EOL#&#x9;&#x9;&#x9;count = uYT030.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '商品別月次取引サマリ(YT030)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////#EOL#&#x9;&#x9;&#x9;// レコードがなければ追加 //#EOL#&#x9;&#x9;&#x9;////////////////////////////#EOL#&#x9;&#x9;&#x9;cYT030 = instance.createTableOperator('Insert', 'YT030');#EOL#&#x9;&#x9;&#x9;cYT030.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;&#x9;cYT030.addValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;&#x9;cYT030.addValue('NRSYOHIN',&#x9;&#x9;&#x9;nrSyohin);#EOL#&#x9;&#x9;&#x9;cYT030.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan);#EOL#&#x9;&#x9;&#x9;cYT030.addValue('QTZAIKISYUZAN',&#x9;qtZaiKisyuzan);#EOL#&#x9;&#x9;&#x9;count = cYT030.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '商品･倉庫別月次取引サマリ(YT031)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;//#EOL#&#x9;amZaiKisyuzan = 0;#EOL#&#x9;qtZaiKisyuzan = 0;#EOL#}#EOL#" SubsystemID="Y" Type="XF000"/><Function ID="YF122" Name="月次期首買掛残高設定処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT010; var rAT030; var rYT040; var cYT040; var uYT040;#EOL#var dtNend = 0; var dtMSeq = 0; var nrTorihikisaki = ''; var errorMessage = '';#EOL#var amKaiKisyuzan = 0; var amKaiKimatsuzan = 0; var workNend = 0; var workMSeq = 0;#EOL#var amKisyuKaikake = 0; var rtRate = 0.000; var workDate = ''; var count = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var today = session.today + '';#EOL#var futureLimitNend = session.getFYearOfDate(today);#EOL#var futureLimitMSeq = session.getMSeqOfDate(today);#EOL##EOL#///////////////////////////////#EOL#// 仕入先マスタ(CT010)の読取 //#EOL#///////////////////////////////#EOL#rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#rCT010.setSelectFields('NRTORIHIKISAKI, AMKISYUKAIKAKE');#EOL#while (rCT010.next()) {#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 取引通貨の検索 //#EOL#&#x9;////////////////////#EOL#&#x9;rAT030 = instance.createTableOperator('Select', 'AT030');#EOL#&#x9;rAT030.setSelectFields('KBCURRENCY');#EOL#&#x9;rAT030.addKeyValue('NRTORIHIKISAKI',&#x9;rCT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;if (rAT030.next()) {#EOL##EOL#&#x9;&#x9;//////////////////////////////////////////////////#EOL#&#x9;&#x9;// 月次為替レートによる期首買掛残高の内貨額換算 //#EOL#&#x9;&#x9;//////////////////////////////////////////////////#EOL#&#x9;&#x9;rtRate = session.getMonthlyExchangeRate(rAT030.getValueOf('KBCURRENCY'), limitNend, 1, 'TTS');#EOL#&#x9;&#x9;amKisyuKaikake = rCT010.getValueOf('AMKISYUKAIKAKE') * rtRate;#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////////#EOL#&#x9;&#x9;// 仕入先別月次取引サマリ(YT040)の検索と更新 //#EOL#&#x9;&#x9;///////////////////////////////////////////////#EOL#&#x9;&#x9;rYT040 = instance.createTableOperator('Count', 'YT040');#EOL#&#x9;&#x9;rYT040.addKeyValue('DTNEND',&#x9;&#x9;&#x9;limitNend);#EOL#&#x9;&#x9;rYT040.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;rYT040.addKeyValue('NRTORIHIKISAKI',&#x9;rCT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;if (rYT040.execute() == 1) {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// レコードがあれば、期首残高更新 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////#EOL#&#x9;&#x9;&#x9;uYT040 = instance.createTableOperator('Update', 'YT040');#EOL#&#x9;&#x9;&#x9;uYT040.addValue('AMKAIKISYUZAN',&#x9;amKisyuKaikake);#EOL#&#x9;&#x9;&#x9;uYT040.addKeyValue('DTNEND',&#x9;&#x9;&#x9;limitNend);#EOL#&#x9;&#x9;&#x9;uYT040.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;uYT040.addKeyValue('NRTORIHIKISAKI',&#x9;rCT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;&#x9;count = uYT040.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先別月次取引サマリ(YT040)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL##EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// レコードがなければ、期首残高を設定して追加 //#EOL#&#x9;&#x9;&#x9;////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;cYT040 = instance.createTableOperator('Insert', 'YT040');#EOL#&#x9;&#x9;&#x9;cYT040.addValue('DTNEND',&#x9;&#x9;&#x9;limitNend);#EOL#&#x9;&#x9;&#x9;cYT040.addValue('DTMSEQ',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;&#x9;cYT040.addValue('NRTORIHIKISAKI',&#x9;rCT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;&#x9;cYT040.addValue('AMKAIKISYUZAN',&#x9;amKisyuKaikake);#EOL#&#x9;&#x9;&#x9;count = cYT040.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先別月次取引サマリ(YT040)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////////#EOL#&#x9;&#x9;// 仕入先別月次取引サマリ(YT040)の期間初期化 //#EOL#&#x9;&#x9;///////////////////////////////////////////////#EOL#&#x9;&#x9;initializeKikanRecordsOfYT040(rCT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;}#EOL#}#EOL##EOL#/////////////////////////////////////////////////////////////////#EOL#// 対象期間の仕入先別月次取引サマリ(YT040)の読取と繰越残高更新 //#EOL#/////////////////////////////////////////////////////////////////#EOL#rYT040 = instance.createTableOperator('Select', 'YT040');#EOL#rYT040.addKeyValue('DTNEND >=',&#x9;limitNend);#EOL#rYT040.setOrderBy('NRTORIHIKISAKI, DTNEND, DTMSEQ');#EOL#while (rYT040.next()) {#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 繰越残高の更新 //#EOL#&#x9;////////////////////#EOL#&#x9;updateYT040();#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 取引先BREAKにもとづく期首残高の設定 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;if (rYT040.getValueOf('NRTORIHIKISAKI').trim() != nrTorihikisaki) {#EOL#&#x9;&#x9;amKaiKisyuzan = rYT040.getValueOf('AMKAIKISYUZAN');#EOL#&#x9;} else {#EOL#&#x9;&#x9;amKaiKisyuzan = amKaiKimatsuzan;#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////#EOL#&#x9;// BREAKキーの設定 //#EOL#&#x9;/////////////////////#EOL#&#x9;dtNend = rYT040.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rYT040.getValueOf('DTMSEQ');#EOL#&#x9;nrTorihikisaki = rYT040.getValueOf('NRTORIHIKISAKI').trim() + '';#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 繰越残高の計算 //#EOL#&#x9;////////////////////#EOL#&#x9;amKaiKimatsuzan = Number(amKaiKisyuzan) + Number(rYT040.getValueOf('AMKAINYUK'))#EOL#&#x9;&#x9; + Number(rYT040.getValueOf('AMKAITYOK')) + Number(rYT040.getValueOf('AMKAIHENPIN')) + Number(rYT040.getValueOf('AMKAIZATSUEKI'))#EOL#&#x9;&#x9; + Number(rYT040.getValueOf('AMKAIZATSUSON')) + Number(rYT040.getValueOf('AMKAISOUSAI')) + Number(rYT040.getValueOf('AMKAIGENKA'))#EOL#&#x9;&#x9; + Number(rYT040.getValueOf('AMKAITAX')) + Number(rYT040.getValueOf('AMKAISIHARAI'));#EOL#}#EOL##EOL#////////////////////#EOL#// 繰越残高の更新 //#EOL#////////////////////#EOL#updateYT040();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#///////////////////////////////////////////////#EOL#// 仕入先別月次取引サマリ(YT040)の期間初期化 //#EOL#///////////////////////////////////////////////#EOL#function initializeKikanRecordsOfYT040(workTorihikisaki) {#EOL##EOL#&#x9;////////////////#EOL#&#x9;// 年月初期化 //#EOL#&#x9;////////////////#EOL#&#x9;workNend = limitNend;#EOL#&#x9;workMSeq = 1;#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 期間内の年月向けに繰り返す //#EOL#&#x9;////////////////////////////////#EOL#&#x9;while (workNend &lt; futureLimitNend || (workNend == futureLimitNend &amp;&amp; workMSeq &lt;= futureLimitMSeq)) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 指定年月向けレコードがなければ追加する //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;rYT040 = instance.createTableOperator('Count', 'YT040');#EOL#&#x9;&#x9;rYT040.addKeyValue('DTNEND',&#x9;&#x9;&#x9;workNend);#EOL#&#x9;&#x9;rYT040.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;workMSeq);#EOL#&#x9;&#x9;rYT040.addKeyValue('NRTORIHIKISAKI',&#x9;workTorihikisaki);#EOL#&#x9;&#x9;if (rYT040.execute() == 0) {#EOL#&#x9;&#x9;&#x9;cYT040 = instance.createTableOperator('Insert', 'YT040');#EOL#&#x9;&#x9;&#x9;cYT040.addValue('DTNEND',&#x9;&#x9;&#x9;workNend);#EOL#&#x9;&#x9;&#x9;cYT040.addValue('DTMSEQ',&#x9;&#x9;&#x9;workMSeq);#EOL#&#x9;&#x9;&#x9;cYT040.addValue('NRTORIHIKISAKI',&#x9;workTorihikisaki);#EOL#&#x9;&#x9;&#x9;count = cYT040.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先別月次取引サマリ(YT040)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 年月のカウントアップ //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;if (workMSeq == 12) {#EOL#&#x9;&#x9;&#x9;workNend++;#EOL#&#x9;&#x9;&#x9;workMSeq = 1;#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;workMSeq++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 繰越残高の更新 //#EOL#////////////////////#EOL#function updateYT040() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;uYT040 = instance.createTableOperator('Update', 'YT040');#EOL#&#x9;&#x9;uYT040.addValue('AMKAIKISYUZAN',&#x9;amKaiKisyuzan);#EOL#&#x9;&#x9;uYT040.addKeyValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;uYT040.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;uYT040.addKeyValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;&#x9;count = uYT040.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '仕入先別月次取引サマリ(YT040)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="Y" Type="XF000"/><Function ID="YF123" Name="月次期首売掛残高設定処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT010; var rYT050; var cYT050; var uYT050;#EOL#var dtNend = 0; var dtMSeq = 0; var nrTorihikisaki = ''; var errorMessage = ''; var count = 0;#EOL#var amUriKisyuzan = 0; var amUriKimatsuzan = 0; var workNend = 0; var workMSeq = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var today = session.today + '';#EOL#var futureLimitNend = session.getFYearOfDate(today);#EOL#var futureLimitMSeq = session.getMSeqOfDate(today);#EOL##EOL#/////////////////////////////#EOL#// 顧客マスタ(DT010)の読取 //#EOL#/////////////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#rDT010.setSelectFields('NRTORIHIKISAKI, AMKISYUURIKAKE');#EOL#while (rDT010.next()) {#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 顧客別月次取引サマリ(YT050)の検索と更新 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;rYT050 = instance.createTableOperator('Count', 'YT050');#EOL#&#x9;rYT050.addKeyValue('DTNEND',&#x9;&#x9;&#x9;limitNend);#EOL#&#x9;rYT050.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;1);#EOL#&#x9;rYT050.addKeyValue('NRTORIHIKISAKI',&#x9;rDT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;if (rYT050.execute() == 1) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////#EOL#&#x9;&#x9;// レコードがあれば、期首残高更新 //#EOL#&#x9;&#x9;////////////////////////////////////#EOL#&#x9;&#x9;uYT050 = instance.createTableOperator('Update', 'YT050');#EOL#&#x9;&#x9;uYT050.addValue('AMURIKISYUZAN',&#x9;rDT010.getValueOf('AMKISYUURIKAKE'));#EOL#&#x9;&#x9;uYT050.addKeyValue('DTNEND',&#x9;&#x9;&#x9;limitNend);#EOL#&#x9;&#x9;uYT050.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;uYT050.addKeyValue('NRTORIHIKISAKI',&#x9;rDT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;count = uYT050.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客別月次取引サマリ(YT050)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////////#EOL#&#x9;&#x9;// レコードがなければ、期首残高を設定して追加 //#EOL#&#x9;&#x9;////////////////////////////////////////////////#EOL#&#x9;&#x9;cYT050 = instance.createTableOperator('Insert', 'YT050');#EOL#&#x9;&#x9;cYT050.addValue('DTNEND',&#x9;&#x9;&#x9;limitNend);#EOL#&#x9;&#x9;cYT050.addValue('DTMSEQ',&#x9;&#x9;&#x9;1);#EOL#&#x9;&#x9;cYT050.addValue('NRTORIHIKISAKI',&#x9;rDT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;cYT050.addValue('AMURIKISYUZAN',&#x9;rDT010.getValueOf('AMKISYUURIKAKE'));#EOL#&#x9;&#x9;count = cYT050.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客別月次取引サマリ(YT050)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;// 顧客別月次取引サマリ(YT050)の期間初期化 //#EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;initializeKikanRecordsOfYT050(rDT010.getValueOf('NRTORIHIKISAKI'));#EOL#}#EOL##EOL#///////////////////////////////////////////////////////////////#EOL#// 対象期間の顧客別月次取引サマリ(YT050)の読取と繰越残高更新 //#EOL#///////////////////////////////////////////////////////////////#EOL#rYT050 = instance.createTableOperator('Select', 'YT050');#EOL#rYT050.addKeyValue('DTNEND >=',&#x9;limitNend);#EOL#rYT050.setOrderBy('NRTORIHIKISAKI, DTNEND, DTMSEQ');#EOL#while (rYT050.next()) {#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 繰越残高の更新 //#EOL#&#x9;////////////////////#EOL#&#x9;updateYT050();#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 取引先BREAKにもとづく期首残高の設定 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;if (rYT050.getValueOf('NRTORIHIKISAKI') != nrTorihikisaki) {#EOL#&#x9;&#x9;amUriKisyuzan = rYT050.getValueOf('AMURIKISYUZAN');#EOL#&#x9;} else {#EOL#&#x9;&#x9;amUriKisyuzan = amUriKimatsuzan;#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////#EOL#&#x9;// BREAKキーの設定 //#EOL#&#x9;/////////////////////#EOL#&#x9;dtNend = rYT050.getValueOf('DTNEND');#EOL#&#x9;dtMSeq = rYT050.getValueOf('DTMSEQ');#EOL#&#x9;nrTorihikisaki = rYT050.getValueOf('NRTORIHIKISAKI') + '';#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 繰越残高の計算 //#EOL#&#x9;////////////////////#EOL#&#x9;amUriKimatsuzan = Number(amUriKisyuzan) + Number(rYT050.getValueOf('AMURISYUK'))#EOL#&#x9;&#x9; + Number(rYT050.getValueOf('AMURITYOK')) + Number(rYT050.getValueOf('AMURIHENPIN')) + Number(rYT050.getValueOf('AMURIZATSUEKI'))#EOL#&#x9;&#x9; + Number(rYT050.getValueOf('AMURIZATSUSON')) + Number(rYT050.getValueOf('AMURISOUSAI')) + Number(rYT050.getValueOf('AMURIHANHURI'))#EOL#&#x9;&#x9; + Number(rYT050.getValueOf('AMURITAX')) + Number(rYT050.getValueOf('AMURIJYURYO'));#EOL#}#EOL##EOL#////////////////////#EOL#// 繰越残高の更新 //#EOL#////////////////////#EOL#updateYT050();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#/////////////////////////////////////////////#EOL#// 顧客別月次取引サマリ(YT050)の期間初期化 //#EOL#/////////////////////////////////////////////#EOL#function initializeKikanRecordsOfYT050(workTorihikisaki) {#EOL##EOL#&#x9;////////////////#EOL#&#x9;// 年月初期化 //#EOL#&#x9;////////////////#EOL#&#x9;workNend = limitNend;#EOL#&#x9;workMSeq = 1;#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 期間内の年月向けに繰り返す //#EOL#&#x9;////////////////////////////////#EOL#&#x9;while (workNend &lt; futureLimitNend || (workNend == futureLimitNend &amp;&amp; workMSeq &lt;= futureLimitMSeq)) {#EOL##EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;// 指定年月向けレコードがなければ追加する //#EOL#&#x9;&#x9;////////////////////////////////////////////#EOL#&#x9;&#x9;rYT050 = instance.createTableOperator('Count', 'YT050');#EOL#&#x9;&#x9;rYT050.addKeyValue('DTNEND',&#x9;&#x9;&#x9;workNend);#EOL#&#x9;&#x9;rYT050.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;workMSeq);#EOL#&#x9;&#x9;rYT050.addKeyValue('NRTORIHIKISAKI',&#x9;workTorihikisaki);#EOL#&#x9;&#x9;if (rYT050.execute() == 0) {#EOL#&#x9;&#x9;&#x9;cYT050 = instance.createTableOperator('Insert', 'YT050');#EOL#&#x9;&#x9;&#x9;cYT050.addValue('DTNEND',&#x9;&#x9;&#x9;workNend);#EOL#&#x9;&#x9;&#x9;cYT050.addValue('DTMSEQ',&#x9;&#x9;&#x9;workMSeq);#EOL#&#x9;&#x9;&#x9;cYT050.addValue('NRTORIHIKISAKI',&#x9;workTorihikisaki);#EOL#&#x9;&#x9;&#x9;count = cYT050.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '顧客別月次取引サマリ(YT050)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 年月のカウントアップ //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;if (workMSeq == 12) {#EOL#&#x9;&#x9;&#x9;workNend++;#EOL#&#x9;&#x9;&#x9;workMSeq = 1;#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;workMSeq++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 繰越残高の更新 //#EOL#////////////////////#EOL#function updateYT050() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;uYT050 = instance.createTableOperator('Update', 'YT050');#EOL#&#x9;&#x9;uYT050.addValue('AMURIKISYUZAN',&#x9;amUriKisyuzan);#EOL#&#x9;&#x9;uYT050.addKeyValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;uYT050.addKeyValue('DTMSEQ',&#x9;&#x9;&#x9;dtMSeq);#EOL#&#x9;&#x9;uYT050.addKeyValue('NRTORIHIKISAKI',&#x9;nrTorihikisaki);#EOL#&#x9;&#x9;count = uYT050.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '顧客別月次取引サマリ(YT050)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="Y" Type="XF000"/><Function ID="YF130" Name="月次集計処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rYT020; var uYT020; var rYT030; var rYT040; var rYT050;#EOL#var errorMessage = ''; var count = 0;#EOL##EOL#////////////////////#EOL#// 集計用変数定義 //#EOL#////////////////////#EOL#var amUriKisyuzan = 0; var amUriSyuk = 0; var amUriTyok = 0; var amUriHenpin = 0; var amUriZatsueki = 0;#EOL#var amUriZatsuson = 0; var amUriSousai = 0; var amUriNebiki = 0; var amUriHanhuri = 0; var amUriJyuryo = 0;#EOL#var amUriGenka = 0; var amUriTax = 0; var amKaiKisyuzan = 0; var amKaiNyuk = 0; var amKaiTyok = 0;#EOL#var amKaiHenpin = 0; var amKaiZatsueki = 0; var amKaiZatsuson = 0; var amKaiSousai = 0; var amKaiGenka = 0;#EOL#var amKaiSiharai = 0; var amKaiTax = 0; var amZaiKisyuzan = 0; var amZaiNyuk = 0; var amZaiNyukHen = 0;#EOL#var amZaiSyuk = 0; var amZaiSyukHen = 0; var amZaiIdou = 0; var amZaiGenmou = 0; var amZaiHyokazon = 0;#EOL#var amZaiHyokaeki = 0; var amZaiSikakari = 0; var amZaiZatsuson = 0; var amZaiZatsueki = 0; var amZaiKansei = 0;#EOL#var amZaiKakouhi = 0; var amZaiZougen = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL#var limitMSeq = instance.parmMap.get('LIMIT_MSEQ');#EOL##EOL#////////////////////////////////////////////////////////////////#EOL#// 対象期間の月次サマリ(YT020)の読取と年次サマリ(YT010)の追加 //#EOL#////////////////////////////////////////////////////////////////#EOL#rYT020 = instance.createTableOperator('Select', 'YT020');#EOL#rYT020.setSelectFields('DTNEND, DTMSEQ');#EOL#rYT020.addKeyValue('DTNEND >=',&#x9;limitNend);#EOL#while (rYT020.next()) {#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 商品別月次取引サマリ(YT030)の読取と集計 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;rYT030 = instance.createTableOperator('Select', 'YT030');#EOL#&#x9;rYT030.addKeyValue('DTNEND',&#x9;rYT020.getValueOf('DTNEND'));#EOL#&#x9;rYT030.addKeyValue('DTMSEQ',&#x9;rYT020.getValueOf('DTMSEQ'));#EOL#&#x9;while (rYT030.next()) {#EOL#&#x9;&#x9;summarizeZaiko();#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;// 仕入先別月次取引サマリ(YT040)の読取と集計 //#EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;rYT040 = instance.createTableOperator('Select', 'YT040');#EOL#&#x9;rYT040.addKeyValue('DTNEND',&#x9;rYT020.getValueOf('DTNEND'));#EOL#&#x9;rYT040.addKeyValue('DTMSEQ',&#x9;rYT020.getValueOf('DTMSEQ'));#EOL#&#x9;while (rYT040.next()) {#EOL#&#x9;&#x9;summarizeKaikake();#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 顧客別月次取引サマリ(YT050)の読取と集計 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;rYT050 = instance.createTableOperator('Select', 'YT050');#EOL#&#x9;rYT050.addKeyValue('DTNEND',&#x9;rYT020.getValueOf('DTNEND'));#EOL#&#x9;rYT050.addKeyValue('DTMSEQ',&#x9;rYT020.getValueOf('DTMSEQ'));#EOL#&#x9;while (rYT050.next()) {#EOL#&#x9;&#x9;summarizeUrikake();#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 月次取引サマリ(YT020)の更新 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;updateYT020();#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#//////////////////////#EOL#// 在庫取引値の集計 //#EOL#//////////////////////#EOL#function summarizeZaiko() {#EOL#&#x9;amZaiKisyuzan= Number(amZaiKisyuzan) + Number(rYT030.getValueOf('AMZAIKISYUZAN'));#EOL#&#x9;amZaiNyuk= Number(amZaiNyuk) + Number(rYT030.getValueOf('AMZAINYUK'));#EOL#&#x9;amZaiNyukHen= Number(amZaiNyukHen) + Number(rYT030.getValueOf('AMZAINYUKHEN'));#EOL#&#x9;amZaiSyuk= Number(amZaiSyuk) + Number(rYT030.getValueOf('AMZAISYUK'));#EOL#&#x9;amZaiSyukHen= Number(amZaiSyukHen) + Number(rYT030.getValueOf('AMZAISYUKHEN'));#EOL#&#x9;amZaiIdou= Number(amZaiIdou) + Number(rYT030.getValueOf('AMZAIIDOU'));#EOL#&#x9;amZaiGenmou= Number(amZaiGenmou) + Number(rYT030.getValueOf('AMZAIGENMOU'));#EOL#&#x9;amZaiHyokazon= Number(amZaiHyokazon) + Number(rYT030.getValueOf('AMZAIHYOKAZON'));#EOL#&#x9;amZaiSikakari= Number(amZaiSikakari) + Number(rYT030.getValueOf('AMZAISIKAKARI'));#EOL#&#x9;amZaiZatsuson= Number(amZaiZatsuson) + Number(rYT030.getValueOf('AMZAIZATSUSON'));#EOL#&#x9;amZaiZatsueki= Number(amZaiZatsueki) + Number(rYT030.getValueOf('AMZAIZATSUEKI'));#EOL#&#x9;amZaiHyokaeki= Number(amZaiHyokaeki) + Number(rYT030.getValueOf('AMZAIHYOKAEKI'));#EOL#&#x9;amZaiKansei= Number(amZaiKansei) + Number(rYT030.getValueOf('AMZAIKANSEI'));#EOL#&#x9;amZaiKakouhi= Number(amZaiKakouhi) + Number(rYT030.getValueOf('AMZAIKAKOUHI'));#EOL#&#x9;amZaiZougen= Number(amZaiZougen) + Number(rYT030.getValueOf('AMZAIZOUGEN'));#EOL#}#EOL##EOL#//////////////////////#EOL#// 買掛取引値の集計 //#EOL#//////////////////////#EOL#function summarizeKaikake() {#EOL#&#x9;amKaiKisyuzan= Number(amKaiKisyuzan) + Number(rYT040.getValueOf('AMKAIKISYUZAN'));#EOL#&#x9;amKaiNyuk= Number(amKaiNyuk) + Number(rYT040.getValueOf('AMKAINYUK'));#EOL#&#x9;amKaiTyok= Number(amKaiTyok) + Number(rYT040.getValueOf('AMKAITYOK'));#EOL#&#x9;amKaiHenpin= Number(amKaiHenpin) + Number(rYT040.getValueOf('AMKAIHENPIN'));#EOL#&#x9;amKaiZatsueki= Number(amKaiZatsueki) + Number(rYT040.getValueOf('AMKAIZATSUEKI'));#EOL#&#x9;amKaiZatsuson= Number(amKaiZatsuson) + Number(rYT040.getValueOf('AMKAIZATSUSON'));#EOL#&#x9;amKaiSousai= Number(amKaiSousai) + Number(rYT040.getValueOf('AMKAISOUSAI'));#EOL#&#x9;amKaiGenka= Number(amKaiGenka) + Number(rYT040.getValueOf('AMKAIGENKA'));#EOL#&#x9;amKaiSiharai= Number(amKaiSiharai) + Number(rYT040.getValueOf('AMKAISIHARAI'));#EOL#&#x9;amKaiTax= Number(amKaiTax) + Number(rYT040.getValueOf('AMKAITAX'));#EOL#}#EOL##EOL#//////////////////////#EOL#// 売掛取引値の集計 //#EOL#//////////////////////#EOL#function summarizeUrikake() {#EOL#&#x9;amUriKisyuzan= Number(amUriKisyuzan) + Number(rYT050.getValueOf('AMURIKISYUZAN'));#EOL#&#x9;amUriSyuk= Number(amUriSyuk) + Number(rYT050.getValueOf('AMURISYUK'));#EOL#&#x9;amUriTyok= Number(amUriTyok) + Number(rYT050.getValueOf('AMURITYOK'));#EOL#&#x9;amUriHenpin= Number(amUriHenpin) + Number(rYT050.getValueOf('AMURIHENPIN'));#EOL#&#x9;amUriZatsueki= Number(amUriZatsueki) + Number(rYT050.getValueOf('AMURIZATSUEKI'));#EOL#&#x9;amUriZatsuson= Number(amUriZatsuson) + Number(rYT050.getValueOf('AMURIZATSUSON'));#EOL#&#x9;amUriSousai= Number(amUriSousai) + Number(rYT050.getValueOf('AMURISOUSAI'));#EOL#&#x9;amUriNebiki= Number(amUriNebiki) + Number(rYT050.getValueOf('AMURINEBIKI'));#EOL#&#x9;amUriHanhuri= Number(amUriHanhuri) + Number(rYT050.getValueOf('AMURIHANHURI'));#EOL#&#x9;amUriJyuryo= Number(amUriJyuryo) + Number(rYT050.getValueOf('AMURIJYURYO'));#EOL#&#x9;amUriGenka= Number(amUriGenka) + Number(rYT050.getValueOf('AMURIGENKA'));#EOL#&#x9;amUriTax= Number(amUriTax) + Number(rYT050.getValueOf('AMURITAX'));#EOL#}#EOL##EOL#/////////////////////////////////#EOL#// 月次取引サマリ(YT020)の更新 //#EOL#/////////////////////////////////#EOL#function updateYT020() {#EOL#&#x9;uYT020 = instance.createTableOperator('Update', 'YT020');#EOL#&#x9;uYT020.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan);#EOL#&#x9;uYT020.addValue('AMZAINYUK',&#x9;&#x9;amZaiNyuk);#EOL#&#x9;uYT020.addValue('AMZAINYUKHEN',&#x9;&#x9;amZaiNyukHen);#EOL#&#x9;uYT020.addValue('AMZAISYUK',&#x9;&#x9;amZaiSyuk);#EOL#&#x9;uYT020.addValue('AMZAISYUKHEN',&#x9;&#x9;amZaiSyukHen);#EOL#&#x9;uYT020.addValue('AMZAIIDOU',&#x9;&#x9;amZaiIdou);#EOL#&#x9;uYT020.addValue('AMZAIGENMOU',&#x9;&#x9;amZaiGenmou);#EOL#&#x9;uYT020.addValue('AMZAISIKAKARI',&#x9;amZaiSikakari);#EOL#&#x9;uYT020.addValue('AMZAIZATSUSON',&#x9;amZaiZatsuson);#EOL#&#x9;uYT020.addValue('AMZAIZATSUEKI',&#x9;amZaiZatsueki);#EOL#&#x9;uYT020.addValue('AMZAIHYOKAZON',&#x9;amZaiHyokazon);#EOL#&#x9;uYT020.addValue('AMZAIHYOKAEKI',&#x9;amZaiHyokaeki);#EOL#&#x9;uYT020.addValue('AMZAIKANSEI',&#x9;&#x9;amZaiKansei);#EOL#&#x9;uYT020.addValue('AMZAIKAKOUHI',&#x9;&#x9;amZaiKakouhi);#EOL#&#x9;uYT020.addValue('AMZAIZOUGEN',&#x9;&#x9;amZaiZougen);#EOL#&#x9;uYT020.addValue('AMKAIKISYUZAN',&#x9;amKaiKisyuzan);#EOL#&#x9;uYT020.addValue('AMKAINYUK',&#x9;&#x9;amKaiNyuk);#EOL#&#x9;uYT020.addValue('AMKAITYOK',&#x9;&#x9;amKaiTyok);#EOL#&#x9;uYT020.addValue('AMKAIHENPIN',&#x9;&#x9;amKaiHenpin);#EOL#&#x9;uYT020.addValue('AMKAIZATSUEKI',&#x9;amKaiZatsueki);#EOL#&#x9;uYT020.addValue('AMKAIZATSUSON',&#x9;amKaiZatsuson);#EOL#&#x9;uYT020.addValue('AMKAISOUSAI',&#x9;&#x9;amKaiSousai);#EOL#&#x9;uYT020.addValue('AMKAIGENKA',&#x9;&#x9;amKaiGenka);#EOL#&#x9;uYT020.addValue('AMKAISIHARAI',&#x9;&#x9;amKaiSiharai);#EOL#&#x9;uYT020.addValue('AMKAITAX',&#x9;&#x9;&#x9;amKaiTax);#EOL#&#x9;uYT020.addValue('AMURIKISYUZAN',&#x9;amUriKisyuzan);#EOL#&#x9;uYT020.addValue('AMURISYUK',&#x9;&#x9;amUriSyuk);#EOL#&#x9;uYT020.addValue('AMURITYOK',&#x9;&#x9;amUriTyok);#EOL#&#x9;uYT020.addValue('AMURIHENPIN',&#x9;&#x9;amUriHenpin);#EOL#&#x9;uYT020.addValue('AMURIZATSUEKI',&#x9;amUriZatsueki);#EOL#&#x9;uYT020.addValue('AMURIZATSUSON',&#x9;amUriZatsuson);#EOL#&#x9;uYT020.addValue('AMURISOUSAI',&#x9;&#x9;amUriSousai);#EOL#&#x9;uYT020.addValue('AMURINEBIKI',&#x9;&#x9;amUriNebiki);#EOL#&#x9;uYT020.addValue('AMURIHANHURI',&#x9;&#x9;amUriHanhuri);#EOL#&#x9;uYT020.addValue('AMURIGENKA',&#x9;&#x9;amUriGenka);#EOL#&#x9;uYT020.addValue('AMURIJYURYO',&#x9;&#x9;amUriJyuryo);#EOL#&#x9;uYT020.addValue('AMURITAX',&#x9;&#x9;&#x9;amUriTax);#EOL#&#x9;uYT020.addKeyValue('DTNEND',&#x9;rYT020.getValueOf('DTNEND'));#EOL#&#x9;uYT020.addKeyValue('DTMSEQ',&#x9;rYT020.getValueOf('DTMSEQ'));#EOL#&#x9;count = uYT020.execute();#EOL#&#x9;if (count != 1) {#EOL#&#x9;&#x9;errorMessage = '月次取引サマリ(YT020)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// 集計用変数のクリア //#EOL#&#x9;////////////////////////#EOL#&#x9;amUriKisyuzan= 0; amUriSyuk= 0; amUriTyok= 0; amUriHenpin= 0; amUriZatsueki= 0;#EOL#&#x9;amUriZatsuson= 0; amUriSousai= 0; amUriNebiki= 0; amUriHanhuri= 0; amUriJyuryo= 0;#EOL#&#x9;amUriGenka= 0; amUriTax= 0; amKaiKisyuzan= 0; amKaiNyuk= 0; amKaiTyok= 0;#EOL#&#x9;amKaiHenpin= 0; amKaiZatsueki= 0; amKaiZatsuson= 0; amKaiSousai= 0; amKaiGenka= 0;#EOL#&#x9;amKaiSiharai= 0; amKaiTax= 0; amZaiKisyuzan= 0; amZaiNyuk= 0; amZaiNyukHen= 0;#EOL#&#x9;amZaiSyuk= 0; amZaiSyukHen= 0; amZaiIdou= 0; amZaiGenmou= 0; amZaiHyokazon= 0;#EOL#&#x9;amZaiHyokaeki= 0; amZaiSikakari= 0; amZaiZatsuson= 0; amZaiZatsueki= 0; amZaiKansei= 0;#EOL#&#x9;amZaiKakouhi= 0; amZaiZougen= 0;#EOL#}#EOL#" SubsystemID="Y" Type="XF000"/><Function ID="YF131" Name="年次集計処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rYT020; var cYT010;#EOL#var dtNend = 0; var errorMessage = ''; var count = 0;#EOL##EOL#////////////////////#EOL#// 集計用変数定義 //#EOL#////////////////////#EOL#var amUriKisyuzan010 = 0; var amUriSyuk010 = 0; var amUriTyok010 = 0; var amUriHenpin010 = 0; var amUriZatsueki010 = 0;#EOL#var amUriZatsuson010 = 0; var amUriSousai010 = 0; var amUriNebiki010 = 0; var amUriHanhuri010 = 0; var amUriJyuryo010 = 0;#EOL#var amUriGenka010 = 0; var amUriTax010 = 0; var amKaiKisyuzan010 = 0; var amKaiNyuk010 = 0; var amKaiTyok010 = 0;#EOL#var amKaiHenpin010 = 0; var amKaiZatsueki010 = 0; var amKaiZatsuson010 = 0; var amKaiSousai010 = 0; var amKaiGenka010 = 0;#EOL#var amKaiSiharai010 = 0; var amKaiTax010 = 0; var amZaiKisyuzan010 = 0; var amZaiNyuk010 = 0; var amZaiNyukHen010 = 0;#EOL#var amZaiSyuk010 = 0; var amZaiSyukHen010 = 0; var amZaiIdou010 = 0; var amZaiGenmou010 = 0; var amZaiHyokazon010 = 0;#EOL#var amZaiHyokaeki010 = 0; var amZaiSikakari010 = 0; var amZaiZatsuson010 = 0; var amZaiZatsueki010 = 0; var amZaiKansei010 = 0;#EOL#var amZaiKakouhi010 = 0; var amZaiZougen010 = 0;#EOL##EOL#//////////////////////////////#EOL#// 集計対象最過去年月の設定 //#EOL#//////////////////////////////#EOL#var limitNend = instance.parmMap.get('LIMIT_NEND');#EOL##EOL#////////////////////////////////////////////////////////////////#EOL#// 対象期間の月次サマリ(YT020)の読取と年次サマリ(YT010)の追加 //#EOL#////////////////////////////////////////////////////////////////#EOL#rYT020 = instance.createTableOperator('Select', 'YT020');#EOL#rYT020.addKeyValue('DTNEND >=',&#x9;limitNend);#EOL#rYT020.setOrderBy('DTNEND, DTMSEQ');#EOL#while (rYT020.next()) {#EOL##EOL#&#x9;////////////////////////////////////////////////#EOL#&#x9;// 年BREAKならば、年次取引サマリ(YT010)を追加 //#EOL#&#x9;////////////////////////////////////////////////#EOL#&#x9;if (Number(rYT020.getValueOf('DTNEND')) != dtNend) {#EOL#&#x9;&#x9;insertYT010();#EOL#&#x9;&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////#EOL#&#x9;// BREAKキーの設定 //#EOL#&#x9;/////////////////////#EOL#&#x9;dtNend = rYT020.getValueOf('DTNEND');#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// 項目値の集計処理 //#EOL#&#x9;//////////////////////#EOL#&#x9;summarizeFields();#EOL#}#EOL##EOL#/////////////////////////////////#EOL#// 年次取引サマリ(YT010)の追加 //#EOL#/////////////////////////////////#EOL#insertYT010();#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#/////////////////////////////////#EOL#// 年次取引サマリ(YT060)の追加 //#EOL#/////////////////////////////////#EOL#function insertYT010() {#EOL#&#x9;if (dtNend != 0) {#EOL#&#x9;&#x9;cYT010 = instance.createTableOperator('Insert', 'YT010');#EOL#&#x9;&#x9;cYT010.addValue('DTNEND',&#x9;&#x9;&#x9;dtNend);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIKISYUZAN',&#x9;amZaiKisyuzan010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAINYUK',&#x9;&#x9;amZaiNyuk010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAINYUKHEN',&#x9;&#x9;amZaiNyukHen010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAISYUK',&#x9;&#x9;amZaiSyuk010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAISYUKHEN',&#x9;&#x9;amZaiSyukHen010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIIDOU',&#x9;&#x9;amZaiIdou010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIGENMOU',&#x9;&#x9;amZaiGenmou010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAISIKAKARI',&#x9;amZaiSikakari010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIZATSUSON',&#x9;amZaiZatsuson010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIZATSUEKI',&#x9;amZaiZatsueki010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIHYOKAZON',&#x9;amZaiHyokazon010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIHYOKAEKI',&#x9;amZaiHyokaeki010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIKANSEI',&#x9;&#x9;amZaiKansei010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIKAKOUHI',&#x9;&#x9;amZaiKakouhi010);#EOL#&#x9;&#x9;cYT010.addValue('AMZAIZOUGEN',&#x9;&#x9;amZaiZougen010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAIKISYUZAN',&#x9;amKaiKisyuzan010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAINYUK',&#x9;&#x9;amKaiNyuk010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAITYOK',&#x9;&#x9;amKaiTyok010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAIHENPIN',&#x9;&#x9;amKaiHenpin010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAIZATSUEKI',&#x9;amKaiZatsueki010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAIZATSUSON',&#x9;amKaiZatsuson010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAISOUSAI',&#x9;&#x9;amKaiSousai010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAIGENKA',&#x9;&#x9;amKaiGenka010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAISIHARAI',&#x9;&#x9;amKaiSiharai010);#EOL#&#x9;&#x9;cYT010.addValue('AMKAITAX',&#x9;&#x9;&#x9;amKaiTax010);#EOL#&#x9;&#x9;cYT010.addValue('AMURIKISYUZAN',&#x9;amUriKisyuzan010);#EOL#&#x9;&#x9;cYT010.addValue('AMURISYUK',&#x9;&#x9;amUriSyuk010);#EOL#&#x9;&#x9;cYT010.addValue('AMURITYOK',&#x9;&#x9;amUriTyok010);#EOL#&#x9;&#x9;cYT010.addValue('AMURIHENPIN',&#x9;&#x9;amUriHenpin010);#EOL#&#x9;&#x9;cYT010.addValue('AMURIZATSUEKI',&#x9;amUriZatsueki010);#EOL#&#x9;&#x9;cYT010.addValue('AMURIZATSUSON',&#x9;amUriZatsuson010);#EOL#&#x9;&#x9;cYT010.addValue('AMURISOUSAI',&#x9;&#x9;amUriSousai010);#EOL#&#x9;&#x9;cYT010.addValue('AMURINEBIKI',&#x9;&#x9;amUriNebiki010);#EOL#&#x9;&#x9;cYT010.addValue('AMURIHANHURI',&#x9;&#x9;amUriHanhuri010);#EOL#&#x9;&#x9;cYT010.addValue('AMURIJYURYO',&#x9;&#x9;amUriJyuryo010);#EOL#&#x9;&#x9;cYT010.addValue('AMURIGENKA',&#x9;&#x9;amUriGenka010);#EOL#&#x9;&#x9;cYT010.addValue('AMURITAX',&#x9;&#x9;&#x9;amUriTax010);#EOL#&#x9;&#x9;count = cYT010.execute();#EOL#&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;errorMessage = '年次取引サマリ(YT010)の登録に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 集計用変数をクリア //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;amUriKisyuzan010 = 0; amUriSyuk010 = 0; amUriTyok010 = 0; amUriHenpin010 = 0; amUriZatsueki010 = 0;#EOL#&#x9;&#x9;amUriZatsuson010 = 0; amUriSousai010 = 0; amUriNebiki010 = 0; amUriHanhuri010 = 0; amUriJyuryo010 = 0;#EOL#&#x9;&#x9;amUriGenka010 = 0; amUriTax010 = 0; amKaiKisyuzan010 = 0; amKaiNyuk010 = 0; amKaiTyok010 = 0;#EOL#&#x9;&#x9;amKaiHenpin010 = 0; amKaiZatsueki010 = 0; amKaiZatsuson010 = 0; amKaiSousai010 = 0; amKaiGenka010 = 0;#EOL#&#x9;&#x9;amKaiSiharai010 = 0; amKaiTax010 = 0; amZaiKisyuzan010 = 0; amZaiNyuk010 = 0; amZaiNyukHen010 = 0;#EOL#&#x9;&#x9;amZaiSyuk010 = 0; amZaiSyukHen010 = 0; amZaiIdou010 = 0; amZaiGenmou010 = 0; amZaiHyokazon010 = 0;#EOL#&#x9;&#x9;amZaiHyokaeki010 = 0; amZaiSikakari010 = 0; amZaiZatsuson010 = 0; amZaiZatsueki010 = 0; amZaiKansei010 = 0;#EOL#&#x9;&#x9;amZaiKakouhi010 = 0; amZaiZougen010 = 0;#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////#EOL#// 項目値の集計処理 //#EOL#//////////////////////#EOL#function summarizeFields() {#EOL##EOL#&#x9;////////////////////////////////////#EOL#&#x9;// 初月度であれば、期首残高を設定 //#EOL#&#x9;////////////////////////////////////#EOL#&#x9;if (Number(rYT020.getValueOf('DTNEND')) == limitNend#EOL#&#x9; &amp;&amp; Number(rYT020.getValueOf('DTMSEQ')) == 1) {#EOL#&#x9;&#x9;amUriKisyuzan010 = Number(rYT020.getValueOf('AMURIKISYUZAN'));#EOL#&#x9;&#x9;amKaiKisyuzan010 = Number(rYT020.getValueOf('AMKAIKISYUZAN'));#EOL#&#x9;&#x9;amZaiKisyuzan010 = Number(rYT020.getValueOf('AMZAIKISYUZAN'));#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 売上項目を集計 //#EOL#&#x9;////////////////////#EOL#&#x9;amUriSyuk010 = Number(amUriSyuk010) + Number(rYT020.getValueOf('AMURISYUK'));#EOL#&#x9;amUriTyok010 = Number(amUriTyok010) + Number(rYT020.getValueOf('AMURITYOK'));#EOL#&#x9;amUriHenpin010 = Number(amUriHenpin010) + Number(rYT020.getValueOf('AMURIHENPIN'));#EOL#&#x9;amUriZatsueki010 = Number(amUriZatsueki010) + Number(rYT020.getValueOf('AMURIZATSUEKI'));#EOL#&#x9;amUriZatsuson010 = Number(amUriZatsuson010) + Number(rYT020.getValueOf('AMURIZATSUSON'));#EOL#&#x9;amUriSousai010 = Number(amUriSousai010) + Number(rYT020.getValueOf('AMURISOUSAI'));#EOL#&#x9;amUriNebiki010 = Number(amUriNebiki010) + Number(rYT020.getValueOf('AMURINEBIKI'));#EOL#&#x9;amUriHanhuri010 = Number(amUriHanhuri010) + Number(rYT020.getValueOf('AMURIHANHURI'));#EOL#&#x9;amUriJyuryo010 = Number(amUriJyuryo010) + Number(rYT020.getValueOf('AMURIJYURYO'));#EOL#&#x9;amUriGenka010 = Number(amUriGenka010) + Number(rYT020.getValueOf('AMURIGENKA'));#EOL#&#x9;amUriTax010 = Number(amUriTax010) + Number(rYT020.getValueOf('AMURITAX'));#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 仕入項目を集計 //#EOL#&#x9;////////////////////#EOL#&#x9;amKaiNyuk010 = Number(amKaiNyuk010) + Number(rYT020.getValueOf('AMKAINYUK'));#EOL#&#x9;amKaiTyok010 = Number(amKaiTyok010) + Number(rYT020.getValueOf('AMKAITYOK'));#EOL#&#x9;amKaiHenpin010 = Number(amKaiHenpin010) + Number(rYT020.getValueOf('AMKAIHENPIN'));#EOL#&#x9;amKaiZatsueki010 = Number(amKaiZatsueki010) + Number(rYT020.getValueOf('AMKAIZATSUEKI'));#EOL#&#x9;amKaiZatsuson010 = Number(amKaiZatsuson010) + Number(rYT020.getValueOf('AMKAIZATSUSON'));#EOL#&#x9;amKaiSousai010 = Number(amKaiSousai010) + Number(rYT020.getValueOf('AMKAISOUSAI'));#EOL#&#x9;amKaiGenka010 = Number(amKaiGenka010) + Number(rYT020.getValueOf('AMKAIGENKA'));#EOL#&#x9;amKaiSiharai010 = Number(amKaiSiharai010) + Number(rYT020.getValueOf('AMKAISIHARAI'));#EOL#&#x9;amKaiTax010 = Number(amKaiTax010) + Number(rYT020.getValueOf('AMKAITAX'));#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 在庫項目を集計 //#EOL#&#x9;////////////////////#EOL#&#x9;amZaiNyuk010 = Number(amZaiNyuk010) + Number(rYT020.getValueOf('AMZAINYUK'));#EOL#&#x9;amZaiNyukHen010 = Number(amZaiNyukHen010) + Number(rYT020.getValueOf('AMZAINYUKHEN'));#EOL#&#x9;amZaiSyuk010 = Number(amZaiSyuk010) + Number(rYT020.getValueOf('AMZAISYUK'));#EOL#&#x9;amZaiSyukHen010 = Number(amZaiSyukHen010) + Number(rYT020.getValueOf('AMZAISYUKHEN'));#EOL#&#x9;amZaiIdou010 = Number(amZaiIdou010) + Number(rYT020.getValueOf('AMZAIIDOU'));#EOL#&#x9;amZaiGenmou010 = Number(amZaiGenmou010) + Number(rYT020.getValueOf('AMZAIGENMOU'));#EOL#&#x9;amZaiHyokazon010 = Number(amZaiHyokazon010) + Number(rYT020.getValueOf('AMZAIHYOKAZON'));#EOL#&#x9;amZaiHyokaeki010 = Number(amZaiHyokaeki010) + Number(rYT020.getValueOf('AMZAIHYOKAEKI'));#EOL#&#x9;amZaiSikakari010 = Number(amZaiSikakari010) + Number(rYT020.getValueOf('AMZAISIKAKARI'));#EOL#&#x9;amZaiZatsuson010 = Number(amZaiZatsuson010) + Number(rYT020.getValueOf('AMZAIZATSUSON'));#EOL#&#x9;amZaiZatsueki010 = Number(amZaiZatsueki010) + Number(rYT020.getValueOf('AMZAIZATSUEKI'));#EOL#&#x9;amZaiKansei010 = Number(amZaiKansei010) + Number(rYT020.getValueOf('AMZAIKANSEI'));#EOL#&#x9;amZaiKakouhi010 = Number(amZaiKakouhi010) + Number(rYT020.getValueOf('AMZAIKAKOUHI'));#EOL#&#x9;amZaiZougen010 = Number(amZaiZougen010) + Number(rYT020.getValueOf('AMZAIZOUGEN'));#EOL#}" SubsystemID="Y" Type="XF000"/><Function ID="CF900" Name="年次買掛残高繰越処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT010; var uCT010; var rCT100;#EOL#var amSiharaiCur = 0; var amKeijyouCur = 0; var amSiharaiNew = 0; var amKeijyouNew = 0;#EOL#var amKisyuKaikake = 0; var errorMessage = ''; var numberOfErrors = 0;#EOL#var amSiire = 0; var count = 0; var logMessage = '';#EOL##EOL#////////////////////////////////////#EOL#// 新旧の集計対象最過去年月の設定 //#EOL#////////////////////////////////////#EOL#var curNend = instance.parmMap.get('CUR_NEND');#EOL#var newNend = instance.parmMap.get('NEW_NEND');#EOL#var isCheckOnly = instance.parmMap.get('CHECK_ONLY');#EOL##EOL#/////////////////////////#EOL#// 仕入先(CT010)の読取 //#EOL#/////////////////////////#EOL#rCT010 = instance.createTableOperator('Select', 'CT010');#EOL#while (rCT010.next()) {#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 関連する仕入実績(CT100)の読取と集計 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;amSiharaiCur = 0; amKeijyouCur = 0; amSiharaiNew = 0; amKeijyouNew = 0;#EOL#&#x9;rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#&#x9;rCT100.addKeyValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;rCT100.addKeyValue('DTNEND >=',&#x9;&#x9;&#x9;curNend);#EOL#&#x9;rCT100.addKeyValue('NRTORIHIKISAKI',&#x9;rCT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;while (rCT100.next()) {#EOL#&#x9;&#x9;amSiire = Number(rCT100.getValueOf('AMSIIRE')) + Number(rCT100.getValueOf('AMTAX'));#EOL#&#x9;&#x9;if (rCT100.getValueOf('KBSIIRE') == '90') {#EOL#&#x9;&#x9;&#x9;if (rCT100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amSiharaiCur = Number(amSiharaiCur) - Number(amSiire);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rCT100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amSiharaiNew = Number(amSiharaiNew) - Number(amSiire);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;if (rCT100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amKeijyouCur = Number(amKeijyouCur) + Number(amSiire);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rCT100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amKeijyouNew = Number(amKeijyouNew) + Number(amSiire);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////#EOL#&#x9;// 合算チェックと仕入先(CT010)の更新 //#EOL#&#x9;///////////////////////////////////////#EOL#&#x9;if (rCT010.getValueOf('AMKEIJYOU') == amKeijyouCur &amp;&amp; rCT010.getValueOf('AMSIHARAI') == amSiharaiCur) {#EOL#&#x9;&#x9;if (isCheckOnly == 'false') {#EOL#&#x9;&#x9;&#x9;amKisyuKaikake = Number(rCT010.getValueOf('AMKISYUKAIKAKE'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amKeijyouCur) - Number(amKeijyouNew) - Number(amSiharaiCur) + Number(amSiharaiNew);#EOL#&#x9;&#x9;&#x9;uCT010 = instance.createTableOperator('Update', 'CT010');#EOL#&#x9;&#x9;&#x9;uCT010.addValue('AMKISYUKAIKAKE',&#x9;amKisyuKaikake);#EOL#&#x9;&#x9;&#x9;uCT010.addValue('AMKEIJYOU',&#x9;&#x9;amKeijyouNew);#EOL#&#x9;&#x9;&#x9;uCT010.addValue('AMSIHARAI',&#x9;&#x9;amSiharaiNew);#EOL#&#x9;&#x9;&#x9;uCT010.addValue('UPDCOUNTER',&#x9;&#x9;Number(rCT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('NRTORIHIKISAKI',&#x9;rCT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;&#x9;uCT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rCT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uCT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '仕入先(CT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;numberOfErrors++;#EOL#&#x9;&#x9;logMessage = '仕入先(' + rCT010.getValueOf('NRTORIHIKISAKI') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')の計上額(' + rCT010.getValueOf('AMKEIJYOU') + #EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')と支払額(' + rCT010.getValueOf('AMSIHARAI') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')が、仕入実績を合算した計上額(' + amKeijyouCur + ')と支払額(' + amSiharaiCur +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')に一致しません。';#EOL#&#x9;&#x9;instance.setProcessLog(logMessage);#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////#EOL#// エラー処理と診断結果の登録 //#EOL#////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;instance.parmMap.put('NUMBER_OF_ERRORS_CF900', numberOfErrors);#EOL#} else {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}" SubsystemID="C" Type="XF000"/><Function ID="DF900" Name="年次売掛残高繰越処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT010; var uDT010; var rDT100;#EOL#var amKaisyuCur = 0; var amKeijyouCur = 0; var amKaisyuNew = 0; var amKeijyouNew = 0;#EOL#var amKisyuUrikake = 0; var errorMessage = ''; var numberOfErrors = 0;#EOL#var amUriage = 0; var count = 0; var logMessage = '';#EOL##EOL#////////////////////////////////////#EOL#// 新旧の集計対象最過去年月の設定 //#EOL#////////////////////////////////////#EOL#var curNend = instance.parmMap.get('CUR_NEND');#EOL#var newNend = instance.parmMap.get('NEW_NEND');#EOL#var isCheckOnly = instance.parmMap.get('CHECK_ONLY');#EOL##EOL#///////////////////////#EOL#// 顧客(DT010)の読取 //#EOL#///////////////////////#EOL#rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#while (rDT010.next()) {#EOL##EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;// 関連する売上実績(DT100)の読取と集計 //#EOL#&#x9;/////////////////////////////////////////#EOL#&#x9;amKaisyuCur = 0; amKeijyouCur = 0; amKaisyuNew = 0; amKeijyouNew = 0;#EOL#&#x9;rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#&#x9;rDT100.addKeyValue('FGVALID',&#x9;&#x9;&#x9;'T');#EOL#&#x9;rDT100.addKeyValue('DTNEND >=',&#x9;&#x9;&#x9;curNend);#EOL#&#x9;rDT100.addKeyValue('NRTORIHIKISAKI',&#x9;rDT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;while (rDT100.next()) {#EOL#&#x9;&#x9;amUriage = Number(rDT100.getValueOf('AMURIAGE')) + Number(rDT100.getValueOf('AMTAX'));#EOL#&#x9;&#x9;if (rDT100.getValueOf('KBURIAGE') == '90') {#EOL#&#x9;&#x9;&#x9;if (rDT100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amKaisyuCur = Number(amKaisyuCur) - Number(amUriage);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rDT100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amKaisyuNew = Number(amKaisyuNew) - Number(amUriage);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;if (rDT100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amKeijyouCur = Number(amKeijyouCur) + Number(amUriage);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rDT100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amKeijyouNew = Number(amKeijyouNew) + Number(amUriage);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////#EOL#&#x9;// 合算チェックと顧客(DT010)の更新 //#EOL#&#x9;/////////////////////////////////////#EOL#&#x9;if (rDT010.getValueOf('AMKEIJYOU') == amKeijyouCur &amp;&amp; rDT010.getValueOf('AMKAISYU') == amKaisyuCur) {#EOL#&#x9;&#x9;if (isCheckOnly == 'false') {#EOL#&#x9;&#x9;&#x9;amKisyuUrikake = Number(rDT010.getValueOf('AMKISYUURIKAKE'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amKeijyouCur) - Number(amKeijyouNew) - Number(amKaisyuCur) + Number(amKaisyuNew);#EOL#&#x9;&#x9;&#x9;uDT010 = instance.createTableOperator('Update', 'DT010');#EOL#&#x9;&#x9;&#x9;uDT010.addValue('AMKISYUURIKAKE',&#x9;amKisyuUrikake);#EOL#&#x9;&#x9;&#x9;uDT010.addValue('AMKEIJYOU',&#x9;&#x9;amKeijyouNew);#EOL#&#x9;&#x9;&#x9;uDT010.addValue('AMKAISYU',&#x9;&#x9;&#x9;amKaisyuNew);#EOL#&#x9;&#x9;&#x9;uDT010.addValue('UPDCOUNTER',&#x9;&#x9;Number(rDT010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('NRTORIHIKISAKI',&#x9;rDT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;&#x9;uDT010.addKeyValue('UPDCOUNTER',&#x9;&#x9;rDT010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uDT010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '顧客(DT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;numberOfErrors++;#EOL#&#x9;&#x9;logMessage = '顧客(' + rDT010.getValueOf('NRTORIHIKISAKI') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')の計上額(' + rDT010.getValueOf('AMKEIJYOU') + #EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')と受領額(' + rDT010.getValueOf('AMKAISYU') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')が、売上実績を合算した計上額(' + amKeijyouCur + ')と受領額(' + amKaisyuCur +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')に一致しません。';#EOL#&#x9;&#x9;instance.setProcessLog(logMessage);#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////#EOL#// エラー処理と診断結果の登録 //#EOL#////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;instance.parmMap.put('NUMBER_OF_ERRORS_DF900', numberOfErrors);#EOL#} else {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}" SubsystemID="D" Type="XF000"/><Function ID="EF900" Name="年次在庫残高繰越処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET010; var uET010; var rET100;#EOL#var amSyukkoCur020 = 0; var amNyukoCur020 = 0; var amSyukkoNew020 = 0; var amNyukoNew020 = 0;#EOL#var qtSyukkoCur020 = 0; var qtNyukoCur020 = 0; var qtSyukkoNew020 = 0; var qtNyukoNew020 = 0;#EOL#var amKisyuZaiko020 = 0; var qtKisyuZaiko020 = 0; var amUkebarai020 = 0; var qtUkebarai020 = 0;#EOL#var errorMessage = ''; var numberOfErrors = 0; var count = 0; var logMessage = '';#EOL##EOL#////////////////////////////////////#EOL#// 新旧の集計対象最過去年月の設定 //#EOL#////////////////////////////////////#EOL#var curNend = instance.parmMap.get('CUR_NEND');#EOL#var newNend = instance.parmMap.get('NEW_NEND');#EOL#var isCheckOnly = instance.parmMap.get('CHECK_ONLY');#EOL##EOL#///////////////////////////#EOL#// 倉庫在庫(ET010)の読取 //#EOL#///////////////////////////#EOL#rET010 = instance.createTableOperator('Select', 'ET010');#EOL#while (rET010.next()) {#EOL##EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;// 合算チェックと商品・倉庫在庫(ET010)の更新 //#EOL#&#x9;///////////////////////////////////////////////#EOL#&#x9;validateET010();#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;break;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////////////////#EOL#// エラー処理と診断結果の登録 //#EOL#////////////////////////////////#EOL#if (errorMessage == '') {#EOL#&#x9;instance.parmMap.put('NUMBER_OF_ERRORS_EF900', numberOfErrors);#EOL#} else {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}#EOL##EOL#///////////////////////////////////////////////////////#EOL#// サブルーチン：関連する売上実績(ET100)の読取と集計 //#EOL#///////////////////////////////////////////////////////#EOL#function summarizeZaiko() {#EOL#&#x9;rET100 = instance.createTableOperator('Select', 'ET100');#EOL#&#x9;rET100.addKeyValue('FGVALID',&#x9;&#x9;'T');#EOL#&#x9;rET100.addKeyValue('DTNEND >=',&#x9;&#x9;curNend);#EOL#&#x9;rET100.addKeyValue('NRSYOHIN',&#x9;&#x9;rET030.getValueOf('NRSYOHIN'));#EOL#&#x9;rET100.addKeyValue('NRSOUKO',&#x9;&#x9;rET030.getValueOf('NRSOUKO'));#EOL#&#x9;while (rET100.next()) {#EOL##EOL#&#x9;&#x9;//////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 受払区分が以下ならば、出庫合計数として加算：     //#EOL#&#x9;&#x9;// 12 仕入返品, 20 受注出荷, 21 直出荷, 30 移動出庫 //#EOL#&#x9;&#x9;// 40 減耗, 41 評価損, 42 仕掛材料出庫, 43 雑損     //#EOL#&#x9;&#x9;//////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (rET100.getValueOf('KBUKEBARAI') == '12' || rET100.getValueOf('KBUKEBARAI') == '20'#EOL#&#x9;&#x9;|| rET100.getValueOf('KBUKEBARAI') == '21' || rET100.getValueOf('KBUKEBARAI') == '30'#EOL#&#x9;&#x9;|| rET100.getValueOf('KBUKEBARAI') == '40' || rET100.getValueOf('KBUKEBARAI') == '41'#EOL#&#x9;&#x9;|| rET100.getValueOf('KBUKEBARAI') == '42' || rET100.getValueOf('KBUKEBARAI') == '43') {#EOL#&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoCur020 = Number(amSyukkoCur020) - Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoCur020 = Number(qtSyukkoCur020) - Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amSyukkoNew020 = Number(amSyukkoNew020) - Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;qtSyukkoNew020 = Number(qtSyukkoNew020) - Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;////////////////////////////////////////////////////////#EOL#&#x9;&#x9;// 受払区分が以下ならば、入庫合計数として加算：       //#EOL#&#x9;&#x9;// 10 発注入荷, 11 直入荷, 22 売上返品, 31 移動入庫   //#EOL#&#x9;&#x9;// 50 雑益, 51 評価益, 52 仕掛完成入庫, 53 加工費繰入 //#EOL#&#x9;&#x9;////////////////////////////////////////////////////////#EOL#&#x9;&#x9;if (rET100.getValueOf('KBUKEBARAI') == '10' || rET100.getValueOf('KBUKEBARAI') == '11'#EOL#&#x9;&#x9;|| rET100.getValueOf('KBUKEBARAI') == '22' || rET100.getValueOf('KBUKEBARAI') == '31'#EOL#&#x9;&#x9;|| rET100.getValueOf('KBUKEBARAI') == '50' || rET100.getValueOf('KBUKEBARAI') == '51'#EOL#&#x9;&#x9;|| rET100.getValueOf('KBUKEBARAI') == '52' || rET100.getValueOf('KBUKEBARAI') == '53') {#EOL#&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoCur020 = Number(amNyukoCur020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoCur020 = Number(qtNyukoCur020) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;amNyukoNew020 = Number(amNyukoNew020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;qtNyukoNew020 = Number(qtNyukoNew020) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;/////////////////#EOL#&#x9;&#x9;// 90 棚増棚減 //#EOL#&#x9;&#x9;/////////////////#EOL#&#x9;&#x9;if (rET100.getValueOf('KBUKEBARAI') == '90') {#EOL#&#x9;&#x9;&#x9;if (rET100.getValueOf('AMUKEBARAI') >= 0) {#EOL#&#x9;&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amNyukoCur020 = Number(amNyukoCur020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtNyukoCur020 = Number(qtNyukoCur020) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amNyukoNew020 = Number(amNyukoNew020) + Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtNyukoNew020 = Number(qtNyukoNew020) + Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') >= curNend) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoCur020 = Number(amSyukkoCur020) - Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoCur020 = Number(qtSyukkoCur020) - Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;if (rET100.getValueOf('DTNEND') == newNend) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;amSyukkoNew020 = Number(amSyukkoNew020) - Number(rET100.getValueOf('AMUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;qtSyukkoNew020 = Number(qtSyukkoNew020) - Number(rET100.getValueOf('QTUKEBARAI'));#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#///////////////////////////////////////////////////////#EOL#// サブルーチン：合算チェックと倉庫在庫(ET010)の更新 //#EOL#///////////////////////////////////////////////////////#EOL#function validateET010() {#EOL#&#x9;if (rET010.getValueOf('AMNYUKO') == amNyukoCur020#EOL#&#x9; &amp;&amp; rET010.getValueOf('AMSYUKKO') == amSyukkoCur020#EOL#&#x9; &amp;&amp; rET010.getValueOf('QTNYUKO') == qtNyukoCur020#EOL#&#x9; &amp;&amp; rET010.getValueOf('QTSYUKKO') == qtSyukkoCur020) {#EOL#&#x9;&#x9;if (isCheckOnly == 'false') {#EOL#&#x9;&#x9;&#x9;amKisyuZaiko020 = Number(rET010.getValueOf('AMKISYUZAIKO'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(amNyukoCur020) - Number(amNyukoNew020) - Number(amSyukkoCur020) + Number(amSyukkoNew020);#EOL#&#x9;&#x9;&#x9;qtKisyuZaiko020 = Number(rET010.getValueOf('QTKISYUZAIKO'))#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; + Number(qtNyukoCur020) - Number(qtNyukoNew020) - Number(qtSyukkoCur020) + Number(qtSyukkoNew020);#EOL#&#x9;&#x9;&#x9;uET010 = instance.createTableOperator('Update', 'ET010');#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMKISYUZAIKO',&#x9;amKisyuZaiko020);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMNYUKO',&#x9;&#x9;amNyukoNew020);#EOL#&#x9;&#x9;&#x9;uET010.addValue('AMSYUKKO',&#x9;&#x9;amSyukkoNew020);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTKISYUZAIKO',&#x9;qtKisyuZaiko020);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTNYUKO',&#x9;&#x9;qtNyukoNew020);#EOL#&#x9;&#x9;&#x9;uET010.addValue('QTSYUKKO',&#x9;&#x9;qtSyukkoNew020);#EOL#&#x9;&#x9;&#x9;uET010.addValue('UPDCOUNTER',&#x9;Number(rET010.getValueOf('UPDCOUNTER')) + 1);#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSYOHIN',&#x9;&#x9;rET010.getValueOf('NRSYOHIN'));#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('NRSOUKO',&#x9;&#x9;rET010.getValueOf('NRSOUKO'));#EOL#&#x9;&#x9;&#x9;uET010.addKeyValue('UPDCOUNTER',&#x9;rET010.getValueOf('UPDCOUNTER'));#EOL#&#x9;&#x9;&#x9;count = uET010.execute();#EOL#&#x9;&#x9;&#x9;if (count != 1) {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = '倉庫別在庫(ET010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL#&#x9;&#x9;numberOfErrors++;#EOL#&#x9;&#x9;logMessage = '倉庫在庫(Key:' + rET010.getValueOf('NRSYOHIN') + #EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'-' + rET010.getValueOf('NRSOUKO') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')の入庫数(' + rET010.getValueOf('QTNYUKO') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'),出庫数(' + rET010.getValueOf('QTSYUKKO') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'),入庫額(' + rET010.getValueOf('AMNYUKO') + #EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'),出庫額(' + rET010.getValueOf('AMSYUKKO') +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')が、受払実績を合算した' +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'入庫数(' + qtNyukoCur020 +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'),出庫数(' + qtSyukkoCur020 +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'),入庫額(' + amNyukoCur020 +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;'),出庫額(' + amSyukkoCur020 +#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;')に一致しません。';#EOL#&#x9;&#x9;instance.setProcessLog(logMessage);#EOL#&#x9;}#EOL#&#x9;amSyukkoCur020 = 0; amNyukoCur020 = 0; amSyukkoNew020 = 0; amNyukoNew020 = 0;#EOL#&#x9;qtSyukkoCur020 = 0; qtNyukoCur020 = 0; qtSyukkoNew020 = 0; qtNyukoNew020 = 0;#EOL#}" SubsystemID="E" Type="XF000"/><Function ID="ZF110" Name="残高増減値一致検査の起動" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(java.lang, java.awt, javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数定義 //#EOL#&#x9;//////////////#EOL#&#x9;var numberOfErrors = 0; var reply;#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// ダイアログ上要素の設定 //#EOL#&#x9;////////////////////////////#EOL#&#x9;var panel = new JPanel();#EOL#&#x9;panel.setPreferredSize(new Dimension(310, 185));#EOL#&#x9;panel.setBorder(BorderFactory.createEtchedBorder());#EOL#&#x9;var labelCurNend = new JLabel();#EOL#&#x9;labelCurNend.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;labelCurNend.setHorizontalAlignment(SwingConstants.RIGHT);#EOL#&#x9;labelCurNend.setHorizontalTextPosition(SwingConstants.LEADING);#EOL#&#x9;labelCurNend.setText('現年度');#EOL#&#x9;labelCurNend.setBounds(new Rectangle(50, 10, 70, 15));#EOL#&#x9;var textFieldCurNend = new JTextField();#EOL#&#x9;textFieldCurNend.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;textFieldCurNend.setBounds(new Rectangle(130, 7, 60, 22));#EOL#&#x9;textFieldCurNend.setEditable(false);#EOL#&#x9;var textAreaMessage = new JTextArea();#EOL#&#x9;textAreaMessage.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;textAreaMessage.setEditable(false);#EOL#&#x9;textAreaMessage.setLineWrap(true);#EOL#&#x9;var scrollPaneMessage = new JScrollPane();#EOL#&#x9;scrollPaneMessage.getViewport().add(textAreaMessage);#EOL#&#x9;scrollPaneMessage.setBounds(new Rectangle(9, 35, 291, 139));#EOL#&#x9;panel.setLayout(null);#EOL#&#x9;panel.add(labelCurNend);#EOL#&#x9;panel.add(textFieldCurNend);#EOL#&#x9;panel.add(scrollPaneMessage);#EOL#&#x9;var btnArray = java.lang.reflect.Array.newInstance(java.lang.String, 2);#EOL#&#x9;btnArray[0] = ' 閉じる ';#EOL#&#x9;btnArray[1] = ' 実行 ';#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 現行年度設定 //#EOL#&#x9;//////////////////#EOL#&#x9;var wrkStr = session.getSystemVariantString('ALLOWED_FISCAL_MONTH') + '';#EOL#&#x9;var curNend = wrkStr.substring(0, 4);#EOL#&#x9;var newNend = Number(curNend) + Number(1);#EOL#&#x9;textFieldCurNend.setText(curNend);#EOL#&#x9;textAreaMessage.setText('＊在庫・売掛・買掛テーブル上の残高増減値と、取引実績テーブルの内容にもとづく残高増減値とが比較されます。差異があれば、セッションログに書き出されます。');#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 実行確認ダイアログ表示 //#EOL#&#x9;////////////////////////////#EOL#&#x9;reply = JOptionPane.showOptionDialog(null, panel, '残高増減値一致検査', JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null, btnArray, btnArray[0]);#EOL#&#x9;if (reply == 1) {#EOL##EOL#&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;// 関連処理起動 //#EOL#&#x9;&#x9;//////////////////#EOL#&#x9;&#x9;instance.parmMap.put('CUR_NEND', curNend);#EOL#&#x9;&#x9;instance.parmMap.put('NEW_NEND', newNend);#EOL#&#x9;&#x9;instance.parmMap.put('CHECK_ONLY', 'true'); //検査のみを実施する//#EOL#&#x9;&#x9;instance.callFunction('CF900'); //買掛残高増減値検査//#EOL#&#x9;&#x9;instance.callFunction('DF900'); //売掛残高増減値検査//#EOL#&#x9;&#x9;instance.callFunction('EF900'); //在庫残高増減値検査//#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// 診断結果の表示 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;var numberOfErrorsCF900 =instance.parmMap.get('NUMBER_OF_ERRORS_CF900');#EOL#&#x9;&#x9;var numberOfErrorsDF900 =instance.parmMap.get('NUMBER_OF_ERRORS_DF900');#EOL#&#x9;&#x9;var numberOfErrorsEF900 =instance.parmMap.get('NUMBER_OF_ERRORS_EF900');#EOL#&#x9;&#x9;if (numberOfErrorsCF900 == 0 &amp;&amp; numberOfErrorsDF900 == 0 &amp;&amp; numberOfErrorsEF900 == 0) {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊残高増減値の差異は見つかりませんでした。');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;wrkStr = '';#EOL#&#x9;&#x9;&#x9;if (numberOfErrorsCF900 > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;wrkStr = '買掛';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (numberOfErrorsDF900 > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;if (wrkStr == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = '売掛';#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = wrkStr + 'と売掛';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (numberOfErrorsEF900 > 0) {#EOL#&#x9;&#x9;&#x9;&#x9;if (wrkStr == '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = '在庫';#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;wrkStr = wrkStr + 'と在庫';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;numberOfErrors = Number(numberOfErrorsCF900) + Number(numberOfErrorsDF900) + Number(numberOfErrorsEF900);#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊' + wrkStr + 'に関して、' + numberOfErrors + '件の残高増減値の差異が見つかりました。差異の詳細についてはセッションログを確認してください。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="Z" Type="XF000"/><Function ID="CF102" Name="買掛増減履歴の元取引情報表示切替処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT100; var rFT012; var rHT020; var rHT010; var rCT110;#EOL##EOL#///////////////////////////////////////#EOL#// 当該買掛増減履歴(CT100)の読み込み //#EOL#///////////////////////////////////////#EOL#rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#rCT100.setSelectFields('KBSIIRE, NRTORIHIKIKANRI');#EOL#rCT100.addKeyValue('NRSIIRE',&#x9;instance.parmMap.get('NRSIIRE'));#EOL#if (rCT100.next()) {#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 00(入荷仕入) FT012 入荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '00') {#EOL#&#x9;&#x9;rFT012 = instance.createTableOperator('Select', 'FT012');#EOL#&#x9;&#x9;rFT012.setSelectFields('NRHATTYU, SQHATTYU, SQNYUKA');#EOL#&#x9;&#x9;rFT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rFT012.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRHATTYU',&#x9;rFT012.getValueOf('NRHATTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQHATTYU',&#x9;rFT012.getValueOf('SQHATTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQNYUKA',&#x9;&#x9;rFT012.getValueOf('SQNYUKA'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('FF042');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;// 01(直入荷仕入), 02(仕入返品) HT020 特殊仕入 //#EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '01' || rCT100.getValueOf('KBSIIRE') == '02') {#EOL#&#x9;&#x9;rHT020 = instance.createTableOperator('Select', 'HT020');#EOL#&#x9;&#x9;rHT020.setSelectFields('NRTOKUSYUSIIRE');#EOL#&#x9;&#x9;rHT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rHT020.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRTOKUSYUSIIRE', rHT020.getValueOf('NRTOKUSYUSIIRE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('HF023');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////////////////////////////////#EOL#&#x9;// 10(雑益振替), 11(雑損仕入), 20(相殺), 30(売上原価振替) HT010 仕入振替 //#EOL#&#x9;///////////////////////////////////////////////////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '10' || rCT100.getValueOf('KBSIIRE') == '11'#EOL#&#x9; || rCT100.getValueOf('KBSIIRE') == '20' || rCT100.getValueOf('KBSIIRE') == '30') {#EOL#&#x9;&#x9;rHT010 = instance.createTableOperator('Select', 'HT010');#EOL#&#x9;&#x9;rHT010.setSelectFields('NRSIIREHURIKAE');#EOL#&#x9;&#x9;rHT010.addKeyValue('NRTORIHIKIKANRI',&#x9;rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rHT010.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRSIIREHURIKAE', rHT010.getValueOf('NRSIIREHURIKAE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('HF012');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////#EOL#&#x9;// 90(支払) CT110 支払依頼 //#EOL#&#x9;/////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '90') {#EOL#&#x9;&#x9;rCT110 = instance.createTableOperator('Select', 'CT110');#EOL#&#x9;&#x9;rCT110.setSelectFields('NRSIHARAIIRAI');#EOL#&#x9;&#x9;rCT110.addKeyValue('NRTORIHIKIKANRI',rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rCT110.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRSIHARAIIRAI', rCT110.getValueOf('NRSIHARAIIRAI'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('CF112');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL#" SubsystemID="C" Type="XF000"/><Function ID="CF122" Name="支払依頼の承認（切替）" Script="///////////////////////////////////#EOL#// 当該支払依頼(CT110)の読み込み //#EOL#///////////////////////////////////#EOL#var rCT110 = instance.createTableOperator('Select', 'CT110');#EOL#rCT110.setSelectFields('FGSYOUNIN, NRSIHARAI');#EOL#rCT110.addKeyValue('NRSIHARAIIRAI',&#x9;instance.parmMap.get('NRSIHARAIIRAI'));#EOL#if (rCT110.next()) {#EOL##EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;// 支払依頼の状態にもとづく関連機能の起動 //#EOL#&#x9;////////////////////////////////////////////#EOL#&#x9;if (rCT110.getValueOf('FGSYOUNIN') == 'F') {#EOL#&#x9;&#x9;instance.callFunction('CF123'); //承認入力//#EOL#&#x9;} else {#EOL#&#x9;&#x9;if (rCT110.getValueOf('NRSIHARAI') == '') {#EOL#&#x9;&#x9;&#x9;instance.callFunction('CF124'); //承認取消入力//#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.callFunction('CF125'); //支払依頼確認//#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL#" SubsystemID="C" Type="XF000"/><Function ID="DF102" Name="売掛増減履歴の元取引情報表示切替処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT100; var rGT012; var rJT020; var rJT010; var rDT120;#EOL##EOL#///////////////////////////////////////#EOL#// 当該売掛増減履歴(DT100)の読み込み //#EOL#///////////////////////////////////////#EOL#rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#rDT100.setSelectFields('KBURIAGE, NRTORIHIKIKANRI');#EOL#rDT100.addKeyValue('NRURIAGE',&#x9;instance.parmMap.get('NRURIAGE'));#EOL#if (rDT100.next()) {#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 00(出荷売上) GT012 出荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '00') {#EOL#&#x9;&#x9;rGT012 = instance.createTableOperator('Select', 'GT012');#EOL#&#x9;&#x9;rGT012.setSelectFields('NRJYUTYU, SQJYUTYU, SQSYUKKA');#EOL#&#x9;&#x9;rGT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rGT012.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRJYUTYU', rGT012.getValueOf('NRJYUTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQJYUTYU', rGT012.getValueOf('SQJYUTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQSYUKKA', rGT012.getValueOf('SQSYUKKA'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('GF042');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;// 01(直出荷売上), 02(出荷返品) JT020 特殊売上 //#EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '01' || rDT100.getValueOf('KBURIAGE') == '02') {#EOL#&#x9;&#x9;rJT020 = instance.createTableOperator('Select', 'JT020');#EOL#&#x9;&#x9;rJT020.setSelectFields('NRTOKUSYUURIAGE');#EOL#&#x9;&#x9;rJT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rJT020.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRTOKUSYUURIAGE', rJT020.getValueOf('NRTOKUSYUURIAGE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('JF023');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////////////////////////////////////////////#EOL#&#x9;// 10(雑益売上), 11(雑損振替), 20(相殺/買掛金振替), 30(値引/販売費振替) JT010 売上振替 //#EOL#&#x9;/////////////////////////////////////////////////////////////////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '10' || rDT100.getValueOf('KBURIAGE') == '11'#EOL#&#x9;|| rDT100.getValueOf('KBURIAGE') == '20' || rDT100.getValueOf('KBURIAGE') == '30') {#EOL#&#x9;&#x9;rJT010 = instance.createTableOperator('Select', 'JT010');#EOL#&#x9;&#x9;rJT010.setSelectFields('NRURIAGEHURIKAE');#EOL#&#x9;&#x9;rJT010.addKeyValue('NRTORIHIKIKANRI',&#x9;rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rJT010.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRURIAGEHURIKAE', rJT010.getValueOf('NRURIAGEHURIKAE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('JF012');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////#EOL#&#x9;// 90(受領) DT120 受領明細 //#EOL#&#x9;/////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '90') {#EOL#&#x9;&#x9;rDT120 = instance.createTableOperator('Select', 'DT120');#EOL#&#x9;&#x9;rDT120.setSelectFields('NRJYURYOU');#EOL#&#x9;&#x9;rDT120.addKeyValue('NRTORIHIKIKANRI',rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rDT120.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRJYURYOU', rDT120.getValueOf('NRJYURYOU'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('DF122');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="D" Type="XF000"/><Function ID="FF016" Name="発注書の印刷（切替と更新）" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rFT010; var uFT010; var rAT030;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#/////////////////////////////////#EOL#// 当該発注見出し(FT010)の読込 //#EOL#/////////////////////////////////#EOL#rFT010 = instance.createTableOperator('Select', 'FT010');#EOL#rFT010.setSelectFields('NRTORIHIKISAKI');#EOL#rFT010.addKeyValue('NRHATTYU',&#x9;instance.parmMap.get('NRHATTYU'));#EOL#if (rFT010.next()) {#EOL##EOL#&#x9;/////////////////////////#EOL#&#x9;// 取引先(AT030)の読込 //#EOL#&#x9;/////////////////////////#EOL#&#x9;rAT030 = instance.createTableOperator('Select', 'AT030');#EOL#&#x9;rAT030.setSelectFields('KBCOUNTRY');#EOL#&#x9;rAT030.addKeyValue('NRTORIHIKISAKI',&#x9;rFT010.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;if (rAT030.next()) {#EOL##EOL#&#x9;&#x9;//////////////////////////////////////#EOL#&#x9;&#x9;// 国コードにもとづく関連機能の起動 //#EOL#&#x9;&#x9;//////////////////////////////////////#EOL#&#x9;&#x9;if (rAT030.getValueOf('KBCOUNTRY') == 'JPN') {#EOL#&#x9;&#x9;&#x9;instance.callFunction('FF016A'); //発注書の印刷(日本語)//#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.callFunction('FF016B'); //発注書の印刷(英語)//#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;// 発注見出し(FT010)の発行日時更新 //#EOL#&#x9;&#x9;/////////////////////////////////////#EOL#&#x9;&#x9;uFT010 = instance.createTableOperator('Update', 'FT010');#EOL#&#x9;&#x9;uFT010.addValue('DTHAKKOU',&#x9;session.getToday());#EOL#&#x9;&#x9;uFT010.addKeyValue('NRHATTYU',&#x9;instance.parmMap.get('NRHATTYU'));#EOL#&#x9;&#x9;count = uFT010.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '10');#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊発注書が発行されました。');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;errorMessage = '発注見出し(FT010)の更新に失敗しました。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}" SubsystemID="F" Type="XF000"/><Function ID="HF021B" Name="特殊仕入の保守(切替)" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rHT020;#EOL##EOL#///////////////////////////////////#EOL#// 当該特殊仕入(HT020)の読み込み //#EOL#///////////////////////////////////#EOL#rHT020 = instance.createTableOperator('Select', 'HT020');#EOL#rHT020.setSelectFields('KBTOKUSYUSIIRE');#EOL#rHT020.addKeyValue('NRTOKUSYUSIIRE',&#x9;instance.parmMap.get('NRTOKUSYUSIIRE'));#EOL#if (rHT020.next()) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 区分に従って関連機能を起動 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;if (rHT020.getValueOf('KBTOKUSYUSIIRE') == '10') {#EOL#&#x9;&#x9;  instance.callFunction('HF021C'); //仕入返品の保守//#EOL#&#x9;} else {#EOL#&#x9;&#x9;if (rHT020.getValueOf('KBTOKUSYUSIIRE') == '20') {#EOL#&#x9;&#x9;&#x9;  instance.callFunction('HF021D'); //直接入荷の保守//#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="H" Type="XF000"/><Function ID="HF022" Name="返品通知書の印刷(切替)" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rHT020; var rAT030;#EOL##EOL#///////////////////////////////////#EOL#// 当該特殊仕入(HT020)の読み込み //#EOL#///////////////////////////////////#EOL#rHT020 = instance.createTableOperator('Select', 'HT020');#EOL#rHT020.setSelectFields('NRTORIHIKISAKI');#EOL#rHT020.addKeyValue('NRTOKUSYUSIIRE',&#x9;instance.parmMap.get('NRTOKUSYUSIIRE'));#EOL#if (rHT020.next()) {#EOL##EOL#&#x9;/////////////////////////////#EOL#&#x9;// 取引先(AT030)の読み込み //#EOL#&#x9;/////////////////////////////#EOL#&#x9;rAT030 = instance.createTableOperator('Select', 'AT030');#EOL#&#x9;rAT030.setSelectFields('KBCOUNTRY');#EOL#&#x9;rAT030.addKeyValue('NRTORIHIKISAKI',&#x9;rHT020.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;if (rAT030.next()) {#EOL##EOL#&#x9;&#x9;//////////////////////////////////////#EOL#&#x9;&#x9;// 国コードにもとづく関連機能の起動 //#EOL#&#x9;&#x9;//////////////////////////////////////#EOL#&#x9;&#x9;if (rAT030.getValueOf('KBCOUNTRY') == 'JPN') {#EOL#&#x9;&#x9;&#x9;instance.callFunction('HF022A'); //返品通知書の印刷(日本語)//#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.callFunction('HF022B'); //返品通知書の印刷(英語)//#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="H" Type="XF000"/><Function ID="JF021B" Name="特殊売上の保守(切替)" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rJT020;#EOL##EOL#///////////////////////////////////#EOL#// 当該特殊売上(JT020)の読み込み //#EOL#///////////////////////////////////#EOL#rJT020 = instance.createTableOperator('Select', 'JT020');#EOL#rJT020.setSelectFields('KBTOKUSYUURIAGE');#EOL#rJT020.addKeyValue('NRTOKUSYUURIAGE',&#x9;instance.parmMap.get('NRTOKUSYUURIAGE'));#EOL#if (rJT020.next()) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 区分に従って関連機能を起動 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;if (rJT020.getValueOf('KBTOKUSYUURIAGE') == '10') {#EOL#&#x9;&#x9;  instance.callFunction('JF021C'); //売上返品の保守//#EOL#&#x9;} else {#EOL#&#x9;&#x9;if (rJT020.getValueOf('KBTOKUSYUURIAGE') == '20') {#EOL#&#x9;&#x9;&#x9;  instance.callFunction('JF021D'); //直出荷の保守//#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="J" Type="XF000"/><Function ID="JF024" Name="特殊売上発行オプション" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(java.lang, java.awt, javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 変数定義 //#EOL#&#x9;//////////////#EOL#&#x9;var rJT020; var rDT010; var dialog;#EOL##EOL#&#x9;///////////////////////////////////#EOL#&#x9;// 当該特殊売上(JT020)の読み込み //#EOL#&#x9;///////////////////////////////////#EOL#&#x9;rJT020 = instance.createTableOperator('Select', 'JT020');#EOL#&#x9;rJT020.setSelectFields('NRTORIHIKISAKI, KBTOKUSYUURIAGE, NRSEIKYU');#EOL#&#x9;rJT020.addKeyValue('NRTOKUSYUURIAGE',&#x9;instance.parmMap.get('NRTOKUSYUURIAGE'));#EOL#&#x9;if (rJT020.next()) {#EOL##EOL#&#x9;&#x9;/////////////////////////////#EOL#&#x9;&#x9;// 得意先(DT010)の読み込み //#EOL#&#x9;&#x9;/////////////////////////////#EOL#&#x9;&#x9;rDT010 = instance.createTableOperator('Select', 'DT010');#EOL#&#x9;&#x9;rDT010.setSelectFields('KBSEIKYUHOUSHIKI');#EOL#&#x9;&#x9;rDT010.addKeyValue('NRTORIHIKISAKI',&#x9;rJT020.getValueOf('NRTORIHIKISAKI'));#EOL#&#x9;&#x9;if (rDT010.next()) {#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 売上返品用オプションの設定とダイアログ表示～関連機能起動 //#EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rJT020.getValueOf('KBTOKUSYUURIAGE') == '10')  {#EOL#&#x9;&#x9;&#x9;&#x9;if (rDT010.getValueOf('KBSEIKYUHOUSHIKI') == '20' &amp;&amp; rJT020.getValueOf('NRSEIKYU') != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog = session.getOptionDialog();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog.addOption('請求書発行'); // 0 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog.addOption('閉じる');     // 1 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;var reply = dialog.request('発行オプション');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (reply == 0) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('NRSEIKYU', rJT020.getValueOf('NRSEIKYU'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.callFunction('DF115B');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;JOptionPane.showMessageDialog(null, '発行可能なものはありません。');#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;// 直接出荷用オプションの設定とダイアログ表示～関連機能起動 //#EOL#&#x9;&#x9;&#x9;//////////////////////////////////////////////////////////////#EOL#&#x9;&#x9;&#x9;if (rJT020.getValueOf('KBTOKUSYUURIAGE') == '20')  {#EOL#&#x9;&#x9;&#x9;&#x9;if (rDT010.getValueOf('KBSEIKYUHOUSHIKI') == '20' &amp;&amp; rJT020.getValueOf('NRSEIKYU') != '') {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog = session.getOptionDialog();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog.addOption('納品書発行'); // 0 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog.addOption('請求書発行'); // 1 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog.addOption('閉じる');     // 2 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;var reply = dialog.request('発行オプション');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (reply == 0) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.callFunction('JF022');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (reply == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.parmMap.put('NRSEIKYU', rJT020.getValueOf('NRSEIKYU'));#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.callFunction('DF115B');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (reply == 2 || reply == -1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog = session.getOptionDialog();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog.addOption('納品書発行'); // 0 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dialog.addOption('閉じる');     // 1 //#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;var reply = dialog.request('発行オプション');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (reply == 0) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.callFunction('JF022');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="J" Type="XF000"/><Function ID="KF019" Name="棚卸編集ツール" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rKT010; var dialog;#EOL##EOL#///////////////////////////////////#EOL#// 当該棚卸指示(KT010)の読み込み //#EOL#///////////////////////////////////#EOL#rKT010 = instance.createTableOperator('Select', 'KT010');#EOL#rKT010.setSelectFields('DTKOUSHIN');#EOL#rKT010.addKeyValue('NRTANAOROSHI',&#x9;instance.parmMap.get('NRTANAOROSHI'));#EOL#if (rKT010.next()) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// ダイアログのオプション設定 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;dialog = session.getOptionDialog();#EOL#&#x9;dialog.addOption('棚卸指示の確認・編集'); // 0 //#EOL#&#x9;dialog.addOption('棚卸指示明細の追加');   // 1 //#EOL#&#x9;dialog.addOption('棚卸結果エントリー');   // 2 //#EOL#&#x9;if (rKT010.getValueOf('DTKOUSHIN') == '' || rKT010.getValueOf('DTKOUSHIN') == null) {#EOL#&#x9;&#x9;dialog.addOption('確定更新');         // 3 //#EOL#&#x9;} else {#EOL#&#x9;&#x9;dialog.addOption('確定解除');         // 3 //#EOL#&#x9;}#EOL#&#x9;dialog.addOption('棚卸指示の削除');       // 4 //#EOL#&#x9;dialog.addOption('閉じる');               // 5 //#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// ダイアログ表示～関連機能起動 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;var reply = dialog.request('編集オプション');#EOL#&#x9;if (reply == 0) {#EOL#&#x9;&#x9;instance.callFunction('KF011'); //棚卸指示の確認・編集//#EOL#&#x9;}#EOL#&#x9;if (reply == 1) {#EOL#&#x9;&#x9;instance.callFunction('KF015'); //棚卸指示明細の追加//#EOL#&#x9;}#EOL#&#x9;if (reply == 2) {#EOL#&#x9;&#x9;instance.callFunction('KF016B'); //棚卸結果エントリー//#EOL#&#x9;}#EOL#&#x9;if (reply == 3) {#EOL#&#x9;&#x9;if (rKT010.getValueOf('DTKOUSHIN') == '' || rKT010.getValueOf('DTKOUSHIN') == null) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('INSTANCE_MODE', 'EDIT'); //編集モードで起動//#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF017A'); //確定更新処理//#EOL#&#x9;&#x9;&#x9;if (instance.returnMap.get('RETURN_CODE') == '20') {#EOL#&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊棚卸結果にもとづいて確定更新しました。');#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('INSTANCE_MODE', 'EDIT'); //編集モードで起動//#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF017B'); //確定取消処理//#EOL#&#x9;&#x9;&#x9;if (instance.returnMap.get('RETURN_CODE') == '20') {#EOL#&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊確定更新が赤黒訂正されました。');#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊取消処理は実行されませんでした。');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;if (reply == 4) {#EOL#&#x9;&#x9;instance.callFunction('KF018'); //棚卸指示の削除//#EOL#&#x9;}#EOL#&#x9;if (reply == 5 || reply == -1) {#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;}#EOL#}" SubsystemID="K" Type="XF000"/><Function ID="KF024A" Name="在庫移動指示書の印刷(更新)" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rKT020; var uKT020;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#///////////////////////////////////////#EOL#// 当該在庫移動指示(KT020)の読み込み //#EOL#///////////////////////////////////////#EOL#rKT020 = instance.createTableOperator('Select', 'KT020');#EOL#rKT020.setSelectFields('TMHAKKOU');#EOL#rKT020.addKeyValue('NRZAIKOIDOU',&#x9;instance.parmMap.get('NRZAIKOIDOU'));#EOL#if (rKT020.next()) {#EOL##EOL#&#x9;//////////////////#EOL#&#x9;// 指示書の発行 //#EOL#&#x9;//////////////////#EOL#&#x9;instance.callFunction('KF024B');#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// 発行日時の更新 //#EOL#&#x9;////////////////////#EOL#&#x9;if (rKT020.getValueOf('TMHAKKOU') == '' || rKT020.getValueOf('TMHAKKOU') == null) {#EOL#&#x9;&#x9;uKT020 = instance.createTableOperator('Update', 'KT020');#EOL#&#x9;&#x9;uKT020.addValue('TMHAKKOU',&#x9;session.getTimeStamp());#EOL#&#x9;&#x9;uKT020.addKeyValue('NRZAIKOIDOU',&#x9;instance.parmMap.get('NRZAIKOIDOU'));#EOL#&#x9;&#x9;count = uKT020.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_CODE', '10');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;errorMessage = '在庫移動指示(KT020)の更新に失敗しました。';#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}" SubsystemID="K" Type="XF000"/><Function ID="KF029" Name="在庫移動指示編集ツール" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rKT020; var dialog;#EOL##EOL#///////////////////////////////////////#EOL#// 当該在庫移動指示(KT020)の読み込み //#EOL#///////////////////////////////////////#EOL#rKT020 = instance.createTableOperator('Select', 'KT020');#EOL#rKT020.setSelectFields('TMKANRYO');#EOL#rKT020.addKeyValue('NRZAIKOIDOU',&#x9;instance.parmMap.get('NRZAIKOIDOU'));#EOL#if (rKT020.next()) {#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// オプション設定 //#EOL#&#x9;////////////////////#EOL#&#x9;dialog = session.getOptionDialog();#EOL#&#x9;dialog.addOption('在庫移動指示の確認・編集'); // 0 //#EOL#&#x9;dialog.addOption('在庫移動指示明細の編集');   // 1 //#EOL#&#x9;if (rKT020.getValueOf('TMKANRYO') == '' || rKT020.getValueOf('TMKANRYO') == null) {#EOL#&#x9;&#x9;dialog.addOption('移動完了エントリー');   // 2 //#EOL#&#x9;} else {#EOL#&#x9;&#x9;dialog.addOption('完了取消処理');         // 2 //#EOL#&#x9;}#EOL#&#x9;dialog.addOption('在庫移動指示の削除');       // 3 //#EOL#&#x9;dialog.addOption('閉じる');                   // 4 //#EOL##EOL#&#x9;//////////////////////////////////#EOL#&#x9;// ダイアログ表示～関連機能起動 //#EOL#&#x9;//////////////////////////////////#EOL#&#x9;var reply = dialog.request('編集オプション');#EOL#&#x9;if (reply == 0) {#EOL#&#x9;&#x9;instance.callFunction('KF021'); //在庫移動指示の保守//#EOL#&#x9;}#EOL#&#x9;if (reply == 1) {#EOL#&#x9;&#x9;instance.callFunction('KF022'); //在庫移動指示明細の保守//#EOL#&#x9;}#EOL#&#x9;if (reply == 2) {#EOL#&#x9;&#x9;if (rKT020.getValueOf('TMKANRYO') == '' || rKT020.getValueOf('TMKANRYO') == null) {#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF026'); //移動完了エントリー//#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF027'); //完了取消処理//#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;if (reply == 3) {#EOL#&#x9;&#x9;instance.callFunction('KF028'); //在庫移動指示の削除//#EOL#&#x9;}#EOL#&#x9;if (reply == 4 || reply == -1) {#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#&#x9;}#EOL#}" SubsystemID="K" Type="XF000"/><Function FixedWhere="NRNYUKA != ''" ID="FF043" InitialMsg="＊Ｆ９を押せば、入荷№がクリアされて入荷見出しから切り離されます。" KeyFields="" Name="入荷明細の切り離し" PrimaryTable="FT012" Size="AUTO" SubsystemID="F" Type="XF200" UpdateOnly="T"><Field DataSource="FT012.NRHATTYU" FieldOptions="" Order="0010"/><Field DataSource="FT012.SQHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT012.SQNYUKA" FieldOptions="HORIZONTAL" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="切り離し" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020A.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020A.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0040"/></Function><Function FixedWhere="NRSYUKKA != ''" ID="GF043" InitialMsg="＊Ｆ９を押せば、出荷№がクリアされ出荷見出しから切り離されます。" KeyFields="" Name="出荷明細の切り離し" PrimaryTable="GT012" Size="AUTO" SubsystemID="G" Type="XF200" UpdateOnly="T"><Field DataSource="GT012.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT012.SQJYUTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT012.SQSYUKKA" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT012.QTYOTEISYUKKA" FieldOptions="" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="切り離し" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0050"/></Function><Function ID="KF017A" InitialMsg="＊確定ボタンを押せば、基準時の帳簿在庫と実棚との差にもとづいて在庫更新されます。" KeyFields="" Name="棚卸確定更新" PrimaryTable="KT010" Size="AUTO" SubsystemID="K" Type="XF200" UpdateOnly="T"><Field DataSource="KT010.NRTANAOROSHI" FieldOptions="" Order="0010"/><Field DataSource="KT010.DTKIJYUN" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="確定" Number="5" Position="3"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫),HORIZONTAL" Order="0020"/><Field DataSource="KT010.DTKOUSHINWORK" FieldOptions="CAPTION(確定更新日時),HORIZONTAL" Order="0040"/></Function><Function ID="KF017B" InitialMsg="＊すでに確定されています。確定解除ボタンを押せば棚卸結果が解除されます。" KeyFields="" Name="棚卸確定解除" PrimaryTable="KT010" Size="AUTO" SubsystemID="K" Type="XF200" UpdateOnly="T"><Field DataSource="KT010.NRTANAOROSHI" FieldOptions="" Order="0010"/><Field DataSource="KT010.DTKIJYUN" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="確定解除" Number="9" Position="4"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫),HORIZONTAL" Order="0020"/><Field DataSource="KT010.DTKOUSHINWORK" FieldOptions="CAPTION(確定更新日時),HORIZONTAL" Order="0040"/></Function><Function AddRowListOrderBy="BT020.TXHINBAN" AddRowListReturnDataSources="CT011.PRSIIRETANKA;CT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;AT030.KBCURRENCY;CT011.KBSIIREUM;CT011.PRSIIRETANKA;CT011.PRSIIRETANKA;CT011.QTSIIRETANNI" AddRowListReturnToDetailDataSources="FT011.PRHATTYU;FT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;AT030.KBCURRENCY;FT011.KBSIIREUM;FT011.PRSIIRETANKA;FT011.PRHATTYU;FT011.QTHATTYU" AddRowListTable="CT011" AddRowListWhere="DTHAKKOU &lt;= 'SESSION_ATTRIBUTE:DateHattyu' AND DTSIKKOU >= 'SESSION_ATTRIBUTE:DateHattyu'" AddRowListWithFields="NRTORIHIKISAKI" AddRowListWithHeaderFields="FT010.NRTORIHIKISAKI" DetailKeyFields="" DetailRowNo="SQHATTYU" DetailTable="FT011" HeaderKeyFields="" HeaderTable="FT010" ID="FF012B" Name="発注見出し／明細の保守" Size="1830;500" SubsystemID="F" Type="XF310"><Field DataSource="FT010.NRHATTYU" FieldOptions="" Order="0010"/><Field DataSource="FT010.STHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT010.DTHATTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT010.NRTORIHIKISAKI" FieldOptions="" Order="0060"/><Field DataSource="FT010.TXTEKIYO" FieldOptions="WIDTH(1000)" Order="0090"/><Column DataSource="FT011.PRHATTYU" FieldOptions="" Order="0040"/><Column DataSource="FT011.QTHATTYU" FieldOptions="" Order="0060"/><Column DataSource="FT011.DTKIBOUNOUKI" FieldOptions="" Order="0110"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="商品／行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(入荷予定倉庫),HORIZONTAL,PROMPT_LIST" Order="0080"/><AddRowListColumn DataSource="CT011.DTHAKKOU" FieldOptions="" Order="0010"/><AddRowListColumn DataSource="CT011.DTSIKKOU" FieldOptions="" Order="0020"/><AddRowListColumn DataSource="CT011.QTSIIRETANNI" FieldOptions="" Order="0050"/><AddRowListColumn DataSource="CT011.PRSIIRETANKA" FieldOptions="CAPTION(契約仕入＠)" Order="0080"/><AddRowListColumn DataSource="CT011.VLKANZANKEISU" FieldOptions="CAPTION(換算係数)" Order="0070"/><AddRowListColumn DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(100)" Order="0030"/><AddRowListColumn DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(150)" Order="0040"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(CF210),PROMPT_CALL_TO_PUT(FT010.NRTORIHIKISAKI;FT010.DTHATTYU;FT010.DTHATTYU),PROMPT_CALL_TO_PUT_TO(CT010.NRTORIHIKISAKI;CT011.DTHAKKOU;CT011.DTSIKKOU),PROMPT_CALL_TO_GET(CT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;CT011.KBSIIREUM;CT011.PRSIIRETANKA;CT011.PRSIIRETANKA),PROMPT_CALL_TO_GET_TO(FT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;FT011.KBSIIREUM;FT011.PRSIIRETANKA;FT011.PRHATTYU)" Order="0010"/><Column DataSource="FT011.TXTEKIYO" FieldOptions="WIDTH(150)" Order="0120"/><Field DataSource="FT010.FGKAKUNIN" FieldOptions="HORIZONTAL" Order="0050"/><AddRowListButton Action="EXIT" Caption="閉じる" Number="3" Position="0"/><AddRowListButton Action="ADD_SELECTED" Caption="選択分追加" Number="6" Position="3"/><AddRowListColumn DataSource="CT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0060"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="FT011.QTHATTYUKANZAN" FieldOptions="" Order="0090"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050"/><AddRowListColumn DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0090"/><Field DataSource="FT010.DTKIBOUNOUKI" FieldOptions="HORIZONTAL" Order="0040"/><Column DataSource="FT011.PRSIIRETANKA" FieldOptions="CAPTION(契約仕入＠)" Order="0030"/><Column DataSource="FT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0080"/></Function><Function ID="FF012A" Name="発注見出し／明細の保守（連係）" Script="instance.callFunction('FF012B'); // 発注見出し／明細の保守 //#EOL#if (instance.returnMap.get('RETURN_CODE') == '20') {#EOL#&#x9;instance.parmMap.put('INITIAL_MESSAGE', '＊発注データが新規登録されました。必要に応じて発注書を発行してください。');#EOL#&#x9;instance.callFunction('FF013'); // 発注見出し／明細の検討 //#EOL#} else {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}#EOL#" SubsystemID="F" Type="XF000"/><Function HeaderFunction="CF121" HeaderKeyFields="" HeaderTable="CT110" ID="CF112" Name="支払依頼と関連情報の確認" Size="AUTO" SubsystemID="C" Type="XF300"><Field DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Field DataSource="CT110.DTSIHARAIIRAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="CT110.TXSEIKYUNO" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT110.TXTEKIYO" FieldOptions="" Order="0130"/><Field DataSource="CT110.FGSYOUNIN" FieldOptions="CAPTION(承認状況),HORIZONTAL" Order="0120"/><Field DataSource="CT110.NRSIHARAI" FieldOptions="HORIZONTAL" Order="0040"/><Detail Caption="支払明細" DetailFunction="CF113" InitialMsg="" KeyFields="NRSIHARAIIRAI;NRSIIRE" Order="0010" ParmAdditional="INSTANCE_MODE:EDIT" Table="CT100"><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0030"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="支払依頼情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0100"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0130"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0110"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0080"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0120"/><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0090"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="" Order="0050"/></Detail><Field DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="CT110.AMTAX" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="CT110AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0070"/><Detail Caption="支払実績" DetailFunction="CF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRSIIRE" Order="0020" Table="CT100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0030"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0040"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="支払依頼情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0020"/><Column DataSource="CT100.AMSIIRE" FieldOptions="CAPTION(税抜支払額)" Order="0060"/><Column DataSource="CT100.AMTAX" FieldOptions="CAPTION(税額)" Order="0070"/></Detail><Field DataSource="CT110AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/></Function><Function DetailFunction="CF122" ID="CF120" InitialMsg="" KeyFields="" Name="支払依頼データの一覧・承認" OrderBy="" PrimaryTable="CT110" Size="AUTO" SubsystemID="C" Type="XF100"><Column DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Column DataSource="CT110.DTSIHARAIIRAI" FieldOptions="CAPTION(支払依頼日)" Order="0030"/><Column DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="CT110.NRSIHARAIIRAI" FieldOptions="HORIZONTAL(44)" Order="0020"/><Filter DataSource="CT110.DTSIHARAIIRAI" FieldOptions="GE,CAPTION(依頼日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Filter DataSource="CT110.TXSEIKYUNO" FieldOptions="VERTICAL,CAPTION(請求番号)" Order="0040"/><Filter DataSource="CT110.FGSYOUNIN" FieldOptions="PROMPT_LIST1,CAPTION(承認区分),VALUE(VALUE:F)" Order="0050"/><Column DataSource="CT110AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0050"/><Column DataSource="CT110.FGSYOUNIN" FieldOptions="CAPTION(承認状況)" Order="0100"/><Column DataSource="CT110.AMTAX" FieldOptions="" Order="0090"/><Column DataSource="CT110.TXSEIKYUNO" FieldOptions="CAPTION(請求番号)" Order="0020"/><Column DataSource="CT110.NRSIHARAI" FieldOptions="" Order="0110"/><Column DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0060"/><Column DataSource="CT110AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0070"/></Function><Function ID="CF134" InitialMsg="＊Ｆ９を押せば、支払№がクリアされ支払指示から切り離されます。" KeyFields="" Name="支払依頼データの確認／支払指示取消" PrimaryTable="CT110" Size="AUTO" SubsystemID="C" Type="XF200" UpdateOnly="T"><Field DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Field DataSource="CT110.DTSIHARAIIRAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="CT110.TXSEIKYUNO" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT110.TXTEKIYO" FieldOptions="" Order="0130"/><Field DataSource="CT110.FGSYOUNIN" FieldOptions="CAPTION(承認状況),HORIZONTAL" Order="0120"/><Field DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0070"/><Field DataSource="CT110.AMTAX" FieldOptions="HORIZONTAL" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="切り離し" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="CT110AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="CT110.NRSIHARAIWORK" FieldOptions="CAPTION(支払指示№),HORIZONTAL" Order="0040"/><Field DataSource="CT110AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/></Function><Function AddBlankRowAllowed="F" DetailKeyFields="NRSIHARAIIRAI;NRSIIRE" DetailRowNo="" DetailTable="CT100" HeaderKeyFields="" HeaderTable="CT110" ID="CF123" InitialMsg="「承認」することで、経理での支払処理が可能になります。Ｆ５を押してください。" Name="支払依頼の承認" Size="AUTO" SubsystemID="C" Type="XF310"><Field DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Field DataSource="CT110.DTSIHARAIIRAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="CT110.TXSEIKYUNO" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT110.TXTEKIYO" FieldOptions="" Order="0110"/><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0030"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="承認" Number="5" Position="3"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0100"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0130"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Field DataSource="CT110AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="CT110.AMTAX" FieldOptions="HORIZONTAL" Order="0090"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0110"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0080"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0120"/><Field DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0060"/><Field DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="CT110AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0090"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="" Order="0050"/></Function><Function AddBlankRowAllowed="F" DetailKeyFields="NRSIHARAIIRAI;NRSIIRE" DetailRowNo="" DetailTable="CT100" HeaderKeyFields="" HeaderTable="CT110" ID="CF124" InitialMsg="Ｆ９を押せば承認取消されます。" Name="支払依頼の承認取消" Size="AUTO" SubsystemID="C" Type="XF310"><Field DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Field DataSource="CT110.DTSIHARAIIRAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="CT110.TXSEIKYUNO" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT110.TXTEKIYO" FieldOptions="" Order="0110"/><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0030"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="承認取消" Number="9" Position="4"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0130"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Field DataSource="CT110AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="CT110.AMTAX" FieldOptions="HORIZONTAL" Order="0090"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0100"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0110"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0080"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0120"/><Field DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0060"/><Field DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="CT110AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0090"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="" Order="0050"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="CT110" ID="CF125" Name="支払依頼データの確認" Size="AUTO" SubsystemID="C" Type="XF300"><Field DataSource="CT110.NRSIHARAIIRAI" FieldOptions="" Order="0010"/><Field DataSource="CT110.DTSIHARAIIRAI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="CT110.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="CT110.TXSEIKYUNO" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="CT110.TXTEKIYO" FieldOptions="" Order="0130"/><Field DataSource="CT110.FGSYOUNIN" FieldOptions="CAPTION(承認状況),HORIZONTAL" Order="0120"/><Field DataSource="CT110.NRSIHARAI" FieldOptions="HORIZONTAL" Order="0040"/><Detail Caption="支払明細" DetailFunction="CF101" InitialMsg="＊すでに経理での支払処理にまわっています。承認取消するためには経理担当者に支払取消を依頼してください。" KeyFields="NRSIHARAIIRAI;NRSIIRE" Order="0010" Table="CT100"><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0030"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0100"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0130"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0110"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0080"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0120"/><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0090"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="" Order="0050"/></Detail><Field DataSource="CT110.KBSIHARAIHOUHOU" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="CT110.AMTAX" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="CT110AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="CT110.AMSIHARAI" FieldOptions="" Order="0070"/><Field DataSource="CT110AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/></Function><Function DetailKeyFields="NRSIHARAI;NRSIHARAIIRAI" DetailTable="CT110" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="CT120" ID="CF135" Margins="50;50;50;50" Name="支払指示書の印刷" PageSize="A4" SubsystemID="C" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="5" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(支払指示書)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(支払指示№ )&amp;DataSource(CT120.NRSIHARAI)&amp;Text(　　支払日 )&amp;DataSource(CT120.DTSIHARAI)&amp;Text(　　支払方法 )&amp;DataSource(CT120.KBSIHARAIHOUHOU)&amp;Text(　　　通貨 )&amp;DataSource(CT120.KBCURRENCY)&amp;Text(　　　　　担当印 _______ 　経理部長印 _______)"/><Column Alignment="LEFT" DataSource="CT110.TXSEIKYUNO" FieldOptions="" Order="0010" Width="10"/><Column Alignment="LEFT" DataSource="CT110AT030.TXKANJI" FieldOptions="CAPTION(仕入先名)" Order="0020" Width="40"/><Column Alignment="LEFT" DataSource="CT110CT010.TXHURIKOMISAKI" FieldOptions="" Order="0030" Width="35"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;Text(　　　摘要 )&amp;DataSource(CT120.TXTEKIYO)"/><Column Alignment="RIGHT" DataSource="CT110.AMSIHARAIGOUKEI" FieldOptions="WITH_TOTAL" Order="0060" Width="10"/></Function><Function ID="CF113" InitialMsg="＊Ｆ９を押せば、支払依頼№がクリアされ支払依頼から切り離されます。" KeyFields="" Name="買掛増減履歴データの確認／支払切り離し" PrimaryTable="CT100" Size="AUTO" SubsystemID="C" Type="XF200" UpdateOnly="T"><Field DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Field DataSource="CT100.KBAKADEN" FieldOptions="CAPTION(伝票区分),HORIZONTAL(75)" Order="0020"/><Field DataSource="CT100.FGVALID" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0030"/><Field DataSource="CT100.KBSIIRE" FieldOptions="" Order="0040"/><Field DataSource="CT100.DTSIIRE" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="CT100.NRTORIHIKISAKI" FieldOptions="" Order="0080"/><Field DataSource="CT100.PRSIIRE" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="CT100.QTSIIRE" FieldOptions="" Order="0120"/><Field DataSource="CT100.KBSIIREUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0130"/><Field DataSource="CT100.AMSIIRE" FieldOptions="HORIZONTAL" Order="0150"/><Field DataSource="CT100.AMTAX" FieldOptions="HORIZONTAL(74)" Order="0180"/><Field DataSource="CT100.DTCREATE" FieldOptions="" Order="0190"/><Field DataSource="CT100.DTNEND" FieldOptions="CAPTION(年月度),HORIZONTAL" Order="0060"/><Field DataSource="CT100.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="切り離し" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／品名)" Order="0100"/><Field DataSource="CT110.NRSIHARAI" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="CT100.NRSIHARAIIRAIWORK" FieldOptions="CAPTION(支払依頼№),HORIZONTAL" Order="0200"/><Field DataSource="CT100.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0160"/><Field DataSource="CT100.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/><Field DataSource="CT100.AMSIIRENAIKA" FieldOptions="" Order="0170"/></Function><Function ID="DF116" InitialMsg="＊Ｆ９を押せば、請求№がクリアされ請求指示から切り離されます。" KeyFields="" Name="売掛増減履歴の確認／請求切り離し" PrimaryTable="DT100" Size="AUTO" SubsystemID="D" Type="XF200" UpdateOnly="T"><Field DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Field DataSource="DT100.KBAKADEN" FieldOptions="CAPTION(伝票区分),HORIZONTAL(79)" Order="0020"/><Field DataSource="DT100.FGVALID" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0030"/><Field DataSource="DT100.KBURIAGE" FieldOptions="" Order="0040"/><Field DataSource="DT100.DTURIAGE" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="DT100.NRTORIHIKISAKI" FieldOptions="" Order="0080"/><Field DataSource="DT100.PRURIAGE" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="DT100.QTURIAGE" FieldOptions="" Order="0130"/><Field DataSource="DT100.KBURIAGEUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0140"/><Field DataSource="DT100.AMURIAGE" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="DT100.AMTAX" FieldOptions="" Order="0180"/><Field DataSource="DT100.AMGENKA" FieldOptions="HORIZONTAL(74)" Order="0190"/><Field DataSource="DT100.DTCREATE" FieldOptions="HORIZONTAL" Order="0220"/><Field DataSource="DT100.AMARARI" FieldOptions="HORIZONTAL" Order="0200"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="切り離し" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／品名)" Order="0100"/><Field DataSource="DT100.DTNEND" FieldOptions="CAPTION(年月度),HORIZONTAL" Order="0060"/><Field DataSource="DT100.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="DT100.NRSEIKYUWORK" FieldOptions="CAPTION(請求№)" Order="0210"/><Field DataSource="DT100.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/></Function><Function DetailFunction="EF011" ID="EF210" InitialMsg="" KeyFields="" Name="在庫推移異状の一覧" OrderBy="ET010.DTSHORT;ET010.AMEXCESSSUMMARY(D)" PrimaryTable="ET010" Size="AUTO" SubsystemID="E" Type="XF100"><Filter DataSource="BT020.KBSYOHIN" FieldOptions="PROMPT_LIST2" Order="0"/><Filter DataSource="ET010.DTSUMMARY" FieldOptions="REFLECT,VALUE(SESSION_ATTRIBUTE:DateNextMonth)" Order="1"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="2"/><Filter DataSource="BT030.TXSOUKO" FieldOptions="VERTICAL,PROMPT_LIST1" Order="3"/><Filter DataSource="ET010.FGSHORT" FieldOptions="PROMPT_LIST1,VALUE(VALUE:T)" Order="4"/><Filter DataSource="ET010.FGEXCESS" FieldOptions="PROMPT_LIST1" Order="5"/><Column DataSource="BT030.TXSOUKO" FieldOptions="WIDTH(150)" Order="01"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(150)" Order="02"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(250)" Order="03"/><Column DataSource="ET010.QTGENZAIKO" FieldOptions="" Order="04"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="05"/><Column DataSource="ET010.DTSHORT" FieldOptions="" Order="06"/><Column DataSource="ET010.AMEXCESSSUMMARY" FieldOptions="" Order="07"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DataName="" ID="EF201" InitialMsg="" KeyFields="NRTORIHIKIKANRI" Name="受払予定データの表示" PrimaryTable="ET200" Size="AUTO" SubsystemID="E" Type="XF200"><Field DataSource="BT030A.TXSOUKO" FieldOptions="" Order="0040"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0070"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="ET200.DTYOTEI" FieldOptions="" Order="0010"/><Field DataSource="ET200.KBYOTEI" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="ET200.QTYOTEI" FieldOptions="" Order="0090"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ET200.TXAITESAKI" FieldOptions="" Order="0050"/><Field DataSource="ET200.NRSANSYOU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="ET200.TXTANTOU" FieldOptions="" Order="0060"/></Function><Function DetailFunction="EF201" ID="EF200" InitialMsg="" KeyFields="NRTORIHIKIKANRI" Name="受払予定データの一覧" OrderBy="ET200.DTYOTEI" PrimaryTable="ET200" Size="AUTO" SubsystemID="E" Type="XF100"><Filter DataSource="ET200.DTYOTEI" FieldOptions="GE,CAPTION(予定日≧)" Order="0"/><Filter DataSource="BT030A.TXSOUKO" FieldOptions="PROMPT_LIST1" Order="1"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="2"/><Column DataSource="ET200.DTYOTEI" FieldOptions="" Order="0010"/><Column DataSource="ET200.KBYOTEI" FieldOptions="" Order="0020"/><Column DataSource="BT030A.TXSOUKO" FieldOptions="WIDTH(100)" Order="0040"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(100)" Order="0050"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(200)" Order="0060"/><Column DataSource="ET200.TXAITESAKI" FieldOptions="WIDTH(200)" Order="0070"/><Column DataSource="ET200.QTYOTEI" FieldOptions="" Order="0080"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET200.NRSANSYOU" FieldOptions="" Order="0030"/></Function><Function ID="EF102" Name="受払履歴の元取引情報表示切替処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET100; var rFT012; var rHT020; var rGT012;#EOL#var rJT020; var rKT020; var rKT030; var rKT010;#EOL##EOL#///////////////////////////////////#EOL#// 当該受払履歴(ET100)の読み込み //#EOL#///////////////////////////////////#EOL#rET100 = instance.createTableOperator('Select', 'ET100');#EOL#rET100.setSelectFields('KBUKEBARAI, NRTORIHIKIKANRI');#EOL#rET100.addKeyValue('NRUKEBARAI',&#x9;instance.parmMap.get('NRUKEBARAI'));#EOL#if (rET100.next()) {#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 10(発注入荷) FT012 入荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '10') {#EOL#&#x9;&#x9;rFT012 = instance.createTableOperator('Select', 'FT012');#EOL#&#x9;&#x9;rFT012.setSelectFields('NRHATTYU, SQHATTYU, SQNYUKA');#EOL#&#x9;&#x9;rFT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rFT012.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRHATTYU', rFT013.getValueOf('NRHATTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQHATTYU', rFT013.getValueOf('SQHATTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQNYUKA', rFT013.getValueOf('SQNYUKA'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('FF042');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 11(直入荷), 12(仕入返品) HT020 特殊仕入 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '11' || rET100.getValueOf('KBUKEBARAI') == '12') {#EOL#&#x9;&#x9;rHT020 = instance.createTableOperator('Select', 'HT020');#EOL#&#x9;&#x9;rHT020.setSelectFields('NRTOKUSYUSIIRE');#EOL#&#x9;&#x9;rHT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rHT020.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRTOKUSYUSIIRE', rHT020.getValueOf('NRTOKUSYUSIIRE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('HF023');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 20(受注出荷) GT012 出荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '20') {#EOL#&#x9;&#x9;rGT012 = instance.createTableOperator('Select', 'GT012');#EOL#&#x9;&#x9;rGT012.setSelectFields('NRJYUTYU, SQJYUTYU, SQSYUKKA');#EOL#&#x9;&#x9;rGT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rGT012.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRJYUTYU', rGT012.getValueOf('NRJYUTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQJYUTYU', rGT012.getValueOf('SQJYUTYU'));#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('SQSYUKKA', rGT012.getValueOf('SQSYUKKA'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('GF042');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 21(直出荷), 22(売上返品) JT020 特殊売上 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '21' || rET100.getValueOf('KBUKEBARAI') == '22') {#EOL#&#x9;&#x9;rJT020 = instance.createTableOperator('Select', 'JT020');#EOL#&#x9;&#x9;rJT020.setSelectFields('NRTOKUSYUURIAGE');#EOL#&#x9;&#x9;rJT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rJT020.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRTOKUSYUURIAGE', rJT020.getValueOf('NRTOKUSYUURIAGE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('JF023');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////////#EOL#&#x9;// 30(移動出庫), 31(移動入庫) KT020 在庫移動指示 //#EOL#&#x9;///////////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '30' || rET100.getValueOf('KBUKEBARAI') == '31') {#EOL#&#x9;&#x9;rKT020 = instance.createTableOperator('Select', 'KT020');#EOL#&#x9;&#x9;rKT020.setSelectFields('NRZAIKOIDOU');#EOL#&#x9;&#x9;rKT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rKT020.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRZAIKOIDOU', rKT020.getValueOf('NRZAIKOIDOU'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF012');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////#EOL#&#x9;// 40(減耗), 41(評価損), 43(雑損) //#EOL#&#x9;// 50(雑益), 51(評価益)           //#EOL#&#x9;//          KT030 在庫振替        //#EOL#&#x9;////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '40' || rET100.getValueOf('KBUKEBARAI') == '41'#EOL#&#x9; || rET100.getValueOf('KBUKEBARAI') == '43' || rET100.getValueOf('KBUKEBARAI') == '50'#EOL#&#x9; || rET100.getValueOf('KBUKEBARAI') == '51') {#EOL#&#x9;&#x9;rKT030 = instance.createTableOperator('Select', 'KT030');#EOL#&#x9;&#x9;rKT030.setSelectFields('NRZAIKOHURIKAE');#EOL#&#x9;&#x9;rKT030.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rKT030.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRZAIKOHURIKAE', rKT030.getValueOf('NRZAIKOHURIKAE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF032');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////////////////////#EOL#&#x9;// 42(仕掛材料出庫), 52(仕掛完成入庫), 53(加工費繰入)        //#EOL#&#x9;//   KT030 在庫振替                                          //#EOL#&#x9;///////////////////////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '42'#EOL#&#x9; || rET100.getValueOf('KBUKEBARAI') == '52' || rET100.getValueOf('KBUKEBARAI') == '53') {#EOL#&#x9;&#x9;rKT030 = instance.createTableOperator('Select', 'KT030');#EOL#&#x9;&#x9;rKT030.setSelectFields('NRZAIKOHURIKAE');#EOL#&#x9;&#x9;rKT030.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rKT030.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRZAIKOHURIKAE', rLKT030.getValueOf('NRZAIKOHURIKAE'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF032');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 90(棚増棚減) KT010 棚卸指示 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '90') {#EOL#&#x9;&#x9;rKT010 = instance.createTableOperator('Select', 'KT010');#EOL#&#x9;&#x9;rKT010.setSelectFields('NRTANAOROSHI');#EOL#&#x9;&#x9;rKT010.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rKT010.next()) {#EOL#&#x9;&#x9;&#x9;instance.parmMap.put('NRTANAOROSHI', rKT010.getValueOf('NRTANAOROSHI'));#EOL#&#x9;&#x9;&#x9;instance.callFunction('KF012');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '取引の元情報が存在しません。');#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="E" Type="XF000"/><Function DataName="" ID="EF101" InitialMsg="" KeyFields="" Name="受払履歴データの表示" PrimaryTable="ET100" Size="AUTO" SubsystemID="E" Type="XF200"><Field DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Field DataSource="BT030A.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ)" Order="0080"/><Field DataSource="ET100.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0130"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0140"/><Field DataSource="ET100.DTUKEBARAI" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="ET100.KBAKADEN" FieldOptions="CAPTION(伝票区分),HORIZONTAL(55)" Order="0020"/><Field DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0040"/><Field DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0150"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0160"/><Field DataSource="ET100.DTCREATE" FieldOptions="HORIZONTAL" Order="0200"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ET100.FGVALID" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0030"/><Field DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0180"/><Field DataSource="ET100.AMSAGAKU" FieldOptions="HORIZONTAL" Order="0190"/><Field DataSource="ET100.DTNEND" FieldOptions="CAPTION(年月度),HORIZONTAL" Order="0060"/><Field DataSource="ET100.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Button Action="CALL(EF102)" Caption="元取引" Number="7" Position="4"/><Field DataSource="ET100.TXLOTNUMBER" FieldOptions="HORIZONTAL" Order="0170"/><Field DataSource="ET100.TXAITESAKI" FieldOptions="" Order="0100"/></Function><Function DetailFunction="EF101" ID="EF100" InitialMsg="" KeyFields="" Name="受払履歴データの一覧" OrderBy="ET100.DTUKEBARAI(D)" PrimaryTable="ET100" Size="AUTO" SubsystemID="E" Type="XF100"><Filter DataSource="ET100.DTUKEBARAI" FieldOptions="GE,CAPTION(受払日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="BT030A.TXSOUKO" FieldOptions="PROMPT_LIST1" Order="0020"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="0030"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0020"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Column DataSource="BT030A.TXSOUKO" FieldOptions="WIDTH(150)" Order="0060"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0080"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(150)" Order="0090"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0110"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0120"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.TXAITESAKI" FieldOptions="WIDTH(130)" Order="0070"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0040"/><Filter DataSource="ET100.FGVALID" FieldOptions="PROMPT_LIST1,VALUE(VALUE:T)" Order="0050"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="WIDTH(150)" Order="0100"/><Filter DataSource="ET100.TXLOTNUMBER" FieldOptions="SCAN,CAPTION(ロット№SCAN)" Order="0040"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="BT030" ID="BF110" Name="倉庫ロケ検索" Size="AUTO" SubsystemID="B" Type="XF300"><Field DataSource="BT030.NRSOUKO" FieldOptions="" Order="0000"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0010"/><Detail Caption="ロケ明細" DetailFunction="" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" ParmType="COLUMNS" Table="BT031"><Column DataSource="BT031.NRLOCATION" FieldOptions="" Order="0000"/><Column DataSource="BT031.TXTEKIYO" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/></Detail></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="CT010" ID="CF210" Name="仕入商品検索" Size="AUTO" SubsystemID="C" Type="XF300"><Field DataSource="CT010.NRTORIHIKISAKI" FieldOptions="" Order="0010"/><Detail Caption="取扱商品" DetailFunction="" HeaderKeyFields="" InitialMsg="" KeyFields="NRTORIHIKISAKI;NRSYOHIN" Order="0010" ParmType="COLUMNS" Table="CT011"><Column DataSource="CT011.DTHAKKOU" FieldOptions="" Order="0040"/><Column DataSource="CT011.DTSIKKOU" FieldOptions="VERTICAL" Order="0050"/><Column DataSource="CT011.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Column DataSource="CT011.QTSIIRETANNI" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(394)" Order="0030"/><Filter DataSource="CT011.DTHAKKOU" FieldOptions="LE,CAPTION(発効日≦)" Order="0010"/><Filter DataSource="CT011.DTSIKKOU" FieldOptions="GT,CAPTION(失効日＞)" Order="0020"/><Column DataSource="CT011.PRSIIRETANKA" FieldOptions="CAPTION(契約仕入＠)" Order="0060"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0070"/><Column DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0010"/><Column DataSource="CT011.VLKANZANKEISU" FieldOptions="" Order="0100"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(在庫U/M)" Order="0110"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/></Function><Function ContinueAdd="T" ID="FF014" InitialMsg="" KeyFields="" Name="発注明細の保守" PrimaryTable="FT011" Size="AUTO" SubsystemID="F" Type="XF200"><Field DataSource="FT011.NRHATTYU" FieldOptions="" Order="0010"/><Field DataSource="FT011.SQHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT011.PRHATTYU" FieldOptions="" Order="0160"/><Field DataSource="FT011.QTHATTYU" FieldOptions="HORIZONTAL" Order="0180"/><Field DataSource="FT011.DTKIBOUNOUKI" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="FT011.TXTEKIYO" FieldOptions="" Order="0220"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(CF210),PROMPT_CALL_TO_PUT(FT010.NRTORIHIKISAKI;FT010.DTHATTYU;FT010.DTHATTYU),PROMPT_CALL_TO_PUT_TO(CT010.NRTORIHIKISAKI;CT011.DTHAKKOU;CT011.DTSIKKOU),PROMPT_CALL_TO_GET(CT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;CT011.KBSIIREUM;CT011.PRSIIRETANKA;CT011.QTSIIRETANNI;CT011.PRSIIRETANKA),PROMPT_CALL_TO_GET_TO(FT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;FT011.KBSIIREUM;FT011.PRSIIRETANKA;FT011.QTSIIRETANNI;FT011.PRHATTYU)" Order="0080"/><Field DataSource="FT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="FT011.QTHATTYUKANZAN" FieldOptions="HORIZONTAL" Order="0200"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0210"/><Field DataSource="FT010.NRSOUKO" FieldOptions="CAPTION(入荷予定倉庫)" Order="0050"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0170"/><Field DataSource="FT011.PRSIIRETANKA" FieldOptions="" Order="0100"/><Field DataSource="FT011.KBSIIREUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0130"/><Field DataSource="FT011.QTSIIRETANNI" FieldOptions="HORIZONTAL" Order="0120"/></Function><Function AddBlankRowAllowed="T" DetailKeyFields="" DetailRowNo="SQNYUKA" DetailTable="FT012" HeaderKeyFields="" HeaderTable="FT011" ID="FF015" Name="発注明細別入荷予定の保守" Size="AUTO" SubsystemID="F" Type="XF310"><Field DataSource="FT011.NRHATTYU" FieldOptions="HORIZONTAL" Order="0010"/><Field DataSource="FT011.SQHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT011.PRHATTYU" FieldOptions="" Order="0110"/><Field DataSource="FT011.QTHATTYU" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="FT011.DTKIBOUNOUKI" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="FT011.TXTEKIYO" FieldOptions="" Order="0180"/><Column DataSource="FT012.DTYOTEINYUKA" FieldOptions="" Order="0010"/><Column DataSource="FT012.FGKAKUNIN" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(CF210),PROMPT_CALL_TO_PUT(FT010.NRTORIHIKISAKI;FT010.DTHATTYU;FT010.DTHATTYU),PROMPT_CALL_TO_PUT_TO(CT010.NRTORIHIKISAKI;CT011.DTHAKKOU;CT011.DTSIKKOU),PROMPT_CALL_TO_GET(CT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;CT011.KBSIIREUM),PROMPT_CALL_TO_GET_TO(FT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;FT011.KBSIIREUM)" Order="0090"/><Field DataSource="FT010.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Column DataSource="BT020A.TXSYOHIN" FieldOptions="WIDTH(200)" Order="0040"/><Column DataSource="BT020A.TXHINBAN" FieldOptions="WIDTH(150),PROMPT_CALL(CF210),PROMPT_CALL_TO_PUT(FT010.NRTORIHIKISAKI;FT010.DTHATTYU;FT010.DTHATTYU),PROMPT_CALL_TO_PUT_TO(CT010.NRTORIHIKISAKI;CT011.DTHAKKOU;CT011.DTSIKKOU),PROMPT_CALL_TO_GET(CT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;CT011.KBSIIREUM),PROMPT_CALL_TO_GET_TO(FT012.NRSYOHIN;BT020A.TXHINBAN;BT020A.TXSYOHIN;CT011A.KBSIIREUM)" Order="0030"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="FT010.DTHATTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT010.NRSOUKO" FieldOptions="CAPTION(入荷予定倉庫)" Order="0060"/><Column DataSource="BT020A.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Field DataSource="FT011.QTHATTYUKANZAN" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0170"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/><Column DataSource="FT012.QTYOTEINYUKO" FieldOptions="" Order="0080"/><Column DataSource="FT012.QTYOTEISIIRE" FieldOptions="" Order="0050"/><Field DataSource="FT011.KBSIIREUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Column DataSource="FT012.KBSIIREUM1" FieldOptions="" Order="0070"/></Function><Function DetailKeyFields="NRSYUKKA;NRJYUTYU;SQJYUTYU;SQSYUKKA" DetailTable="GT012" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="GT020" ID="GF021A" Margins="20;20;50;50" Name="出荷指示書の印刷" PageSize="A4" SubsystemID="G" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="3" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" AlignmentMargin="" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(出荷指示書)"/><Column Alignment="LEFT" DataSource="GT012.NRJYUTYU" FieldOptions="" Order="0010" Width="6"/><Column Alignment="RIGHT" DataSource="GT012.QTYOTEISYUKKA" FieldOptions="" Order="0050" Width="7"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0040" Width="29"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0030" Width="10"/><Column Alignment="CENTER" DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0060" Width="4"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(出荷№　)&amp;DataSource(GT020.NRSYUKKA)&amp;Text(　　出荷日 )&amp;DataSource(GT020.DTSYUKKA;jp11)&amp;Text(　倉庫 )&amp;DataSource(BT030GT020.TXSOUKO)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;Text(　顧客　)&amp;DataSource(GT020.NRTORIHIKISAKI)&amp;Text( )&amp;DataSource(AT030GT020.TXKANJI)&amp;Text(　出荷先 )&amp;DataSource(DT011GT020.TXKANJI)"/><Column Alignment="LEFT" DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0020" Width="5"/><Column Alignment="LEFT" DataSource="ET010.NRLOCATION" FieldOptions="CAPTION(ロケ)" Order="0070" Width="5"/><Column Alignment="LEFT" DataSource="GT012.TXLOTNUMBER" FieldOptions="" Order="0080" Width="31"/></Function><Function ID="GF021" Name="出荷指示書の印刷（発行日時更新）" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var uGT020;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#//////////////////////////////#EOL#// 出荷指示書印刷処理の起動 //#EOL#//////////////////////////////#EOL#instance.callFunction('GF021A');#EOL##EOL#////////////////////#EOL#// 発行日時の更新 //#EOL#////////////////////#EOL#uGT020 = instance.createTableOperator('Update', 'GT020');#EOL#uGT020.addValue('TMHAKKOU',&#x9;session.getTimeStamp());#EOL#uGT020.addKeyValue('NRSYUKKA',&#x9;instance.parmMap.get('NRSYUKKA'));#EOL#count = uGT020.execute();#EOL#if (count == 1) {#EOL#&#x9;instance.returnMap.put('RETURN_CODE', '10');#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊出荷指示書が発行されました。');#EOL#} else {#EOL#&#x9;errorMessage = '出荷見出し(GT020)の更新に失敗しました。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}" SubsystemID="G" Type="XF000"/><Function ID="HF023" Name="特殊仕入別取引実績の検討(切替)" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rHT020;#EOL##EOL#///////////////////////////////////#EOL#// 当該特殊仕入(HT020)の読み込み //#EOL#///////////////////////////////////#EOL#rHT020 = instance.createTableOperator('Select', 'HT020');#EOL#rHT020.setSelectFields('KBTOKUSYUSIIRE');#EOL#rHT020.addKeyValue('NRTOKUSYUSIIRE',&#x9;instance.parmMap.get('NRTOKUSYUSIIRE'));#EOL#if (rHT020.next()) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 区分に従って関連機能を起動 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;if (rHT020.getValueOf('KBTOKUSYUSIIRE') == '10') {#EOL#&#x9;&#x9;  instance.callFunction('HF023A'); //仕入返品別取引実績の検討//#EOL#&#x9;} else {#EOL#&#x9;&#x9;if (rHT020.getValueOf('KBTOKUSYUSIIRE') == '20') {#EOL#&#x9;&#x9;&#x9;  instance.callFunction('HF023B'); //直入荷別取引実績の検討//#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="H" Type="XF000"/><Function HeaderFunction="HF021B" HeaderKeyFields="" HeaderTable="HT020" ID="HF023A" Name="仕入返品別取引実績の検討" Size="AUTO" SubsystemID="H" Type="XF300"><Field DataSource="HT020.NRTOKUSYUSIIRE" FieldOptions="" Order="0010"/><Field DataSource="HT020.KBTOKUSYUSIIRE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="HT020.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="HT020.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="HT020.NRSOUKO" FieldOptions="CAPTION(倉庫／ロケ)" Order="0080"/><Detail Caption="買掛増減履歴" DetailFunction="CF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRSIIRE" Order="0010" Table="CT100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0050"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="返品情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0070"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0120"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0080"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0060"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0090"/><Button Action="CALL(HF022)" Caption="通知書" Number="10" Position="5"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0100"/><Column DataSource="CT100.AMSIIRENAIKA" FieldOptions="" Order="0110"/></Detail><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0020" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="返品情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.NRSOUKO" FieldOptions="" Order="0060"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0090"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0110"/><Column DataSource="ET100.AMSAGAKU" FieldOptions="" Order="0120"/><Button Action="CALL(HF022)" Caption="通知書" Number="10" Position="5"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0070"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="WIDTH(150)" Order="0080"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0060"/><Field DataSource="HT020.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="HT020.QTTORIHIKI" FieldOptions="CAPTION(返品数量)" Order="0120"/><Field DataSource="HT020.QTTORIHIKIKANZAN" FieldOptions="HORIZONTAL(26)" Order="0140"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Field DataSource="HT020.PRTORIHIKI" FieldOptions="CAPTION(返品単価)" Order="0160"/><Field DataSource="HT020.AMTORIHIKI" FieldOptions="CAPTION(税抜返品額)" Order="0190"/><Field DataSource="HT020.TXTEKIYO" FieldOptions="" Order="0230"/><Field DataSource="HT020.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0220"/><Field DataSource="HT020.KBTORIHIKIUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0130"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0170"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0200"/><Field DataSource="HT020.TXLOTNUMBER" FieldOptions="" Order="0110"/><Field DataSource="HT020.AMTORIHIKINAIKA" FieldOptions="CAPTION(内貨税抜返品額),HORIZONTAL" Order="0210"/><Field DataSource="HT020.PRUKEBARAI" FieldOptions="CAPTION(出庫単価),HORIZONTAL" Order="0180"/></Function><Function HeaderFunction="HF021B" HeaderKeyFields="" HeaderTable="HT020" ID="HF023B" Name="直接入荷別取引実績の検討" Size="AUTO" SubsystemID="H" Type="XF300"><Field DataSource="HT020.NRTOKUSYUSIIRE" FieldOptions="" Order="0010"/><Field DataSource="HT020.KBTOKUSYUSIIRE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="HT020.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="HT020.DTTORIHIKI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="HT020.NRSOUKO" FieldOptions="CAPTION(倉庫／ロケ)" Order="0080"/><Detail Caption="買掛増減履歴" DetailFunction="CF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRSIIRE" Order="0010" Table="CT100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0050"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="直入荷情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0070"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0120"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0080"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0060"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0090"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0100"/><Column DataSource="CT100.AMSIIRENAIKA" FieldOptions="" Order="0110"/></Detail><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0020" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="直入荷情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.NRSOUKO" FieldOptions="" Order="0060"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0090"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0110"/><Column DataSource="ET100.AMSAGAKU" FieldOptions="" Order="0120"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0070"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="WIDTH(150)" Order="0080"/></Detail><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0060"/><Field DataSource="HT020.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="HT020.QTTORIHIKI" FieldOptions="CAPTION(検収数量)" Order="0120"/><Field DataSource="HT020.QTTORIHIKIKANZAN" FieldOptions="HORIZONTAL(26)" Order="0140"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Field DataSource="HT020.PRTORIHIKI" FieldOptions="CAPTION(仕入単価)" Order="0160"/><Field DataSource="HT020.AMTORIHIKI" FieldOptions="" Order="0190"/><Field DataSource="HT020.TXTEKIYO" FieldOptions="" Order="0230"/><Field DataSource="HT020.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0220"/><Field DataSource="HT020.KBTORIHIKIUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0130"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0170"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0200"/><Field DataSource="HT020.TXLOTNUMBER" FieldOptions="" Order="0110"/><Field DataSource="HT020.AMTORIHIKINAIKA" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="HT020.PRUKEBARAI" FieldOptions="CAPTION(入庫単価),HORIZONTAL" Order="0180"/></Function><Function AddBlankRowAllowed="T" AddRowListOrderBy="GT010.DTJYUTYU" AddRowListReturnDataSources="" AddRowListReturnToDetailDataSources="" AddRowListTable="GT011" AddRowListWithFields="NRTORIHIKISAKI" AddRowListWithHeaderFields="GT010.NRTORIHIKISAKI" DetailKeyFields="" DetailRowNo="SQJYUTYU" DetailTable="GT011" HeaderKeyFields="" HeaderTable="GT010" ID="GF012B" Name="受注見出し／明細の保守" Size="AUTO" SubsystemID="G" Type="XF310"><Field DataSource="GT010.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT010.STJYUTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT010.DTJYUTYU" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="GT010.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="GT010.TXTEKIYO" FieldOptions="WIDTH(1030)" Order="0130"/><Column DataSource="GT011.PRJYUTYU" FieldOptions="" Order="0050"/><Column DataSource="GT011.QTJYUTYU" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="履歴／行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先),PROMPT_LIST" Order="0080"/><Column DataSource="GT011.DTKIBOUNOUKI" FieldOptions="" Order="0080"/><Column DataSource="GT011.TXTEKIYO" FieldOptions="WIDTH(200)" Order="0090"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(200)" Order="0030"/><Column DataSource="BT020.TXHINBAN" FieldOptions="PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.TXSIYOU;BT020.KBZAIKOUM;BT020.PRHANBAI),PROMPT_CALL_TO_GET_TO(GT011.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.TXSIYOU;BT020.KBZAIKOUM;BT020.PRHANBAI)" Order="0020"/><Column DataSource="BT020.TXSIYOU" FieldOptions="WIDTH(200)" Order="0040"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0070"/><AddRowListColumn DataSource="GT011.PRJYUTYU" FieldOptions="" Order="0040"/><AddRowListColumn DataSource="GT011.QTJYUTYU" FieldOptions="" Order="0050"/><AddRowListColumn DataSource="GT010.DTJYUTYU" FieldOptions="" Order="0010"/><AddRowListColumn DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><AddRowListColumn DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Field DataSource="GT010.DTKIBOUNOUKI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(50)" Order="0100"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/><Field DataSource="GT010.TXTYUBAN" FieldOptions="HORIZONTAL" Order="0020"/><AddRowListButton Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(出荷予定倉庫),PROMPT_LIST" Order="0090"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT020.PRHANBAI" FieldOptions="" Order="0041"/><AddRowListButton Action="ADD_BLANK" Caption="空白行追加" Number="6" Position="3"/><Field DataSource="GT010.NRMITSUMORI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(50)" Order="0110"/><Field DataSource="GT010.SQVERSION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/></Function><Function ID="GF012A" Name="受注見出し／明細の保守(連係)" Script="instance.callFunction('GF012B'); //受注見出し／明細の保守//#EOL#if (instance.returnMap.get('RETURN_CODE') == '20') {#EOL#&#x9;instance.parmMap.put('NRJYUTYU', instance.returnMap.get('NRJYUTYU'));#EOL#&#x9;instance.parmMap.put('INITIAL_MESSAGE', '＊データは正常に更新されました。');#EOL#&#x9;instance.callFunction('GF013'); //受注見出し／明細の検討//#EOL#} else {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}#EOL#" SubsystemID="G" Type="XF000"/><Function AddBlankRowAllowed="T" AddRowListReturnDataSources="ET010.NRSOUKO;BT030.TXSOUKO" AddRowListReturnToDetailDataSources="GT012.NRSOUKO;BT030.TXSOUKO" AddRowListTable="ET010" AddRowListWithFields="NRSYOHIN" AddRowListWithHeaderFields="GT011.NRSYOHIN" DetailKeyFields="" DetailRowNo="SQSYUKKA" DetailTable="GT012" HeaderKeyFields="" HeaderTable="GT011" ID="GF015" InitialMsg="必要に応じて、受注商品毎の出荷予定を入力してください。" Name="受注明細別出荷予定の保守" Size="AUTO" SubsystemID="G" Type="XF310"><Field DataSource="GT011.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT011.SQJYUTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT011.PRJYUTYU" FieldOptions="HORIZONTAL(35)" Order="0150"/><Field DataSource="GT011.QTJYUTYU" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="GT011.DTKIBOUNOUKI" FieldOptions="" Order="0120"/><Column DataSource="GT012.DTYOTEISYUKKA" FieldOptions="" Order="0010"/><Column DataSource="GT012.QTYOTEISYUKKA" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Field DataSource="GT011.TXTEKIYO" FieldOptions="WIDTH(980)" Order="0160"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／品名)" Order="0080"/><Field DataSource="BT020.TXSIYOU" FieldOptions="" Order="0100"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0140"/><Column DataSource="BT030.TXSOUKO" FieldOptions="PROMPT_LIST" Order="0020"/><AddRowListColumn DataSource="ET010.QTGENZAIKO" FieldOptions="" Order="0030"/><AddRowListColumn DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫)" Order="0020"/><AddRowListColumn DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0040"/><AddRowListButton Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Field DataSource="GT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL" Order="0110"/><Column DataSource="GT012.TXZAIKOCHECK" FieldOptions="PROMPT_CALL(EF300),PROMPT_CALL_TO_PUT(GT011.NRSYOHIN;GT012.NRSOUKO),PROMPT_CALL_TO_PUT_TO(ET010.NRSYOHIN;ET010.NRSOUKO)" Order="0030"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0050"/><Column DataSource="GT012.NRSYUKKA" FieldOptions="" Order="0060"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先)" Order="0060"/><Field DataSource="DT011.VLUNSOULT" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0070"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0050"/></Function><Function DetailFunction="ZF081" ID="ZF080" InitialListing="T" InitialMsg="" KeyFields="" Name="年次為替レートの一覧・保守" OrderBy="" PrimaryTable="ZT080" Size="AUTO" SubsystemID="Z" Type="XF100"><Column DataSource="ZT080.KBCURRENCY" FieldOptions="CAPTION(通貨)" Order="0010"/><Column DataSource="ZT080.DTNEND" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ZT080.KBCURRENCY" FieldOptions="PROMPT_LIST1,CAPTION(通貨)" Order="0010"/><Filter DataSource="ZT080.DTNEND" FieldOptions="" Order="0020"/><Column DataSource="ZT080.VLRATEB" FieldOptions="" Order="0030"/><Column DataSource="ZT080.VLRATEM" FieldOptions="" Order="0040"/><Column DataSource="ZT080.VLRATES" FieldOptions="" Order="0050"/></Function><Function ContinueAdd="T" ID="ZF081" InitialMsg="" KeyFields="" Name="年次為替レートの保守" PrimaryTable="ZT080" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT080.KBCURRENCY" FieldOptions="" Order="0010"/><Field DataSource="ZT080.DTNEND" FieldOptions="HORIZONTAL" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ZT080.VLRATEB" FieldOptions="" Order="0030"/><Field DataSource="ZT080.VLRATEM" FieldOptions="" Order="0040"/><Field DataSource="ZT080.VLRATES" FieldOptions="" Order="0050"/></Function><Function DetailFunction="ZF083" ID="ZF082" InitialListing="T" InitialMsg="" KeyFields="" Name="月次為替レートの一覧・保守" OrderBy="" PrimaryTable="ZT081" Size="AUTO" SubsystemID="Z" Type="XF100"><Column DataSource="ZT081.KBCURRENCY" FieldOptions="CAPTION(通貨)" Order="0010"/><Column DataSource="ZT081.DTNEND" FieldOptions="" Order="0020"/><Column DataSource="ZT081.DTMSEQ" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ZT081.KBCURRENCY" FieldOptions="PROMPT_LIST1,CAPTION(通貨)" Order="0010"/><Filter DataSource="ZT081.DTNEND" FieldOptions="" Order="0020"/><Column DataSource="ZT081.VLRATEB" FieldOptions="" Order="0050"/><Column DataSource="ZT081.VLRATEM" FieldOptions="" Order="0060"/><Column DataSource="ZT081.VLRATES" FieldOptions="" Order="0070"/></Function><Function ContinueAdd="T" ID="ZF083" InitialMsg="" KeyFields="" Name="月次為替レートの保守" PrimaryTable="ZT081" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT081.KBCURRENCY" FieldOptions="" Order="0010"/><Field DataSource="ZT081.DTNEND" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="ZT081.DTMSEQ" FieldOptions="HORIZONTAL" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ZT081.VLRATEB" FieldOptions="" Order="0050"/><Field DataSource="ZT081.VLRATEM" FieldOptions="" Order="0060"/><Field DataSource="ZT081.VLRATES" FieldOptions="" Order="0070"/></Function><Function DetailFunction="CF101" ID="CF140" InitialMsg="" KeyFields="" Name="買掛増減履歴の一覧（記録日時順）" OrderBy="CT100.DTCREATE" PrimaryTable="CT100" Size="AUTO" SubsystemID="C" Type="XF100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0020"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0050"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0060"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0040"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.NRTORIHIKISAKI" FieldOptions="" Order="0070"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0130"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0150"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0110"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0120"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0140"/><Column DataSource="CT100.AMTAX" FieldOptions="" Order="0180"/><Column DataSource="CT100.DTCREATE" FieldOptions="" Order="0010"/><Column DataSource="CT100.DTNEND" FieldOptions="" Order="0190"/><Column DataSource="CT100.DTMSEQ" FieldOptions="" Order="0200"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(仕入先名),WIDTH(190)" Order="0080"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(150)" Order="0090"/><Filter DataSource="CT100.DTCREATE" FieldOptions="GENERIC,CAPTION(追加日時上位桁),VALUE(SESSION_ATTRIBUTE:TodayWithSlash)" Order="0010"/><Column DataSource="CT100.TXSYOHIN" FieldOptions="WIDTH(190)" Order="0100"/><Column DataSource="CT100.AMSIIRENAIKA" FieldOptions="" Order="0170"/></Function><Function DetailFunction="DF101" ID="DF130" InitialMsg="" KeyFields="" Name="売掛増減履歴の一覧（記録日時順）" OrderBy="DT100.DTCREATE" PrimaryTable="DT100" Size="AUTO" SubsystemID="D" Type="XF100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0020"/><Column DataSource="DT100.KBAKADEN" FieldOptions="" Order="0050"/><Column DataSource="DT100.FGVALID" FieldOptions="" Order="0060"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0040"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="DT100.DTCREATE" FieldOptions="GENERIC,CAPTION(追加日時上位桁),VALUE(SESSION_ATTRIBUTE:TodayWithSlash)" Order="0010"/><Column DataSource="DT100.NRTORIHIKISAKI" FieldOptions="" Order="0070"/><Column DataSource="DT100.PRHANBAI" FieldOptions="" Order="0170"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0180"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0150"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0160"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0200"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0210"/><Column DataSource="DT100.AMGENKA" FieldOptions="" Order="0220"/><Column DataSource="DT100.NRJYUGYOIN" FieldOptions="" Order="0090"/><Column DataSource="DT100.DTCREATE" FieldOptions="" Order="0010"/><Column DataSource="DT100.DTNEND" FieldOptions="" Order="0240"/><Column DataSource="DT100.DTMSEQ" FieldOptions="" Order="0250"/><Column DataSource="DT100.AMNEBIKI" FieldOptions="" Order="0190"/><Column DataSource="DT100.AMARARI" FieldOptions="" Order="0230"/><Column DataSource="AT030.TXKANJI" FieldOptions="CAPTION(顧客名),WIDTH(190)" Order="0080"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(150)" Order="0110"/><Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(担当営業名),WIDTH(150)" Order="0100"/><Column DataSource="DT100.TXSYOHIN" FieldOptions="WIDTH(190)" Order="0120"/></Function><Function DetailFunction="EF101" ID="EF110" InitialMsg="" KeyFields="" Name="受払履歴の一覧（記録日時順）" OrderBy="" PrimaryTable="ET100" Size="AUTO" SubsystemID="E" Type="XF100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0020"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0050"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0060"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0030"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="ET100.DTCREATE" FieldOptions="GENERIC,CAPTION(追加日時上位桁),VALUE(SESSION_ATTRIBUTE:TodayWithSlash)" Order="0010"/><Column DataSource="ET100.NRSOUKO" FieldOptions="" Order="0110"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0130"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0150"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0170"/><Column DataSource="ET100.AMSAGAKU" FieldOptions="" Order="0180"/><Column DataSource="ET100.DTCREATE" FieldOptions="" Order="0010"/><Column DataSource="ET100.DTNEND" FieldOptions="" Order="0190"/><Column DataSource="ET100.DTMSEQ" FieldOptions="" Order="0200"/><Column DataSource="ET100.TXAITESAKI" FieldOptions="WIDTH(190)" Order="0140"/><Column DataSource="BT030A.TXSOUKO" FieldOptions="WIDTH(190)" Order="0120"/><Column DataSource="BT020.TXHINBAN" FieldOptions="WIDTH(150)" Order="0070"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(190)" Order="0080"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0160"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="WIDTH(150)" Order="0100"/></Function><Function ID="ZF900" Name="パージ処理の起動" Script="//////////////////////////#EOL#// Javaパッケージの導入 //#EOL#//////////////////////////#EOL#var importedPackage = new JavaImporter(java.lang, java.awt, javax.swing);#EOL#with (importedPackage) {#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// ダイアログ要素の設定 //#EOL#&#x9;//////////////////////////#EOL#&#x9;var panel = new JPanel();#EOL#&#x9;panel.setPreferredSize(new Dimension(310, 180));#EOL#&#x9;panel.setBorder(BorderFactory.createEtchedBorder());#EOL#&#x9;var labelDate = new JLabel();#EOL#&#x9;labelDate.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;labelDate.setHorizontalAlignment(SwingConstants.RIGHT);#EOL#&#x9;labelDate.setHorizontalTextPosition(SwingConstants.LEADING);#EOL#&#x9;labelDate.setText('パージ基準日付');#EOL#&#x9;labelDate.setBounds(new Rectangle(10, 10, 100, 15));#EOL#&#x9;var textFieldDate = new JTextField();#EOL#&#x9;textFieldDate.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;textFieldDate.setBounds(new Rectangle(120, 8, 85, 22));#EOL#&#x9;textFieldDate.setText('0000-00-00');#EOL#&#x9;var textAreaMessage = new JTextArea();#EOL#&#x9;textAreaMessage.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;textAreaMessage.setEditable(false);#EOL#&#x9;textAreaMessage.setLineWrap(true);#EOL#&#x9;textAreaMessage.setText('＊チェックされた対象について、上の日付を含めそれ以前の取引日を持つデータをクリアします。実行前に必ずＤＢをバックアップしてください。');#EOL#&#x9;var scrollPaneMessage = new JScrollPane();#EOL#&#x9;scrollPaneMessage.getViewport().add(textAreaMessage);#EOL#&#x9;scrollPaneMessage.setBounds(new Rectangle(9, 37, 291, 85));#EOL#&#x9;var checkBoxTransactionData = new JCheckBox();#EOL#&#x9;checkBoxTransactionData.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;checkBoxTransactionData.setText('トランザクションデータ');#EOL#&#x9;checkBoxTransactionData.setBounds(new Rectangle(10, 128, 200, 22));#EOL#&#x9;var checkBoxSessionLog = new JCheckBox();#EOL#&#x9;checkBoxSessionLog.setFont(new java.awt.Font('Dialog', 0, 14));#EOL#&#x9;checkBoxSessionLog.setText('セッションログ');#EOL#&#x9;checkBoxSessionLog.setBounds(new Rectangle(10, 152, 200, 22));#EOL#&#x9;panel.setLayout(null);#EOL#&#x9;panel.add(labelDate);#EOL#&#x9;panel.add(textFieldDate);#EOL#&#x9;panel.add(scrollPaneMessage);#EOL#&#x9;panel.add(checkBoxTransactionData);#EOL#&#x9;panel.add(checkBoxSessionLog);#EOL#&#x9;var btnArray = java.lang.reflect.Array.newInstance(java.lang.String, 2);#EOL#&#x9;btnArray[0] = ' 閉じる '; btnArray[1] = ' 実行 ';#EOL##EOL#&#x9;////////////////#EOL#&#x9;// 変数の定義 //#EOL#&#x9;////////////////#EOL#&#x9;var hasError = true; var reply = 0; var workCount = 0; var totalCount = 0;#EOL##EOL#&#x9;//////////////////////////////#EOL#&#x9;// 起動確認ダイアログの表示 //#EOL#&#x9;//////////////////////////////#EOL#&#x9;while (hasError) {#EOL#&#x9;&#x9;reply = JOptionPane.showOptionDialog(null, panel, '処理条件の設定', JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null, btnArray, btnArray[0]);#EOL#&#x9;&#x9;if (reply == 1) {#EOL#&#x9;&#x9;&#x9;if (!session.isValidDateFormat(textFieldDate.getText(), '-')) {#EOL#&#x9;&#x9;&#x9;&#x9;JOptionPane.showMessageDialog(null, '正しい日付を指定してください');#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;if (!checkBoxTransactionData.isSelected() &amp;&amp; !checkBoxSessionLog.isSelected()) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;JOptionPane.showMessageDialog(null, 'パージ処理の対象を選択してください');#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;hasError = false;#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;hasError = false;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////#EOL#&#x9;// パージ処理の起動 //#EOL#&#x9;//////////////////////#EOL#&#x9;if (reply == 1) {#EOL##EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// パラメータのセット //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;instance.parmMap.put('LIMIT_DATE', textFieldDate.getText());#EOL##EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;// 取引実績のパージ処理 //#EOL#&#x9;&#x9;//////////////////////////#EOL#&#x9;&#x9;if (checkBoxTransactionData.isSelected()) {#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('CF990'); // 支払指示･依頼パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('CT110');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('CT120');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('DF990'); // 請求･受領パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('DT110');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('DT120');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('FF990'); // 発注･入荷パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('FT010');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('FT011');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('FT012');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('FT013');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('FT020');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('GF990'); // 受注･出荷パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('GT010');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('GT011');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('GT012');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('GT013');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('GT020');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('HF990'); // 一般仕入取引パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('HT010');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('HT020');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('JF990'); // 一般売上取引パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('JT010');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('JT020');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('KF990'); // 一般在庫取引パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('KT010');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('KT011');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('KT020');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('KT021');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('LF990'); // 在庫振替パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('LT010');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('LT011');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('LT020');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('CF999'); // 仕入実績パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('CT100');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('DF999'); // 売上実績パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('DT100');#EOL#&#x9;&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('EF999'); // 受払実績パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('ET100');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////////////////#EOL#&#x9;&#x9;// セッション履歴のパージ処理 //#EOL#&#x9;&#x9;////////////////////////////////#EOL#&#x9;&#x9;if (checkBoxSessionLog.isSelected()) {#EOL#&#x9;&#x9;&#x9;if (!hasError) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.callFunction('ZF999'); // セッション履歴パージ処理 //#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('ZT050');#EOL#&#x9;&#x9;&#x9;&#x9;summarizeCountOfDeleted('ZT051');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;//////////////#EOL#&#x9;&#x9;// 終了処理 //#EOL#&#x9;&#x9;//////////////#EOL#&#x9;&#x9;if (hasError) {#EOL#&#x9;&#x9;&#x9;instance.rollback();#EOL#&#x9;&#x9;&#x9;instance.cancelWithMessage('＊パージ処理に失敗しました。');#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;if (checkBoxTransactionData.isSelected()) {#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('CT110');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('CT110 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('CT120');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('CT120 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('DT110');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('DT110 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('DT120');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('DT120 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('FT010');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('FT010 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('FT011');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('FT011 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('FT012');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('FT012 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('FT013');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('FT013 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('FT020');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('FT020 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('GT010');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('GT010 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('GT011');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('GT011 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('GT012');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('GT012 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('GT013');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('GT013 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('GT020');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('GT020 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('HT010');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('HT010 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('HT020');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('HT020 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('JT010');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('JT010 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('JT020');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('JT020 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('KT010');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('KT010 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('KT011');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('KT011 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('KT020');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('KT020 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('KT021');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('KT021 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('LT010');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('LT010 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('LT011');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('LT011 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('LT020');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('LT020 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('CT100');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('CT100 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('DT100');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('DT100 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('ET100');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('ET100 compressed.');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;if (checkBoxSessionLog.isSelected()) {#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('ZT050');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('ZT050 compressed.');#EOL#&#x9;&#x9;&#x9;&#x9;session.compressTable('ZT051');#EOL#&#x9;&#x9;&#x9;&#x9;instance.setProcessLog('ZT051 compressed.');#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;instance.commit();#EOL#&#x9;&#x9;&#x9;instance.setProcessLog('削除／コンプレス処理がコミットされました。');#EOL#&#x9;&#x9;&#x9;var message = '＊パージ処理が完了しました。合計' + totalCount + 'レコードが削除されました。';#EOL#&#x9;&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', message);#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;} else {#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊パージ処理は取り消されました。');#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////////#EOL#&#x9;// 内部関数：テーブル別削除件数の処理 //#EOL#&#x9;////////////////////////////////////////#EOL#&#x9;function summarizeCountOfDeleted(tableID) {#EOL#&#x9;&#x9;workCount = parseInt(instance.returnMap.get(tableID + '_COUNT'));#EOL#&#x9;&#x9;if (workCount == -1) {#EOL#&#x9;&#x9;&#x9;hasError = true;#EOL#&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;instance.setProcessLog(tableID + 'の' + workCount + '件が削除されました');#EOL#&#x9;&#x9;&#x9;totalCount = totalCount + workCount;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}" SubsystemID="Z" TimerOption="CONSOLE" Type="XF000"/><Function ID="CF990" Name="支払指示･依頼パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT120; var dCT120; var rCT110; var dCT110;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countCT110_ToBeDeleted = 0; var countCT110_Deleted = 0;#EOL#var countCT120_ToBeDeleted = 0; var countCT120_Deleted = 0; var wrkInt = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('CT110_COUNT', -1);#EOL#instance.returnMap.put('CT120_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// CT120 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rCT120 = instance.createTableOperator('Select', 'CT120');#EOL#rCT120.setSelectFields('NRSIHARAI');#EOL#rCT120.addKeyValue('DTSIHARAI &lt;=',&#x9;limitDate);#EOL#while (rCT120.next()) {#EOL##EOL#&#x9;countCT120_ToBeDeleted++;#EOL##EOL#&#x9;//////////////////////////////#EOL#&#x9;// CT110 削除対象件数の検索 //#EOL#&#x9;//////////////////////////////#EOL#&#x9;rCT110 = instance.createTableOperator('Count', 'CT110');#EOL#&#x9;rCT110.addKeyValue('NRSIHARAI',&#x9;rCT120.getValueOf('NRSIHARAI'));#EOL#&#x9;wrkInt = rCT110.execute();#EOL#&#x9;countCT110_ToBeDeleted = Number(countCT110_ToBeDeleted) + Number(wrkInt);#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// CT110 削除処理 //#EOL#&#x9;////////////////////#EOL#&#x9;dCT110 = instance.createTableOperator('Delete', 'CT110');#EOL#&#x9;dCT110.addKeyValue('NRSIHARAI',&#x9;rCT120.getValueOf('NRSIHARAI'));#EOL#&#x9;wrkInt = dCT110.execute();#EOL#&#x9;countCT110_Deleted = Number(countCT110_Deleted) + Number(wrkInt);#EOL#}#EOL##EOL#//////////////////////////#EOL#// CT110 削除結果の登録 //#EOL#//////////////////////////#EOL#if (countCT110_Deleted == countCT110_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('CT110_COUNT', countCT110_ToBeDeleted);#EOL#}#EOL##EOL#////////////////////////////////////#EOL#// CT120 削除処理＆削除結果の登録 //#EOL#////////////////////////////////////#EOL#dCT120 = instance.createTableOperator('Delete', 'CT120');#EOL#dCT120.addKeyValue('DTSIHARAI &lt;=',&#x9;limitDate);#EOL#countCT120_Deleted = dCT120.execute();#EOL#if (countCT120_Deleted == countCT120_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('CT120_COUNT', countCT120_ToBeDeleted);#EOL#}" SubsystemID="C" Type="XF000"/><Function ID="DF990" Name="請求･受領パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rDT110; var dDT110; var rDT120; var dDT120;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countDT110_ToBeDeleted = 0; var countDT110_Deleted = 0;#EOL#var countDT120_ToBeDeleted = 0; var countDT120_Deleted = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('DT110_COUNT', -1);#EOL#instance.returnMap.put('DT120_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// DT110 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rDT110 = instance.createTableOperator('Count', 'DT110');#EOL#rDT110.addKeyValue('DTSEIKYU &lt;=',&#x9;limitDate);#EOL#countDT110_ToBeDeleted = rDT110.execute();#EOL##EOL#////////////////////#EOL#// DT110 削除処理 //#EOL#////////////////////#EOL#dDT110 = instance.createTableOperator('Delete', 'DT110');#EOL#dDT110.addKeyValue('DTSEIKYU &lt;=',&#x9;limitDate);#EOL#countDT110_Deleted = dDT110.execute();#EOL#if (countDT110_Deleted == countDT110_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('DT110_COUNT', countDT110_ToBeDeleted);#EOL#}#EOL##EOL#//////////////////////////////#EOL#// DT120 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rDT120 = instance.createTableOperator('Count', 'DT120');#EOL#rDT120.addKeyValue('DTJYURYOU &lt;=',&#x9;limitDate);#EOL#countDT120_ToBeDeleted = rDT120.execute();#EOL##EOL#////////////////////#EOL#// DT120 削除処理 //#EOL#////////////////////#EOL#dDT120 = instance.createTableOperator('Delete', 'DT120');#EOL#dDT120.addKeyValue('DTJYURYOU &lt;=',&#x9;limitDate);#EOL#countDT120_Deleted = dDT120.execute();#EOL#if (countDT120_Deleted == countDT120_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('DT120_COUNT', countDT120_ToBeDeleted);#EOL#}" SubsystemID="D" Type="XF000"/><Function ID="CF999" Name="買掛増減履歴パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rCT100; var rFT012; var rHT020; var rHT010; var rCT110; var dCT100;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countToBeDeleted = 0; var countDeleted = 0; var isToBeDeleted = false;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('CT100_COUNT', -1);#EOL##EOL#//////////////////////////#EOL#// CT100 削除対象の検索 //#EOL#//////////////////////////#EOL#rCT100 = instance.createTableOperator('Select', 'CT100');#EOL#rCT100.setSelectFields('NRSIIRE, KBSIIRE, NRTORIHIKIKANRI');#EOL#rCT100.addKeyValue('DTSIIRE &lt;=',&#x9;limitDate);#EOL#while (rCT100.next()) {#EOL##EOL#&#x9;//////////////////////////////#EOL#&#x9;// 削除対象フラグのリセット //#EOL#&#x9;//////////////////////////////#EOL#&#x9;isToBeDeleted = false;#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 00(入荷仕入) FT012 入荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '00') {#EOL#&#x9;&#x9;rFT012 = instance.createTableOperator('Count', 'FT012');#EOL#&#x9;&#x9;rFT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rFT012.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;// 01(直入荷仕入), 02(仕入返品) HT020 特殊仕入 //#EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '01' || rCT100.getValueOf('KBSIIRE') == '02') {#EOL#&#x9;&#x9;rHT020 = instance.createTableOperator('Count', 'HT020');#EOL#&#x9;&#x9;rHT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rHT020.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////////////////////////////////#EOL#&#x9;// 10(雑益振替), 11(雑損仕入), 20(相殺), 30(売上原価振替) HT010 仕入振替 //#EOL#&#x9;///////////////////////////////////////////////////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '10'#EOL#&#x9;|| rCT100.getValueOf('KBSIIRE') == '11'#EOL#&#x9;|| rCT100.getValueOf('KBSIIRE') == '20'#EOL#&#x9;|| rCT100.getValueOf('KBSIIRE') == '30') {#EOL#&#x9;&#x9;rHT010 = instance.createTableOperator('Count', 'HT010');#EOL#&#x9;&#x9;rHT010.addKeyValue('NRTORIHIKIKANRI',&#x9;rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rHT010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////#EOL#&#x9;// 90(支払) CT110 支払依頼 //#EOL#&#x9;/////////////////////////////#EOL#&#x9;if (rCT100.getValueOf('KBSIIRE') == '90') {#EOL#&#x9;&#x9;rCT110 = instance.createTableOperator('Count', 'CT110');#EOL#&#x9;&#x9;rCT110.addKeyValue('NRTORIHIKIKANRI',&#x9;rCT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rCT110.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 削除処理 //#EOL#&#x9;//////////////#EOL#&#x9;if (isToBeDeleted) {#EOL#&#x9;&#x9;countToBeDeleted++;#EOL#&#x9;&#x9;dCT100 = instance.createTableOperator('Delete', 'CT100');#EOL#&#x9;&#x9;dCT100.addKeyValue('NRSIIRE',&#x9;rCT100.getValueOf('NRSIIRE'));#EOL#&#x9;&#x9;if (dCT100.execute() == 1) {#EOL#&#x9;&#x9;&#x9;countDeleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countToBeDeleted == countDeleted) {#EOL#&#x9;instance.returnMap.put('CT100_COUNT', countToBeDeleted);#EOL#}" SubsystemID="C" Type="XF000"/><Function ID="DF999" Name="売掛増減履歴パージ処理" Script="////////////////#EOL#// 変数の定義 //#EOL#////////////////#EOL#var rDT100; var rGT012; var rJT020; var rJT010; var rDT120; var dDT100;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countToBeDeleted = 0; var countDeleted = 0; var count = 0;#EOL#var isToBeDeleted = false;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('DT100_COUNT', -1);#EOL##EOL#//////////////////////////#EOL#// DT100 削除対象の検索 //#EOL#//////////////////////////#EOL#rDT100 = instance.createTableOperator('Select', 'DT100');#EOL#rDT100.setSelectFields('NRURIAGE, KBURIAGE, NRTORIHIKIKANRI');#EOL#rDT100.addKeyValue('DTURIAGE &lt;=',&#x9;limitDate);#EOL#while (rDT100.next()) {#EOL##EOL#&#x9;//////////////////////////////#EOL#&#x9;// 削除対象フラグのリセット //#EOL#&#x9;//////////////////////////////#EOL#&#x9;isToBeDeleted = false;#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 00(出荷売上) GT012 出荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '00') {#EOL#&#x9;&#x9;rGT012 = instance.createTableOperator('Count', 'GT012');#EOL#&#x9;&#x9;rGT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rGT012.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;// 01(直出荷売上), 02(出荷返品) JT020 特殊売上 //#EOL#&#x9;/////////////////////////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '01' || rDT100.getValueOf('KBURIAGE') == '02') {#EOL#&#x9;&#x9;rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#&#x9;&#x9;rJT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rJT020.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////////////////////////////////////////////////#EOL#&#x9;// 10(雑益売上), 11(雑損振替), 20(相殺/買掛金振替), 30(値引/販売費振替) JT010 売上振替 //#EOL#&#x9;/////////////////////////////////////////////////////////////////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '10' || rDT100.getValueOf('KBURIAGE') == '11'#EOL#&#x9; || rDT100.getValueOf('KBURIAGE') == '20' || rDT100.getValueOf('KBURIAGE') == '30') {#EOL#&#x9;&#x9;rJT010 = instance.createTableOperator('Count', 'JT010');#EOL#&#x9;&#x9;rJT010.addKeyValue('NRTORIHIKIKANRI',&#x9;rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rJT010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////#EOL#&#x9;// 90(受領) DT120 受領明細 //#EOL#&#x9;/////////////////////////////#EOL#&#x9;if (rDT100.getValueOf('KBURIAGE') == '90') {#EOL#&#x9;&#x9;rDT120 = instance.createTableOperator('Count', 'DT120');#EOL#&#x9;&#x9;rDT120.addKeyValue('NRTORIHIKIKANRI',&#x9;rDT100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rDT120.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 削除処理 //#EOL#&#x9;//////////////#EOL#&#x9;if (isToBeDeleted) {#EOL#&#x9;&#x9;countToBeDeleted++;#EOL#&#x9;&#x9;dDT100 = instance.createTableOperator('Delete', 'DT100');#EOL#&#x9;&#x9;dDT100.addKeyValue('NRURIAGE',&#x9;rDT100.getValueOf('NRURIAGE'));#EOL#&#x9;&#x9;if (dDT100.execute() == 1) {#EOL#&#x9;&#x9;&#x9;countDeleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countToBeDeleted == countDeleted) {#EOL#&#x9;instance.returnMap.put('DT100_COUNT', countToBeDeleted);#EOL#}" SubsystemID="D" Type="XF000"/><Function ID="EF999" Name="受払履歴パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rET100; var rFT012; var rHT020; var rGT012; var rJT020;#EOL#var rKT020; var rKT030; var rKT010; var dET100;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countToBeDeleted = 0; var countDeleted = 0; var count = 0;#EOL#var isToBeDeleted = false;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('ET100_COUNT', -1);#EOL##EOL#//////////////////////////#EOL#// ET100 削除対象の検索 //#EOL#//////////////////////////#EOL#rET100 = instance.createTableOperator('Select', 'ET100');#EOL#rET100.setSelectFields('NRUKEBARAI, KBUKEBARAI, NRTORIHIKIKANRI');#EOL#rET100.addKeyValue('DTUKEBARAI &lt;=',limitDate);#EOL#while (rET100.next()) {#EOL##EOL#&#x9;//////////////////////////////#EOL#&#x9;// 削除対象フラグのリセット //#EOL#&#x9;//////////////////////////////#EOL#&#x9;isToBeDeleted = false;#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 10(発注入荷) FT012 入荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '10') {#EOL#&#x9;&#x9;rFT012 = instance.createTableOperator('Count', 'FT012');#EOL#&#x9;&#x9;rFT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rFT012.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 11(直入荷), 12(仕入返品) HT020 特殊仕入 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '11' || rET100.getValueOf('KBUKEBARAI') == '12') {#EOL#&#x9;&#x9;rHT020 = instance.createTableOperator('Count', 'HT020');#EOL#&#x9;&#x9;rHT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rHT020.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 20(受注出荷) GT012 出荷明細 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '20') {#EOL#&#x9;&#x9;rGT012 = instance.createTableOperator('Count', 'GT012');#EOL#&#x9;&#x9;rGT012.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rGT012.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;// 21(直出荷), 22(売上返品) JT020 特殊売上 //#EOL#&#x9;/////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '21' || rET100.getValueOf('KBUKEBARAI') == '22') {#EOL#&#x9;&#x9;rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#&#x9;&#x9;rJT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rJT020.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;///////////////////////////////////////////////////#EOL#&#x9;// 30(移動出庫), 31(移動入庫) KT020 在庫移動指示 //#EOL#&#x9;///////////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '30' || rET100.getValueOf('KBUKEBARAI') == '31') {#EOL#&#x9;&#x9;rKT020 = instance.createTableOperator('Count', 'KT020');#EOL#&#x9;&#x9;rKT020.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rKT020.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;// 40(減耗), 41(評価損), 42(仕掛材料出庫), 43(雑損)       //#EOL#&#x9;// 50(雑益), 51(評価益), 52(仕掛完成入庫), 53(加工費繰入) //#EOL#&#x9;//                   KT030 在庫振替                       //#EOL#&#x9;////////////////////////////////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '40' || rET100.getValueOf('KBUKEBARAI') == '41'#EOL#&#x9; || rET100.getValueOf('KBUKEBARAI') == '42' || rET100.getValueOf('KBUKEBARAI') == '43'#EOL#&#x9; || rET100.getValueOf('KBUKEBARAI') == '50' || rET100.getValueOf('KBUKEBARAI') == '51'#EOL#&#x9; || rET100.getValueOf('KBUKEBARAI') == '52' || rET100.getValueOf('KBUKEBARAI') == '53') {#EOL#&#x9;&#x9;rKT030 = instance.createTableOperator('Count', 'KT030');#EOL#&#x9;&#x9;rKT030.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rKT030.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// 90(棚増棚減) KT010 棚卸指示 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;if (rET100.getValueOf('KBUKEBARAI') == '90') {#EOL#&#x9;&#x9;rKT010 = instance.createTableOperator('Count', 'KT010');#EOL#&#x9;&#x9;rKT010.addKeyValue('NRTORIHIKIKANRI',&#x9;rET100.getValueOf('NRTORIHIKIKANRI'));#EOL#&#x9;&#x9;if (rKT010.execute() == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = true;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////#EOL#&#x9;// 削除処理 //#EOL#&#x9;//////////////#EOL#&#x9;if (isToBeDeleted) {#EOL#&#x9;&#x9;countToBeDeleted++;#EOL#&#x9;&#x9;dET100 = instance.createTableOperator('Delete', 'ET100');#EOL#&#x9;&#x9;dET100.addKeyValue('NRUKEBARAI',&#x9;rET100.getValueOf('NRUKEBARAI'));#EOL#&#x9;&#x9;if (dET100.execute() == 1) {#EOL#&#x9;&#x9;&#x9;countDeleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countToBeDeleted == countDeleted) {#EOL#&#x9;instance.returnMap.put('ET100_COUNT', countToBeDeleted);#EOL#}" SubsystemID="E" Type="XF000"/><Function ID="ZF999" Name="セッション履歴パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rZT050; var dZT050; var dZT051;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countZT050_Deleted = 0; var countZT050_ToBeDeleted = 0; var countZT051_Deleted = 0;#EOL#var count = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果省略値の登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('ZT050_COUNT', -1);#EOL#instance.returnMap.put('ZT051_COUNT', -1);#EOL##EOL#/////////////////////////////////////////////#EOL#// セッション(ZT050)削除対象レコードの検索 //#EOL#/////////////////////////////////////////////#EOL#rZT050 = instance.createTableOperator('Select', 'ZT050');#EOL#rZT050.setSelectFields('NRSESSION');#EOL#rZT050.addKeyValue('DTLOGOUT &lt;=',&#x9;limitDate + ' 23:59:59.999');#EOL#while (rZT050.next()) {#EOL#&#x9;countZT050_ToBeDeleted++;#EOL##EOL#&#x9;/////////////////////////////////#EOL#&#x9;// セッション明細(ZT051)の削除 //#EOL#&#x9;/////////////////////////////////#EOL#&#x9;dZT051 = instance.createTableOperator('Delete', 'ZT051');#EOL#&#x9;dZT051.addKeyValue('NRSESSION',&#x9;rZT050.getValueOf('NRSESSION'));#EOL#&#x9;count = dZT051.execute();#EOL#&#x9;countZT051_Deleted = Number(countZT051_Deleted) + Number(count);#EOL##EOL#&#x9;/////////////////////////////#EOL#&#x9;// セッション(ZT050)の削除 //#EOL#&#x9;/////////////////////////////#EOL#&#x9;dZT050 = instance.createTableOperator('Delete', 'ZT050');#EOL#&#x9;dZT050.addKeyValue('NRSESSION',&#x9;rZT050.getValueOf('NRSESSION'));#EOL#&#x9;count = dZT050.execute();#EOL#&#x9;if (count == 1) {#EOL#&#x9;&#x9;countZT050_Deleted++;#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countZT050_Deleted == countZT050_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('ZT050_COUNT', countZT050_Deleted);#EOL#&#x9;instance.returnMap.put('ZT051_COUNT', countZT051_Deleted);#EOL#}#EOL#" SubsystemID="Z" Type="XF000"/><Function ID="HF990" Name="一般仕入取引パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rHT010; var dHT010; var rHT020; var dHT020;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countHT010_ToBeDeleted = 0; var countHT010_Deleted = 0;#EOL#var countHT020_ToBeDeleted = 0; var countHT020_Deleted = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('HT010_COUNT', -1);#EOL#instance.returnMap.put('HT020_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// HT010 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rHT010 = instance.createTableOperator('Count', 'HT010');#EOL#rHT010.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countHT010_ToBeDeleted = rHT010.execute();#EOL##EOL#////////////////////#EOL#// HT010 削除処理 //#EOL#////////////////////#EOL#dHT010 = instance.createTableOperator('Delete', 'HT010');#EOL#dHT010.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countHT010_Deleted = dHT010.execute();#EOL#if (countHT010_Deleted == countHT010_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('HT010_COUNT', countHT010_ToBeDeleted);#EOL#}#EOL##EOL#//////////////////////////////#EOL#// HT020 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rHT020 = instance.createTableOperator('Count', 'HT020');#EOL#rHT020.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countHT020_ToBeDeleted = rHT020.execute();#EOL##EOL#////////////////////#EOL#// HT020 削除処理 //#EOL#////////////////////#EOL#dHT020 = instance.createTableOperator('Delete', 'HT020');#EOL#dHT020.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countHT020_Deleted = dHT020.execute();#EOL#if (countHT020_Deleted == countHT020_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('HT020_COUNT', countHT020_ToBeDeleted);#EOL#}" SubsystemID="H" Type="XF000"/><Function ID="JF990" Name="一般売上取引パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rJT010; var dJT010; var rJT020; var dJT020;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countJT010_ToBeDeleted = 0; var countJT010_Deleted = 0;#EOL#var countJT020_ToBeDeleted = 0; var countJT020_Deleted = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('JT010_COUNT', -1);#EOL#instance.returnMap.put('JT020_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// JT010 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rJT010 = instance.createTableOperator('Count', 'JT010');#EOL#rJT010.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countJT010_ToBeDeleted = rJT010.execute();#EOL##EOL#////////////////////#EOL#// JT010 削除処理 //#EOL#////////////////////#EOL#dJT010 = instance.createTableOperator('Delete', 'JT010');#EOL#dJT010.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countJT010_Deleted = dJT010.execute();#EOL#if (countJT010_Deleted == countJT010_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('JT010_COUNT', countJT010_ToBeDeleted);#EOL#}#EOL##EOL#//////////////////////////////#EOL#// JT020 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rJT020 = instance.createTableOperator('Count', 'JT020');#EOL#rJT020.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countJT020_ToBeDeleted = rJT020.execute();#EOL##EOL#////////////////////#EOL#// JT020 削除処理 //#EOL#////////////////////#EOL#dJT020 = instance.createTableOperator('Delete', 'JT020');#EOL#dJT020.addKeyValue('DTTORIHIKI &lt;=',&#x9;limitDate);#EOL#countJT020_Deleted = dJT020.execute();#EOL#if (countJT020_Deleted == countJT020_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('JT020_COUNT', countJT020_ToBeDeleted);#EOL#}" SubsystemID="J" Type="XF000"/><Function ID="FF990" Name="発注･入荷パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rFT020; var dFT020; var rFT010; var dFT010;#EOL#var rFT011; var dFT011; var rFT012; var dFT012;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var qtsiire = 0; var qtwork = 0; var isToBeDeleted = false;#EOL#var workCount1 = 0; var workCount2 = 0; var count = 0;#EOL#var countFT010_ToBeDeleted = 0; var countFT010_Deleted = 0;#EOL#var countFT011_ToBeDeleted = 0; var countFT011_Deleted = 0;#EOL#var countFT012_ToBeDeleted = 0; var countFT012_Deleted = 0;#EOL#var countFT020_ToBeDeleted = 0; var countFT020_Deleted = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('FT010_COUNT', -1);#EOL#instance.returnMap.put('FT011_COUNT', -1);#EOL#instance.returnMap.put('FT012_COUNT', -1);#EOL#instance.returnMap.put('FT020_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// FT020 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rFT020 = instance.createTableOperator('Select', 'FT020');#EOL#rFT020.setSelectFields('NRNYUKA');#EOL#rFT020.addKeyValue('DTNYUKA &lt;=',&#x9;limitDate);#EOL#while (rFT020.next()) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 削除対象フラグのセット //#EOL#&#x9;////////////////////////////#EOL#&#x9;isToBeDeleted = true;#EOL##EOL#&#x9;//////////////////////////////////////////////////////////#EOL#&#x9;// 入荷明細 FT012 削除対象検査（入荷残があれば削除不可）//#EOL#&#x9;//////////////////////////////////////////////////////////#EOL#&#x9;rFT012 = instance.createTableOperator('Select', 'FT012');#EOL#&#x9;rFT012.setSelectFields('NRSYOHIN, NRHATTYU, SQHATTYU, SQNYUKA, QTJITSUSIIRE, QTDEFECT');#EOL#&#x9;rFT012.addKeyValue('NRNYUKA',&#x9;rFT020.getValueOf('NRNYUKA'));#EOL#&#x9;while (rFT012.next()) {#EOL#&#x9;&#x9;qtsiire = Number(rFT012.getValueOf('QTJITSUSIIRE')) + Number(rFT012.getValueOf('QTDEFECT'));#EOL#&#x9;&#x9;if (qtsiire == 0) {#EOL#&#x9;&#x9;&#x9;isToBeDeleted = false;#EOL#&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;// 入荷見出し(FT020)が削除可の場合の処理//#EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;if (isToBeDeleted) {#EOL##EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;// FT012 削除対象件数の検索 //#EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;rFT012 = instance.createTableOperator('Select', 'FT012');#EOL#&#x9;&#x9;rFT012.setSelectFields('NRHATTYU, SQHATTYU, SQNYUKA');#EOL#&#x9;&#x9;rFT012.addKeyValue('NRNYUKA',&#x9;rFT020.getValueOf('NRNYUKA'));#EOL#&#x9;&#x9;while (rFT012.next()) {#EOL#&#x9;&#x9;&#x9;countFT012_ToBeDeleted++;#EOL##EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;// FT012 削除処理 //#EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;dFT012 = instance.createTableOperator('Delete', 'FT012');#EOL#&#x9;&#x9;&#x9;dFT012.addKeyValue('NRHATTYU',&#x9;rFT012.getValueOf('NRHATTYU'));#EOL#&#x9;&#x9;&#x9;dFT012.addKeyValue('SQHATTYU',&#x9;rFT012.getValueOf('SQHATTYU'));#EOL#&#x9;&#x9;&#x9;dFT012.addKeyValue('SQNYUKA',&#x9;rFT012.getValueOf('SQNYUKA'));#EOL#&#x9;&#x9;&#x9;count = dFT012.execute();#EOL#&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;countFT012_Deleted++;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// FT020 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;countFT020_ToBeDeleted++;#EOL#&#x9;&#x9;dFT020 = instance.createTableOperator('Delete', 'FT020');#EOL#&#x9;&#x9;dFT020.addKeyValue('NRNYUKA',&#x9;rFT020.getValueOf('NRNYUKA'));#EOL#&#x9;&#x9;count = dFT020.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;countFT020_Deleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////////////#EOL#// FT010 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rFT010 = instance.createTableOperator('Select', 'FT010');#EOL#rFT010.setSelectFields('NRHATTYU');#EOL#rFT010.addKeyValue('DTHATTYU &lt;=',&#x9;limitDate);#EOL#while (rFT010.next()) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 削除対象件数のリセット //#EOL#&#x9;////////////////////////////#EOL#&#x9;workCount1 = 0;#EOL#&#x9;workCount2 = 0;#EOL##EOL#&#x9;//////////////////////////////#EOL#&#x9;// FT011 削除対象件数の検索 //#EOL#&#x9;//////////////////////////////#EOL#&#x9;rFT011 = instance.createTableOperator('Select', 'FT011');#EOL#&#x9;rFT011.setSelectFields('NRHATTYU, SQHATTYU');#EOL#&#x9;rFT011.addKeyValue('NRHATTYU',&#x9;rFT010.getValueOf('NRHATTYU'));#EOL#&#x9;while (rFT011.next()) {#EOL#&#x9;&#x9;workCount1++;#EOL##EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;// FT012 削除対象件数の検索 //#EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;rFT012 = instance.createTableOperator('Count', 'FT012');#EOL#&#x9;&#x9;rFT012.addKeyValue('NRHATTYU',&#x9;rFT011.getValueOf('NRHATTYU'));#EOL#&#x9;&#x9;rFT012.addKeyValue('SQHATTYU',&#x9;rFT011.getValueOf('SQHATTYU'));#EOL#&#x9;&#x9;if (rFT012.execute() == 0) {#EOL#&#x9;&#x9;&#x9;workCount2++;#EOL##EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;// FT011 削除処理 //#EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;countFT011_ToBeDeleted++;#EOL#&#x9;&#x9;&#x9;dFT011 = instance.createTableOperator('Delete', 'FT011');#EOL#&#x9;&#x9;&#x9;dFT011.addKeyValue('NRHATTYU',&#x9;rFT011.getValueOf('NRHATTYU'));#EOL#&#x9;&#x9;&#x9;dFT011.addKeyValue('SQHATTYU',&#x9;rFT011.getValueOf('SQHATTYU'));#EOL#&#x9;&#x9;&#x9;count = dFT011.execute();#EOL#&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;countFT011_Deleted++;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// FT010 削除処理 //#EOL#&#x9;////////////////////#EOL#&#x9;if (workCount1 == workCount2) {#EOL#&#x9;&#x9;countFT010_ToBeDeleted++;#EOL#&#x9;&#x9;dFT010 = instance.createTableOperator('Delete', 'FT010');#EOL#&#x9;&#x9;dFT010.addKeyValue('NRHATTYU',&#x9;rFT010.getValueOf('NRHATTYU'));#EOL#&#x9;&#x9;count = dFT010.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;countFT010_Deleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countFT010_Deleted == countFT010_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('FT010_COUNT', countFT010_ToBeDeleted);#EOL#}#EOL#if (countFT011_Deleted == countFT011_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('FT011_COUNT', countFT011_ToBeDeleted);#EOL#}#EOL#if (countFT012_Deleted == countFT012_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('FT012_COUNT', countFT012_ToBeDeleted);#EOL#}#EOL#if (countFT020_Deleted == countFT020_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('FT020_COUNT', countFT020_ToBeDeleted);#EOL#}#EOL#" SubsystemID="F" Type="XF000"/><Function ID="GF990" Name="受注･出荷パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rGT020; var dGT020; var rGT010; var dGT010;#EOL#var rGT011; var dGT011; var rGT012; var dGT012;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var workCount1 = 0; var workCount2 = 0; var count = 0;#EOL#var countGT010_ToBeDeleted = 0; var countGT010_Deleted = 0;#EOL#var countGT011_ToBeDeleted = 0; var countGT011_Deleted = 0;#EOL#var countGT012_ToBeDeleted = 0; var countGT012_Deleted = 0;#EOL#var countGT020_ToBeDeleted = 0; var countGT020_Deleted = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果の省略値登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('GT010_COUNT', -1);#EOL#instance.returnMap.put('GT011_COUNT', -1);#EOL#instance.returnMap.put('GT012_COUNT', -1);#EOL#instance.returnMap.put('GT020_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// GT020 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rGT020 = instance.createTableOperator('Select', 'GT020');#EOL#rGT020.setSelectFields('NRSYUKKA, TMKANRYO');#EOL#rGT020.addKeyValue('DTSYUKKA &lt;=',&#x9;limitDate);#EOL#while (rGT020.next()) {#EOL##EOL#&#x9;////////////////////////////////#EOL#&#x9;// 出荷完了分であれば削除対象 //#EOL#&#x9;////////////////////////////////#EOL#&#x9;if (rGT020.getValueOf('TMKANRYO') != null &amp;&amp; rGT020.getValueOf('TMKANRYO') != '') {#EOL#&#x9;&#x9;countGT020_ToBeDeleted++;#EOL##EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;// GT012 削除対象件数の検索 //#EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;rGT012 = instance.createTableOperator('Select', 'GT012');#EOL#&#x9;&#x9;rGT012.setSelectFields('NRJYUTYU, SQJYUTYU, SQSYUKKA');#EOL#&#x9;&#x9;rGT012.addKeyValue('NRSYUKKA',&#x9;rGT020.getValueOf('NRSYUKKA'));#EOL#&#x9;&#x9;while (rGT012.next()) {#EOL#&#x9;&#x9;&#x9;countGT012_ToBeDeleted++;#EOL##EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;// GT012 削除処理 //#EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;dGT012 = instance.createTableOperator('Delete', 'GT012');#EOL#&#x9;&#x9;&#x9;dGT012.addKeyValue('NRJYUTYU',&#x9;rGT012.getValueOf('NRJYUTYU'));#EOL#&#x9;&#x9;&#x9;dGT012.addKeyValue('SQJYUTYU',&#x9;rGT012.getValueOf('SQJYUTYU'));#EOL#&#x9;&#x9;&#x9;dGT012.addKeyValue('SQSYUKKA',&#x9;rGT012.getValueOf('SQSYUKKA'));#EOL#&#x9;&#x9;&#x9;count = dGT012.execute();#EOL#&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;countGT012_Deleted++;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// GT020 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dGT020 = instance.createTableOperator('Delete', 'GT020');#EOL#&#x9;&#x9;dGT020.addKeyValue('NRSYUKKA',&#x9;rGT020.getValueOf('NRSYUKKA'));#EOL#&#x9;&#x9;count = dGT020.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;countGT020_Deleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////////////#EOL#// GT010 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rGT010 = instance.createTableOperator('Select', 'GT010');#EOL#rGT010.setSelectFields('NRJYUTYU');#EOL#rGT010.addKeyValue('DTJYUTYU &lt;=',&#x9;limitDate);#EOL#while (rGT010.next()) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 削除対象件数のリセット //#EOL#&#x9;////////////////////////////#EOL#&#x9;workCount1 = 0;#EOL#&#x9;workCount2 = 0;#EOL##EOL#&#x9;//////////////////////////////#EOL#&#x9;// GT011 削除対象件数の検索 //#EOL#&#x9;//////////////////////////////#EOL#&#x9;rGT011 = instance.createTableOperator('Select', 'GT011');#EOL#&#x9;rGT011.setSelectFields('NRJYUTYU, SQJYUTYU');#EOL#&#x9;rGT011.addKeyValue('NRJYUTYU',&#x9;rGT010.getValueOf('NRJYUTYU'));#EOL#&#x9;while (rGT011.next()) {#EOL#&#x9;&#x9;workCount1++;#EOL##EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;// GT012 削除対象件数の検索 //#EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;rGT012 = instance.createTableOperator('Count', 'GT012');#EOL#&#x9;&#x9;rGT012.addKeyValue('NRJYUTYU',&#x9;rGT011.getValueOf('NRJYUTYU'));#EOL#&#x9;&#x9;rGT012.addKeyValue('SQJYUTYU',&#x9;rGT011.getValueOf('SQJYUTYU'));#EOL#&#x9;&#x9;if (rGT012.execute() == 0) {#EOL#&#x9;&#x9;&#x9;workCount2++;#EOL##EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;// GT011 削除処理 //#EOL#&#x9;&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;&#x9;countGT011_ToBeDeleted++;#EOL#&#x9;&#x9;&#x9;dGT011 = instance.createTableOperator('Delete', 'GT011');#EOL#&#x9;&#x9;&#x9;dGT011.addKeyValue('NRJYUTYU',&#x9;rGT011.getValueOf('NRJYUTYU'));#EOL#&#x9;&#x9;&#x9;dGT011.addKeyValue('SQJYUTYU',&#x9;rGT011.getValueOf('SQJYUTYU'));#EOL#&#x9;&#x9;&#x9;count = dGT011.execute();#EOL#&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;countGT011_Deleted++;#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////////#EOL#&#x9;// GT010 削除処理 //#EOL#&#x9;////////////////////#EOL#&#x9;if (workCount1 == workCount2) {#EOL#&#x9;&#x9;countGT010_ToBeDeleted++;#EOL#&#x9;&#x9;dGT010 = instance.createTableOperator('Delete', 'GT010');#EOL#&#x9;&#x9;dGT010.addKeyValue('NRJYUTYU',&#x9;rGT010.getValueOf('NRJYUTYU'));#EOL#&#x9;&#x9;count = dGT010.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;countGT010_Deleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countGT010_Deleted == countGT010_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('GT010_COUNT', countGT010_ToBeDeleted);#EOL#}#EOL#if (countGT011_Deleted == countGT011_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('GT011_COUNT', countGT011_ToBeDeleted);#EOL#}#EOL#if (countGT012_Deleted == countGT012_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('GT012_COUNT', countGT012_ToBeDeleted);#EOL#}#EOL#if (countGT020_Deleted == countGT020_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('GT020_COUNT', countGT020_ToBeDeleted);#EOL#}#EOL#" SubsystemID="G" Type="XF000"/><Function ID="KF990" Name="一般在庫取引パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rKT010; var dKT010; var rKT011; var dKT011;#EOL#var rKT020; var dKT020; var rKT021; var dKT021; var rKT030; var dKT030;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countKT010_ToBeDeleted = 0; var countKT010_Deleted = 0;#EOL#var countKT011_ToBeDeleted = 0; var countKT011_Deleted = 0;#EOL#var countKT020_ToBeDeleted = 0; var countKT020_Deleted = 0;#EOL#var countKT021_ToBeDeleted = 0; var countKT021_Deleted = 0;#EOL#var countKT030_ToBeDeleted = 0; var countKT030_Deleted = 0;#EOL#var count = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果省略値の登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('KT010_COUNT', -1);#EOL#instance.returnMap.put('KT011_COUNT', -1);#EOL#instance.returnMap.put('KT020_COUNT', -1);#EOL#instance.returnMap.put('KT021_COUNT', -1);#EOL#instance.returnMap.put('KT030_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// KT010 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rKT010 = instance.createTableOperator('Select', 'KT010');#EOL#rKT010.setSelectFields('NRTANAOROSHI, DTKOUSHIN');#EOL#rKT010.addKeyValue('DTKIJYUN &lt;=',&#x9;limitDate + ' 23:59:59.999');#EOL#while (rKT010.next()) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 完了分であれば削除対象 //#EOL#&#x9;////////////////////////////#EOL#&#x9;if (rKT010.getValueOf('DTKOUSHIN') != null &amp;&amp; rKT010.getValueOf('DTKOUSHIN') != '') {#EOL#&#x9;&#x9;countKT010_ToBeDeleted++;#EOL##EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;// KT011 削除対象件数の検索 //#EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;rKT011 = instance.createTableOperator('Count', 'KT011');#EOL#&#x9;&#x9;rKT011.addKeyValue('NRTANAOROSHI',rKT010.getValueOf('NRTANAOROSHI'));#EOL#&#x9;&#x9;count = rKT011.execute();#EOL#&#x9;&#x9;countKT011_ToBeDeleted = Number(countKT011_ToBeDeleted) + Number(count);#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// KT011 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dKT011 = instance.createTableOperator('Delete', 'KT011');#EOL#&#x9;&#x9;dKT011.addKeyValue('NRTANAOROSHI',rKT010.getValueOf('NRTANAOROSHI'));#EOL#&#x9;&#x9;count = dKT011.execute();#EOL#&#x9;&#x9;countKT011_Deleted = Number(countKT011_Deleted) + Number(count);#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// KT010 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dKT010 = instance.createTableOperator('Delete', 'KT010');#EOL#&#x9;&#x9;dKT010.addKeyValue('NRTANAOROSHI',rKT010.getValueOf('NRTANAOROSHI'));#EOL#&#x9;&#x9;count = dKT010.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;countKT010_Deleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////////////#EOL#// KT020 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rKT020 = instance.createTableOperator('Select', 'KT020');#EOL#rKT020.setSelectFields('NRZAIKOIDOU, TMKANRYO');#EOL#rKT020.addKeyValue('DTSHIJI &lt;=',&#x9;limitDate);#EOL#while (rKT020.next()) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 完了分であれば削除対象 //#EOL#&#x9;////////////////////////////#EOL#&#x9;if (rKT020.getValueOf('TMKANRYO') != null &amp;&amp; rKT020.getValueOf('TMKANRYO') != '') {#EOL#&#x9;&#x9;countKT020_ToBeDeleted++;#EOL##EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;// KT021 削除対象件数の検索 //#EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;rKT021 = instance.createTableOperator('Count', 'KT021');#EOL#&#x9;&#x9;rKT021.addKeyValue('NRZAIKOIDOU',&#x9;rKT020.getValueOf('NRZAIKOIDOU'));#EOL#&#x9;&#x9;count = rKT021.execute();#EOL#&#x9;&#x9;countKT021_ToBeDeleted = Number(countKT021_ToBeDeleted) + Number(count);#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// KT021 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dKT021 = instance.createTableOperator('Delete', 'KT021');#EOL#&#x9;&#x9;dKT021.addKeyValue('NRZAIKOIDOU',&#x9;rKT020.getValueOf('NRZAIKOIDOU'));#EOL#&#x9;&#x9;count = dKT021.execute();#EOL#&#x9;&#x9;countKT021_Deleted = Number(countKT021_Deleted) + Number(count);#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// KT020 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dKT020 = instance.createTableOperator('Delete', 'KT020');#EOL#&#x9;&#x9;dKT020.addKeyValue('NRZAIKOIDOU',&#x9;rKT020.getValueOf('NRZAIKOIDOU'));#EOL#&#x9;&#x9;count = dKT020.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;countKT020_Deleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#//////////////////////////////#EOL#// KT030 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rKT030 = instance.createTableOperator('Count', 'KT030');#EOL#rKT030.addKeyValue('DTHURIKAE &lt;=',&#x9;limitDate);#EOL#countKT030_ToBeDeleted = rKT030.execute();#EOL##EOL#////////////////////#EOL#// KT030 削除処理 //#EOL#////////////////////#EOL#dKT030 = instance.createTableOperator('Delete', 'KT030');#EOL#dKT030.addKeyValue('DTHURIKAE &lt;=',&#x9;limitDate);#EOL#countKT030_Deleted = dKT030.execute();#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countKT010_Deleted == countKT010_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('KT010_COUNT', countKT010_ToBeDeleted);#EOL#}#EOL#if (countKT011_Deleted == countKT011_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('KT011_COUNT', countKT011_ToBeDeleted);#EOL#}#EOL#if (countKT020_Deleted == countKT020_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('KT020_COUNT', countKT020_ToBeDeleted);#EOL#}#EOL#if (countKT021_Deleted == countKT021_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('KT021_COUNT', countKT021_ToBeDeleted);#EOL#}#EOL#if (countKT030_Deleted == countKT030_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('KT030_COUNT', countKT030_ToBeDeleted);#EOL#}" SubsystemID="K" Type="XF000"/><Function HeaderFunction="FF014" HeaderKeyFields="" HeaderTable="FT011" ID="FF017" Name="発注明細別入荷予定の検討" Size="AUTO" SubsystemID="F" Type="XF300"><Field DataSource="FT011.NRHATTYU" FieldOptions="" Order="0010"/><Field DataSource="FT011.SQHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT011.PRHATTYU" FieldOptions="" Order="0110"/><Field DataSource="FT011.QTHATTYU" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="FT011.DTKIBOUNOUKI" FieldOptions="HORIZONTAL" Order="0080"/><Field DataSource="FT011.TXTEKIYO" FieldOptions="" Order="0180"/><Detail Caption="入荷予定" DetailFunction="FF042" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" Table="FT012"><Column DataSource="FT012.DTYOTEINYUKA" FieldOptions="" Order="0010"/><Column DataSource="FT012.FGKAKUNIN" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(FF015)" Caption="編集" Number="5" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT020A.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Column DataSource="BT020A.TXSYOHIN" FieldOptions="WIDTH(200)" Order="0040"/><Column DataSource="BT020A.TXHINBAN" FieldOptions="WIDTH(150)" Order="0030"/><Column DataSource="FT012.QTYOTEISIIRE" FieldOptions="" Order="0050"/><Column DataSource="FT012.QTJITSUNYUKO" FieldOptions="" Order="0080"/><Button Action="HEADER" Caption="受注明細" Number="7" Position="4"/><Column DataSource="FT012.KBSIIREUM1" FieldOptions="" Order="0070"/></Detail><Field DataSource="FT010.DTHATTYU" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT010.NRTORIHIKISAKI" FieldOptions="" Order="0040"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="FT010.NRSOUKO" FieldOptions="" Order="0060"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0090"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/><Field DataSource="FT011.QTHATTYUKANZAN" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0170"/><Field DataSource="FT011.KBSIIREUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/></Function><Function FixedWhere="" HeaderFunction="" HeaderKeyFields="" HeaderTable="FT012" ID="FF042" Name="入荷明細別取引実績の検討" Size="AUTO" SubsystemID="F" Type="XF300"><Field DataSource="FT012.NRHATTYU" FieldOptions="" Order="0010"/><Field DataSource="FT012.SQHATTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="FT012.SQNYUKA" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT012.QTDEFECT" FieldOptions="HORIZONTAL(37)" Order="0180"/><Field DataSource="FT012.NRNYUKA" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="BT030B.TXSOUKO" FieldOptions="CAPTION(入荷倉庫／ロケ)" Order="0090"/><Field DataSource="FT012.DTYOTEINYUKA" FieldOptions="" Order="0120"/><Field DataSource="FT020.DTNYUKA" FieldOptions="CAPTION(実際入荷日),HORIZONTAL(42)" Order="0130"/><Field DataSource="BT020A.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="BT020A.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0070"/><Field DataSource="FT010.NRTORIHIKISAKI" FieldOptions="CAPTION(仕入先)" Order="0050"/><Detail Caption="買掛増減履歴" DetailFunction="CF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRSIIRE" Order="0030" Table="CT100"><Column DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Column DataSource="CT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="CT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="CT100.KBSIIRE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="CT100.DTSIIRE" FieldOptions="" Order="0050"/><Column DataSource="CT100.PRSIIRE" FieldOptions="" Order="0080"/><Column DataSource="CT100.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0100"/><Column DataSource="CT100.QTSIIRE" FieldOptions="" Order="0060"/><Column DataSource="CT100.KBSIIREUM" FieldOptions="CAPTION(U/M)" Order="0070"/><Column DataSource="CT100.AMSIIRE" FieldOptions="" Order="0090"/><Button Action="CALL(FF043,INSTANCE_MODE:EDIT)" Caption="入荷切離し" Number="9" Position="4"/></Detail><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0040" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0050"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0060"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="" Order="0070"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0080"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0100"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Button Action="CALL(FF043)" Caption="入荷切離し" Number="9" Position="4"/></Detail><Field DataSource="FT012.QTYOTEISIIRE" FieldOptions="" Order="0140"/><Field DataSource="FT012.QTJITSUSIIRE" FieldOptions="HORIZONTAL(26)" Order="0160"/><Field DataSource="FT012.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="FT012.TXLOTNUMBER" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="FT012.PRSIIRE" FieldOptions="" Order="0210"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0240"/><Field DataSource="AT030.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0220"/><Field DataSource="FT012.AMSIIREGAIKA" FieldOptions="HORIZONTAL" Order="0230"/><Field DataSource="FT012.AMSIIRENAIKA" FieldOptions="HORIZONTAL" Order="0250"/><Field DataSource="FT012.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0260"/><Field DataSource="FT012.KBSIIREUM1" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Field DataSource="FT012.KBSIIREUM2" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0170"/><Field DataSource="FT012.KBSIIREUM3" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0200"/></Function><Function ID="LF990" Name="セット指示パージ処理" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rLT010; var dLT010;#EOL#var rLT011; var dLT011;#EOL#var limitDate = instance.parmMap.get('LIMIT_DATE');#EOL#var countLT010_ToBeDeleted = 0; var countLT010_Deleted = 0;#EOL#var countLT011_ToBeDeleted = 0; var countLT011_Deleted = 0;#EOL#var count = 0;#EOL##EOL#//////////////////////////#EOL#// 削除結果省略値の登録 //#EOL#//////////////////////////#EOL#instance.returnMap.put('LT010_COUNT', -1);#EOL#instance.returnMap.put('LT011_COUNT', -1);#EOL##EOL#//////////////////////////////#EOL#// LT010 削除対象件数の検索 //#EOL#//////////////////////////////#EOL#rLT010 = instance.createTableOperator('Select', 'LT010');#EOL#rLT010.setSelectFields('NRSET, TMJISSEKI');#EOL#rLT010.addKeyValue('DTYOTEI &lt;=',&#x9;limitDate);#EOL#while (rLT010.next()) {#EOL##EOL#&#x9;////////////////////////////#EOL#&#x9;// 完了分であれば削除対象 //#EOL#&#x9;////////////////////////////#EOL#&#x9;if (rLT010.getValueOf('TMJISSEKI') != null &amp;&amp; rLT010.getValueOf('TMJISSEKI') != '') {#EOL#&#x9;&#x9;countLT010_ToBeDeleted++;#EOL##EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;// LT011 削除対象件数の検索 //#EOL#&#x9;&#x9;//////////////////////////////#EOL#&#x9;&#x9;rLT011 = instance.createTableOperator('Count', 'LT011');#EOL#&#x9;&#x9;rLT011.addKeyValue('NRSET',&#x9;rLT010.getValueOf('NRSET'));#EOL#&#x9;&#x9;count = rLT011.execute();#EOL#&#x9;&#x9;countLT011_ToBeDeleted = Number(countLT011_ToBeDeleted) + Number(count);#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// LT011 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dLT011 = instance.createTableOperator('Delete', 'LT011');#EOL#&#x9;&#x9;dLT011.addKeyValue('NRSET',&#x9;rLT010.getValueOf('NRSET'));#EOL#&#x9;&#x9;count = dLT011.execute();#EOL#&#x9;&#x9;countLT011_Deleted = Number(countLT011_Deleted) + Number(count);#EOL##EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;// LT010 削除処理 //#EOL#&#x9;&#x9;////////////////////#EOL#&#x9;&#x9;dLT010 = instance.createTableOperator('Delete', 'LT010');#EOL#&#x9;&#x9;dLT010.addKeyValue('NRSET',&#x9;rLT010.getValueOf('NRSET'));#EOL#&#x9;&#x9;count = dLT010.execute();#EOL#&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;countLT010_Deleted++;#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}#EOL##EOL#////////////////////#EOL#// 削除結果の登録 //#EOL#////////////////////#EOL#if (countLT010_Deleted == countLT010_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('LT010_COUNT', countLT010_ToBeDeleted);#EOL#}#EOL#if (countLT011_Deleted == countLT011_ToBeDeleted) {#EOL#&#x9;instance.returnMap.put('LT011_COUNT', countLT011_ToBeDeleted);#EOL#}" SubsystemID="L" Type="XF000"/><Function ContinueAdd="T" ID="BF023" InitialMsg="" KeyFields="" Name="セット構成の保守" PrimaryTable="BT021" Size="AUTO" SubsystemID="B" Type="XF200"><Field DataSource="BT021.RTKOUSEI" FieldOptions="" Order="0070"/><Field DataSource="BT021.SQLIST" FieldOptions="" Order="0100"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020A.TXSYOHIN" FieldOptions="" Order="0040"/><Field DataSource="BT020A.TXHINBAN" FieldOptions="CAPTION(セット商品品番)" Order="0030"/><Field DataSource="BT020B.TXSYOHIN" FieldOptions="" Order="0060"/><Field DataSource="BT020B.TXHINBAN" FieldOptions="CAPTION(構成品番),PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.KBZAIKOUM),PROMPT_CALL_TO_GET_TO(BT021.NRCHILD;BT020B.TXHINBAN;BT020B.TXSYOHIN;BT020B.KBZAIKOUM)" Order="0050"/><Field DataSource="BT020B.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/></Function><Function DetailFunction="LF013" ID="LF010" InitialMsg="" KeyFields="" Name="セット指示の一覧・保守" OrderBy="" PrimaryTable="LT010" Size="AUTO" SubsystemID="L" Type="XF100"><Column DataSource="LT010.NRSET" FieldOptions="" Order="0020"/><Column DataSource="LT010.NRSOUKO" FieldOptions="" Order="0030"/><Column DataSource="LT010.DTYOTEI" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(LF011)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Filter DataSource="LT010.NRSET" FieldOptions="" Order="0020"/><Filter DataSource="LT010.NRSOUKO" FieldOptions="" Order="0030"/><Filter DataSource="LT010.DTYOTEI" FieldOptions="GE,CAPTION(完了予定日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Column DataSource="LT010.QTSHIJI" FieldOptions="" Order="0080"/><Column DataSource="LT010.STSET" FieldOptions="" Order="0100"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="WIDTH(250)" Order="0060"/><Column DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(セット品番)" Order="0050"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0090"/><Column DataSource="BT030.TXSOUKO" FieldOptions="WIDTH(250)" Order="0040"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="0040"/></Function><Function FunctionAfterInsert="LF013" ID="LF011" InitialMsg="" KeyFields="" Name="セット指示の保守" PrimaryTable="LT010" Size="AUTO" SubsystemID="L" Type="XF200"><Field DataSource="LT010.NRSET" FieldOptions="" Order="0010"/><Field DataSource="LT010.DTYOTEI" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="LT010.QTSHIJI" FieldOptions="" Order="0090"/><Field DataSource="LT010.TXTEKIYO" FieldOptions="" Order="0110"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(セット品番),PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.KBZAIKOUM),PROMPT_CALL_TO_GET_TO(LT010.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.KBZAIKOUM)" Order="0070"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫),PROMPT_LIST" Order="0050"/></Function><Function HeaderFunction="LF011" HeaderKeyFields="" HeaderTable="LT010" ID="LF013" Name="セット指示と関連情報の検討" Size="AUTO" SubsystemID="L" Type="XF300"><Field DataSource="LT010.NRSET" FieldOptions="" Order="0010"/><Field DataSource="LT010.DTYOTEI" FieldOptions="" Order="0040"/><Field DataSource="LT010.QTSHIJI" FieldOptions="" Order="0120"/><Detail Caption="構成明細" DetailFunction="NONE" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" Table="LT011"><Column DataSource="LT011.QTSHIJI" FieldOptions="" Order="0040"/><Column DataSource="LT011.QTJISSEKI" FieldOptions="" Order="0050"/><Column DataSource="LT011.AMJISSEKI" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="指示情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(LF012)" Caption="指示書" Number="10" Position="4"/><Button Action="CALL(LF014)" Caption="完了／取消" Number="11" Position="5"/><Column DataSource="BT020CHILD.TXSYOHIN" FieldOptions="WIDTH(300)" Order="0020"/><Column DataSource="BT020CHILD.TXHINBAN" FieldOptions="CAPTION(構成品番),WIDTH(200)" Order="0010"/><Column DataSource="BT020CHILD.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0060"/><Column DataSource="ET010CHILD.NRLOCATION" FieldOptions="CAPTION(ロケ№)" Order="0030"/><Column DataSource="LT011.TXLOTNUMBER" FieldOptions="WIDTH(300)" Order="0080"/></Detail><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0020" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="指示情報" Number="8" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0080"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0120"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0140"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0090"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0100"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0130"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="" Order="0110"/><Column DataSource="BT030A.TXSOUKO" FieldOptions="" Order="0060"/></Detail><Field DataSource="LT010.QTJISSEKI" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="LT010.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="LT010.TXTEKIYO" FieldOptions="WIDTH(1000)" Order="0160"/><Field DataSource="LT010.STSET" FieldOptions="HORIZONTAL(59)" Order="0030"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(セット品番)" Order="0070"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0140"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ)" Order="0090"/><Field DataSource="LT010.AMJISSEKI" FieldOptions="HORIZONTAL" Order="0150"/><Field DataSource="LT010.TMHAKKOU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(50)" Order="0050"/><Field DataSource="LT010.TMJISSEKI" FieldOptions="HORIZONTAL" Order="0060"/><Field DataSource="LT010.TXLOTNUMBER" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(34)" Order="0110"/></Function><Function AddBlankRowAllowed="T" AddRowListOrderBy="BT021.SQLIST" AddRowListReturnDataSources="BT021.NRCHILD" AddRowListReturnToDetailDataSources="LT011.NRCHILD" AddRowListTable="BT021" AddRowListWithFields="NRSYOHIN" AddRowListWithHeaderFields="LT010.NRSYOHIN" DetailKeyFields="" DetailRowNo="SQKOUSEI" DetailTable="LT011" HeaderFixedWhere="" HeaderKeyFields="" HeaderTable="LT010" ID="LF014A" Name="セット指示完了エントリー" Size="AUTO" SubsystemID="L" Type="XF310"><Field DataSource="LT010.NRSET" FieldOptions="" Order="0010"/><Field DataSource="LT010.DTYOTEI" FieldOptions="HORIZONTAL(71)" Order="0030"/><Field DataSource="LT010.QTSHIJI" FieldOptions="" Order="0090"/><Column DataSource="LT011.QTSHIJI" FieldOptions="WIDTH(100)" Order="0030"/><Column DataSource="LT011.QTJISSEKI" FieldOptions="WIDTH(100)" Order="0040"/><Column DataSource="LT011.AMJISSEKI" FieldOptions="WIDTH(100)" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(セット品番)" Order="0040"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(入庫倉庫／ロケ)" Order="0060"/><Field DataSource="LT010.QTJISSEKI" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/><Field DataSource="LT010.AMJISSEKI" FieldOptions="HORIZONTAL" Order="0120"/><Column DataSource="BT020CHILD.TXSYOHIN" FieldOptions="WIDTH(250)" Order="0020"/><Column DataSource="BT020CHILD.TXHINBAN" FieldOptions="CAPTION(構成品番),WIDTH(150)" Order="0010"/><Column DataSource="BT020CHILD.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0050"/><Field DataSource="LT010.TXTEKIYO" FieldOptions="WIDTH(1000)" Order="0130"/><AddRowListColumn DataSource="BT021.RTKOUSEI" FieldOptions="" Order="0030"/><AddRowListColumn DataSource="BT020B.TXSYOHIN" FieldOptions="" Order="0020"/><AddRowListColumn DataSource="BT020B.TXHINBAN" FieldOptions="CAPTION(構成品番)" Order="0010"/><AddRowListColumn DataSource="BT020B.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0040"/><AddRowListButton Action="EXIT" Caption="終了" Number="3" Position="0"/><AddRowListButton Action="ADD_SELECTED" Caption="選択分追加" Number="6" Position="3"/><Field DataSource="LT010.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="LT010.TXLOTNUMBER" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0080"/><Column DataSource="LT011.TXLOTNUMBER" FieldOptions="WIDTH(300)" Order="0070"/></Function><Function ID="LF014" Name="セット指示完了／完了取消エントリー" Script="var rLT010 = instance.createTableOperator('Select', 'LT010');#EOL#rLT010.setSelectFields('TMJISSEKI');#EOL#rLT010.addKeyValue('NRSET',&#x9;instance.parmMap.get('NRSET'));#EOL#if (rLT010.next()) {#EOL#&#x9;if (rLT010.getValueOf('TMJISSEKI') == '') {#EOL#&#x9;&#x9;instance.callFunction('LF014A'); //セット指示完了エントリー//#EOL#&#x9;} else {#EOL#&#x9;&#x9;instance.parmMap.put('INSTANCE_MODE', 'EDIT'); //編集モードで起動//#EOL#&#x9;&#x9;instance.callFunction('LF014B'); //セット指示完了取消//#EOL#&#x9;}#EOL#}" SubsystemID="L" Type="XF000"/><Function FixedWhere="" ID="LF014B" InitialMsg="＊完了を取り消すためにはＦ９を押してください。" KeyFields="" Name="セット指示完了取消" PrimaryTable="LT010" Size="AUTO" SubsystemID="L" Type="XF200" UpdateOnly="T"><Field DataSource="LT010.NRSET" FieldOptions="" Order="0010"/><Field DataSource="LT010.QTSHIJI" FieldOptions="" Order="0090"/><Field DataSource="LT010.QTJISSEKI" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="LT010.TXTEKIYO" FieldOptions="WIDTH(1000)" Order="0130"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="完了取消" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="LT010.AMJISSEKI" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(セット品番)" Order="0030"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ)" Order="0050"/><Field DataSource="LT010.TMJISSEKIWORK" FieldOptions="CAPTION(実際完了日時),HORIZONTAL(71)" Order="0020"/><Field DataSource="LT010.TXLOTNUMBER" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0080"/><Field DataSource="LT010.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/></Function><Function DetailKeyFields="" DetailTable="LT011" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="LT010" ID="LF012A" Margins="50;50;30;30" Name="セット指示書の印刷" PageSize="A4" SubsystemID="L" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="3" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="RIGHT" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="UNDERLINE" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(セット指示書)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;Text(　　　倉庫　)&amp;Text(　)&amp;DataSource(BT030.TXSOUKO)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;Text(セット商品　)&amp;DataSource(BT020.TXHINBAN)&amp;Text(　)&amp;DataSource(BT020.TXSYOHIN)"/><Column Alignment="RIGHT" DataSource="LT011.QTSHIJI" FieldOptions="" Order="0040" Width="8"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="-120" Value="&amp;DataSourceImage(BT020.TXIMAGEFILENAME;0;0;200;160)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;Text(作業予定日　)&amp;DataSource(LT010.DTYOTEI)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0080" SpacingAfter="-18" Value="&amp;Text(　　　摘要　)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0070" SpacingAfter="0" Value="&amp;Text(　セット数　)&amp;DataSource(LT010.QTSHIJI)&amp;Text( )&amp;DataSource(BT020.KBZAIKOUM)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="75" MarginRight="210" Order="0081" SpacingAfter="0" Value="&amp;DataSource(LT010.TXTEKIYO)"/><Column Alignment="LEFT" DataSource="BT020CHILD.TXSYOHIN" FieldOptions="" Order="0030" Width="30"/><Column Alignment="LEFT" DataSource="BT020CHILD.TXHINBAN" FieldOptions="" Order="0020" Width="10"/><Column Alignment="CENTER" DataSource="BT020CHILD.TXIMAGEFILENAME" FieldOptions="" Order="0010" Width="7"/><Column Alignment="LEFT" DataSource="BT020CHILD.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0050" Width="5"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0082" SpacingAfter="10" Value="&amp;Text(　ロット№　)&amp;DataSource(LT010.TXLOTNUMBER)"/><HeaderPhrase Alignment="RIGHT" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0011" SpacingAfter="0" Value="&amp;Text(（指示№ )&amp;DataSource(LT010.NRSET)&amp;Text(）)"/><Column Alignment="LEFT" DataSource="LT011.TXLOTNUMBER" FieldOptions="" Order="0070" Width="32"/><Column Alignment="LEFT" DataSource="ET010CHILD.NRLOCATION" FieldOptions="CAPTION(ロケ№)" Order="0060" Width="5"/></Function><Function ID="LF012" Name="セット指示書の印刷（発行日時更新）" Script="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var uLT010;#EOL#var count = 0; var errorMessage = '';#EOL##EOL#//////////////////////////////#EOL#// 出荷指示書印刷処理の起動 //#EOL#//////////////////////////////#EOL#instance.callFunction('LF012A');#EOL##EOL#////////////////////#EOL#// 発行日時の更新 //#EOL#////////////////////#EOL#uLT010 = instance.createTableOperator('Update', 'LT010');#EOL#uLT010.addValue('TMHAKKOU',&#x9;session.getTimeStamp());#EOL#uLT010.addKeyValue('NRSET',&#x9;instance.parmMap.get('NRSET'));#EOL#count = uLT010.execute();#EOL#if (count == 1) {#EOL#&#x9;instance.returnMap.put('RETURN_CODE', '10');#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊セット指示書が発行されました。');#EOL#} else {#EOL#&#x9;errorMessage = 'セット指示(LT010)の更新に失敗しました。';#EOL#}#EOL##EOL#////////////////#EOL#// エラー処理 //#EOL#////////////////#EOL#if (errorMessage != '') {#EOL#&#x9;instance.cancelWithMessage(errorMessage);#EOL#}" SubsystemID="L" Type="XF000"/><PrintFont FontName="Hゴシック" ID="Font0" PDFEncoding="UniJIS-UCS2-H" PDFFontName="HeiseiKakuGo-W5"/><PrintFont FontName="H明朝" ID="Font1" PDFEncoding="UniJIS-UCS2-H" PDFFontName="HeiseiMin-W3"/><PrintFont FontName="Times-Roman" ID="Font2" PDFEncoding="Cp1252" PDFFontName="Times-Roman"/><Function DetailFunction="ZF071" ID="ZF070" InitialListing="T" InitialMsg="" InitialReadCount="" KeyFields="" Name="休日の一覧・保守" OrderBy="" PrimaryTable="ZT070" Size="AUTO" SubsystemID="Z" Type="XF100"><Column DataSource="ZT070.KBCALENDAR" FieldOptions="" Order="0000"/><Column DataSource="ZT070.DTOFF" FieldOptions="" Order="0010"/><Column DataSource="ZT070.TXOFF" FieldOptions="" Order="0020"/><Filter DataSource="ZT070.KBCALENDAR" FieldOptions="" Order="0000"/><Filter DataSource="ZT070.DTOFF" FieldOptions="GE,CAPTION(日付≦)" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(ZF072)" Caption="土日登録" Number="7" Position="4"/></Function><Function DataName="休日" ID="ZF071" InitialMsg="" KeyFields="" Name="休日の保守" PrimaryTable="ZT070" Size="AUTO" SubsystemID="Z" Type="XF200"><Field DataSource="ZT070.KBCALENDAR" FieldOptions="" Order="0000"/><Field DataSource="ZT070.DTOFF" FieldOptions="" Order="0010"/><Field DataSource="ZT070.TXOFF" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function AddBlankRowAllowed="T" AddRowListInitialMsg="＊移動元倉庫の在庫一覧です。移動商品を選択してください。" AddRowListOrderBy="ET010.NRLOCATION;BT020.TXHINBAN" AddRowListReturnDataSources="ET010.NRLOCATION;ET010.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN" AddRowListReturnToDetailDataSources="ET010FROM.NRLOCATION;KT021.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN" AddRowListTable="ET010" AddRowListWithFields="NRSOUKO" AddRowListWithHeaderFields="KT020.NRSOUKOFROM" DetailKeyFields="" DetailRowNo="SQZAIKOIDOU" DetailTable="KT021" HeaderKeyFields="" HeaderTable="KT020" ID="KF022" Name="在庫移動指示見出し明細の保守" Size="AUTO" SubsystemID="K" Type="XF310"><Field DataSource="KT020.NRZAIKOIDOU" FieldOptions="" Order="0010"/><Field DataSource="KT020.DTSHIJI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0020"/><Field DataSource="KT020.DTKANRYOYOTEI" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0030"/><Field DataSource="KT020.TXTEKIYO" FieldOptions="WIDTH(900)" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="KT020.STZAIKOIDOU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0040"/><Field DataSource="BT030FROM.TXSOUKO" FieldOptions="CAPTION(移動元／先倉庫)" Order="0050"/><Field DataSource="BT030TO.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0040"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0030"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/><AddRowListButton Action="EXIT" Caption="終了" Number="3" Position="0"/><AddRowListButton Action="ADD_SELECTED" Caption="選択分追加" Number="5" Position="3"/><Column DataSource="KT021.QTIDOU" FieldOptions="" Order="0060"/><Field DataSource="KT020.TMHAKKOU" FieldOptions="" Order="0070"/><Field DataSource="KT020.TMKANRYO" FieldOptions="HORIZONTAL" Order="0080"/><Column DataSource="ET010FROM.NRLOCATION" FieldOptions="CAPTION(元ロケ№)" Order="0020"/><AddRowListColumn DataSource="ET010.NRLOCATION" FieldOptions="CAPTION(ロケ№)" Order="0010"/><AddRowListColumn DataSource="ET010.QTGENZAIKO" FieldOptions="" Order="0040"/><AddRowListColumn DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><AddRowListColumn DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><AddRowListColumn DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0050"/></Function><Function DetailFunction="EF011" ID="EF010" InitialMsg="" KeyFields="" Name="倉庫在庫データの一覧" OrderBy="BT020.TXHINBAN" PrimaryTable="ET010" Size="AUTO" SubsystemID="E" Type="XF100"><Filter DataSource="BT030.TXSOUKO" FieldOptions="PROMPT_LIST1" Order="0"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="1"/><Column DataSource="BT030.TXSOUKO" FieldOptions="" Order="00"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="01"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="02"/><Column DataSource="ET010.QTGENZAIKO" FieldOptions="" Order="03"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="04"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function HeaderFunction="EF012" HeaderKeyFields="" HeaderTable="ET010" ID="EF011" Name="倉庫在庫と関連情報の確認" Size="AUTO" SubsystemID="E" Type="XF300"><Field DataSource="BT030.TXSOUKO" FieldOptions="" Order="0010"/><Field DataSource="BT020.TXIMAGEFILENAME" FieldOptions="HORIZONTAL(150)" Order="0040"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0030"/><Field DataSource="BT020.KBSYOHIN" FieldOptions="" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="HORIZONTAL(10)" Order="0020"/><Field DataSource="BT020.TXSIYOU" FieldOptions="" Order="0060"/><Field DataSource="BT010.TXMAKERABR" FieldOptions="CAPTION(メーカー)" Order="0070"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="HORIZONTAL(18)" Order="0080"/><Field DataSource="ET010.QTGENZAIKO" FieldOptions="" Order="0150"/><Field DataSource="ET010.AMGENZAIKO" FieldOptions="HORIZONTAL" Order="0160"/><Field DataSource="ET010.QTANZENZAIKO" FieldOptions="" Order="0170"/><Field DataSource="ET010.QTJYOUGENZAIKO" FieldOptions="HORIZONTAL" Order="0180"/><Field DataSource="BT020.QTHANBAIUNIT" FieldOptions="" Order="0190"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL" Order="0200"/><Detail Caption="受払履歴" DetailFunction="EF101" InitialMsg="" KeyFields="NRSYOHIN;NRSOUKO;NRUKEBARAI" Order="0030" OrderBy="ET100.DTUKEBARAI;ET100.NRUKEBARAI" Table="ET100"><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.NRLOCATION" FieldOptions="" Order="0050"/><Column DataSource="ET100.TXAITESAKI" FieldOptions="" Order="0080"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="在庫属性情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0100"/><Column DataSource="ET100.AMSAGAKU" FieldOptions="" Order="0110"/><Filter DataSource="ET100.FGVALID" FieldOptions="PROMPT_LIST1,VALUE(VALUE:T)" Order="0030"/><Filter DataSource="ET100.KBUKEBARAI" FieldOptions="PROMPT_LIST1" Order="0020"/><Filter DataSource="ET100.DTUKEBARAI" FieldOptions="GE,CAPTION(受払日≧),VALUE(SESSION_ATTRIBUTE:Date3MonthsAgo)" Order="0010"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="" Order="0060"/></Detail><Detail Caption="受払予定" DetailFunction="EF201" HeaderKeyFields="NRSYOHIN;NRSOUKO" InitialMsg="" KeyFields="NRSYOHIN;NRSOUKO;NRTORIHIKIKANRI" Order="0020" OrderBy="ET200.DTYOTEI;ET200.KBYOTEI" Table="ET200"><Column DataSource="ET200.DTYOTEI" FieldOptions="" Order="0010"/><Column DataSource="ET200.KBYOTEI" FieldOptions="" Order="0020"/><Column DataSource="ET200.TXAITESAKI" FieldOptions="" Order="0040"/><Column DataSource="ET200.QTYOTEI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="在庫属性情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET200.QTZAIKOSUII" FieldOptions="" Order="0060"/><Column DataSource="ET200.NRSANSYOU" FieldOptions="" Order="0030"/></Detail><Field DataSource="ET010.QTKISYUZAIKO" FieldOptions="" Order="0090"/><Field DataSource="ET010.QTNYUKO" FieldOptions="" Order="0110"/><Field DataSource="ET010.QTSYUKKO" FieldOptions="" Order="0130"/><Field DataSource="ET010.AMKISYUZAIKO" FieldOptions="HORIZONTAL" Order="0100"/><Field DataSource="ET010.AMNYUKO" FieldOptions="HORIZONTAL" Order="0120"/><Field DataSource="ET010.AMSYUKKO" FieldOptions="HORIZONTAL" Order="0140"/></Function><Function ContinueAdd="T" DataName="在庫属性" ID="EF012" InitialMsg="" KeyFields="" Name="倉庫在庫属性の保守" PrimaryTable="ET010" Size="AUTO" SubsystemID="E" Type="XF200"><Field DataSource="BT030.TXSOUKO" FieldOptions="" Order="0010"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Field DataSource="ET010.AMGENZAIKO" FieldOptions="" Order="0040"/><Field DataSource="ET010.QTGENZAIKO" FieldOptions="" Order="0050"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="HORIZONTAL,NO_CAPTION" Order="0060"/><Field DataSource="ET010.QTANZENZAIKO" FieldOptions="" Order="0070"/><Field DataSource="ET010.QTJYOUGENZAIKO" FieldOptions="" Order="0080"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="ET010.NRLOCATION" FieldOptions="" Order="0090"/><Field DataSource="BT031.TXTEKIYO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/></Function><Function ID="EF300" Name="在庫検索用チェッカー" Script="//////////////////////////////////////#EOL#// 要求された品番・倉庫で在庫を検索 //#EOL#//////////////////////////////////////#EOL#var rET010 = instance.createTableOperator('Select', 'ET010');#EOL#rET010.setSelectFields('QTKISYUZAIKO');#EOL#rET010.addKeyValue('NRSYOHIN',&#x9;instance.parmMap.get('ET010.NRSYOHIN'));#EOL#rET010.addKeyValue('NRSOUKO',&#x9;instance.parmMap.get('ET010.NRSOUKO'));#EOL#if (rET010.next()) {#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// 倉庫在庫と関連情報の確認(EF021)の起動 //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;instance.parmMap.put('NRSYOHIN', instance.parmMap.get('ET010.NRSYOHIN'));#EOL#&#x9;instance.parmMap.put('NRSOUKO', instance.parmMap.get('ET010.NRSOUKO'));#EOL#&#x9;instance.callFunction('EF011'); #EOL#} else {#EOL#&#x9;javax.swing.JOptionPane.showMessageDialog(null, 'この倉庫向けに現時点で商品在庫も入荷予定もありません。');#EOL#}" SubsystemID="E" Type="XF000"/><Function DetailKeyFields="NRNYUKA;NRHATTYU;SQHATTYU;SQNYUKA" DetailTable="FT012" HeaderKeyFields="" HeaderTable="FT020" ID="FF030" Name="入荷実績エントリー" Size="AUTO" SubsystemID="F" Type="XF310"><Field DataSource="FT020.NRNYUKA" FieldOptions="" Order="0010"/><Field DataSource="FT020.NRTORIHIKISAKI" FieldOptions="CAPTION(仕入先)" Order="0040"/><Field DataSource="FT020.DTNYUKA" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="FT020.STNYUKA" FieldOptions="HORIZONTAL" Order="0020"/><Column DataSource="FT012.NRHATTYU" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(入荷倉庫),HORIZONTAL" Order="0070"/><Column DataSource="BT020A.TXSYOHIN" FieldOptions="WIDTH(220)" Order="0030"/><Column DataSource="BT020A.TXHINBAN" FieldOptions="WIDTH(180)" Order="0020"/><Column DataSource="FT012.QTYOTEISIIRE" FieldOptions="WIDTH(110)" Order="0060"/><Column DataSource="FT012.QTJITSUSIIRE" FieldOptions="CAPTION(検収数),WIDTH(110)" Order="0070"/><Column DataSource="FT012.QTDEFECT" FieldOptions="WIDTH(110)" Order="0080"/><Column DataSource="FT012.PRSIIRE" FieldOptions="WIDTH(110)" Order="0040"/><Column DataSource="FT012.TXLOTNUMBER" FieldOptions="WIDTH(150)" Order="0140"/><Column DataSource="FT012.NRLOCATION" FieldOptions="" Order="0130"/><Column DataSource="FT012.QTJITSUNYUKO" FieldOptions="CAPTION(在庫計上数),WIDTH(110)" Order="0110"/><Column DataSource="BT020A.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0120"/><Column DataSource="AT030.KBCURRENCY" FieldOptions="CAPTION(CUR)" Order="0050"/><Column DataSource="FT012.KBSIIREUM1" FieldOptions="" Order="0100"/></Function><Function DataName="仕入実績" ID="CF101" InitialMsg="" KeyFields="" Name="買掛増減履歴データの表示" PrimaryTable="CT100" Size="AUTO" SubsystemID="C" Type="XF200"><Field DataSource="CT100.NRSIIRE" FieldOptions="" Order="0010"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／品名)" Order="0100"/><Field DataSource="CT100.DTSIIRE" FieldOptions="HORIZONTAL" Order="0050"/><Field DataSource="CT100.KBAKADEN" FieldOptions="CAPTION(伝票区分),HORIZONTAL(55)" Order="0020"/><Field DataSource="CT100.KBSIIRE" FieldOptions="" Order="0040"/><Field DataSource="CT100.QTSIIRE" FieldOptions="" Order="0120"/><Field DataSource="CT100.AMTAX" FieldOptions="HORIZONTAL(74)" Order="0180"/><Field DataSource="CT100.DTCREATE" FieldOptions="" Order="0190"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="CT100.FGVALID" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0030"/><Field DataSource="CT100.KBSIIREUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0130"/><Field DataSource="CT100.PRSIIRE" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="CT100.AMSIIRE" FieldOptions="HORIZONTAL" Order="0150"/><Field DataSource="CT100.DTNEND" FieldOptions="CAPTION(年月度),HORIZONTAL" Order="0060"/><Field DataSource="CT100.DTMSEQ" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Field DataSource="CT100.NRSIHARAIIRAI" FieldOptions="HORIZONTAL" Order="0200"/><Button Action="CALL(CF102)" Caption="元取引" Number="7" Position="4"/><Field DataSource="CT100.NRTORIHIKISAKI" FieldOptions="" Order="0080"/><Field DataSource="CT110.NRSIHARAI" FieldOptions="HORIZONTAL" Order="0210"/><Field DataSource="CT100.KBCURRENCY" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0160"/><Field DataSource="CT100.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0110"/><Field DataSource="CT100.AMSIIRENAIKA" FieldOptions="" Order="0170"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="GT012" ID="GF042" Name="出荷明細別取引実績の検討" Size="AUTO" SubsystemID="G" Type="XF300"><Field DataSource="GT012.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT012.SQJYUTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT012.SQSYUKKA" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="GT012.NRSOUKO" FieldOptions="" Order="0070"/><Field DataSource="GT012.DTYOTEISYUKKA" FieldOptions="CAPTION(予定／実際出荷日),HORIZONTAL(50)" Order="0090"/><Field DataSource="GT012.QTJITSUSYUKKA" FieldOptions="HORIZONTAL" Order="0170"/><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialListing="T" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0020" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0040"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0050"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(GF043)" Caption="切り離し" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.TXLOTNUMBER" FieldOptions="" Order="0080"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0060"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0090"/><Column DataSource="ET100.AMSAGAKU" FieldOptions="CAPTION(粗利)" Order="0100"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/></Detail><Detail Caption="売掛増減履歴" DetailFunction="DF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRURIAGE" Order="0010" Table="DT100"><Column DataSource="DT100.NRURIAGE" FieldOptions="" Order="0010"/><Column DataSource="DT100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="DT100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="DT100.KBURIAGE" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(GF043,INSTANCE_MODE:EDIT)" Caption="切り離し" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="DT100.DTURIAGE" FieldOptions="" Order="0050"/><Column DataSource="DT100.PRURIAGE" FieldOptions="" Order="0080"/><Column DataSource="DT100.QTURIAGE" FieldOptions="" Order="0060"/><Column DataSource="DT100.KBURIAGEUM" FieldOptions="CAPTION(U/M)" Order="0070"/><Column DataSource="DT100.AMURIAGE" FieldOptions="" Order="0090"/><Column DataSource="DT100.AMTAX" FieldOptions="" Order="0100"/><Column DataSource="DT100.NRSEIKYU" FieldOptions="" Order="0110"/></Detail><Field DataSource="GT012.QTTORIKESHI" FieldOptions="" Order="0160"/><Field DataSource="GT012.TXLOTNUMBER" FieldOptions="" Order="0130"/><Field DataSource="GT012.AMTAX" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0200"/><Field DataSource="GT010.NRTORIHIKISAKI" FieldOptions="" Order="0050"/><Field DataSource="GT011.PRJYUTYU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0150"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="BT030.TXSOUKO" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0080"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0120"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0110"/><Field DataSource="GT020.DTSYUKKA" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0180"/><Field DataSource="GT012.AMURIAGE" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(23)" Order="0190"/><Field DataSource="GT012.NRSYUKKA" FieldOptions="HORIZONTAL" Order="0040"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL" Order="0140"/></Function><Function ID="GF032" Name="納品書の印刷(状態確認)" Script="/////////////////////////////#EOL#// 出荷見出し(GT020)の読込 //#EOL#/////////////////////////////#EOL#var rGT020 = instance.createTableOperator('Select', 'GT020');#EOL#rGT020.setSelectFields('TMKANRYO');#EOL#rGT020.addKeyValue('NRSYUKKA',&#x9;instance.parmMap.get('NRSYUKKA'));#EOL#if (rGT020.next()) {#EOL##EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;// 出荷完了であれば納品書発行機能を起動 //#EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;if (rGT020.getValueOf('TMKANRYO') == null || rGT020.getValueOf('TMKANRYO') == '') {#EOL#&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '納品書を発行する前に出荷報告してください');#EOL#&#x9;&#x9;instance.returnMap.put('RETURN_MESSAGE', '＊納品書発行は取り消されました。');#EOL#&#x9;} else {#EOL#&#x9;&#x9;instance.callFunction('GF032A'); //納品書発行//#EOL#&#x9;}#EOL#}" SubsystemID="G" Type="XF000"/><Function DetailKeyFields="NRSYUKKA;NRJYUTYU;SQJYUTYU;SQSYUKKA" DetailTable="GT012" Direction="LANDSCAPE" HeaderKeyFields="" HeaderTable="GT020" ID="GF032A" Margins="20;20;50;50" Name="納品書の印刷" PageSize="A4" SubsystemID="G" TableFontID="Font0" TableFontSize="9" TableRowNoWidth="3" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" Block="HEADER" FontID="Font0" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0000" SpacingAfter="0" Value="&amp;Text(納品書)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0001" SpacingAfter="0" Value="&amp;Text(出荷管理№ )&amp;DataSource(GT020.NRSYUKKA)&amp;Text(  出荷日 )&amp;DataSource(GT020.DTSYUKKA)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0002" SpacingAfter="-18" Value="&amp;DataSource(AT030GT020.TXKANJI)&amp;Text( 御中)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0003" SpacingAfter="0" Value="&amp;Image(logo.PNG;0;-5;32;0)&amp;SystemVariant(COMP_NAME)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0004" SpacingAfter="0" Value="&amp;SystemVariant(COMP_ADDRESS)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0005" SpacingAfter="0" Value="&amp;SystemVariant(COMP_TEL)&amp;Text( ㈹)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0006" SpacingAfter="10" Value="&amp;Text(営業担当 )&amp;DataSource(AT020GT020.TXKANJI)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0007" SpacingAfter="0" Value="&amp;Text(毎度お世話になっております。下記の商品を納品させていただきます。ご確認ください。)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0008" SpacingAfter="0" Value="&amp;Text(納品先 )&amp;DataSource(DT011GT020.TXKANJI)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font0" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0009" SpacingAfter="0" Value="&amp;Text(　　　 )&amp;DataSource(DT011GT020.NRYUBIN)&amp;Text( )&amp;DataSource(DT011GT020.TXJYUSYO)"/><Column Alignment="RIGHT" DataSource="GT012.QTJITSUSYUKKA" FieldOptions="CAPTION(納品数量)" Order="0060" Width="6"/><Column Alignment="LEFT" DataSource="GT012.TXLOTNUMBER" FieldOptions="CAPTION(摘要)" Order="0080" Width="32"/><Column Alignment="CENTER" DataSource="GT012.TXBUNNOU" FieldOptions="CAPTION(分納)" Order="0020" Width="3"/><Column Alignment="LEFT" DataSource="GT010.TXTYUBAN" FieldOptions="CAPTION(ご注文番号)" Order="0010" Width="8"/><Column Alignment="LEFT" DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0050" Width="28"/><Column Alignment="LEFT" DataSource="BT020.TXHINBAN" FieldOptions="" Order="0040" Width="10"/><Column Alignment="CENTER" DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070" Width="5"/><Column Alignment="CENTER" DataSource="BT020.TXIMAGEFILENAME" FieldOptions="" Order="0030" Width="5"/></Function><Function HeaderFunction="GF014" HeaderKeyFields="" HeaderTable="GT011" ID="GF017" Name="受注明細別出荷予定の検討" Size="AUTO" SubsystemID="G" Type="XF300"><Field DataSource="GT011.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT011.SQJYUTYU" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT011.PRJYUTYU" FieldOptions="HORIZONTAL(35)" Order="0150"/><Field DataSource="GT011.QTJYUTYU" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="GT011.DTKIBOUNOUKI" FieldOptions="" Order="0120"/><Detail Caption="出荷明細" DetailFunction="GF042" HeaderKeyFields="" InitialListing="T" InitialMsg="" KeyFields="" Order="0010" Table="GT012"><Column DataSource="GT012.SQSYUKKA" FieldOptions="" Order="0010"/><Column DataSource="GT012.NRSOUKO" FieldOptions="" Order="0020"/><Column DataSource="GT012.DTYOTEISYUKKA" FieldOptions="" Order="0040"/><Column DataSource="GT012.QTYOTEISYUKKA" FieldOptions="" Order="0060"/><Column DataSource="GT012.QTJITSUSYUKKA" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(GF015)" Caption="編集" Number="5" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="HEADER" Caption="受注明細" Number="7" Position="4"/><Column DataSource="BT030.TXSOUKO" FieldOptions="" Order="0030"/><Column DataSource="GT020.DTSYUKKA" FieldOptions="CAPTION(実際出荷日)" Order="0050"/><Column DataSource="GT012.TXLOTNUMBER" FieldOptions="" Order="0090"/><Column DataSource="GT012.NRSYUKKA" FieldOptions="" Order="0100"/><Column DataSource="GT012.PRSYUKKO" FieldOptions="" Order="0080"/></Detail><Field DataSource="GT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(20)" Order="0050"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0080"/><Field DataSource="BT020.TXSIYOU" FieldOptions="" Order="0100"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0140"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="DT011.TXKANJI" FieldOptions="CAPTION(出荷先)" Order="0060"/><Field DataSource="DT011.VLUNSOULT" FieldOptions="CAPTION_LENGTH_VARIABLE,HORIZONTAL(30)" Order="0070"/><Field DataSource="GT011.TXTEKIYO" FieldOptions="WIDTH(980)" Order="0160"/></Function><Function ContinueAdd="" ID="GF014" InitialMsg="" KeyFields="" Name="受注明細の保守" PrimaryTable="GT011" Size="AUTO" SubsystemID="G" Type="XF200"><Field DataSource="GT011.NRJYUTYU" FieldOptions="" Order="0010"/><Field DataSource="GT011.PRJYUTYU" FieldOptions="HORIZONTAL" Order="0130"/><Field DataSource="GT011.QTJYUTYU" FieldOptions="HORIZONTAL" Order="0140"/><Field DataSource="GT011.DTKIBOUNOUKI" FieldOptions="" Order="0120"/><Field DataSource="GT011.TXTEKIYO" FieldOptions="" Order="0160"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="DELETE" Caption="削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0090"/><Field DataSource="BT020.TXHINBAN" FieldOptions="" Order="0080"/><Field DataSource="BT020.TXSIYOU" FieldOptions="" Order="0100"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0150"/><Field DataSource="BT020.PRHANBAI" FieldOptions="HORIZONTAL" Order="0110"/><Field DataSource="DT010.CDKAKERITSURANK" FieldOptions="" Order="0050"/><Field DataSource="DT020.VLKAKERITSU" FieldOptions="HORIZONTAL" Order="0070"/><Field DataSource="DT020.TXKAKERITSURANK" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0060"/><Field DataSource="AT030.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/><Field DataSource="GT010.NRTORIHIKISAKI" FieldOptions="" Order="0030"/><Field DataSource="GT011.SQJYUTYU" FieldOptions="HORIZONTAL" Order="0020"/></Function><Function DetailKeyFields="NRSYUKKA;NRJYUTYU;SQJYUTYU;SQSYUKKA" DetailTable="GT012" HeaderKeyFields="" HeaderTable="GT020" ID="GF030" Name="出荷実績エントリー" Size="AUTO" SubsystemID="G" Type="XF310"><Field DataSource="GT020.NRSYUKKA" FieldOptions="" Order="0010"/><Field DataSource="GT020.DTSYUKKA" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="GT020.TXTEKIYO" FieldOptions="WIDTH(1296)" Order="0090"/><Column DataSource="GT012.NRJYUTYU" FieldOptions="" Order="0010"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="AT030GT020.TXKANJI" FieldOptions="CAPTION(倉庫),WIDTH(600),HORIZONTAL(112)" Order="0050"/><Field DataSource="AT030GT020.TXKANJI" FieldOptions="CAPTION(顧客),WIDTH(600)" Order="0070"/><Field DataSource="DT011GT020.TXKANJI" FieldOptions="CAPTION(出荷先),CAPTION_LENGTH_VARIABLE,WIDTH(600),HORIZONTAL(30)" Order="0080"/><Column DataSource="GT012.QTYOTEISYUKKA" FieldOptions="" Order="0040"/><Column DataSource="GT012.QTJITSUSYUKKA" FieldOptions="" Order="0050"/><Column DataSource="GT012.QTTORIKESHI" FieldOptions="" Order="0060"/><Column DataSource="GT012.TXLOTNUMBER" FieldOptions="" Order="0080"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0030"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0020"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/></Function><Function DetailFunction="KF032" ID="KF030" InitialMsg="" KeyFields="NRZAIKOHURIKAE" Name="在庫振替データの一覧・保守" OrderBy="" PrimaryTable="KT030" Size="AUTO" SubsystemID="K" Type="XF100"><Column DataSource="KT030.NRZAIKOHURIKAE" FieldOptions="" Order="0020"/><Column DataSource="KT030.KBZAIKOHURIKAE" FieldOptions="" Order="0030"/><Column DataSource="KT030.DTHURIKAE" FieldOptions="" Order="0010"/><Column DataSource="KT030.NRSOUKO" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(KF031)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BT030.TXSOUKO" FieldOptions="" Order="0050"/><Column DataSource="BT020.TXSYOHIN" FieldOptions="" Order="0070"/><Column DataSource="BT020.TXHINBAN" FieldOptions="" Order="0060"/><Column DataSource="KT030.QTHURIKAE" FieldOptions="" Order="0090"/><Column DataSource="KT030.AMHURIKAE" FieldOptions="" Order="0110"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0100"/><Filter DataSource="KT030.DTHURIKAE" FieldOptions="GE,CAPTION(振替日≧),VALUE(SESSION_ATTRIBUTE:DateLastYear)" Order="0010"/><Filter DataSource="BT020.TXHINBAN" FieldOptions="SCAN,CAPTION(品番SCAN)" Order="0020"/><Filter DataSource="KT030.NRSOUKO" FieldOptions="" Order="0030"/></Function><Function ContinueAdd="T" ID="KF031" InitialMsg="" KeyFields="NRZAIKOHURIKAE" Name="在庫振替の保守" PrimaryTable="KT030" Size="AUTO" SubsystemID="K" Type="XF200"><Field DataSource="KT030.NRZAIKOHURIKAE" FieldOptions="" Order="0010"/><Field DataSource="KT030.KBZAIKOHURIKAE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="KT030.DTHURIKAE" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="KT030.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL,PROMPT_CALL(BF110),PROMPT_CALL_TO_PUT(KT030.NRSOUKO),PROMPT_CALL_TO_PUT_TO(BT030.NRSOUKO),PROMPT_CALL_TO_GET(BT031.NRLOCATION),PROMPT_CALL_TO_GET_TO(KT030.NRLOCATION)" Order="0070"/><Field DataSource="KT030.QTHURIKAE" FieldOptions="" Order="0090"/><Field DataSource="KT030.AMHURIKAE" FieldOptions="HORIZONTAL(20)" Order="0110"/><Field DataSource="KT030.TXTEKIYO" FieldOptions="" Order="0120"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ),PROMPT_LIST" Order="0060"/><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名),PROMPT_CALL(BF100),PROMPT_CALL_TO_GET(BT020.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.KBZAIKOUM),PROMPT_CALL_TO_GET_TO(KT030.NRSYOHIN;BT020.TXHINBAN;BT020.TXSYOHIN;BT020.KBZAIKOUM)" Order="0040"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="KT030.TXLOTNUMBER" FieldOptions="" Order="0080"/></Function><Function HeaderFunction="KF031" HeaderKeyFields="" HeaderTable="KT030" ID="KF032" Name="在庫振替の検討" Size="AUTO" SubsystemID="K" Type="XF300"><Field DataSource="KT030.NRZAIKOHURIKAE" FieldOptions="" Order="0010"/><Field DataSource="KT030.KBZAIKOHURIKAE" FieldOptions="HORIZONTAL" Order="0020"/><Field DataSource="KT030.DTHURIKAE" FieldOptions="HORIZONTAL" Order="0030"/><Field DataSource="KT030.NRLOCATION" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0070"/><Detail Caption="受払履歴" DetailFunction="EF101" HeaderKeyFields="NRTORIHIKIKANRI" InitialMsg="" KeyFields="NRTORIHIKIKANRI;NRUKEBARAI" Order="0010" Table="ET100"><Column DataSource="ET100.NRUKEBARAI" FieldOptions="" Order="0010"/><Column DataSource="ET100.KBAKADEN" FieldOptions="" Order="0020"/><Column DataSource="ET100.FGVALID" FieldOptions="" Order="0030"/><Column DataSource="ET100.KBUKEBARAI" FieldOptions="" Order="0050"/><Column DataSource="ET100.DTUKEBARAI" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="HEADER" Caption="在庫振替情報" Number="8" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="ET100.QTUKEBARAI" FieldOptions="" Order="0060"/><Column DataSource="ET100.AMUKEBARAI" FieldOptions="" Order="0080"/><Column DataSource="BT020.KBZAIKOUM" FieldOptions="CAPTION(U/M)" Order="0070"/></Detail><Field DataSource="BT020.TXSYOHIN" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0050"/><Field DataSource="BT020.TXHINBAN" FieldOptions="CAPTION(品番／商品名)" Order="0040"/><Field DataSource="BT030.TXSOUKO" FieldOptions="CAPTION(倉庫／ロケ)" Order="0060"/><Field DataSource="KT030.QTHURIKAE" FieldOptions="" Order="0090"/><Field DataSource="KT030.AMHURIKAE" FieldOptions="HORIZONTAL(13)" Order="0110"/><Field DataSource="KT030.TXTEKIYO" FieldOptions="" Order="0120"/><Field DataSource="BT020.KBZAIKOUM" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0100"/><Field DataSource="KT030.TXLOTNUMBER" FieldOptions="" Order="0080"/></Function><MaintenanceLog Descriptions="・最初の公開版" Headder="2.0.0" ID="0" SortKey="20140728"/><MaintenanceLog Descriptions="・Java1.8に対応するために、スクリプト中のimportPackage()を廃止した#EOL#" Headder="2.0.1" ID="1" SortKey="20150427"/><MaintenanceLog Descriptions="・範囲KEY機能の停止にともなって、「AT021 従業員所属部門」の所属最終年月をScriptによる導出項目とした#EOL#・範囲KEY機能の停止にともなって、「CT011 仕入先別商品明細」のテーブル定義と関連する機能定義を修正した#EOL#・逆参照チェック機能の停止にともなって、各種テーブルに削除チェックのためのScriptを組み込んだ" Headder="2.0.2" ID="2" SortKey="20160205"/><Function ID="ZF072" Name="土日一括登録" Script="////////////////////////////#EOL#// 変数とダイアログの定義 //#EOL#////////////////////////////#EOL#var date; var dtOff = ''; var rZT070; var cZT070;#EOL#var dialog = session.getInputDialog();#EOL#dialog.setMessageHeight(80);#EOL#var kubun = dialog.addField('カレンダー区分', 'LISTBOX');#EOL#var rZT040 = instance.createTableOperator('Select', 'ZT040'); //ユーザ定義区分の検索用//#EOL#rZT040.addKeyValue('IDUSERKUBUN',&#x9;'KBCALENDAR');#EOL#rZT040.setOrderBy('SQLIST');#EOL#while (rZT040.next()) {#EOL#&#x9;kubun.addItem(rZT040.getValueOf('TXUSERKUBUN'), rZT040.getValueOf('KBUSERKUBUN'));#EOL#}#EOL#var year = dialog.addField('対象年', 'ALPHA');#EOL#var wrkStr = session.getSystemVariantString('ALLOWED_FISCAL_MONTH') + '';#EOL#year.value = Number(wrkStr.substring(0, 4)) + Number(1) + '';#EOL#dialog.setMessage('＊指定された年の土曜と日曜が休日として一括登録されます。既存であれば無視されます。');#EOL##EOL#////////////////////////////////////////////#EOL#// ダイアログ表示と条件にもとづく後続処理 //#EOL#////////////////////////////////////////////#EOL#var reply = dialog.request('土日一括登録');#EOL#if (reply == 0) {#EOL##EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;// 土日であればその日付を休日として登録 //#EOL#&#x9;//////////////////////////////////////////#EOL#&#x9;for (month = 0; month &lt; 12; month++) {#EOL#&#x9;&#x9;for (day = 1; day &lt;= 31; day++) {#EOL#&#x9;&#x9;&#x9;date = new Date(year.value, month, day);#EOL#&#x9;&#x9;&#x9;dtOff = year.value + '-' + (month + Number(1)) + '-' + day;#EOL#&#x9;&#x9;&#x9;if(dtOff == (date.getFullYear() + &quot;-&quot; + (date.getMonth() + Number(1)) + &quot;-&quot; + date.getDate())) {#EOL#&#x9;&#x9;&#x9;&#x9;if (date.getDay() == 0 || date.getDay() == 6) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rZT070 = instance.createTableOperator('Count', 'ZT070');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rZT070.addKeyValue('KBCALENDAR',&#x9;kubun.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;rZT070.addKeyValue('DTOFF',&#x9;&#x9;&#x9;dtOff);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;if (rZT070.execute() == 0) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cZT070 = instance.createTableOperator('Insert', 'ZT070');#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cZT070.addValue('KBCALENDAR',&#x9;kubun.value);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cZT070.addValue('DTOFF',&#x9;&#x9;dtOff);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cZT070.execute();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;instance.returnMap.put('RETURN_CODE', '10');#EOL#&#x9;instance.commit();#EOL##EOL#} else {#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE', '処理は取り消されました。');#EOL#&#x9;instance.returnMap.put('RETURN_CODE', '01');#EOL#}#EOL#" SubsystemID="Z" Type="XF000"/><MaintenanceLog Descriptions="･「ZF072 土日一括登録」を追加して、「ZF070 休日の一覧・保守」に組み込んだ#EOL#" Headder="2.0.3" ID="3" SortKey="20160428"/><MaintenanceLog Descriptions="XF200の「更新専用」の設定廃止にともなって、FF042,GF042,KF019,CF133,CF112,DF113,LF014からの関連機能の起動設定にINSTANCE_MODE:EDITのパラメータを組み込んだ" Headder="2.0.4" ID="4" SortKey="20160607"/><MaintenanceLog Descriptions="・ZT021を追加して、DB設定に追加した#EOL#・DB接続文字列からポート指定(:50000)をはずした" Headder="2.0.5" ID="5" SortKey="20160622"/></System>